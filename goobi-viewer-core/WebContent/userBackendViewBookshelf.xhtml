<ui:composition 
	xmlns="http://www.w3.org/1999/xhtml" 
	xmlns:c="http://java.sun.com/jsp/jstl/core" 
	xmlns:h="http://xmlns.jcp.org/jsf/html" 
	xmlns:f="http://xmlns.jcp.org/jsf/core" 
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets" 
	xmlns:composite="http://xmlns.jcp.org/jsf/composite" 
	xmlns:viewerComponent="http://xmlns.jcp.org/jsf/composite/components"
	xmlns:widgetComponent="http://xmlns.jcp.org/jsf/composite/components/widgets" 
	template="/resources/themes/#{navigationHelper.theme}/template.html">

	<composite:interface />

	<ui:define name="metadata">
		<f:metadata>
			<f:event type="preRenderView" listener="#{navigationHelper.setCurrentPage('mybookshelves', false, true)}" />
			<f:event type="preRenderView" listener="#{navigationHelper.addStaticLinkToBreadcrumb(msg.bookshelf_myBookshelves,1)}" />
			<f:event type="preRenderView" listener="#{navigationHelper.addStaticLinkToBreadcrumb(bookshelfBean.currentBookshelf.name,2)}" />
		</f:metadata>
	</ui:define>
	
	<ui:define name="breadcrumbs">
		<ui:include src="/resources/includes/breadcrumbs.xhtml" />
	</ui:define>

	<ui:define name="content">
		<div id="viewBookshelf" class="view-bookshelf">
			<h:panelGroup rendered="#{userBean.loggedIn}">
				<h2>#{msg.bookshelf_changeBookshelfText}: #{bookshelfBean.currentBookshelf.name}</h2>
				
				<p>#{bookshelfBean.currentBookshelf.description}</p>

				<!-- MESSAGE -->
				<h:panelGroup rendered="#{!configurationBean.bookshelvesEnabled}">
					<div class="alert alert-warning" role="alert">
						<h:outputText value="#{msg.errFunctionalityDisabled}" />
					</div>
				</h:panelGroup>

				<h:panelGroup rendered="#{configurationBean.bookshelvesEnabled}">
					<h:panelGroup rendered="#{!bookshelfBean.newBookshelf}">
						<!-- warning if no entries exists -->
						<h:panelGroup rendered="#{bookshelfBean.currentBookshelf.items.isEmpty()}">
							<div class="alert alert-warning" role="alert">#{msg.bookshelves_noEntryWarning}</div>
						</h:panelGroup>

						<!-- bookshelf entries -->
						<h:panelGroup rendered="#{!bookshelfBean.currentBookshelf.items.isEmpty()}">
							<div class="row">
								<ui:repeat value="#{bookshelfBean.currentBookshelf.items}" var="item" varStatus="status">
									<div class="col-xs-12 col-sm-6">
										<h:form id="viewBookshelfItemForm" prependId="false">
											<div class="view-bookshelf__item">
												<!--  IMAGE -->
												<div class="view-bookshelf__item-image" style="background-image: url('#{item.getRepresentativeImageUrl(400,400)}');">
													<a href="#{item.url}"></a>
												</div>
												<div class="view-bookshelf__item-info">
													<!--  NAME -->
													<h4>#{item.name}</h4>
													
													<!--  DESCRIPTION -->
<!-- 													<textarea name="item-description" id="itemDescription-#{status.index}" data-pi="#{item.pi}" placeholder="#{msg.bookshelf_enterItemDescription}"></textarea> -->
													
<!-- 													<ui:fragment rendered="#{!item.description}">														 -->
<!-- 														<h:inputTextarea name="item-description" value="#{bookshelfBean.currentBookshelfDescription}"> -->
<!-- 															<f:passThroughAttribute name="placeholder" value="#{msg.bookshelf_enterItemDescription}" /> -->
<!-- 														</h:inputTextarea> -->
<!-- 													</ui:fragment> -->
													
<!-- 													<ui:fragment rendered="#{item.description}"> -->
<!-- 														<p>#{item.description}</p> -->
<!-- 													</ui:fragment>													 -->
												</div>
												<!--  ACTION -->
												<div class="view-bookshelf__item-action">
													
<!-- 													<button type="button" data-bookshelf-type="save" data-description-id="#{status.index}">Speichern</button> -->



													<h:commandLink action="#{bookshelfBean.deleteCurrentItemAction(item)}" title="#{msg.bookshelf_itemDelete}" role="button">
														<f:passThroughAttribute name="data-bookshelf-type" value="delete" />
														<f:passThroughAttribute name="data-toggle" value="tooltip" />
														<f:passThroughAttribute name="data-placement" value="top" />
													</h:commandLink>
												</div>
											</div>
										</h:form>
									</div>
								</ui:repeat>
							</div>
						</h:panelGroup>
					</h:panelGroup>
				</h:panelGroup>
			</h:panelGroup>
		</div>
	</ui:define>

	<ui:define name="sidebar">
		<h:panelGroup rendered="#{browseBean.browsingMenuEnabled}">
			<widgetComponent:widget_browsing />
		</h:panelGroup>

		<widgetComponent:widget_bookshelfList />

		<h:panelGroup rendered="#{userBean.loggedIn}">
			<widgetComponent:widget_mySearches />
		</h:panelGroup>

		<widgetComponent:widget_user />
	</ui:define>

	<ui:define name="rssFeed">
		<ui:include src="resources/includes/rssFeed.xhtml" />
	</ui:define>
</ui:composition>