<ui:composition xmlns="http://www.w3.org/1999/xhtml" 
    xmlns:f="http://xmlns.jcp.org/jsf/core" 
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets" 
    xmlns:composite="http://xmlns.jcp.org/jsf/composite">
    
	<composite:interface>
        <composite:attribute name="piwikBaseURL" required="true" />
        <composite:attribute name="piwikSiteID" required="true" default="1" />
        <composite:attribute name="piwikFile" required="true" default="piwik.php" />
    </composite:interface>

    <composite:implementation>
        <script type="text/javascript">
        jQuery(document).ready(function() {
            var pkBaseURL = (("https:" == document.location.protocol) ? "https://#{cc.attrs.piwikBaseURL}" : "http://#{cc.attrs.piwikBaseURL}");
            jQuery.getScript(pkBaseURL + 'piwik.js', function() {
                var piwikTracker = Piwik.getTracker(pkBaseURL + "#{cc.attrs.piwikFile}", #{cc.attrs.piwikSiteID});
                piwikTracker.trackPageView();
                piwikTracker.enableLinkTracking();      
            })
        });
        </script>    
        <noscript>
            <p>
                <img src="http://#{cc.attrs.piwikBaseURL}/#{cc.attrs.piwikFile}?idsite=#{cc.attrs.piwikSiteID}" />
            </p>
        </noscript>
    </composite:implementation>
</ui:composition>
