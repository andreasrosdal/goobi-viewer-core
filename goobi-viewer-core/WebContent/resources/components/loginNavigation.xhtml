<ui:composition
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:composite="http://xmlns.jcp.org/jsf/composite">
    
    <!-- INTERFACE OPTIONS -->
    <composite:interface />

    <!-- COMPONENT CONTENT -->
    <composite:implementation>
        <ui:fragment rendered="#{configurationBean.displayUserNavigation}">
            <ul class="login-navigation">
                <!-- USER NOT LOGGED IN -->
                <ui:fragment rendered="#{!userBean.loggedIn}">
                    <li data-login="false">
                        <!-- TOGGLE LOGIN -->
                        <button type="button" class="btn btn--clean" data-toggle="login" aria-label="#{msg.userNotLoggedIn}">
                            <span>#{msg.userNotLoggedIn}</span>
                            <i class="fa fa-user-circle-o" aria-hidden="true"></i>
                        </button>
                    </li>
                </ui:fragment>
                
                <!-- USER LOGGED IN -->
                <ui:fragment rendered="#{userBean.loggedIn}">
                    <li data-login="true">
                        <!-- TOGGLE USER DROPDOWN -->
                        <button type="button" class="btn btn--clean" data-toggle="user-dropdown">
                            <!-- USER NAME -->
                            <ui:fragment rendered="#{userBean.user.nickName != ''}">
                                <span class="login-navigation__user-name" title="#{userBean.user.nickName}">#{userBean.user.nickName}</span>
                            </ui:fragment>
                            <ui:fragment rendered="#{userBean.user.nickName eq null}">
                                <span class="login-navigation__user-name" title="#{userBean.user.email}">#{userBean.user.email}</span>
                            </ui:fragment>
                            
                            <!-- USER ICON -->
                            <span class="login-navigation__user-icon">
                                <!-- GRAVATAR -->
                                <ui:fragment rendered="#{user.useGravatar}">
                                    <img src="#{user.getGravatarUrl(96)}" class="img-circle" alt="User Gravatar" />
                                </ui:fragment>
                                
                                <!-- ICON -->
                                <ui:fragment rendered="#{!user.useGravatar}">
                                    <i class="fa fa-user-circle-o" aria-hidden="true"></i>
                                </ui:fragment>
                            </span>
                        </button>
                        
                        <!-- USER DROPDOWN -->
                        <div class="login-navigation__user-dropdown">
                            <h:form id="userDropdownForm" prependId="false">
                                <ul>
                                    <!-- BOKKSHELVES -->
                                    <ui:fragment rendered="#{configurationBean.bookshelvesEnabled}">
                                        <li>
                                            <div class="login-navigation__user-dropdown-item">
                                                <div class="login-navigation__user-dropdown-item-icon">
                                                    <i class="fa #{msg.bookshelf_iconAdded}" aria-hidden="true"></i>
                                                </div>
                                                <div class="login-navigation__user-dropdown-item-string">
                                                    <a href="#{navigationHelper.applicationUrl}mybookshelves/">#{msg.bookshelf_myBookshelves}</a>
                                                </div>
                                            </div>
                                        </li>
                                    </ui:fragment>
                                    
                                    <!-- SAVED SEARCHES -->
                                    <ui:fragment rendered="#{searchBean.searchSavingEnabled}">
                                        <li>
                                            <div class="login-navigation__user-dropdown-item">
                                                <div class="login-navigation__user-dropdown-item-icon">
                                                    <i class="fa fa-search" aria-hidden="true"></i>
                                                </div>
                                                <div class="login-navigation__user-dropdown-item-string">
                                                    <a href="#{navigationHelper.applicationUrl}mysearches/">#{msg.user_mySearches}</a>
                                                </div>
                                            </div>
                                        </li>
                                    </ui:fragment>
                                    
                                    <!-- USERDATA -->
                                    <li>
                                        <div class="login-navigation__user-dropdown-item">
                                            <div class="login-navigation__user-dropdown-item-icon">
                                                <i class="fa fa-user-circle-o" aria-hidden="true"></i>
                                            </div>
                                            <div class="login-navigation__user-dropdown-item-string">
                                                <a href="#{navigationHelper.applicationUrl}user/">#{msg.userCP}</a>
                                            </div>
                                        </div>
                                    </li>
                                    
                                    <!-- ADMINISTRATION -->
                                    <ui:fragment rendered="#{userBean.admin or userBean.user.isHasPrivilege('CMS_PAGES')}">
                                        <li>
                                            <div class="login-navigation__user-dropdown-item">
                                                <div class="login-navigation__user-dropdown-item-icon">
                                                    <i class="fa fa-cogs" aria-hidden="true"></i>
                                                </div>
                                                <div class="login-navigation__user-dropdown-item-string">
                                                    <h:commandLink action="pretty:admin">#{msg.admin}</h:commandLink>
                                                </div>
                                            </div>
                                        </li>
                                    </ui:fragment>
                                </ul>
                                
                                <!-- LOGOUT -->
                                <div class="login-navigation__user-dropdown-action">
                                    <h:commandLink value="#{msg.logout}" action="#{userBean.logout}" styleClass="btn btn--full">
                                    </h:commandLink>
                                </div>
                            </h:form>
                        </div>
                    </li>
                </ui:fragment>
                
                <script type="text/javascript">
    			    viewerJS.userDropdown.init();
    			</script>
            </ul>
        </ui:fragment>
    </composite:implementation>
</ui:composition>
