/*!
 * This file is part of the Goobi viewer - a content presentation and management application for digitized objects.
 *
 * Visit these websites for more information.
 * - http://www.intranda.com
 * - http://digiverso.com
 *
 * This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free
 * Software Foundation; either version 2 of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along with this program. If not, see <http://www.gnu.org/licenses/>.
 */
var viewerJS=function(){"use strict";var e={currentPage:"",browser:"",sidebarSelector:"#sidebar",contentSelector:"#main",equalHeightRSSInterval:1e3,equalHeightInterval:500,messageBoxSelector:".messages .alert",messageBoxInterval:1e3,messageBoxTimeout:8e3,pageScrollSelector:".icon-totop",pageScrollAnchor:"#top",widgetNerSidebarRight:!1},t={};return t.init=function(o){if($.extend(!0,e,o),e.browser=viewerJS.helper.getCurrentBrowser(),console.info("Current Page = ",e.currentPage),console.info("Current Browser = ",e.browser),function(){if(navigator.userAgent.match(/IEMobile\/10\.0/)){var e=document.createElement("style");e.appendChild(document.createTextNode("@-ms-viewport{width:auto!important}")),document.querySelector("head").appendChild(e)}}(),$('[data-toggle="tooltip"]').tooltip(),!t.localStoragePossible){var n=this.helper.renderWarningPopover("Ihr Browser befindet sich im privaten Modus und unterstützt momentan nicht die Möglichkeit Daten lokal zu speichern. Aus diesem Grund sind nicht alle Funktionenn des viewers verfügbar. Bitte verlasen Sie den privaten Modus oder benutzen einen alternativen Browser. Vielen Dank.");$("body").append(n),$('[data-toggle="warning-popover"]').on("click",function(){$(".warning-popover").fadeOut("fast",function(){$(".warning-popover").remove()})})}switch($('[data-toggle="offcanvas"]').click(function(){var e=$(this).children(".glyphicon");$(".row-offcanvas").toggleClass("active"),$(this).toggleClass("in"),e.hasClass("glyphicon-option-vertical")?e.removeClass("glyphicon-option-vertical").addClass("glyphicon-option-horizontal"):e.removeClass("glyphicon-option-horizontal").addClass("glyphicon-option-vertical")}),$('[data-toggle="mobilenav"]').on("click",function(){$(".btn-toggle.search").removeClass("in"),$(".header-actions__search").hide(),$(".btn-toggle.language").removeClass("in"),$("#changeLocal").hide(),$("#mobileNav").slideToggle("fast")}),$('[data-toggle="language"]').on("click",function(){$(".btn-toggle.search").removeClass("in"),$(".header-actions__search").hide(),$(this).toggleClass("in"),$("#changeLocal").fadeToggle("fast")}),$('[data-toggle="search"]').on("click",function(){$(".btn-toggle.language").removeClass("in"),$("#changeLocal").hide(),$(this).toggleClass("in"),$(".header-actions__search").fadeToggle("fast")}),window.matchMedia("(max-width: 768px)").matches&&($(".rss_wrapp").length>0?setTimeout(function(){viewerJS.helper.equalHeight(e.sidebarSelector,e.contentSelector)},e.equalHeightRSSInterval):setTimeout(function(){viewerJS.helper.equalHeight(e.sidebarSelector,e.contentSelector)},e.equalHeightInterval),$(window).on("orientationchange",function(){viewerJS.helper.equalHeight(e.sidebarSelector,e.contentSelector)})),function(){var t=!1;setInterval(function(){if($(e.messageBoxSelector).size()>0&&!t){t=!0;setTimeout(function(){$(e.messageBoxSelector).each(function(){$(this).fadeOut("slow",function(){$(this).parent().remove()})}),t=!1},e.messageBoxTimeout)}},e.messageBoxInterval)}(),$(".collapse").on("show.bs.collapse",function(){$(this).prev().find(".glyphicon").removeClass("glyphicon-arrow-down").addClass("glyphicon-arrow-up")}),$(".collapse").on("hide.bs.collapse",function(){$(this).prev().find(".glyphicon").removeClass("glyphicon-arrow-up").addClass("glyphicon-arrow-down")}),this.pageScroll.init(e.pageScrollSelector,e.pageScrollAnchor),t.localStoragePossible&&($("#image_container").length>0||"readingmode"===currentPage?(null===localStorage.getItem("currIdDoc")&&localStorage.setItem("currIdDoc","false"),this.helper.saveSidebarTocPosition()):localStorage.setItem("sidebarTocScrollPosition",0)),"undefined"!=typeof jsf&&jsf.ajax.addOnEvent(function(o){var n=o.status,a=document.getElementById("AJAXLoader"),i=document.getElementById("AJAXLoaderSidebarToc");if(i&&a)switch(n){case"begin":i.style.display="block",a.style.display="none";break;case"complete":i.style.display="none",a.style.display="none";break;case"success":$('[data-toggle="tooltip"]').tooltip(),t.localStoragePossible&&(t.helper.saveSidebarTocPosition(),$(".widget-toc-elem-wrapp").scrollTop(localStorage.sidebarTocScrollPosition)),window.matchMedia("(max-width: 768px)").matches&&(viewerJS.helper.equalHeight(e.sidebarSelector,e.contentSelector),$(window).off().on("orientationchange",function(){viewerJS.helper.equalHeight(e.sidebarSelector,e.contentSelector)}))}else if(a)switch(n){case"begin":a.style.display="block";break;case"complete":a.style.display="none";break;case"success":$('[data-toggle="tooltip"]').tooltip(),window.matchMedia("(max-width: 768px)").matches&&(viewerJS.helper.equalHeight(e.sidebarSelector,e.contentSelector),$(window).off().on("orientationchange",function(){viewerJS.helper.equalHeight(e.sidebarSelector,e.contentSelector)}))}else switch(n){case"success":$('[data-toggle="tooltip"]').tooltip(),window.matchMedia("(max-width: 768px)").matches&&(viewerJS.helper.equalHeight(e.sidebarSelector,e.contentSelector),$(window).off().on("orientationchange",function(){viewerJS.helper.equalHeight(e.sidebarSelector,e.contentSelector)}))}}),"feedback"===currentPage&&$("#submitFeedbackBtn").attr("disabled",!0),$("#widgetNerFacetting").length>0&&(nerFacettingConfig.sidebarRight=e.widgetNerSidebarRight,this.nerFacetting.init(nerFacettingConfig)),$(".input-integer").on("keypress",function(e){if(e.which<48||e.which>57)return!1}),this.tinyConfig.language=currentLang,"adminCmsCreatePage"===currentPage&&(this.tinyConfig.setup=function(e){e.on("change input paste",function(e){tinymce.triggerSave(),createPageConfig.prevBtn.attr("disabled",!0),createPageConfig.prevDescription.show()})}),"overview"===currentPage&&(viewerJS.tinyConfig.menubar=!0,viewerJS.tinyMce.overview()),"undefined"!=typeof jsf&&jsf.ajax.addOnEvent(function(e){switch(e.status){case"success":"overview"===currentPage&&viewerJS.tinyMce.overview(),viewerJS.tinyMce.init(viewerJS.tinyConfig)}}),$(".tinyMCE").length>0&&viewerJS.tinyMce.init(this.tinyConfig),e.browser){case"Chrome":$("img").error(function(){$(this).addClass("broken")});break;case"Firefox":$("img").error(function(){$(this).hide()}),$(".image-doublePageView").length>0&&$(".image-doublePageView").addClass("oneUp");break;case"IE":case"Edge":case"Safari":$("img").error(function(){$(this).hide()})}},t.tinyConfig={},t}(jQuery),viewerJS=function(e){"use strict";function t(e){l&&(console.log("---------- _degradeFontSize() ----------"),console.log("_degradeFontSize: current = ",e));var t=e;--t>=d.minFontSize?($(d.fontDownBtn).prop("disabled",!1),$(d.fontUpBtn).prop("disabled",!1),$("html").css("font-size",t+"px"),a(t+"px")):($(d.fontDownBtn).prop("disabled",!0),$(d.fontUpBtn).prop("disabled",!1))}function o(e){l&&(console.log("---------- _raiseFontSize() ----------"),console.log("_raiseFontSize: current = ",e));var t=e;++t<=d.maxFontSize?($(d.fontDownBtn).prop("disabled",!1),$(d.fontUpBtn).prop("disabled",!1),$("html").css("font-size",t+"px"),a(t+"px")):($(d.fontDownBtn).prop("disabled",!1),$(d.fontUpBtn).prop("disabled",!0))}function n(e){return l&&(console.log("---------- _parseFontSize() ----------"),console.log("_parseFontSize: string = ",e)),parseInt(e.replace("px"))}function a(e){l&&(console.log("---------- _saveFontSize() ----------"),console.log("_parseFontSize: size = ",e)),localStorage.setItem("currentFontSize",e)}function i(){l&&console.log("---------- _setFontSize() ----------");var e=localStorage.getItem("currentFontSize");null===e||""===e?localStorage.setItem("currentFontSize",d.baseFontSize):$("html").css("font-size",e)}function r(){l&&console.log("---------- _setButtonState() ----------");var e=n(localStorage.getItem("currentFontSize"));e===d.minFontSize&&$(d.fontDownBtn).prop("disabled",!0),e===d.maxFontSize&&$(d.fontUpBtn).prop("disabled",!0)}var l=!1,s=0,c="",d={fontDownBtn:"",fontUpBtn:"",maxFontSize:18,minFontSize:12,baseFontSize:"14px"};return e.changeFontSize={init:function(g){l&&(console.log("##############################"),console.log("viewer.changeFontSize.init"),console.log("##############################"),console.log("viewer.changeFontSize.init: config - "),console.log(g)),$.extend(!0,d,g),e.localStoragePossible&&(i(),r(),$(d.fontDownBtn).on("click",function(){a(c=$("html").css("font-size")),t(s=n(c))}),$(d.fontUpBtn).on("click",function(){a(c=$("html").css("font-size")),o(s=n(c))}))}},e}((viewerJS=function(e){"use strict";function t(e,t){o&&(console.log("---------- _getPopoverContent() ----------"),console.log("_getPopoverContent: data = ",e),console.log("_getPopoverContent: config = ",t));var n="",a="";return n+='<ul class="list">',$.each(e,function(e,o){a=t.appUrl+"image/"+o.PI_TOPSTRUCT+"/"+o.THUMBPAGENO+"/"+o.LOGID+"/",n+="<li>",n+='<a href="'+a+'">',n+=o.LABEL,n+="</a>",n+="</li>"}),n+="</ul>"}var o=!1,n=null,a="",i={},r=null,l={appUrl:"",calendarWrapperSelector:".search-calendar__months",popoverTriggerSelector:'[data-popover-trigger="calendar-po-trigger"]',popoverTitle:"Bitte übergeben Sie den Titel des Werks"};return e.calendarPopover={init:function(e){o&&(console.log("##############################"),console.log("viewer.calendarPopover.init"),console.log("##############################"),console.log("viewer.calendarPopover.init: config - ",e)),$.extend(!0,l,e),$(l.popoverTriggerSelector).on("click",function(){n=$(this),a=encodeURI(n.attr("data-api")),viewerJS.helper.getRemoteData(a).done(function(e){r=t(e,l),i={placement:"auto bottom",title:l.popoverTitle,content:r,viewport:{selector:l.calendarWrapperSelector},html:!0},$(l.popoverTriggerSelector).popover("destroy"),n.popover(i),n.popover("show")})}),$("body").on("click",function(e){$(e.target).closest(l.popoverTriggerSelector).length||$(l.popoverTriggerSelector).popover("destroy")})}},e}(viewerJS||{},jQuery))||{},jQuery),viewerJS=function(e){"use strict";function t(e){var t="";$.each(e,function(e,n){t+="<h4>"+o(n.date)+"</h4>",$.each(n,function(e,o){if(o.title)for(var n=0;n<=o.title.length;n++)void 0!==o.title[n]&&(t+='<div class="sorted-feed-title"><a href="',t+=o.url,t+='" title="',t+=o.title[n],t+='">',t+=o.title[n],t+="</a></div>")})}),a.feedBox.append(t)}function o(e){var t=e.split("-"),o=parseInt(t[1]);return t[2]+". "+a.monthNames[o]+" "+t[0]}var n=null,a={path:null,dataSortOrder:null,dataCount:null,dataEncoding:null,feedBox:null,monthNames:["","Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"]};return e.dateSortedFeed={init:function(o){$.extend(!0,a,o);var i=a.path;i+="/api?action=query&q=PI:*&jsonFormat=datecentric&sortField=DATECREATED",i+="&sortOrder=",i+=a.dataSortOrder,i+="&count=",i+=a.dataCount,i+="&encoding=",i+=a.dataEncoding,a.feedBox&&(n=e.helper.getRemoteData(i)).then(function(e){t(e)}).then(null,function(){console.error("ERROR: viewer.dateSortedFeed.init - ",error)})},getDataSortOrder:function(){return a.dataSortOrder},setDataSortOrder:function(e){a.dataSortOrder=e},getDataCount:function(){return a.dataCount},setDataCount:function(e){a.dataCount=e},getDataEncoding:function(){return a.dataEncoding},setDataEncoding:function(e){a.dataEncoding=e}},e}((viewerJS=function(e){"use strict";var t=null,o=null,n=null,a=null,i=null,r={dataTablePaginator:"",txtField1:"",txtField2:"",totalCount:"",reloadBtn:""};return e.dataTable={init:function(t){$.extend(!0,r,t),e.dataTable.paginator.init(),$(".column-filter-wrapper").length>0&&e.dataTable.filter.init()},paginator:{setupAjax:!1,init:function(){t=$(r.dataTablePaginator),o=$(r.txtField1),n=$(r.txtField2),a=$(r.totalCount),i=$(r.reloadBtn),o.on("click",function(){$(this).hide(),e.dataTable.paginator.inputFieldHandler()}),a.on("click",function(){o.hide(),e.dataTable.paginator.inputFieldHandler()}),this.setupAjax||(jsf.ajax.addOnEvent(function(t){var a=t.status;if(r.dataTablePaginator.length>0)switch(a){case"begin":null!==o&&null!==n&&(o.off(),n.off());break;case"complete":break;case"success":e.dataTable.paginator.init()}}),this.setupAjax=!0)},inputFieldHandler:function(){n.show().find("input").focus().select(),n.find("input").on("blur",function(){$(this).hide(),o.show(),i.click()}),n.find("input").on("keypress",function(e){13==e.keyCode&&i.click()})}},filter:{setupAjax:!1,init:function(){$("#adminAllUserForm").on("submit",function(e){e.preventDefault(),$(".column-filter-wrapper").find(".btn-filter").click()}),this.setupAjax||(jsf.ajax.addOnEvent(function(t){var o=t.status;if(r.dataTablePaginator.length>0)switch(o){case"begin":case"complete":break;case"success":e.dataTable.filter.init()}}),this.setupAjax=!0)}}},e}(viewerJS||{},jQuery))||{},jQuery),viewerJS=function(e){"use strict";function t(e,t){o&&(console.log("---------- _getWorkInfo() ----------"),console.log("_getWorkInfo: pi = ",e),console.log("_getWorkInfo: logid = ",t));var a="";return""!==t||void 0!==t?(a=n.iiifPath+"pdf/mets/"+e+"/"+t+"/",o&&(console.log("if"),console.log("_getWorkInfo: restCall = ",a))):(a=n.iiifPath+"pdf/mets/"+e+"/-/",o&&(console.log("else"),console.log("_getWorkInfo: restCall = ",a))),viewerJS.helper.getRemoteData(a)}var o=!1,n={dataType:null,dataTitle:null,dataId:null,dataPi:null,downloadBtn:null,reCaptchaSiteKey:"",useReCaptcha:!0,path:"",iiifPath:"",apiUrl:"",userEmail:null,workInfo:{},modal:{id:"",label:"",string:{title:"",body:"",closeBtn:"",saveBtn:""}},messages:{downloadInfo:{text:"Informationen zum angeforderten Download",title:"Werk",part:"Teil",fileSize:"Größe"},reCaptchaText:"Um die Generierung von Dokumenten durch Suchmaschinen zu verhindern bestätigen Sie bitte das reCAPTCHA.",rcInvalid:"Die Überprüfung war nicht erfolgreich. Bitte bestätigen Sie die reCAPTCHA Anfrage.",rcValid:"Vielen Dank. Sie können nun ihre ausgewählte Datei generieren lassen.",eMailText:"Um per E-Mail informiert zu werden sobald der Download zur Verfügung steht, können Sie hier optional Ihre E-Mail Adresse hinterlassen",eMailTextLoggedIn:"Sie werden über Ihre registrierte E-Mail Adresse von uns über den Fortschritt des Downloads informiert.",eMail:""}},a=null;return e.downloadModal={init:function(i){o&&(console.log("##############################"),console.log("viewer.downloadModal.init"),console.log("##############################"),console.log("viewer.downloadModal.init: config = ",i)),$.extend(!0,n,i),(a=$("<div />")).addClass("dl-modal__overlay"),$("body").append(a),n.downloadBtn.on("click",function(){$(".dl-modal__overlay").fadeIn("fast"),n.dataType=$(this).attr("data-type"),n.dataTitle=$(this).attr("data-title"),""!==$(this).attr("data-id")?n.dataId=$(this).attr("data-id"):n.dataId="-",n.dataPi=$(this).attr("data-pi"),t(n.dataPi,n.dataId).done(function(t){n.workInfo=t,n.modal={id:n.dataPi+"-Modal",label:n.dataPi+"-Label",string:{title:n.dataTitle,body:e.downloadModal.renderModalBody(n.dataType,n.workInfo),closeBtn:n.messages.closeBtn,saveBtn:n.messages.saveBtn}},$(".dl-modal__overlay").fadeOut("fast"),e.downloadModal.initModal(n)})})},initModal:function(t){o&&(console.log("---------- viewer.downloadModal.initModal() ----------"),console.log("viewer.downloadModal.initModal: params = ",t)),$("body").append(e.helper.renderModal(t.modal)),$("#submitModal").attr("disabled","disabled"),$("#"+t.modal.id).modal("show"),$("#"+t.modal.id).on("shown.bs.modal",function(t){if(n.useReCaptcha)var o=grecaptcha.render("reCaptchaWrapper",{sitekey:n.reCaptchaSiteKey,callback:function(){e.downloadModal.validateReCaptcha(grecaptcha.getResponse(o))?($("#modalAlerts").append(e.helper.renderAlert("alert-success",n.messages.rcValid,!0)),$("#submitModal").removeAttr("disabled").on("click",function(){n.userEmail=$("#recallEMail").val(),n.apiUrl=e.downloadModal.buildAPICall(n.path,n.dataType,n.dataPi,n.dataId,n.userEmail),window.location.href=n.apiUrl})):$("#modalAlerts").append(e.helper.renderAlert("alert-danger",n.messages.rcInvalid,!0))}});else $(this).find(".modal-body h4").next("p").hide(),$("#submitModal").removeAttr("disabled").on("click",function(){n.userEmail=$("#recallEMail").val(),n.apiUrl=e.downloadModal.buildAPICall(n.path,n.dataType,n.dataPi,n.dataId,n.userEmail),window.location.href=n.apiUrl})}),$("#"+t.modal.id).on("hidden.bs.modal",function(e){$(this).remove()})},renderModalBody:function(e,t){o&&(console.log("---------- viewer.downloadModal.renderModalBody() ----------"),console.log("viewer.downloadModal.renderModalBody: type = ",e),console.log("viewer.downloadModal.renderModalBody: infos = ",t));var a="";return a+="",a+='<div id="modalAlerts"></div>',"pdf"===e?(a+="<h4>",a+='<i class="fa fa-file-pdf-o" aria-hidden="true"></i> PDF-Download: ',a+="</h4>"):(a+="<h4>",a+='<i class="fa fa-file-text-o" aria-hidden="true"></i> ePub-Download: ',a+="</h4>"),a+="<p>"+n.messages.downloadInfo.text+":</p>",a+='<dl class="dl-horizontal">',a+="<dt>"+n.messages.downloadInfo.title+":</dt>",a+="<dd>"+t.title+"</dd>",null!==t.div&&(a+="<dt>"+n.messages.downloadInfo.part+":</dt>",a+="<dd>"+t.div+"</dd>"),a+="<dt>"+n.messages.downloadInfo.fileSize+":</dt>",a+="<dd>"+t.size+"</dd>",a+="</dl>",n.useReCaptcha&&(a+="<hr />",a+="<p><strong>reCAPTCHA</strong></p>",a+="<p>"+n.messages.reCaptchaText+":</p>",a+='<div id="reCaptchaWrapper"></div>'),a+="<hr />",a+='<form class="email-form">',a+='<div class="form-group">',a+='<label for="recallEMail">'+n.messages.eMail+"</label>",void 0!=n.userEmail?(a+='<p class="help-block">'+n.messages.eMailTextLoggedIn+"</p>",a+='<input type="email" class="form-control" id="recallEMail" value="'+n.userEmail+'" disabled="disabled" />'):(a+='<p class="help-block">'+n.messages.eMailText+":</p>",a+='<input type="email" class="form-control" id="recallEMail" />'),a+="</div>",a+="</form>"},validateReCaptcha:function(e){return o&&(console.log("---------- viewer.downloadModal.validateReCaptcha() ----------"),console.log("viewer.downloadModal.validateReCaptcha: response = ",e)),0!=e},buildAPICall:function(e,t,n,a,i){o&&(console.log("---------- viewer.downloadModal.buildAPICall() ----------"),console.log("viewer.downloadModal.buildAPICall: path = ",e),console.log("viewer.downloadModal.buildAPICall: type = ",t),console.log("viewer.downloadModal.buildAPICall: pi = ",n),console.log("viewer.downloadModal.buildAPICall: logid = ",a),console.log("viewer.downloadModal.buildAPICall: email = ",i));var r="";return r+=e+"rest/download",r+=""==t?"/-":"/"+t,r+=""==n?"/-":"/"+n,r+=""==a?"/-":"/"+a,r+=""==i||void 0==i?"/-/":"/"+i+"/",encodeURI(r)}},e}((viewerJS=function(e){"use strict";var t=null,o=null;return e.download={init:function(){t=$("#agreeLicense"),(o=$("#downloadBtn")).prop("disabled",!0),t.on("click",function(){var t=$(this).prop("checked");e.download.checkboxValidation(t)})},checkboxValidation:function(e){if(!e)return o.prop("disabled",!0),!1;o.prop("disabled",!1)}},e}(viewerJS||{},jQuery))||{},jQuery),viewerJS=function(e){"use strict";return e.helper={truncateString:function(e,t){return parseInt(e.length)>t?e.substring(0,t)+"...":e},switchClass:function(e,t,o){e.toggleClass(function(){return e.hasClass(t)?(e.removeClass(t),o):(e.removeClass(o),t)})},saveSidebarTocPosition:function(){var t=null,o=localStorage.getItem("currIdDoc"),n=null,a="",i="";if(!e.localStoragePossible)return!1;"false"!==o?((n=$('li[data-iddoc="'+o+'"]')).length>0?($(".widget-toc-elem-wrapp").scrollTop(n.offset().top-$(".widget-toc-elem-wrapp").offset().top+$(".widget-toc-elem-wrapp").scrollTop()),localStorage.setItem("currIdDoc","false")):localStorage.setItem("currIdDoc","false"),$(".widget-toc-elem-link a").on("click",function(){i=$(this).parents("li").attr("data-iddoc"),localStorage.setItem("currIdDoc",i)})):(localStorage.setItem("currIdDoc","false"),$(".widget-toc-elem-expand a").on("click",function(){t=$(".widget-toc-elem-wrapp").scrollTop(),localStorage.setItem("sidebarTocScrollPosition",t)}),$(".widget-toc-elem-link a").on("click",function(e){e.preventDefault(),a=$(this).attr("href"),t=$(".widget-toc-elem-wrapp").scrollTop(),localStorage.setItem("sidebarTocScrollPosition",t),location.href=a}),$(".widget-toc-elem-wrapp").scrollTop(localStorage.getItem("sidebarTocScrollPosition")))},getRemoteData:function(e){return Q($.ajax({url:decodeURI(e),type:"GET",dataType:"JSON",async:!0}))},renderModal:function(e){var t={id:"myModal",label:"myModalLabel",closeId:"closeModal",submitId:"submitModal",string:{title:"Modal title",body:"",closeBtn:"Close",saveBtn:"Save changes"}};$.extend(!0,t,e);var o="";return o+='<div class="modal fade" id="'+t.id+'" tabindex="-1" role="dialog" aria-labelledby="'+t.label+'">',o+='<div class="modal-dialog" role="document">',o+='<div class="modal-content">',o+='<div class="modal-header">',o+='<button type="button" class="close" data-dismiss="modal" aria-label="'+t.string.closeBtn+'">',o+='<span aria-hidden="true">&times;</span>',o+="</button>",o+='<h4 class="modal-title" id="'+t.label+'">'+t.string.title+"</h4>",o+="</div>",o+='<div class="modal-body">'+t.string.body+"</div>",o+='<div class="modal-footer">',o+='<button type="button" id="'+t.closeId+'"  class="btn" data-dismiss="modal">'+t.string.closeBtn+"</button>",o+='<button type="button" id="'+t.submitId+'" class="btn">'+t.string.saveBtn+"</button>",o+="</div></div></div></div>"},renderAlert:function(e,t,o){var n="";return n+='<div role="alert" class="alert '+e+' alert-dismissible fade in">',o&&(n+='<button aria-label="Close" data-dismiss="alert" class="close" type="button"><span aria-hidden="true">×</span></button>'),n+=t,n+="</div>"},detectIEVersion:function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);if(e.indexOf("Trident/")>0){var o=e.indexOf("rv:");return parseInt(e.substring(o+3,e.indexOf(".",o)),10)}var n=e.indexOf("Edge/");return n>0&&parseInt(e.substring(n+5,e.indexOf(".",n)),10)},checkLocalStorage:function(){if("object"==typeof localStorage)try{return localStorage.setItem("testLocalStorage",1),localStorage.removeItem("testLocalStorage"),!0}catch(e){return console.error("Not possible to write in local Storage: ",e),!1}},renderWarningPopover:function(e){var t=$("<div />"),o=$("<p />"),n=$("<button />"),a=$('<i aria-hidden="true" />');return t.addClass("warning-popover"),n.addClass("btn-clean"),n.attr("data-toggle","warning-popover"),a.addClass("fa fa-times"),n.append(a),t.append(n),o.html(e),t.append(o),t},equalHeight:function(e,t){var o=$(e),n=$(t),a=o.outerHeight();a>n.outerHeight()&&n.css({"min-height":a+"px"})},validateReCaptcha:function(e,t){var o=grecaptcha.render(e,{sitekey:t,callback:function(){var e=grecaptcha.getResponse(o);return console.log(e),0!=e}})},getCurrentBrowser:function(){var e=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,t="undefined"!=typeof InstallTrigger,o=/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window["safari"]||typeof safari!=="undefined"&&safari.pushNotification).toString(),n=!!document.documentMode,a=!n&&!!window.StyleMedia,i=!!window.chrome&&!!window.chrome.webstore;return e?"Opera":t?"Firefox":o?"Safari":n?"IE":a?"Edge":i?"Chrome":void 0}},e.localStoragePossible=e.helper.checkLocalStorage(),e}((viewerJS=function(e){"use strict";var t={commentCount:0,editBtnCount:0,deleteBtnCount:0,deleteModalCount:0,btnId:null,commentText:null};return e.editComment={init:function(){""!==$('textarea[id*="newCommentInput"]').val()&&$('textarea[id*="newCommentInput"]').focus().val(""),$(".comment-edit").on("click",function(){$("#newCommentField").fadeOut(),t.btnId=$(this).attr("id").replace("commentEditBtn-",""),$("#addComment").hide(),$("#commentEditComment-"+t.btnId).prev().hide(),$("#commentEditComment-"+t.btnId).show(),$(".comment-edit").hide()}),$(".comment-abort").on("click",function(){$("#newCommentField").fadeIn(),$(".comments-comment-text").show(),$(".comment-edit").show(),$("#addComment").show(),$(this).parent().hide()}),$(".comment-edit").each(function(){$(this).attr("id","commentEditBtn-"+t.editBtnCount),t.editBtnCount++}),$(".comments-comment-edit").each(function(){$(this).attr("id","commentEditComment-"+t.commentCount),t.commentCount++}),$.each($(".comments-delete-btn"),function(){$(this).attr("data-toggle","modal").attr("data-target","#deleteCommentModal-"+t.deleteBtnCount),t.deleteBtnCount++}),$.each($(".deleteCommentModal"),function(){$(this).attr("id","deleteCommentModal-"+t.deleteModalCount),t.deleteModalCount++})}},e}(viewerJS||{},jQuery))||{},jQuery),viewerJS=function(e){"use strict";function t(e){p&&(console.log("---------- _renderOverview() ----------"),console.log("_renderOverview: data = ",e)),m="",m+='<ul class="overview-scale">',$.each(e.pages,function(t,o){m+="<li>",m+='<div class="page-number">',1==e.rangeSize?("nerfacetting"===T.currentPage?m+='<a href="'+T.baseUrl+"/image/"+T.workId+"/"+o.pageOrder+'/">':m+='<a href="'+T.baseUrl+"/"+T.currentPage+"/"+T.workId+"/"+o.pageOrder+'/">',m+=o.pageOrder,m+="</a>"):"nerfacetting"===T.currentPage?void 0!==o.firstPage||void 0!==o.lastPage?(m+='<a href="'+T.baseUrl+"/image/"+T.workId+"/"+o.firstPage+'/">',m+=o.firstPage+"-"+o.lastPage,m+="</a>"):(m+='<a href="'+T.baseUrl+"/image/"+T.workId+"/"+o.pageOrder+'/">',m+=o.pageOrder,m+="</a>"):void 0!==o.firstPage||void 0!==o.lastPage?(m+='<a href="'+T.baseUrl+"/"+T.currentPage+"/"+T.workId+"/"+o.firstPage+'/">',m+=o.firstPage+"-"+o.lastPage,m+="</a>"):(m+='<a href="'+T.baseUrl+"/"+T.currentPage+"/"+T.workId+"/"+o.pageOrder+'/">',m+=o.pageOrder,m+="</a>"),m+="</div>",m+='<div class="tag-container">',0===o.tags.length||"undefined"===o.tags.length?m+='<span class="page-tag empty">'+T.msg.emptyTag+"</span>":$.each(o.tags,function(e,t){m+='<span class="page-tag '+t.type+'">'+t.value+"</span>"}),m+="</div>",m+="</li>"}),m+="</ul>",$(T.overviewContent).hide().html(m).find(".tag-container").each(function(){$(this).children(".page-tag").slice(T.recurrenceNumber).remove()}),$(T.overviewContent).show(),$(T.loader).hide(),$(".tag-container").on({mouseover:function(){o($(this))},mouseout:function(){n()}})}function o(e){var t=e.html(),o=e.position();T.sidebarRight?"nerfacetting"===T.currentPage?$(T.currentTags).html(t).css({display:"block",top:o.top+25+"px"}):$(T.currentTags).addClass("right").html(t).css({display:"block",top:o.top-2+"px",left:"auto",right:"100%"}):"nerfacetting"===T.currentPage?$(T.currentTags).html(t).css({display:"block",top:o.top+25+"px"}):$(T.currentTags).html(t).css({display:"block",top:o.top-2+"px"})}function n(){$(T.currentTags).hide()}function a(){p&&(console.log("---------- _renderSection() ----------"),console.log("_renderSection: _currentNerPageRange = ",_),console.log("_renderSection: _currentNerType = ",P)),f=d(),(I=e.helper.getRemoteData(f)).then(function(t){v=l(t),null!==_&&""!==_||(_=localStorage.getItem("currentNerPageRange")),null!==P&&""!==P||(P=localStorage.getItem("currentNerType")),"nerfacetting"===T.currentPage?$("#sliderScale .scale-page.end").html(v):v>1e3?$("#sliderScale .scale-page.end").html("999+"):$("#sliderScale .scale-page.end").html(v),$(T.slider).slider({orientation:"vertical",range:!1,min:1,max:v,value:v,slide:function(e,t){b=$(T.sliderHandle).position(),w=v+1-t.value,$(".page-bubble").show(),r(w)},start:function(){b=$(T.sliderHandle).position(),S=b.top},stop:function(t,o){switch(P=localStorage.getItem("currentNerType"),x=$(T.sliderScale).height(),_>v?$(T.sliderSectionStripe).css({top:"0px",height:"600px"}):b.top<100?$(T.sliderSectionStripe).animate({top:"0px",height:"100px"}):b.top>100&&(b.top>500?$(T.sliderSectionStripe).animate({top:x-100+"px",height:"100px"}):S<b.top?$(T.sliderSectionStripe).animate({top:b.top-25+"px",height:"100px"}):$(T.sliderSectionStripe).animate({top:b.top-50+"px",height:"100px"})),_){case"5":for(y=w-2,C=w+3;y<1;)y++,C++;for(;C>v;)y--,C--;f=u(y,C,P);break;case"10":for(y=w-5,C=w+5;y<1;)y++,C++;for(;C>v;)y--,C--;f=u(y,C,P);break;case"50":for(y=w-25,C=w+25;y<1;)y++,C++;for(;C>v;)y--,C--;f=u(y,C,P);break;case"100":for(y=w-50,C=w+50;y<1;)y++,C++;for(;C>v;)y--,C--;f=u(y,C,P)}(I=e.helper.getRemoteData(f)).then(function(t){""===(m=i(h=t))?$(T.sectionTags).hide().html(e.helper.renderAlert("alert-warning",T.msg.emptyTag,!1)).show():($(T.sectionTags).hide().html(m).each(function(){$(this).children(".page-tag").slice(T.recurrenceSectionNumber).remove()}),$(T.sectionTags).show()),$(".page-bubble").fadeOut()}).then(null,function(t){$(".facetting-content").empty().append(e.helper.renderAlert("alert-danger","<strong>Status: </strong>"+t.status+" "+t.statusText,!1)),console.error("ERROR: viewer.nerFacetting.init - ",t)})}}),f=u(0,_,P),(I=e.helper.getRemoteData(f)).then(function(t){""===(m=i(h=t))?$(T.sectionTags).hide().html(e.helper.renderAlert("alert-warning",T.msg.emptyTag,!1)).show():($(T.sectionTags).hide().html(m).each(function(){$(this).children(".page-tag").slice(T.recurrenceSectionNumber).remove()}),$(T.sectionTags).show()),$(T.loader).hide()}).then(null,function(t){$(".facetting-content").empty().append(e.helper.renderAlert("alert-danger","<strong>Status: </strong>"+t.status+" "+t.statusText,!1)),console.error("ERROR: viewer.nerFacetting.init - ",t)})}).then(null,function(t){$(".facetting-content").empty().append(e.helper.renderAlert("alert-danger","<strong>Status: </strong>"+t.status+" "+t.statusText,!1)),console.error("ERROR: viewer.nerFacetting.init - ",t)})}function i(e){return p&&(console.log("---------- _renderSectionTags() ----------"),console.log("_renderSectionTags: data - ",e)),m="",$.each(e.pages,function(e,t){0===t.tags.length||"undefined"===t.tags.length?m+="":$.each(t.tags,function(e,t){"nerfacetting"===T.currentPage?t.counter<10?m+='<span class="page-tag '+t.type+'" style="font-size: 1.'+t.counter+'rem;">'+t.value+"</span>":m+='<span class="page-tag '+t.type+'" style="font-size: 2rem;">'+t.value+"</span>":t.counter<10?m+='<span class="page-tag '+t.type+'" style="font-size: 1'+t.counter+'px;">'+t.value+"</span>":m+='<span class="page-tag '+t.type+'" style="font-size: 19px;">'+t.value+"</span>"})}),m}function r(e){p&&(console.log("---------- _renderPageBubble() ----------"),console.log("_renderPageBubble: page - ",e));var t="";switch(_){case"5":for(y=e-2,C=e+3;y<1;)y++,C++;for(;C>v;)y--,C--;t+='<span class="page-bubble">'+y+"-"+C+"</span>";break;case"10":for(y=e-5,C=e+5;y<1;)y++,C++;for(;C>v;)y--,C--;t+='<span class="page-bubble">'+y+"-"+C+"</span>";break;case"50":for(y=e-25,C=e+25;y<1;)y++,C++;for(;C>v;)y--,C--;t+='<span class="page-bubble">'+y+"-"+C+"</span>";break;case"100":for(y=e-50,C=e+50;y<1;)y++,C++;for(;C>v;)y--,C--;t+='<span class="page-bubble">'+y+"-"+C+"</span>"}$("#sliderVertical .ui-slider-handle").html(t)}function l(e){return p&&(console.log("---------- _getPageCount() ----------"),console.log("_getPageCount: work - ",e)),e.pages.length}function s(){p&&console.log("---------- _resetFacettingIcons() ----------"),$(".facetting-trigger").addClass("active"),$(".reset-filter").hide()}function c(){p&&console.log("---------- _cleanUpLocalStorage() ----------"),localStorage.removeItem("currentNerPageRange"),localStorage.removeItem("currentNerType")}function d(){return T.baseUrl+T.apiUrl+T.workId}function g(e,t){return T.baseUrl+T.apiUrl+"ranges/"+e+"/"+t+"/"+T.workId+"/"}function u(e,t,o){return T.baseUrl+T.apiUrl+e+"/"+t+"/"+o+"/"+T.workId+"/"}var p=!1,h=null,f="",m="",v=0,b={},S=0,w=0,x=0,y=0,C=0,_="",P="",I=null,T={currentPage:"",baseUrl:"",apiUrl:"/rest/ner/tags/",workId:"",overviewTrigger:"",overviewContent:"",sectionTrigger:"",sectionContent:"",facettingTrigger:"",setTagRange:"",slider:"",sliderScale:"",sectionTags:"",currentTags:"",sliderHandle:"",sliderSectionStripe:"",recurrenceNumber:0,recurrenceSectionNumber:0,sidebarRight:!1,loader:"",msg:{noJSON:"Es konnten keine Daten abgerufen werden.",emptyTag:"Keine Tags vorhanden",page:"Seite",tags:"Tags"}};return e.nerFacetting={init:function(o){p&&(console.log("##############################"),console.log("viewer.nerFacetting.init"),console.log("##############################"),console.log("viewer.nerFacetting.init: config - ",o)),$.extend(!0,T,o),e.localStoragePossible?($(T.loader).show(),c(),$(T.setTagRange).find("option").attr("selected",!1),"nerfacetting"===T.currentPage?$(T.setTagRangeOverview).find('option[value="1"]').prop("selected",!0):$(T.setTagRangeOverview).find('option[value="10"]').prop("selected",!0),s(),f="nerfacetting"===T.currentPage?g(1,"-"):g(10,"-"),(I=e.helper.getRemoteData(f)).then(function(o){null!==(h=o)||"undefinded"!==h?""===$(T.overviewContent).html()&&t(h):(m=e.helper.renderAlert("alert-danger",T.msg.noJSON+"<br /><br />URL: "+f,!0),$(T.overviewContent).html(m))}).then(null,function(t){$(".facetting-content").empty().append(e.helper.renderAlert("alert-danger","<strong>Status: </strong>"+t.status+" "+t.statusText,!1)),console.error("ERROR: viewer.nerFacetting.init - ",t)}),$(T.overviewTrigger).on("click",function(){$(T.loader).show(),$(T.setTagRange).find("option").attr("selected",!1),"nerfacetting"===T.currentPage?($(T.setTagRangeOverview).find('option[value="1"]').prop("selected",!0),localStorage.setItem("currentNerPageRange","1")):($(T.setTagRangeOverview).find('option[value="10"]').prop("selected",!0),localStorage.setItem("currentNerPageRange","10")),_=localStorage.getItem("currentNerPageRange"),localStorage.setItem("currentNerType","-"),P=localStorage.getItem("currentNerType"),s(),$(this).parent().hasClass("active")?console.info("Overview is already active."):(f="nerfacetting"===T.currentPage?g(1,"-"):g(10,"-"),(I=e.helper.getRemoteData(f)).then(function(e){t(h=e)}).then(null,function(t){$(".facetting-content").empty().append(e.helper.renderAlert("alert-danger","<strong>Status: </strong>"+t.status+" "+t.statusText,!1)),console.error("ERROR: viewer.nerFacetting.init - ",t)}))}),$(T.sectionTrigger).on("click",function(){$(T.loader).show(),$(T.setTagRange).find("option").attr("selected",!1),"nerfacetting"===T.currentPage?$(T.setTagRangeSection).find('option[value="5"]').prop("selected",!0):$(T.setTagRangeSection).find('option[value="10"]').prop("selected",!0),s(),"nerfacetting"===T.currentPage?localStorage.setItem("currentNerPageRange",5):localStorage.setItem("currentNerPageRange",10),_=localStorage.getItem("currentNerPageRange"),localStorage.setItem("currentNerType","-"),P=localStorage.getItem("currentNerType"),$(this).parent().hasClass("active")?console.info("Section is already active."):(a(),$(T.sliderSectionStripe).css("top","0px"))}),$(T.setTagRange).on("change",function(){var o=$(this).val();P=localStorage.getItem("currentNerType"),$(T.loader).show(),localStorage.setItem("currentNerPageRange",o),_=localStorage.getItem("currentNerPageRange"),$(this).hasClass("overview")?(null!==P&&""!==P||(P="-"),f=g(o,P),(I=e.helper.getRemoteData(f)).then(function(o){null!==(h=o)||"undefinded"!==h?t(h):(m=e.helper.renderAlert("alert-danger",T.msg.noJSON+"<br /><br />URL: "+f,!0),$(T.overviewContent).html(m))}).then(null,function(t){$(".facetting-content").empty().append(e.helper.renderAlert("alert-danger","<strong>Status: </strong>"+t.status+" "+t.statusText,!1)),console.error("ERROR: viewer.nerFacetting.init - ",t)})):(localStorage.setItem("currentNerPageRange",o),_=localStorage.getItem("currentNerPageRange"),a(),_>v?$(T.sliderSectionStripe).css({top:"0px",height:"600px"}):$(T.sliderSectionStripe).css({top:"0px",height:"100px"}))}),$(T.facettingTrigger).on("click",function(){var o=$(this).attr("data-type");$(T.loader).show(),localStorage.setItem("currentNerType",o),P=localStorage.getItem("currentNerType"),"nerfacetting"===T.currentPage?null!=_&&""!==_||(_=localStorage.setItem("currentNerPageRange",1)):null!=_&&""!==_||(_=localStorage.setItem("currentNerPageRange",10)),_=localStorage.getItem("currentNerPageRange"),$(".facetting-trigger").removeClass("active"),$(this).addClass("active"),$(".reset-filter").show(),"overview"===$(this).parent().parent().parent().attr("id")?(f=g(_,P),(I=e.helper.getRemoteData(f)).then(function(e){t(h=e),$(this).parent().hasClass("reset-filter")&&$(this).parent().hide(),"-"===P&&$(".facetting-trigger").addClass("active")}).then(null,function(t){$(".facetting-content").empty().append(e.helper.renderAlert("alert-danger","<strong>Status: </strong>"+t.status+" "+t.statusText,!1)),console.error("ERROR: viewer.nerFacetting.init - ",t)})):(a(),$(this).parent().hasClass("reset-filter")&&$(this).parent().hide(),"-"===P&&$(".facetting-trigger").addClass("active"),$(T.sliderSectionStripe).css("top","0px"))})):$(".facetting-content").empty().append(e.helper.renderAlert("alert-danger","<strong>Deactivated: </strong>Not possible to write in local Storage!",!1))}},e}((viewerJS=function(e){"use strict";function t(){a&&console.log("---------- _resetMenus() ----------"),$(".navigation__submenu-trigger").removeClass("active"),$(".navigation__submenu").removeClass("in"),$(".navigation__megamenu-trigger").removeClass("active"),$(".navigation__megamenu-wrapper").removeClass("in")}function o(){$(".level-2, .level-3, .level-4, .level-5").parent().removeClass("active"),$(".level-2, .level-3, .level-4, .level-5").removeClass("in").removeClass("left")}function n(e){a&&(console.log("---------- _clacSubMenuPosition() ----------"),console.log("_clacSubMenuPosition: menu - ",e));var t=e.offset().left,o=e.outerWidth(),n=$(window).outerWidth(),i=t+o;if(a&&(console.log("_clacSubMenuPosition: currentOffsetLeft - ",t),console.log("_clacSubMenuPosition: menuWidth - ",o),console.log("_clacSubMenuPosition: windowWidth - ",n),console.log("_clacSubMenuPosition: offsetWidth - ",i)),!(i>=n))return!1;e.addClass("left").css("width",o)}var a=!1,i={navigationSelector:"#navigation",subMenuSelector:'[data-toggle="submenu"]',megaMenuSelector:'[data-toggle="megamenu"]',closeMegaMenuSelector:'[data-toggle="close"]'};return e.navigation={init:function(e){a&&(console.log("##############################"),console.log("viewer.navigation.init"),console.log("##############################"),console.log("viewer.navigation.init: config - ",e)),$.extend(!0,i,e),$(i.subMenuSelector).on("click",function(){var e=$(this);$(this).parents(".navigation__submenu").hasClass("in")?(o(),e.parent().addClass("active"),e.next(".navigation__submenu").addClass("in"),n(e.next(".navigation__submenu"))):(t(),e.parent().addClass("active"),e.next(".navigation__submenu").addClass("in"))}),$(i.megaMenuSelector).on("click",function(){t(),$(this).next(".navigation__megamenu-wrapper").hasClass("in")?($(this).parent().removeClass("active"),$(this).next(".navigation__megamenu-wrapper").removeClass("in")):($(".navigation__megamenu-trigger").removeClass("active"),$(".navigation__megamenu-wrapper").removeClass("in"),$(this).parent().addClass("active"),$(this).next(".navigation__megamenu-wrapper").addClass("in"))}),$(i.closeMegaMenuSelector).on("click",function(){t()}),$(".navigation__megamenu-wrapper").length>0&&t(),$("body").on("click",function(e){"navigation"==e.target.id||$(e.target).closest(i.navigationSelector).length||t()})}},e}(viewerJS||{},jQuery))||{},jQuery),viewerJS=function(e){"use strict";function t(e,m){l&&(console.log("---------- _renderPopoverAction() ----------"),console.log("_renderPopoverAction: $Obj = ",e),console.log("_renderPopoverAction: id = ",m)),p=e.find(".fa-list-ul"),h=e.find(".normdata-preloader"),c=e.attr("data-remotecontent"),s=r(c,h,p),d=e.offset(),g=o(s,m),l&&(console.log("_renderPopoverAction: _dataURL = ",c),console.log("_renderPopoverAction: _data = ",s),console.log("_renderPopoverAction: _linkPos = ",d)),$("body").append(g),n(m,d,e),$(document).find("#normdataPopover-"+m).hide().fadeIn("fast",function(){e.attr("disabled","disabled").addClass("disabled"),e.tooltip("hide"),$(".normdataDetailLink").off("click").on("click",function(){t(u=$(this),f.id)})}).draggable(),a(e),f.id++,i(e)}function o(e,t){l&&(console.log("---------- _buildPopover() ----------"),console.log("_buildPopover: data = ",e),console.log("_buildPopover: id = ",t));var o="";return o+='<div id="normdataPopover-'+t+'" class="normdata-popover">',o+='<div class="normdata-popover-title">',o+="<h4>"+f.lang.popoverTitle+"</h4>",o+='<span class="normdata-popover-close glyphicon glyphicon-remove" title="'+f.lang.popoverClose+'"></span>',o+="</div>",o+='<div class="normdata-popover-content">',o+='<dl class="dl-horizontal">',$.each(e,function(e,t){$.each(t,function(e,t){o+='<dt title="'+e+'">'+e+"</dt>",o+="<dd>",$.each(t,function(t,n){n.text&&("URI"===e?(o+='<a href="'+n.text+'" target="_blank">',o+=n.text,o+="</a>"):o+=n.text),n.identifier&&(o+='<a href="'+f.path+"/search/-/"+n.identifier+'/1/">',o+='<span class="glyphicon glyphicon-search"></span>',o+="</a>"),n.url&&(o+='<button type="button" class="normdataDetailLink" data-remotecontent="',o+=f.path,o+="/api?action=normdata&amp;url=",o+=n.url,o+='" title="'+f.lang.showNormdata+'">',o+='<i class="fa fa-list-ul" aria-hidden="true"></i>',o+='<div class="normdata-preloader"></div>',o+="</button>"),o+="<br />"}),o+="</dd>"})}),o+="</dl>",o+="</div>",o+="</div>"}function n(e,t,o){l&&(console.log("---------- _calculatePopoverPosition() ----------"),console.log("_calculatePopoverPosition: id = ",e),console.log("_calculatePopoverPosition: pos = ",t),console.log("_calculatePopoverPosition: $Obj = ",o));var n=$("body").outerWidth(),a=$("#normdataPopover-"+e).outerWidth(),i=t.left+a;if(l&&(console.log("_calculatePopoverPosition: _bodyWidth = ",n),console.log("_calculatePopoverPosition: _popoverWidth = ",a),console.log("_calculatePopoverPosition: _popoverLeft = ",t.left),console.log("_calculatePopoverPosition: _popoverRight = ",i)),i>n){var r=i-n;l&&console.log("_calculatePopoverPosition: _diff = ",r),$(document).find("#normdataPopover-"+e).css({top:t.top+o.outerHeight()+5,left:t.left-r})}else $(document).find("#normdataPopover-"+e).css({top:t.top+o.outerHeight()+5,left:t.left})}function a(e){l&&(console.log("---------- _closeNormdataPopover() ----------"),console.log("_closeNormdataPopover: $Obj = ",e)),$(document).find(".normdata-popover-close").on("click",function(){$(this).parent().parent().remove(),e.removeAttr("disabled").removeClass("disabled"),$(".normdata-popover").length<1&&$(".closeAllPopovers").hide()})}function i(e){l&&(console.log("---------- _closeAllNormdataPopovers() ----------"),console.log("_closeAllNormdataPopovers: $Obj = ",e));var t=e.parent().find("i.closeAllPopovers");$(".normdata-popover").length>0?(t.show(),t.on("click",function(){$(".normdata-popover").each(function(){$(this).remove()}),$(".closeAllPopovers").each(function(){$(this).hide()}),$(".normdataLink").removeAttr("disabled").removeClass("disabled")})):t.hide()}function r(e,t,o){l&&(console.log("---------- _getRemoteData() ----------"),console.log("_getRemoteData: url = ",e),console.log("_getRemoteData: loader = ",t),console.log("_getRemoteData: icon = ",o)),t.show(),o.hide();var n=$.ajax({url:decodeURI(e),type:"POST",dataType:"JSON",async:!1,success:function(){t.hide(),o.show()}}).responseText;return jQuery.parseJSON(n)}var l=!1,s=null,c="",s="",d=null,g="",u=null,p=null,h=null,f={id:0,path:null,lang:{},elemWrapper:null};return e.normdata={init:function(e){l&&(console.log("##############################"),console.log("viewer.normdata.init"),console.log("##############################"),console.log("viewer.normdata.init: config = ",e)),$.extend(!0,f,e),$(".closeAllPopovers").hide(),$(".normdataLink").on("click",function(){(u=$(this)).off("focus"),t(u,f.id)})}},e}((viewerJS=function(e){"use strict";function t(e){return l&&(console.log("viewer.nerFulltext _getRemoteData: target - "),console.log(e)),$(".ner-detail-loader",e).css({display:"inline-block"}),$.ajax({url:decodeURI($(e).attr("data-remotecontent")),type:"POST",dataType:"JSON",async:!1,complete:function(){$(".ner-detail-loader").hide()}}).responseText}function o(e){l&&console.log("viewer.nerFulltext _initNerPopover: path - "+e);var o,s,c,d,g,u,p;$(".ner-trigger").on("click",function(){$("body").find(".ner-popover-pointer").hide(),$("body").find(".ner-popover").remove(),o=t($(this)),s=$(this).position(),d={top:s.top,left:s.left,width:$(this).outerWidth()},g=$("#view_fulltext_wrapp"),u=g.position(),p={top:u.top,left:0,right:u.left+g.outerWidth()},c=$(this).attr("title"),g.append(n(o,i(d,p),c,e)),$(".ner-popover")&&($(this).find(".ner-popover-pointer").show(),r(),$(".ner-detail-trigger").on("click",function(){o=t($(this)),c=$(this).attr("title"),$(this).parent().next(".ner-popover-detail").html(a(o,c))}))})}function n(e,t,o,n){l&&(console.log("viewer.nerFulltext _renderNerPopover: data - "),console.log(e),console.log("viewer.nerFulltext _renderNerPopover: position - "),console.log(t),console.log("viewer.nerFulltext _renderNerPopover: title - "+o),console.log("viewer.nerFulltext _renderNerPopover: path - "+n));var a=t.top,i=t.left,r="";return r+='<div class="ner-popover" style="top:'+a+"px; left:"+i+'px">',r+='<div class="ner-popover-close" title="Fenster schlie&szlig;en">&times;</div>',r+='<div class="ner-popover-header"><h4>'+o+"</h4></div>",r+='<div class="ner-popover-body">',r+='<dl class="dl-horizontal">',$.each($.parseJSON(e),function(e,t){$.each(t,function(e,t){r+='<dt title="'+e+'">'+e+":</dt>";var o="";$.each(t,function(t,a){var i="";switch(e){case"Beruf":case"Verwandte Begriffe":i="glyphicon-briefcase";break;case"Sohn":case"Vater":i="glyphicon-user";break;case"Geburtsort":case"Sterbeort":i="glyphicon-map-marker"}a.url?(o+="<span ",o+='class="ner-detail-trigger" ',o+='title="'+a.text+'" ',o+='tabindex="-1"',o+='data-remotecontent="'+n+"/api?action=normdata&url="+a.url+'">',o+='<span class="glyphicon '+i+'"></span>&nbsp;',o+=a.text,o+='<span class="ner-detail-loader"></span>',o+="</span>"):o+="URI"===e?'<a href="'+a.text+'" target="_blank">'+a.text+"</a>":a.text,o+="<br />"}),r+="<dd>"+o+"</dd>",r+='<div class="ner-popover-detail"></div>'})}),r+="</dl>",r+="</div>",r+="</div>"}function a(e,t){l&&(console.log("viewer.nerFulltext _renderNerPopoverDetail: data - "),console.log(e),console.log("viewer.nerFulltext _renderNerPopoverDetail: title - "+t));var o="";return o+='<div class="ner-popover-detail">',o+='<div class="ner-popover-detail-header"><h4>'+t+"</h4></div>",o+='<div class="ner-popover-detail-body">',o+='<dl class="dl-horizontal">',$.each($.parseJSON(e),function(e,t){$.each(t,function(e,t){o+='<dt title="'+e+'">'+e+":</dt>";var n="";$.each(t,function(t,o){n+="URI"===e?'<a href="'+o.text+'" target="_blank">'+o.text+"</a>":o.text,n+="<br />"}),o+="<dd>"+n+"</dd>",o+='<div class="ner-popover-detail"></div>'})}),o+="</dl>",o+="</div>",o+="</div>"}function i(e,t){l&&(console.log("viewer.nerFulltext _calculateNerPopoverPosition: triggerCoords - "),console.log(e),console.log("viewer.nerFulltext _calculateNerPopoverPosition: textBoxCoords - "),console.log(t));var o,n=e.left-(150-e.width/2),a=n+300,i=t.left,r=t.right,s=n;return o=e.top+27,n<=i&&(s=i),a>=r&&(s=t.right-300),{top:o,left:s}}function r(){l&&console.log("viewer.nerFulltext _removeNerPopover"),$(".ner-popover-close").on("click",function(){$("body").find(".ner-popover-pointer").hide(),$(this).parent().remove()})}var l=!1,s={path:null,lang:{}};return e.nerFulltext={init:function(e){l&&(console.log("##############################"),console.log("viewer.nerFulltext.init"),console.log("##############################"),console.log("viewer.nerFulltext.init: config - "),console.log(e)),$.extend(!0,s,e),o(s.path)}},e}(viewerJS||{},jQuery))||{},jQuery),viewerJS=function(e){"use strict";var t={themePath:"",imagePath:"",imageDataFile:"",galleryObject:null,maxColumnCount:null,maxImagesPerColumn:null,fixedHeight:!1,maxHeight:"",caption:!0,overlayColor:"",lang:{},lightbox:{active:!0,caption:!0}},o=null,n=null,a=null,i=null,r=null,l=null,s=null;return e.responsiveColumnGallery={init:function(c){$.extend(!0,t,c),s=t.themePath+t.imageDataFile,(o=e.helper.getRemoteData(s)).then(function(o){if(n=o,l=e.responsiveColumnGallery.checkForSmallViewport(),t.maxColumnCount>4)return t.galleryObject.append(e.helper.renderAlert("alert-danger","Die maximale Spaltenanzahl für die Galerie beträgt 4!",!0)),!1;for(var s=0;s<t.maxColumnCount;s++)t.galleryObject.append(e.responsiveColumnGallery.renderColumns(t.maxColumnCount));for(;n.length;)$.each($(".rcg-col"),function(){$(this).append(e.responsiveColumnGallery.renderImages(n.splice(0,t.maxImagesPerColumn)))});t.fixedHeight&&!l&&$.each($(".rcg-image-body"),function(){e.responsiveColumnGallery.fixedHeight($(this))}),t.lightbox.active&&$(".lightbox-toggle").on("click",function(t){t.preventDefault(),a=$(this).parent().children("img"),i=e.responsiveColumnGallery.prepareLightbox(a),r=e.responsiveColumnGallery.renderLightbox(i),$("body").append(r),$(".rcg-lightbox-body").hide(),$(".rcg-lightbox-overlay").fadeIn("slow"),$(".rcg-lightbox-image img").load(function(){e.responsiveColumnGallery.centerLightbox($(".rcg-lightbox-body")),$(".rcg-lightbox-body").show()}),$(".rcg-lightbox-close").on("click",function(){$(".rcg-lightbox-overlay").remove()}),$(document).keypress(function(e){27===e.keyCode&&$(".rcg-lightbox-overlay").remove()}),$(".rcg-lightbox-image img").on("click",function(){$(".rcg-lightbox-overlay").remove()})})}).then(null,function(o){t.galleryObject.append(e.helper.renderAlert("alert-danger","<strong>Status: </strong>"+o.status+" "+o.statusText,!1)),console.error("ERROR: viewer.responsiveColumnGallery.init - ",o)})},renderColumns:function(e){var t="";return t+='<div class="rcg-col col-'+e+'"></div>'},renderImages:function(e){var o="";return $.each(e,function(e,n){$.each(n,function(e,n){o+='<div class="rcg-image-container">',o+='<div class="rcg-image-body">',o+='<a href="'+n.url+'">',o+='<div class="rcg-image-overlay" style="background-color:'+t.overlayColor+'"></div>',o+="</a>",o+='<div class="rcg-image-title">',o+="<h4>"+n.title+"</h4>",o+="</div>",o+='<img src="'+t.themePath+t.imagePath+n.name+'" alt="'+n.alt+'" />',t.lightbox.active&&(o+='<div class="lightbox-toggle" title="'+t.lang.showLightbox+'">',o+='<span class="glyphicon glyphicon-fullscreen"></span>',o+="</div>"),o+="</div>",t.caption&&(o+='<div class="rcg-image-footer">',o+="<p>"+n.caption+'<a href="'+n.url+'" title="'+n.title+'">',o+=t.lang.goToWork+' <span class="glyphicon glyphicon glyphicon-picture"></span></a></p>',o+="</div>"),o+="</div>"})}),o},fixedHeight:function(e){e.children("img").css({height:t.maxHeight})},checkForSmallViewport:function(){return $(window).outerWidth()<=375},prepareLightbox:function(e){var t={};return t.src=e.attr("src"),t.caption=e.attr("alt"),t},renderLightbox:function(e){var o="";return o+='<div class="rcg-lightbox-overlay">',o+='<div class="rcg-lightbox-body">',o+='<div class="rcg-lightbox-close" title="'+t.lang.close+'"><span class="glyphicon glyphicon-remove"></span></div>',o+='<div class="rcg-lightbox-image">',o+='<img src="'+e.src+'" alt="'+e.alt+'" />',o+="</div>",t.lightbox.caption&&(o+='<div class="rcg-lightbox-caption">',o+="<p>"+e.caption+"</p>",o+="</div>"),o+="</div>",o+="</div>"},centerLightbox:function(e){var t=e.outerWidth(),o=e.outerHeight();e.css({"margin-top":"-"+o/2+"px","margin-left":"-"+t/2+"px"})}},e}((viewerJS=function(e){"use strict";function t(e){return $("html,body").animate({scrollTop:$(e).offset().top},1e3),!1}var o=null,n=null;return e.pageScroll={init:function(e,a){o=$(e),n=a,$(window).on("scroll",function(){window.pageYOffset>200?o.fadeIn():o.hide()}),o.on("click",function(){t(n)})}},e}(viewerJS||{},jQuery))||{},jQuery),viewerJS=function(e){"use strict";function t(e,t){return l&&(console.log("---------- _getApiUrl() ----------"),console.log("_getApiUrl: id = ",e)),c.contextPath+c.restApiPath+e+"/"+t+"/"}function o(e,t){l&&(console.log("---------- _renderChildHits() ----------"),console.log("_renderChildHits: data = ",e),console.log("_renderChildHits: $this = ",t));var o=null;t.next().empty(),$.each(e.children,function(e,r){(o=$('<div class="search-list__hit-content-set" />')).append(n(r.browseElement)),o.append(a(r.foundMetadata,r.url)),r.hasChildren&&$.each(r.children,function(e,t){o.append(i(t.browseElement,t.type))}),t.next().append(o)})}function n(e){l&&(console.log("---------- _renderHitSetTitle() ----------"),console.log("_renderHitSetTitle: data = ",e));var t=null,o=null,n=null;return t=$('<div class="search-list__struct-title" />'),o=$("<h5 />"),(n=$("<a />")).attr("href",c.contextPath+"/"+e.url),n.append(e.labelShort),o.append(n),t.append(o),t}function a(e,t){l&&(console.log("---------- _renderMetdataInfo() ----------"),console.log("_renderMetdataInfo: data = ",e),console.log("_renderMetdataInfo: url = ",t));var o=null,n=null,a=null,i=null,r=null,s=null,d=null;if(!$.isEmptyObject(e))return o=$('<div class="search-list__metadata-info" />'),n=$('<dl class="dl-horizontal" />'),$.each(e,function(e,l){a=$("<dt />"),i=$('<i class="fa fa-bookmark-o" aria-hidden="true" />'),(r=$("<a />")).attr("href",c.contextPath+"/"+t),r.append(l.one+":"),a.append(i).append(r),s=$("<dd />"),(d=$("<a />")).attr("href",c.contextPath+"/"+t),d.append(l.two),s.append(d),n.append(a).append(s),o.append(n)}),o}function i(e,t){l&&(console.log("---------- _renderSubChildHits() ----------"),console.log("_renderSubChildHits: data = ",e),console.log("_renderSubChildHits: type = ",t));var o=null,n=null,a=null,i=null,r=null;switch(o=$('<div class="search-list__struct-child-hits" />'),n=$('<dl class="dl-horizontal" />'),a=$("<dt />"),t){case"PAGE":a.append('<i class="fa fa-file-text-o" aria-hidden="true"></i>');break;case"EVENT":a.append('<i class="fa fa-calendar-o" aria-hidden="true"></i>')}switch(i=$("<dd />"),(r=$("<a />")).attr("href",c.contextPath+"/"+e.url),t){case"PAGE":r.append(e.fulltextForHtml);break;default:r.append(e.labelShort)}return i.append(r),n.append(a).append(i),o.append(n),o}function r(n,a,i){l&&(console.log("---------- _renderGetMoreChildren() ----------"),console.log("_renderGetMoreChildren: data = ",n),console.log("_renderGetMoreChildren: iddoc = ",a),console.log("_renderGetMoreChildren: $this = ",i));var d=t(a,c.hitsPerCall+n.hitsDisplayed),g=$("<div />"),u=$('<button type="button" />');if(!n.hasMoreChildren)return i.next().find(c.hitContentMoreSelector).empty().hide(),console.info("_renderGetMoreChildren: No more child hits available"),!1;g.addClass("search-list__hit-content-more"),u.addClass("btn-clean"),u.attr("data-api",d),u.attr("data-iddoc",a),u.append(c.msg.getMoreChildren),g.append(u),i.next().append(g),u.off().on("click",function(t){var n=$(this).attr("data-api");i.parent().offset().top;(s=e.helper.getRemoteData(n)).then(function(e){o(e,i),r(e,a,i)}).then(null,function(){i.next().append(e.helper.renderAlert("alert-danger","<strong>Status: </strong>"+error.status+" "+error.statusText,!1)),console.error("ERROR: _renderGetMoreChildren - ",error)})})}var l=!1,s=null,c={contextPath:"",restApiPath:"/rest/search/hit/",hitsPerCall:20,resetSearchSelector:"#resetCurrentSearch",searchInputSelector:"#currentSearchInput",searchTriggerSelector:"#slCurrentSearchTrigger",saveSearchModalSelector:"#saveSearchModal",saveSearchInputSelector:"#saveSearchInput",excelExportSelector:".excel-export-trigger",excelExportLoaderSelector:".excel-export-loader",hitContentLoaderSelector:".search-list__loader",hitContentSelector:".search-list__hit-content",msg:{getMoreChildren:"Mehr Treffer laden"}};return e.searchList={init:function(n){l&&(console.log("##############################"),console.log("viewer.searchList.init"),console.log("##############################"),console.log("viewer.searchList.init: config = ",n)),$.extend(!0,c,n),$('[data-toggle="tooltip"]').tooltip(),$(c.saveSearchModalSelector).on("shown.bs.modal",function(){$(c.saveSearchInputSelector).focus()}),$(c.resetSearchSelector).on("click",function(){$(c.searchInputSelector).val(""),location.href=c.contextPath+"/search/"}),$(c.excelExportSelector).on("click",function(){var e=$(this),t=$(c.excelExportLoaderSelector);e.hide(),t.show();var o=c.contextPath+"/rest/download/search/waitFor/";console.log("Calling ",o),Q($.ajax({url:decodeURI(o),type:"GET",dataType:"text",async:!0})).then(function(o){l&&console.log("Download started"),t.hide(),e.show()}).catch(function(o){l&&console.log("Error downloading excel sheet: ",o.responseText),t.hide(),e.show()})}),$('[data-toggle="hit-content"]').each(function(){var n=$(this),a=$(this).attr("data-iddoc"),i=t(a,c.hitsPerCall);l&&console.log("Current API Call URL: ",i),s=e.helper.getRemoteData(i),n.find(c.hitContentLoaderSelector).css("display","inline-block"),s.then(function(e){e.hitsDisplayed<c.hitsPerCall?(o(e,n),n.toggleClass("in").find(c.hitContentLoaderSelector).hide(),n.next().show(),n.off().on("click",function(){$(this).toggleClass("in").next().slideToggle()})):(n.find(c.hitContentLoaderSelector).hide(),n.off().on("click",function(){o(e,n),r(e,a,n),$(this).toggleClass("in").next().slideToggle()}))}).then(null,function(){n.next().append(e.helper.renderAlert("alert-danger","<strong>Status: </strong>"+error.status+" "+error.statusText,!1)),console.error("ERROR: viewer.searchList.init - ",error)})})}},e}((viewerJS=function(e){"use strict";function t(){a&&console.log("---------- _setAdvSearchValues() ----------"),$(r.inputSelector).off().on("keyup",function(){var e=$(this).attr("id"),t=$(this).val(),o=JSON.parse(localStorage.getItem("advSearchValues"));if(o.hasOwnProperty(t))return!1;o[e]=t,localStorage.setItem("advSearchValues",JSON.stringify(o))})}function o(){a&&console.log("---------- _getAdvSearchValues() ----------");var e=JSON.parse(localStorage.getItem("advSearchValues"));$.each(e,function(e,t){$("#"+e).val(t)})}function n(){a&&console.log("---------- _resetValue() ----------"),$(r.resetSelector).off().on("click",function(){var e=$(this).parents(".input-group").find("input").attr("id"),t=JSON.parse(localStorage.getItem("advSearchValues"));t.hasOwnProperty(e)&&delete t[e],localStorage.setItem("advSearchValues",JSON.stringify(t)),$(this).parents(".input-group").find("input").val("")})}var a=!1,i={},r={loaderSelector:".search-advanced__loader",inputSelector:".value-text",resetSelector:".reset"};return e.searchAdvanced={init:function(l){if(a&&(console.log("##############################"),console.log("viewer.searchAdvanced.init"),console.log("##############################"),console.log("viewer.searchAdvanced.init: config = ",l)),$.extend(!0,r,l),$('[data-toggle="tooltip"]').tooltip(),!e.localStoragePossible)return!1;localStorage.setItem("advSearchValues",JSON.stringify(i)),t(),n(),jsf.ajax.addOnEvent(function(e){switch(e.status){case"begin":$(r.loaderSelector).show();break;case"success":$('[data-toggle="tooltip"]').tooltip(),t(),o(),n(),$("select").each(function(){"disabled"===$(this).attr("disabled")?$(this).parent().addClass("disabled"):$(this).parent().removeClass("disabled")}),$(r.loaderSelector).hide()}})}},e}(viewerJS||{},jQuery))||{},jQuery),viewerJS=function(e){"use strict";function t(e){return r=e.attr("data-imgpath")}function o(e){return l=e.attr("data-imgname")}function n(e,t){var o="";return o='<div class="lightbox-overlay">',o+='<div class="lightbox-modal-box">',o+='<div class="lightbox-close">',o+='<span class="lightbox-close-btn" title="Fenster schlie&szlig;en">&times;</span>',o+="</div>",o+='<img src="'+e+t+'" alt="'+t+'" /></div></div>'}function a(e){var t=e.outerWidth(),o=e.outerHeight();e.css({"margin-top":"-"+o/2+"px","margin-left":"-"+t/2+"px"})}var i=null,r=null,l=null;return e.simpleLightBox={init:function(){$(".lightbox-image").on("click",function(e){e.preventDefault();var s=$(this);r=t(s),l=o(s),i=n(r,l),$("body").append(i),a($(".lightbox-modal-box")),$(".lightbox-overlay").fadeIn(),$(".lightbox-close-btn").on("click",function(){$(".lightbox-overlay").remove()})})}},e}((viewerJS=function(e){"use strict";var t="",o="",n="",a="",i="",r="",l={select:"#sortSelect"};return e.searchSortingDropdown={init:function(s){if($.extend(!0,l,s),!e.localStoragePossible)return!1;t=localStorage.dataSortField,n=location.href,""===t&&"undefinded"===t||$(l.select).children("option").each(function(){o=$(this).attr("data-sortField"),i=$(this).val(),o===t&&i===n&&$(this).attr("selected","selected")}),$(l.select).on("change",function(){if(a=$(this).val(),r=$(this).children("option:selected").attr("data-sortField"),""!==a){if("undefined"==typeof Storage)return console.info("Local Storage is not defined. Current sorting state could not be saved."),!1;localStorage.dataSortField=r,window.location.href=a}})}},e}(viewerJS||{},jQuery))||{},jQuery),viewerJS=function(e){"use strict";function t(e){r&&(console.log("viewer.timematrix _renderThumbs: json - "),console.log(e));var t="";return t+='<div class="timematrix-box">',t+='<header class="timematrix-header">',""!==c.startDate&&""!==c.endDate&&(t+="<h3>"+c.startDate+" - "+c.endDate+"</h3>"),t+="</header>",t+='<section class="timematrix-body">',$.each(e,function(e,o){t+='<div class="timematrix-thumb" data-title="'+o.title+'" data-mediumimage="'+o.mediumimage+'" data-url="'+o.url+'">',o.thumbnailUrl?t+='<img src="'+o.thumbnailUrl+'" style="visibility: hidden;" />':t+="",t+="</div>"}),t+="</section>",t+='<footer class="timematrix-footer"></footer>',t+="</div>"}function o(t,o){r&&(console.log("viewer.timematrix _renderPopover: obj - "),console.log(t),console.log("viewer.timematrix _renderPopover: lang - "+o));var a=t.attr("data-title"),i=t.attr("data-mediumimage"),l=t.attr("data-url"),s=t.position(),d=n({top:s.top,left:s.left,width:t.outerWidth()},c.$tmCanvasCoords),g="";g+='<div class="timematrix-popover" style="top: '+d.top+"px; left: "+d.left+'px;">',g+='<span class="timematrix-popover-close" title="'+o.closeWindow+'">&times;</span>',g+='<header class="timematrix-popover-header">',g+='<h4 title="'+a+'">'+e.helper.truncateString(a,75)+"</h4>",g+="</header>",g+='<section class="timematrix-popover-body">',g+='<div class="timematrix-popover-imageloader"></div>',g+='<a href="'+l+'"><img src="'+i+'" /></a>',g+="</section>",g+='<footer class="timematrix-popover-footer">',g+='<a href="'+l+'" title="'+a+'">'+o.goToWork+"</a>",g+="</footer>",g+="</div>",c.$tmCanvas.append(g)}function n(e,t){r&&(console.log("viewer.timematrix _calculatePopoverPosition: triggerCoords - "),console.log(e),console.log("viewer.timematrix _calculatePopoverPosition: tmCanvasCoords - "),console.log(t));var o,n=e.left-(150-e.width/2),a=n+300,i=t.left,l=t.right,s=n;return o=e.top+$(".timematrix-thumb").outerHeight()-1,n<=i&&(s=i),a>=l&&(s=t.right-300),{top:o,left:s}}function a(e,t){return r&&(console.log("viewer.timematrix _renderSliderBubble: time - "+e),console.log("viewer.timematrix _renderSliderBubble: val - "+t)),'<div class="timematrix-slider-bubble-'+e+'">'+t+"</div>"}function i(){r&&console.log("---------- _removePopovers() ----------"),$(".timematrix-popover").remove(),$(".timematrix-thumb").removeClass("marker")}var r=!1,l=null,s=null,c={contextPath:null,apiQuery:"api?action=timeline",startDateQuery:"&startDate=",rangeInput1:null,startDate:null,endDateQuery:"&endDate=",rangeInput2:null,endDate:null,countQuery:"&count=",count:null,$tmCanvas:null,$tmCanvasPos:null,$tmCanvasCoords:{},lang:{}};return e.timematrix={init:function(n){r&&(console.log("##############################"),console.log("viewer.timematrix.init"),console.log("##############################"),console.log("viewer.timematrix.init: config - "),console.log(n)),$.extend(!0,c,n),c.$tmCanvasCoords={top:c.$tmCanvasPos.top,left:0,right:c.$tmCanvasPos.left+c.$tmCanvas.outerWidth()},$("#slider-range").slider({range:!0,min:parseInt(c.startDate),max:parseInt(c.endDate),values:[parseInt(c.startDate),parseInt(c.endDate)],slide:function(e,t){c.rangeInput1.val(t.values[0]),$(".timematrix-slider-bubble-startDate").html(t.values[0]),c.startDate=t.values[0],c.rangeInput1.val(t.values[1]),$(".timematrix-slider-bubble-endDate").html(t.values[1]),c.endDate=t.values[1]}}),$("#slider-range .ui-slider-range").next().append(a("startDate",c.startDate)),$("#slider-range .ui-slider-range").next().next().append(a("endDate",c.endDate)),$("#locateTimematrix").on("submit",function(n){n.preventDefault(),$(".timematrix-popover").length&&$(".timematrix-popover").remove();var a=c.contextPath;a+=c.apiQuery,a+=c.startDateQuery,a+=c.startDate,a+=c.endDateQuery,a+=c.endDate,a+=c.countQuery,a+=c.count,(l=e.helper.getRemoteData(a)).then(function(e){s=e,c.$tmCanvas.html(t(s)),$(".timematrix-thumb").css({height:$(".timematrix-thumb").outerWidth()}),$(".timematrix-thumb img").load(function(){$(this).css({visibility:"visible"})}),$(".timematrix-thumb").on("click",function(){$(".timematrix-popover")?($(".timematrix-popover").remove(),$(".timematrix-thumb").removeClass("marker"),$(this).addClass("marker"),o($(this),c.lang)):($(".timematrix-thumb").removeClass("marker"),$(this).addClass("marker"),o($(this),c.lang)),$(".timematrix-popover-close").on("click",function(){$(this).parent().remove(),$(".timematrix-thumb").removeClass("marker")}),$(".timematrix-popover-body img").load(function(){$(".timematrix-popover-imageloader").hide()})})}).then(null,function(){c.$tmCanvas.append(e.helper.renderAlert("alert-danger","<strong>Status: </strong>"+error.status+" "+error.statusText,!1)),console.error("ERROR: viewer.timematrix.init - ",error)})}),$("body").on("click",function(e){$(e.target).closest(".timematrix-thumb").length||i()})}},e}((viewerJS=function(e){"use strict";var t=null,o=null,n={thumbs:".stacked-thumbnail",thumbsBefore:".stacked-thumbnail-before",thumbsAfter:".stacked-thumbnail-after"};return e.stackedThumbnails={init:function(e){$.extend(!0,n,e),$(n.thumbs).hide(),$(n.thumbs).siblings().hide(),$(n.thumbs).each(function(){t=$(this).outerWidth(),o=$(this).outerHeight(),$(this).css({"margin-left":"-"+t/2+"px"}),$(this).siblings().css({width:t,height:o,"margin-left":"-"+t/2+"px"}),$(this).show(),$(this).siblings(n.thumbsBefore).fadeIn("slow",function(){$(this).siblings(n.thumbsAfter).fadeIn()})})}},e}(viewerJS||{},jQuery))||{},jQuery),viewerJS=function(e){"use strict";var t={versions:[],json:null,imgUrl:"",imgPi:"",versionLink:"",widgetInputs:"",widgetList:""};return e.versionHistory={init:function(e){$.extend(!0,t,e),$(t.widgetInputs).each(function(){t.versions.push($(this).val())});for(var o=0;o<t.versions.length;o++)t.json=JSON.parse(t.versions[o]),t.json.id===t.imgPi?(t.versionLink="<li><span>"+t.json.id+" ("+t.json.year+")</span></li>",$(t.widgetList).append(t.versionLink)):(t.versionLink='<li><a href="'+t.imgUrl+"/"+t.json.id+'/1/">'+t.json.id+" ("+t.json.year+")</a></li>",$(t.widgetList).append(t.versionLink))}},e}((viewerJS=function(e){"use strict";var t={currLang:"de",selector:"textarea.tinyMCE",width:"100%",height:400,theme:"modern",plugins:"print preview paste searchreplace autolink directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount spellchecker imagetools media contextmenu colorpicker textpattern help",toolbar:"undo redo | bold italic underline strikethrough forecolor backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | fullscreen",menubar:!1,statusbar:!1,relative_urls:!1,force_br_newlines:!1,force_p_newlines:!1,forced_root_block:"",language:"de"};return e.tinyMce={init:function(e){switch($.extend(!0,t,e),t.currLang){case"de":t.language="de";break;case"es":t.language="es";break;case"pt":t.language="pt_PT";break;case"ru":t.language="ru"}tinymce.init(t)},overview:function(){$(".overview__description-editor").length>0?viewerJS.tinyConfig.setup=function(e){e.on("init",function(e){$(".overview__publication-action .btn").hide()}),e.on("FullscreenStateChanged",function(e){e.state?$(".overview__description-action-fullscreen").addClass("in"):$(".overview__description-action-fullscreen").removeClass("in")})}:viewerJS.tinyConfig.setup=function(e){e.on("init",function(e){$(".overview__description-action .btn").hide()}),e.on("FullscreenStateChanged",function(e){e.state?$(".overview__publication-action-fullscreen").addClass("in"):$(".overview__publication-action-fullscreen").removeClass("in")})}}},e}(viewerJS||{},jQuery))||{},jQuery),cmsJS=function(e){"use strict";var t="",o={selectedPageID:null,inputFields:null,prevBtn:null,prevDescription:null,saveBtn:null,sortablesConfig:{}};return e.createPage={init:function(e){$.extend(!0,o,e),null===o.selectedPageID&&(cmsJS.createPage.disablePreview(),o.prevDescription.show()),o.inputFields.on("change input paste",function(){cmsJS.createPage.disablePreview(),o.prevDescription.show()}),cmsJS.createPage.initSortables(o),"false"===(t=localStorage.getItem("previewStatus"))?(o.prevBtn.attr("disabled",!0),o.prevDescription.show()):(o.prevBtn.attr("disabled",!1),o.prevDescription.hide(),o.prevBtn.on("click",function(){var e=$(this).attr("data-previewUrl");window.open(e,"_blank")}))},initSortables:function(e){if(e.sortablesConfig.visibleItemList=$(e.sortablesConfig.visibleItemList),e.sortablesConfig.availableItemList=$(e.sortablesConfig.availableItemList),!(e.sortablesConfig.availableItemList.length>0))return!1;cmsJS.sortableList.init(0,!1,e),e.sortablesConfig.editButton.on("click",function(){$(this).hasClass("glyphicon-edit")?$(this).removeClass("glyphicon-edit").addClass("glyphicon-remove"):$(this).removeClass("glyphicon-remove").addClass("glyphicon-edit"),$(this).parent(".sidebar-editor-widget-item-header").next(".sidebar-editor-widget-item-body").slideToggle("slow")}),e.sortablesConfig.availableItemList.on("sortbeforestop",function(e,t){"visibleItemList"===$(t.item).parent().attr("id")&&cmsJS.createPage.disablePreview()}),e.sortablesConfig.visibleItemList.on("sortbeforestop",function(){cmsJS.createPage.disablePreview()})},disablePreview:function(){localStorage.setItem("previewStatus","false")},enablePreview:function(){localStorage.setItem("previewStatus","true")}},e}((cmsJS=function(){"use strict";var e={};return e.init=function(){jsf.ajax.addOnEvent(function(e){var t=e.status,o=document.getElementById("AJAXLoader");if(o)switch(t){case"begin":o.style.display="block";break;case"complete":o.style.display="none"}})},e.dataTables_de={sEmptyTable:"Keine Daten in der Tabelle vorhanden",sInfo:"_START_ bis _END_ von _TOTAL_ Einträgen",sInfoEmpty:"0 bis 0 von 0 Einträgen",sInfoFiltered:"(gefiltert von _MAX_ Einträgen)",sInfoPostFix:"",sInfoThousands:".",sLengthMenu:"_MENU_ Einträge anzeigen",sLoadingRecords:"Wird geladen...",sProcessing:"Bitte warten...",sSearch:"Suchen",sZeroRecords:"Keine Einträge vorhanden.",oPaginate:{sFirst:"Erste",sPrevious:"Zurück",sNext:"Nächste",sLast:"Letzte"},oAria:{sSortAscending:": aktivieren, um Spalte aufsteigend zu sortieren",sSortDescending:": aktivieren, um Spalte absteigend zu sortieren"}},e.dataTables_en={sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sInfoThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sZeroRecords:"No matching records found",oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"}},e.dataTables_es={sProcessing:"Procesando...",sLengthMenu:"Mostrar _MENU_ registros",sZeroRecords:"No se encontraron resultados",sEmptyTable:"Ningún dato disponible en esta tabla",sInfo:"Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",sInfoEmpty:"Mostrando registros del 0 al 0 de un total de 0 registros",sInfoFiltered:"(filtrado de un total de _MAX_ registros)",sInfoPostFix:"",sSearch:"Buscar:",sUrl:"",sInfoThousands:",",sLoadingRecords:"Cargando...",oPaginate:{sFirst:"Primero",sLast:"Último",sNext:"Siguiente",sPrevious:"Anterior"},oAria:{sSortAscending:": Activar para ordenar la columna de manera ascendente",sSortDescending:": Activar para ordenar la columna de manera descendente"}},e}(jQuery))||{},jQuery),cmsJS=function(e){"use strict";function t(e){o&&(console.log("---------- _renderRssFeed() ----------"),console.log("_renderRssFeed: data = ",e));var t=null,a=null,i=null,r=null,l=null,s=null,c=null,d=null,g=null,u=null,p=null,h=null,f=null,m=null,v=null;e.items.forEach(function(e){(t=$("<div />")).addClass("tpl-rss__item"),(a=$("<div />")).addClass("tpl-rss__item-title"),i=$("<h3 />"),(r=$("<a />")).attr("href",e.link),r.text(e.title),i.append(r),a.append(i),(l=$("<div />")).addClass("row"),(s=$("<div />")).addClass("col-xs-3 col-sm-2"),(d=$("<div />")).addClass("tpl-rss__item-image"),(u=$("<a />")).attr("href",e.link),(g=$("<img />")).attr("src",e.description.image),g.addClass("img-responsive"),u.append(g),d.append(u),s.append(d),(c=$("<div />")).addClass("col-xs-9 col-sm-10"),(p=$("<div />")).addClass("tpl-rss__item-date"),h=new Date(e.pubDate),p.text(h.toLocaleString()),(f=$("<dl />")).addClass("tpl-rss__item-metadata dl-horizontal"),e.description.metadata.forEach(function(e){(m=$("<dt />")).text(e.label+":"),(v=$("<dd />")).text(e.value),f.append(m).append(v)}),c.append(p).append(f),l.append(s).append(c),t.append(a).append(l),$(n.rssFeedSelector).append(t)})}var o=!1,n={rssFeedSelector:".tpl-rss__feed"};return e.rssFeed={init:function(e,a){o&&(console.log("##############################"),console.log("cmsJS.rssFeed.init"),console.log("##############################"),console.log("cmsJS.rssFeed.init: config - ",e),console.log("cmsJS.rssFeed.init: data - ",a)),$.extend(!0,n,e),t(a)}},e}((cmsJS=function(e){"use strict";function t(e){o&&(console.log("---------- _renderMasonryGrid() ----------"),console.log("_renderMasonryGrid: data = ",e)),e.items.forEach(function(e){i=$("<div />"),e.important?i.addClass("grid-item important"):i.addClass("grid-item"),s=$("<div />"),""!==e.url&&((c=$("<a />")).attr("href",e.url),c.attr("title",e.title)),s.addClass("grid-item-title"),s.text(e.title),""!==e.url?(c.append(s),i.append(c)):i.append(s),""!==e.caption&&((d=$("<div />")).addClass("grid-item-caption"),d.html(e.caption),(g=$("<h4 />")).text(e.title),d.prepend(g),""!==e.url?((u=$("<a />")).attr("href",e.url),u.attr("title",e.title),(p=$('<i aria-hidden="true" />')).addClass("fa fa-arrow-right"),d.append(p),u.append(d),i.append(u)):i.append(d)),(r=$("<img />")).attr("src",e.name),r.addClass("img-responsive"),""!==e.url?((l=$("<a />")).attr("href",e.url),l.attr("title",e.title),l.append(r),i.append(l)):i.append(r),a.$grid.append(i)})}var o=!1,n=null,a={$grid:null},i=null,r=null,l=null,s=null,c=null,d=null,g=null,u=null,p=null;return e.masonry={init:function(e,i){o&&(console.log("##############################"),console.log("cmsJS.masonry.init"),console.log("##############################"),console.log("cmsJS.masonry.init: config - ",e),console.log("cmsJS.masonry.init: data - ",i)),$.extend(!0,a,e),t(i),(n=a.$grid.imagesLoaded(function(){n.masonry({itemSelector:".grid-item",columnWidth:".grid-sizer",gutter:".gutter-sizer",percentPosition:!0})})).on("layoutComplete",function(e,t){a.$grid.addClass("ready")})}},e}(cmsJS||{},jQuery))||{},jQuery),cmsJS=function(e){"use strict";function t(e){return o&&(console.log("---------- _buildGrid() ----------"),console.log("_buildGrid: data = ",e)),i=$('<div class="row" />'),e.items.forEach(function(e){r=$('<div class="col-xs-6 col-sm-3" />'),l=$('<div class="grid-tile" />'),s=$('<div class="grid-tile__title" />'),d=$("<h4 />"),c=$("<a />"),""!==e.url?c.attr("href",e.url):c.attr("href","#"),c.attr("title",e.title),c.append(e.title),d.append(c),(g=$('<div class="grid-tile__image" />')).css("background-image","url("+e.name+")"),u=$("<a />"),""!==e.url?u.attr("href",e.url):u.attr("href","#"),s.append(d),l.append(s),g.append(u),l.append(s),l.append(g),r.append(l),i.append(r)}),i}var o=!1,n={gridSelector:".tpl-static-grid__grid"},a=null,i=null,r=null,l=null,s=null,c=null,d=null,g=null,u=null;return e.staticGrid={init:function(e,i){o&&(console.log("##############################"),console.log("cmsJS.staticGrid.init"),console.log("##############################"),console.log("cmsJS.staticGrid.init: config - ",e),console.log("cmsJS.staticGrid.init: data - ",i)),$.extend(!0,n,e),a=t(i),$(n.gridSelector).append(a)}},e}((cmsJS=function(e){"use strict";function t(e,t){d&&(console.log("cmsJS.sortableList _handleBeforeDropFromAvailable: event - ",e),console.log("cmsJS.sortableList _handleBeforeDropFromAvailable: ui - ",t)),$(t.item).find("td").each(function(e,t){var o=$(t).find("input");if(o.length>0){var n=!1;o.each(function(e,t){if($(t).prop("checked"))return n=!0,!1}),n||$(o.get(0)).prop("checked",!0)}}),u&&"visibleItemList"===item.parent().attr("id")&&item.clone().appendTo($("#availableItemList"))}function o(e,t){d&&(console.log("cmsJS.sortableList _handleBeforeDropFromVisible: event - ",e),console.log("cmsJS.sortableList _handleBeforeDropFromVisible: ui - ",t));var o=$(t.item);u&&"availableItemList"===o.parent().attr("id")&&t.item.remove()}function n(){d&&console.log("cmsJS.sortableList _handleDrop"),a()}function a(){d&&console.log("cmsJS.sortableList _updateAllSortIcons"),$("#visibleItemList").children("li").each(function(){null!=$(this).attr(h)&&i($(this))}),$("#availableItemList").children("li").each(function(){null!=$(this).attr(h)&&i($(this))})}function i(t){if(d&&console.log("cmsJS.sortableList _updateSortIcons: item - ",t),"visibleItemList"===t.parent().attr("id")){if(t.children(".menu-item__level").show(),-1===l(t.prev()))for(;l(t)>0;)e.sortableList.decreaseLevel(t);0===l(t)?(t.find(".left").css("visibility","hidden"),t.find(".right").css("visibility","hidden"),t.css("margin-left","0px")):(t.find(".left").css("visibility","visible"),t.find(".right").css("visibility","visible"),t.css("margin-left",l(t)*g+"px")),l(t)>l(t.prev())?(t.find(".left").css("visibility","visible"),t.find(".right").css("visibility","hidden")):(t.find(".left").css("visibility","visible"),t.find(".right").css("visibility","visible"))}else t.children(".menu-item__level").hide()}function r(e){d&&console.log("cmsJS.sortableList _getJQueryItem: element - ",e);for(var t=$(e);null!==t&&void 0===t.attr(h);)t=t.parent();return t}function l(e){d&&console.log("cmsJS.sortableList _getLevel: item - ",e);var t=e.attr(h);if(null===t||void 0===t)return-1;var o=t.substr(t.indexOf("?")+1);return parseInt(o)}function s(e,t){d&&(console.log("cmsJS.sortableList _changePos: item - ",e),console.log("cmsJS.sortableList _changePos: diff - ",t));var o=e.attr(h);if(null===o||void 0===o)return-1;var n=o.substr(o.indexOf("?")+1),a=o.substr(o.indexOf("_")+1),i=parseInt(a),r=parseInt(n)+t;return e.attr(h,"item_"+i+"?"+r),r}function c(){d&&console.log("cmsJS.sortableList _serializeVisibleItems");var e=$("#visibleItemList").sortable("serialize",{key:"item",attribute:h});null!==p&&(p.value=e)}var d=!1,g=0,u=!1,p=null,h="sortposition";return e.sortableList={init:function(e,i,r){d&&(console.log("##############################"),console.log("cmsJS.sortableList.init"),console.log("##############################"),console.log("cmsJS.sortableList.init: indent - ",e),console.log("cmsJS.sortableList.init: allowMultiple - ",i),console.log("cmsJS.sortableList.init: inputTextField - ",r.sortablesConfig.componentListInput)),g=e,u=i,null===(p=r.sortablesConfig.componentListInput)&&console.warn("Input field for item order not found: No order information can be saved!"),0===r.sortablesConfig.visibleItemList.length&&console.error("No container for active items found. Cannot initialize sortable"),0===r.sortablesConfig.availableItemList.length&&console.error("No container for available items found. Cannot initialize sortable"),a(),d&&console.log("Make sortable ",r.sortablesConfig.visibleItemList),r.sortablesConfig.visibleItemList.sortable({update:c,connectWith:"#availableItemList"}),d&&console.log("Make sortable ",r.sortablesConfig.availableItemList),r.sortablesConfig.availableItemList.sortable({update:c,connectWith:"#visibleItemList",helper:"clone"}),c(),$("#availableItemList").on("sortbeforestop",t),$("#visibleItemList").on("sortbeforestop",o),$("#availableItemList").on("sortstop",n),$("#visibleItemList").on("sortstop",n)},decreaseLevel:function(t,o){d&&(console.log("cmsJS.sortableList.decreaseLevel: element - ",t),console.log("cmsJS.sortableList.decreaseLevel: applyToNext - ",o));var n=r(t);if(l(n)>0&&(s(n,-1),o))for(var i=n.next();null!==i&&l(i)>l(n)+1;)e.sortableList.decreaseLevel(i,!1),i=i.next();c(),a()},increaseLevel:function(t,o){d&&(console.log("cmsJS.sortableList.increaseLevel: element - ",t),console.log("cmsJS.sortableList.increaseLevel: applyToNext - ",o));var n=r(t),i=n.prev();if(l(n)<=l(i)&&(s(n,1),o))for(var g=n.next();null!==g&&l(g)>=l(n);)e.sortableList.increaseLevel(g,!1),g=g.next();c(),a()},save:function(e){void 0!==e&&"begin"!==e.status||c()}},e}(cmsJS||{},jQuery))||{},jQuery),cmsJS=function(e){"use strict";function t(e){n&&(console.log("---------- _getTiles() ----------"),console.log("_getTiles: data = ",e));var t=[];return e.items.forEach(function(e){r=$("<div />"),l=$("<a />"),s=$("<a />"),c=$('<i aria-hidden="true" />'),d=$("<figure />"),g=$("<figcaption />"),u=$("<h3 />"),p=$("<img />"),e.important?r.addClass("tpl-tile-grid__grid-item important"):r.addClass("tpl-tile-grid__grid-item"),""!==e.size&&r.addClass(e.size),p.attr("src",e.name),p.attr("alt",e.title),""!==e.url?(l.attr("href",e.url),l.append(p),d.append(l)):d.append(p),u.text(e.title),d.append(u),g.append(e.caption),""!==e.url&&(s.attr("href",e.url),c.addClass("fa fa-arrow-right"),s.append(c),g.append(s)),d.append(g),r.append(d),t.push(r)}),t}function o(e){n&&(console.log("---------- _renderTileGrid() ----------"),console.log("_renderTileGrid: tiles = ",e)),e.forEach(function(e){e.hasClass("important")?i.$highlights.append(e):i.$grid.append(e)})}var n=!1,a=[],i={$highlights:null,$grid:null},r=null,l=null,s=null,c=null,d=null,g=null,u=null,p=null;return e.tileGrid={init:function(e,r){n&&(console.log("##############################"),console.log("cmsJS.tileGrid.init"),console.log("##############################"),console.log("cmsJS.tileGrid.init: config - ",e),console.log("cmsJS.tileGrid.init: data - ",r)),$.extend(!0,i,e),o(a=t(r))}},e}((cmsJS=function(e){"use strict";function t(e){s&&(console.log("---------- _readTags() ----------"),console.log("_readTags: $input = ",e));var t=e.val();if(t||(t="[]"),!(t.length>0))return[];s&&(console.log("---------- _readTags() ----------"),console.log("tagString: ",t));try{return JSON.parse(t)}catch(e){return console.log("Error reading tags from "+t),[]}}function o(e,t){s&&(console.log("---------- _writeTags() ----------"),console.log("_writeTags: $tags = ",e),console.log("_writeTags: $input = ",t));var o=[];e.each(function(){$(this).text().length>0&&o.push($(this).text())});var n=JSON.stringify(o);t.val(n)}function n(e,t){s&&(console.log("---------- _renderList() ----------"),console.log("_renderList: tags = ",e),console.log("_renderList: $ul = ",t));for(var o=0,n=(t.attr("id"),0);n<e.length;n++)a(e[n],t,o),o++;i(t.parent())}function a(e,t,o){s&&(console.log("---------- _createListElement() ----------"),console.log("_createListElement: value = ",e),console.log("_createListElement: $parent = ",t),console.log("_createListElement: count = ",o)),o||(o=t.children("[id$=_item]").length);var n=t.attr("id"),a=$(".tag-input"),i=$("<li/>");i.attr("id",n+"_"+o+"_item");var r=$('<span class="tag label"/>');r.text(e);var c=$("<span />");c.addClass("tag-terminator"),c.on("click",l),i.append(r),r.append(c),a.length>0?i.insertBefore(a):t.append(i)}function i(t){s&&(console.log("---------- _createTagInputElement() ----------"),console.log("_createTagInputElement: $parent = ",t));var o=$(".media-modal__tags"),n=1,a=t.attr("id"),i=$("<li />");i.addClass("tag-input");var l=$('<input type="text" />');l.attr("id",a+"_inputField"),l.attr("size",n),i.append(l),t.find("ul").append(i),o.on("click",function(){l.focus()}),l.on("change",r),l.on("keypress",function(e){if(n++,l.attr("size",n),13==e.keyCode)return n=1,l.attr("size",n),r(e)}),l.autocomplete({source:function(t,o){Q($.ajax({url:e.tagList.autoSuggestUrl+t.term+"/",type:"GET",datatype:"json"})).then(function(e){o(e)})},appendTo:l.parent(),select:function(e,t){r(e,t.item.value)}})}function r(t,o){return s&&(console.log("---------- _handleInputChange() ----------"),console.log("_handleInputChange: event = ",t),console.log("_handleInputChange: text = ",o),console.log("on change occured in: ",t.target)),o&&0!==o.length||(o=$(t.target).val()),o.trim().length>0&&(e.tagList.addTag(o),$(t.target).val("")),t.preventDefault(),t.stopPropagation(),!1}function l(t){s&&(console.log("---------- _handleClickTerminator() ----------"),console.log("_handleClickTerminator: event = ",t),console.log("Click on: ",t.currentTarget));var o=$(t.target).parent().parent();e.tagList.deleteTag(o)}var s=!1,c={inputFieldId:"tagInput",tagListId:"tagList",autoSuggestUrl:"",msg:{addTagLabel:"Tag hinzufügen"}};return e.tagList={tags:[],$tagListElement:null,autoSuggestUrl:null,init:function(e){if(s&&(console.log("##############################"),console.log("cmsJS.tagList.init"),console.log("##############################"),console.log("cmsJS.tagList.init: config - ",e)),$.extend(!0,c,e),this.$inputField=$("#"+c.inputFieldId),0===this.$inputField.length&&console.log("Data input field not found"),this.$tagListElement=$("#"+c.tagListId),0===this.$tagListElement.length)throw"Tag list element not found";this.autoSuggestUrl=c.autoSuggestUrl,this.tags=t(this.$inputField),n(this.tags,this.$tagListElement)},addTag:function(e){s&&(console.log("---------- cms.tagList.addTag() ----------"),console.log("cmsJS.tagList.addTag: tagName = ",e));var t=this.getTag(e);if(t){$(t).fadeOut(100,function(){$(t).fadeIn(100)})}else this.$tagListElement&&a(e,this.$tagListElement),this.saveTags()},deleteTag:function(e){s&&(console.log("---------- cms.tagList.deleteTag() ----------"),console.log("cmsJS.tagList.deleteTag: tag = ",e)),e.remove(),this.saveTags()},saveTags:function(){s&&console.log("---------- cms.tagList.saveTags() ----------"),o(e.tagList.$tagListElement.children("[id$=_item]"),e.tagList.$inputField)},contains:function(t){s&&(console.log("---------- cms.tagList.contains() ----------"),console.log("cmsJS.tagList.contains: tagName = ",t));var o=!1;return e.tagList.$tagListElement.children("[id$=_item]").each(function(){var e=$(this).text();if(t.trim().toUpperCase()===e.trim().toUpperCase())return o=!0,!1}),o},close:function(){s&&console.log("---------- cms.tagList.close() ----------"),this.$inputField.off(),this.$tagListElement.off(),this.$tagListElement.find(".tag-terminator").off(),this.$tagListElement.find("input").off()},getTags:function(){return s&&console.log("---------- cms.tagList.getTags() ----------"),e.tagList.$tagListElement.children("[id$=_item]")},getTagValues:function(){return s&&console.log("---------- cms.tagList.getTagValues() ----------"),cmsJS.tagList.getTags().map(function(e,t){return $(t).text()})},getTag:function(e){s&&(console.log("---------- cms.tagList.getTag() ----------"),console.log("cmsJS.tagList.getTag: value = ",e));var t=void 0;return cmsJS.tagList.getTags().each(function(o,n){if(cmsJS.tagList.getValue(n).trim().toUpperCase()===e.trim().toUpperCase())return t=n,!1}),t},getValue:function(e){return s&&(console.log("---------- cms.tagList.getValue() ----------"),console.log("cmsJS.tagList.getValue: tag = ",e)),$(e).text()}},e}(cmsJS||{},jQuery))||{},jQuery);