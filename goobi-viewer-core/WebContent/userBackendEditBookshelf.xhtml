<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:c="http://java.sun.com/jsp/jstl/core" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:composite="http://xmlns.jcp.org/jsf/composite" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:viewerComponent="http://xmlns.jcp.org/jsf/composite/components"
	xmlns:widgetComponent="http://xmlns.jcp.org/jsf/composite/components/widgets" template="/resources/themes/#{navigationHelper.theme}/template.html">

	<composite:interface />

	<ui:define name="metadata">
		<f:metadata>
			<f:event type="preRenderView" listener="#{navigationHelper.setCurrentPage('editbookshelf', false, true)}" />
			<f:event type="preRenderView" listener="#{navigationHelper.addStaticLinkToBreadcrumb(msg.bookshelf_edit,1)}" />
		</f:metadata>
	</ui:define>

	<ui:define name="content">
		<div id="userBookshelfEdit" class="user-bookshelf-edit">
			<h:panelGroup rendered="#{userBean.loggedIn and bookshelfBean.currentBookshelfMine}">
				<h2>#{msg.bookshelf_edit}</h2>

				<div class="user-bookshelf-edit__form">
					<h:form id="userBookshelfEditForm" styleClass="form-horizontal" prependId="false">
						<div class="form-group">
							<label for="editBookshelfName" class="col-sm-2 control-label">#{msg.name}:</label>
							<div class="col-sm-10">
								<h:inputText id="editBookshelfName" styleClass="form-control" value="#{bookshelfBean.currentBookshelfName}" validator="#{bookshelfBean.validateName}" required="true" requiredMessage="#{msg.bookshelf_bookshelfNameFailure}" />
							</div>
						</div>
	
						<div class="form-group">
							<label for="editBookshelfDescription" class="col-sm-2 control-label">#{msg.description}:</label>
							<div class="col-sm-10">
								<h:inputTextarea id="editBookshelfDescription" styleClass="form-control" value="#{bookshelfBean.currentBookshelfDescription}" />
							</div>
						</div>
	
						<!-- 					<div class="form-group"> -->
						<!-- 						<label for="editBookshelfPublic" class="col-sm-2 control-label">#{msg.public}:</label> -->
						<!-- 						<div class="col-sm-10"> -->
						<!-- 							<div class="checkbox"> -->
						<!-- 								<label> -->
						<!-- 									<h:selectBooleanCheckbox id="editBookshelfPublic" value="#{bookshelfBean.currentBookshelfPublic}" /> -->
						<!-- 								</label> -->
						<!-- 							</div> -->
						<!-- 						</div> -->
						<!-- 					</div> -->
						
						<!-- ACTION -->
						<div class="user-bookshelf-edit__action">
							<h:commandLink value="#{msg.bookshelf_delete}" action="#{bookshelfBean.deleteCurrentBookshelfAction}" styleClass="btn" />
							<h:commandLink value="#{msg.save}" action="#{bookshelfBean.saveCurrentBookshelfAction}" styleClass="btn" />
						</div>
					</h:form>
				</div>

				<!-- 				<h:panelGroup rendered="#{!bookshelfBean.newBookshelf}"> -->
				<!--                     <h3>#{msg.bookshelf_items}</h3> -->

				<!-- warning if no entries exists -->
				<!-- 					<h:panelGroup rendered="#{bookshelfBean.currentBookshelf.items.isEmpty()}"> -->
				<!-- 						<div class="alert alert-warning" role="alert">#{msg.bookshelves_noEntryWarning}</div> -->
				<!-- 					</h:panelGroup> -->

				<!-- bookshelf entries -->
				<!--                     <h:panelGroup rendered="#{!bookshelfBean.currentBookshelf.items.isEmpty()}"> -->
				<!-- 	                    <h:form id="editBookshelfItemForm" styleClass="form" prependId="false"> -->
				<!-- 	                        <h:dataTable  -->
				<!-- 	                        	id="single_bookshelf_data_table"  -->
				<!-- 	                        	styleClass="table table-condensed user-backend-table"  -->
				<!-- 	                        	value="#{bookshelfBean.currentBookshelf.items}"  -->
				<!-- 	                        	var="item"> -->
				<!-- 	                            <h:column> -->
				<!-- 	                                <f:facet name="header"> -->
				<!-- 	                                    <h:outputText value="#{msg.title}" /> -->
				<!-- 	                                </f:facet> -->
				<!-- 	                                <a href="#{item.url}"> -->
				<!-- 	                                    <h:outputText value="#{item.mainTitleUnescaped}" /> -->
				<!-- 	                                </a> -->
				<!-- 	                            </h:column> -->
				<!-- 	                            <h:column> -->
				<!-- 	                                <f:facet name="header"> -->
				<!-- 	                                    <h:outputText value="#{msg.description}" /> -->
				<!-- 	                                </f:facet> -->
				<!-- 	                                <a href="#{item.url}"> -->
				<!-- 	                                    <h:outputText value="#{item.description}" /> -->
				<!-- 	                                </a> -->
				<!-- 	                            </h:column> -->
				<!-- 	                            <h:column> -->
				<!-- 	                                <f:facet name="header"> -->
				<!-- 	                                    <h:outputText value="#{msg.dateAdded}" /> -->
				<!-- 	                                </f:facet> -->
				<!-- 	                                <h:outputText value="#{item.dateAdded}"> -->
				<!-- 	                                    <f:convertDateTime type="date" dateStyle="medium" /> -->
				<!-- 	                                </h:outputText> -->
				<!-- 	                            </h:column> -->
				<!-- 	                            <h:column> -->
				<!-- 	                                <f:facet name="header"> -->
				<!-- 	                                    <h:outputText value="#{msg.action}" /> -->
				<!-- 	                                </f:facet> -->

				<!-- delete bookshelf item -->
				<!-- 	                                <h:panelGroup rendered="#{bookshelfBean.currentBookshelfMine}"> -->
				<!-- 	                                    <button type="button" class="btn deleteBookshelfItemBtn" data-toggle="modal">#{msg.delete}</button> -->
				<!-- 	                                </h:panelGroup> -->

				<!-- 	                                <div class="modal fade deleteBookshelfItemModal" tabindex="-1" role="dialog"> -->
				<!-- 	                                    <div class="modal-dialog"> -->
				<!-- 	                                        <div class="modal-content"> -->
				<!-- 	                                            <div class="modal-header"> -->
				<!-- 	                                                <button type="button" class="close" data-dismiss="modal"> -->
				<!-- 	                                                    <span aria-hidden="true"> -->
				<!-- 	                                                        <h:outputText value="&amp;times;" escape="false" /> -->
				<!-- 	                                                    </span> -->
				<!-- 	                                                    <span class="sr-only">Close</span> -->
				<!-- 	                                                </button> -->
				<!-- 	                                                <h4 class="modal-title" id="myModalLabel">#{msg.bookshelf_items}: #{bookshelfBean.currentBookshelf.name}</h4> -->
				<!-- 	                                            </div> -->
				<!-- 	                                            <div class="modal-body"> -->
				<!-- 	                                                <p>#{msg.bookshelf_deleteCurrentBookFromBookshelfConfirmationTextLeft}</p> -->
				<!-- 	                                            </div> -->
				<!-- 	                                            <div class="modal-footer"> -->
				<!-- 	                                                <h:commandLink styleClass="btn" data-dismiss="modal">#{msg.cancel}</h:commandLink> -->
				<!-- 	                                                <h:commandLink value="#{msg.delete}" action="#{bookshelfBean.deleteCurrentItemAction(item)}" styleClass="btn" /> -->
				<!-- 	                                            </div> -->
				<!-- 	                                        </div> -->
				<!-- 	                                    </div> -->
				<!-- 	                                </div> -->
				<!-- 	                            </h:column> -->
				<!-- 	                        </h:dataTable> -->
				<!-- 	                    </h:form> -->
				<!--                     </h:panelGroup> -->
				<!--                 </h:panelGroup> -->

				<!-- delete bookshelf -->
				<!--                     <div id="deleteBookshelfWrapp"> -->
				<!--                         <h:form id="deleteBookshelfForm" prependId="false"> -->
				<!--                             <button type="button" class="btn" data-toggle="modal" data-target="#deleteBookshelfModal">#{msg.bookshelf_delete}</button> -->

				<!--                             <div id="deleteBookshelfModal" class="modal fade" tabindex="-1" role="dialog"> -->
				<!--                                 <div class="modal-dialog"> -->
				<!--                                     <div class="modal-content"> -->
				<!--                                         <div class="modal-header"> -->
				<!--                                             <button type="button" class="close" data-dismiss="modal"> -->
				<!--                                                 <span aria-hidden="true"> <h:outputText value="&amp;times;" escape="false" /></span> -->
				<!--                                                 <span class="sr-only">Close</span> -->
				<!--                                             </button> -->
				<!--                                             <h4 class="modal-title" id="myModalLabel">#{msg.bookshelf_bookshelf}: #{bookshelfBean.currentBookshelf.name}</h4> -->
				<!--                                         </div> -->
				<!--                                         <div class="modal-body"> -->
				<!--                                             <p>#{msg.bookshelf_deleteCurrentBookshelfConfirmationTextLeft}</p> -->
				<!--                                         </div> -->
				<!--                                         <div class="modal-footer"> -->
				<!--                                             <h:commandLink styleClass="btn" data-dismiss="modal">#{msg.cancel}</h:commandLink> -->
				<!--                                             <h:commandLink value="#{msg.bookshelf_delete}" action="#{bookshelfBean.deleteCurrentBookshelfAction}" styleClass="btn" /> -->
				<!--                                         </div> -->
				<!--                                     </div> -->
				<!--                                 </div> -->
				<!--                             </div> -->
				<!--                         </h:form> -->
				<!--                     </div> -->

				<!-- 				<h:form id="editBookshelfItemControlsForm" prependId="false"> -->
				<!-- 					<h:commandLink rendered="#{bookshelfBean.newBookshelf}" value="#{msg.cancel}" -->
				<!-- 						action="#{bookshelfBean.cancelEditCurrentBookshelfAction}" immediate="true" styleClass="btn" /> -->
				<!-- 					<h:commandLink rendered="#{!bookshelfBean.newBookshelf}" value="#{msg.bookshelf_returnToMyBookshelves}" -->
				<!-- 						action="#{bookshelfBean.cancelEditCurrentBookshelfAction}" immediate="true" styleClass="btn" /> -->
				<!-- 				</h:form> -->
			</h:panelGroup>
		</div>

		<script type="text/javascript">
//                   $(document).ready(
//                           function() {
//                             var btnCount = 0;
//                             $('.deleteBookshelfItemBtn').each(
//                                     function() {
//                                       $(this).attr(
//                                               'data-target',
//                                               '#deleteBookshelfItemModal-'
//                                                       + btnCount);
//                                       btnCount++;
//                                     });

//                             var modalCount = 0;
//                             $('.deleteBookshelfItemModal').each(
//                                     function() {
//                                       $(this).attr(
//                                               'id',
//                                               'deleteBookshelfItemModal-'
//                                                       + modalCount);
//                                       modalCount++;
//                                     });
//                           });
                </script>
	</ui:define>

	<ui:define name="sidebar">
		<h:panelGroup rendered="#{browseBean.browsingMenuEnabled}">
			<widgetComponent:widget_browsing />
		</h:panelGroup>

		<widgetComponent:widget_bookshelfList />

		<h:panelGroup rendered="#{userBean.loggedIn}">
			<widgetComponent:widget_mySearches />
		</h:panelGroup>

		<c:forEach var="module" items="#{configurationBean.modules}">
			<c:forEach var="contribution" items="#{module.sidebarContributions}">
				<ui:include src="/#{contribution}" />
			</c:forEach>
		</c:forEach>

		<widgetComponent:widget_user />
	</ui:define>

	<ui:define name="rssFeed">
		<ui:include src="resources/includes/rssFeed.xhtml" />
	</ui:define>

	<ui:define name="breadcrumbs">
		<ui:include src="/resources/includes/breadcrumbs.xhtml" />
	</ui:define>
</ui:composition>
