<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"viewImage_viewImage.zoomSlider.js.html":{"id":"viewImage_viewImage.zoomSlider.js.html","title":"Source: viewImage/viewImage.zoomSlider.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewImage/viewImage.zoomSlider.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which handles the zoomslider functionality. * * @version 3.2.0 * @module viewImage.zoomSlider * @requires jQuery */ var viewImage = ( function( osViewer ) { 'use strict'; var _debug = false; var _zoomSlider = {}; var _defaults = { global: { /** * The position of the zoom-slider is &quot;dilated&quot; by a function d(zoom) = * 1/sliderDilation*tan[atan(sliderDilation)*zoom] This makes the slider * position change slower for small zoom and faster for larger zoom The * function is chosen so that d(0) = 0 and d(1) = 1 */ sliderDilation: 12 } }; osViewer.zoomSlider = { init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'osViewer.zoomSlider.init' ); console.log( '##############################' ); } $.extend( true, _defaults, config ); if ( $( _defaults.global.zoomSlider ) ) { osViewer.zoomSlider.addZoomSlider( _defaults.global.zoomSlider ); // handler for openSeadragon Object osViewer.viewer.addHandler( 'zoom', function( data ) { osViewer.zoomSlider.buttonToZoom( data.zoom ); } ); } }, buttonToMouse: function( mousePos ) { if ( _debug ) { console.log( 'osViewer.zoomSlider.buttonToMouse: mousePos - ' + mousePos ); } var offset = _zoomSlider.$button.width() / 2; var newPos = mousePos - offset; if ( newPos &lt; 0 ) { newPos = 0; } if ( newPos + 2 * offset &gt; _zoomSlider.absoluteWidth ) { newPos = _zoomSlider.absoluteWidth - 2 * offset; } _zoomSlider.$button.css( { left: newPos } ); _zoomSlider.buttonPosition = newPos; var factor = ( newPos / ( _zoomSlider.absoluteWidth - offset * 2 ) ); factor = 1 / _defaults.global.sliderDilation * Math.tan( Math.atan( _defaults.global.sliderDilation ) * factor ); var newScale = osViewer.viewer.viewport.getMinZoom() + ( osViewer.viewer.viewport.getMaxZoom() - osViewer.viewer.viewport.getMinZoom() ) * factor; if ( _debug ) { console.log( 'osViewer.zoomSlider.buttonToMouse: newScale - ' + newScale ); } osViewer.controls.zoomTo( newScale ); }, buttonToZoom: function( scale ) { if ( _debug ) { console.log( 'osViewer.zoomSlider.buttonToZoom: scale - ' + scale ); } if ( !_zoomSlider || !osViewer.viewer.viewport ) { return; } // console.log(&quot;Dilation = &quot;, osViewer.viewer.viewport.getMinZoom()) // console.log(&quot;minZoom = &quot;, osViewer.viewer.viewport.getMinZoom()); // console.log(&quot;maxZoom = &quot;, osViewer.viewer.viewport.getMaxZoom()) // console.log(&quot;scale = &quot;, scale); var factor = ( scale - osViewer.viewer.viewport.getMinZoom() ) / ( osViewer.viewer.viewport.getMaxZoom() - osViewer.viewer.viewport.getMinZoom() ); // console.log( &quot;factor = &quot;, factor ); // factor = 1 / Math.atan( _defaults.global.sliderDilation ) * Math.atan( _defaults.global.sliderDilation * factor ); var newPos = factor * ( _zoomSlider.absoluteWidth - _zoomSlider.$button.width() ); // var newPos = ( ( scale - osViewer.viewer.viewport.getMinZoom() ) / ( // osViewer.viewer.viewport.getMaxZoom() - // osViewer.viewer.viewport.getMinZoom() ) ) // * ( _zoomSlider.absoluteWidth - _zoomSlider.$button.width() ); // console.log( &quot;pos = &quot;, newPos ); if ( Math.abs( osViewer.viewer.viewport.getMaxZoom() - scale ) &lt; 0.0000000001 ) { newPos = _zoomSlider.absoluteWidth - _zoomSlider.$button.width(); } if ( newPos &lt; 0 ) { newPos = 0; } _zoomSlider.$button.css( { left: newPos } ); _zoomSlider.buttonPosition = newPos; }, zoomSliderMouseUp: function() { if ( _debug ) { console.log( 'osViewer.zoomSlider.zoomSliderMouseUp' ); } _zoomSlider.mousedown = false; }, zoomSliderMouseMove: function( evt ) { if ( _debug ) { console.log( 'osViewer.zoomSlider.zoomSliderMouseMove: evt - ' + evt ); } if ( !_zoomSlider.mousedown ) { return; } var offset = $( this ).offset(); var hitX = evt.pageX - offset.left; osViewer.zoomSlider.buttonToMouse( hitX ); if ( _debug ) { console.log( 'osViewer.zoomSlider.zoomSliderMouseMove: moving - ' + hitX ); } }, zoomSliderMouseDown: function( evt ) { if ( _debug ) { console.log( 'osViewer.zoomSlider.zoomSliderMouseDown: evt - ' + evt ); } _zoomSlider.mousedown = true; var offset = $( this ).offset(); var hitX = evt.pageX - offset.left; osViewer.zoomSlider.buttonToMouse( hitX ); }, buttonMouseDown: function() { if ( _debug ) { console.log( 'osViewer.zoomSlider.buttonMouseDown' ); } _zoomSlider.mousedown = true; return false; }, addZoomSlider: function( element ) { if ( _debug ) { console.log( 'osViewer.zoomSlider.addZoomSlider: element - ' + element ); } _zoomSlider.$element = $( element ); _zoomSlider.$button = _zoomSlider.$element.children( _defaults.global.zoomSliderHandle ); _zoomSlider.buttonPosition = 0; _zoomSlider.absoluteWidth = _zoomSlider.$element.innerWidth(); _zoomSlider.mousedown = false; _zoomSlider.$button.on( 'mousedown', osViewer.zoomSlider.buttonMouseDown ); _zoomSlider.$element.click( osViewer.zoomSlider._zoomSliderClick ); _zoomSlider.$element.mousedown( osViewer.zoomSlider.zoomSliderMouseDown ); _zoomSlider.$element.mousemove( osViewer.zoomSlider.zoomSliderMouseMove ); $( document ).on( 'mouseup', osViewer.zoomSlider.zoomSliderMouseUp ); } }; return osViewer; } )( viewImage || {}, jQuery ); Ã— Search results Close "},"viewImage.js.html":{"id":"viewImage.js.html","title":"Source: viewImage.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewImage.js /*! * This file is part of the Goobi viewer - a content presentation and management application for digitized objects. * * Visit these websites for more information. * - http://www.intranda.com * - http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this program. If not, see &lt;http://www.gnu.org/licenses/&gt;. */var viewImage = ( function() { 'use strict'; var osViewer = {}; var _debug = false; var _footerImage = null; var _canvasScale; var _container; var _defaults = { global: { divId: &quot;map&quot;, zoomSlider: &quot;.zoom-slider&quot;, zoomSliderHandle: '.zoom-slider-handle', overlayGroups: [ { name: &quot;searchHighlighting&quot;, styleClass: &quot;coords-highlighting&quot;, interactive: false }, { name: &quot;ugc&quot;, styleClass: &quot;ugcBox&quot;, interactive: true } ], zoomSpeed: 1.25, maxZoomLevel: 20, minZoomLevel: 1, imageControlsActive: true, visibilityRatio: 0.4, loadImageTimeout: 10 * 60 * 1000, maxParallelImageLoads: 4, adaptContainerHeight: false, footerHeight: 50, rememberZoom: false, rememberRotation: false, }, image: {}, getOverlayGroup: function( name ) { var allGroups = _defaults.global.overlayGroups; for ( var int = 0; int &lt; allGroups.length; int++ ) { var group = allGroups[ int ]; if ( group.name === name ) { return group; } } }, getCoordinates: function( name ) { var coodinatesArray = _defaults.image.highlightCoords; if ( coodinatesArray ) { for ( var int = 0; int &lt; coodinatesArray.length; int++ ) { var coords = coodinatesArray[ int ]; if ( coords.name === name ) { return coords; } } } }, }; osViewer = { viewer: null, init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'osViewer.init' ); console.log( '##############################' ); } // constructor $.extend( true, _defaults, config ); // convert mimeType &quot;image/jpeg&quot; to &quot;image/jpg&quot; to provide correct // iiif calls _defaults.image.mimeType = _defaults.image.mimeType.replace(&quot;jpeg&quot;,&quot;jpg&quot;); _container = $( &quot;#&quot; + _defaults.global.divId ); var sources = _defaults.image.tileSource; if(typeof sources === 'string' &amp;&amp; sources.startsWith(&quot;[&quot;)) { sources = JSON.parse(sources); } else if(!$.isArray(sources)) { sources = [sources]; } var promises = []; for ( var i=0; i&lt;sources.length; i++) { var source = sources[i]; // returns the OpenSeadragon.TileSource if it can be created, // otherweise // rejects the promise var promise = viewImage.createTileSource(source); promises.push(promise); } return Q.all(promises).then(function(tileSources) { var minWidth = Number.MAX_VALUE; var minHeight = Number.MAX_VALUE; var minAspectRatio = Number.MAX_VALUE; for ( var j=0; j&lt;tileSources.length; j++) { var tileSource = tileSources[j]; minWidth = Math.min(minWidth, tileSource.width); minHeight = Math.min(minHeight, tileSource.height); minAspectRatio = Math.min(minAspectRatio, tileSource.aspectRatio); } if(_debug) { console.log(&quot;Min aspect ratio = &quot; + minAspectRatio); } var x = 0; for ( var i=0; i&lt;tileSources.length; i++) { var tileSource = tileSources[i]; tileSources[i] = { tileSource: tileSource, width: tileSource.aspectRatio/minAspectRatio, // height: minHeight/tileSource.height, x : x, y: 0, } x += tileSources[i].width; } return viewImage.loadImage(tileSources); }); }, loadImage : function(tileSources) { if ( _debug ) { console.log( 'Loading image with tilesource: ', tileSources ); } osViewer.loadFooter(); osViewer.viewer = new OpenSeadragon( { immediateRender: false, visibilityRatio: _defaults.global.visibilityRatio, sequenceMode: false, id: _defaults.global.divId, controlsEnabled: false, prefixUrl: &quot;/openseadragon-bin/images/&quot;, zoomPerClick: 1, maxZoomLevel: _defaults.global.maxZoomLevel, minZoomLevel: _defaults.global.minZoomLevel, zoomPerScroll: _defaults.global.zoomSpeed, mouseNavEnabled: _defaults.global.zoomSpeed &gt; 1, showNavigationControl: false, showZoomControl: false, showHomeControl: false, showFullPageControl: true, timeout: _defaults.global.loadImageTimeout, tileSources: tileSources, blendTime: .5, alwaysBlend: false, imageLoaderLimit: _defaults.global.maxParallelImageLoads, viewportMargins: { top: 0, left: 0, right: 0, bottom: _defaults.global.footerHeight } } ); var result = Q.defer(); osViewer.observables = createObservables(window, osViewer.viewer); osViewer.observables.viewerOpen.subscribe(function(openevent, loadevent) { result.resolve(osViewer); }, function(error) { result.reject(error); }); // Calculate sizes if redraw is required osViewer.observables.redrawRequired.subscribe(function(event) { if(_debug) { console.log(&quot;viewer &quot; + event.osState + &quot;ed with target location &quot;, event.targetLocation); } osViewer.redraw(); }); if ( osViewer.controls ) { osViewer.controls.init( _defaults ); } if ( osViewer.zoomSlider ) { osViewer.zoomSlider.init( _defaults ); } if ( osViewer.overlays ) { osViewer.overlays.init( _defaults ); } if ( osViewer.drawRect ) { osViewer.drawRect.init(); } if ( osViewer.transformRect ) { osViewer.transformRect.init(); } osViewer.observables.redrawRequired.connect(); return result.promise; }, getObservables: function() { console.log(&quot;Observables = &quot;, osViewer.observables); return osViewer.observables; }, hasFooter: function() { return _footerImage != null; }, getConfig: function() { return _defaults; }, loadFooter: function() { if ( _defaults.image.baseFooterUrl &amp;&amp; _defaults.global.footerHeight &gt; 0 ) { _footerImage = new Image(); _footerImage.src = _defaults.image.baseFooterUrl.replace( &quot;{width}&quot;, Math.round( _container.width() ) ).replace( &quot;{height}&quot;, Math.round( _defaults.global.footerHeight ) ); _footerImage.src = _defaults.image.baseFooterUrl.replace( &quot;/full/max/&quot;, &quot;/full/!&quot; + Math.round( _container.width() ) + &quot;,&quot; + Math.round( _defaults.global.footerHeight ) + &quot;/&quot;); _footerImage.onload = function() { if ( _debug ) { console.log( &quot;loading footer image &quot;, _footerImage ); console.log( &quot;Calculating image Footer size&quot; ); } osViewer.drawFooter(); }; } }, drawFooter: function() { if ( osViewer.viewer ) { _overlayFooter(); } osViewer.viewer.removeHandler( 'update-viewport', _overlayFooter ); osViewer.viewer.addHandler( 'update-viewport', _overlayFooter ); }, getOverlayGroup: function( name ) { return _defaults.getOverlayGroup( name ); }, getHighlightCoordinates: function( name ) { return _defaults.getCoordinates( name ); }, createPyramid: function( imageInfo ) { var fileExtension = _defaults.image.mimeType; fileExtension = fileExtension.replace( &quot;image/&quot;, &quot;&quot; ); fileExtension = fileExtension.replace(&quot;jpeg&quot;, &quot;jpg&quot;).replace(&quot;tiff&quot;, &quot;tif&quot;); var imageLevels = []; var tileSource; if(Array.isArray(imageInfo)) { imageInfo.forEach(function(level) { level.mimetype = _defaults.image.mimeType; }); tileSource = new OpenSeadragon.LegacyTileSource(imageInfo); } else if(imageInfo.sizes) { imageInfo.sizes.forEach(function(size) { if(_debug) { console.log(&quot;Image level width = &quot;, size.width) console.log(&quot;Image level height = &quot;, size.height) } var level = { mimetype: _defaults.image.mimeType, url: imageInfo[&quot;@id&quot;].replace( &quot;/info.json&quot;, &quot;&quot; ) + &quot;/full/&quot; + size.width + &quot;,/0/default.&quot; + fileExtension, width: imageInfo.width, height: imageInfo.height }; if(_debug) { console.log(&quot;Created level &quot;, level); } imageLevels.push( level ); }); tileSource = new OpenSeadragon.LegacyTileSource(imageLevels); } else { tileSource = new OpenSeadragon.ImageTileSource({ url: imageInfo[&quot;@id&quot;].replace( &quot;/info.json&quot;, &quot;&quot; ) + &quot;/full/full/0/default.&quot; + fileExtension, crossOriginPolicy: &quot;Anonymous&quot;, buildPyramid: false }); } return tileSource; }, getSizes: function() { return osViewer.sizes; }, addImage: function( url, width, height ) { if ( _debug ) { console.log( 'osViewer.addImage: url - ' + url ); console.log( 'osViewer.addImage: width - ' + width ); console.log( 'osViewer.addImage: height - ' + height ); } if ( osViewer.viewer ) { osViewer.viewer.addTiledImage( { tileSource: { type: &quot;legacy-image-pyramid&quot;, levels: [ { url: url, height: height, width: width } ] }, x: 0, y: 1.6, width: 1 } ); } else { if ( _debug ) { console.log( &quot;Viewer not initialized yet; cannot add image&quot; ); } } }, getImageInfo: function() { if(osViewer.viewer) { return osViewer.viewer.tileSources; } return null; }, getScaleToOriginalSize: function(imageNo) { return 1.0; // if(!imageNo) { // imageNo = 0; // } // var displaySize = osViewer.viewer.viewport._contentSize.x; // return osViewer.getImageInfo()[imageNo].tileSource.width / displaySize; }, scaleToOriginalSize: function( value, imageNo ) { return value; // if ( _debug ) { // console.log( 'Overlays _scaleToOriginalSize: value - ' + value ); // } // // if(!imageNo) { // imageNo = 0; // } // // var displaySize = osViewer.viewer.viewport._contentSize.x; // return value / displaySize * osViewer.getImageInfo()[imageNo].tileSource.width; }, scaleToImageSize: function( value, imageNo ) { return value; // if ( _debug ) { // console.log( 'Overlays _scaleToImageSize: value - ' + value ); // } // // if(!imageNo) { // imageNo = 0; // } // // var displaySize = osViewer.viewer.viewport._contentSize.x; // return value * displaySize / osViewer.getImageInfo()[imageNo].tileSource.width; }, close: function() { if ( _debug ) { console.log( &quot;Closing openSeadragon viewer&quot; ); } if ( osViewer.viewer ) { osViewer.viewer.destroy(); } }, redraw: function() { if(osViewer.controls) { osViewer.controls.setPanning( true ); } _calculateSizes(osViewer); }, setImageSizes: function(imageInfo, sizes) { if(sizes) { var string = sizes.replace(/[\\{\\}]/, &quot;&quot;); var sizes = JSON.parse(sizes); var iiifSizes = []; sizes.forEach(function(size) { iiifSizes.push({&quot;width&quot;: parseInt(size), &quot;height&quot;: parseInt(size)}); }); if(iiifSizes.length &gt; 0) { imageInfo.sizes = iiifSizes; } else { delete imageInfo.sizes; } } }, setTileSizes: function(imageInfo, tiles) { if(tiles) { var tileString = viewImage.getConfig().global.tileSizes.replace(/(\\d+)/, '&quot;$1&quot;').replace(&quot;=&quot;, &quot;:&quot;); var tiles = JSON.parse(tileString); var iiifTiles = []; Object.keys(tiles).forEach(function(size) { var scaleFactors = tiles[size]; iiifTiles.push({&quot;width&quot;: parseInt(size), &quot;height&quot;: parseInt(size), &quot;scaleFactors&quot;: scaleFactors}) }); imageInfo.tiles = iiifTiles; } }, onFirstTileLoaded: function() { var defer = Q.defer(); if(viewImage.observables) { viewImage.observables.firstTileLoaded.subscribe(function(event) { defer.resolve(event); }, function(error) { defer.reject(error) }); } else { defer.reject(&quot;No observables defined&quot;); } return defer.promise; }, createTileSource: function(source) { var result = Q.defer(); viewImage.tileSourceResolver.resolveAsJson(source) .then( function(imageInfo) { if(_debug) { console.log(&quot;IIIF image info &quot;, imageInfo); } viewImage.setImageSizes(imageInfo, _defaults.global.imageSizes); viewImage.setTileSizes(imageInfo, _defaults.global.tileSizes); var tileSource; if(imageInfo.tiles) { tileSource = new OpenSeadragon.IIIFTileSource(imageInfo); } else { tileSource = osViewer.createPyramid(imageInfo); } return tileSource; }, function(error) { if(viewImage.tileSourceResolver.isURI(_defaults.image.tileSource)) { if(_debug) { console.log(&quot;Image URL&quot;, _defaults.image.tileSource); } var tileSource = new OpenSeadragon.ImageTileSource( { url: _defaults.image.tileSource, buildPyramid: true, crossOriginPolicy: false } ); return tileSource; } else { var errorMsg = &quot;Failed to load tilesource from &quot; + tileSource; if(_debug) { console.log(errorMsg); } return Q.reject(errorMsg); } }) .then(function(tileSource) { result.resolve(tileSource); }).catch(function(errorMessage) { result.reject(errorMessage); }); return result.promise; } }; function createObservables(window, viewer) { var observables = {}; observables.viewerOpen = Rx.Observable.create(function(observer) { viewer.addOnceHandler( 'open', function( event ) { event.osState = &quot;open&quot;; if(Number.isNaN(event.eventSource.viewport.getHomeBounds().x)) { return observer.onError(&quot;Unknow error loading image from &quot;, _defaults.image.tileSource); } else { return observer.onNext(event); } } ); viewer.addOnceHandler( 'open-failed', function( event ) { event.osState = &quot;open-failed&quot;; console.log(&quot;Failed to open openseadragon &quot;); return observer.onError(event); } ); }); observables.firstTileLoaded = Rx.Observable.create(function(observer) { viewer.addOnceHandler( 'tile-loaded', function( event ) { event.osState = &quot;tile-loaded&quot;; return observer.onNext(event); } ); viewer.addOnceHandler( 'tile-load-failed', function( event ) { event.osState = &quot;tile-load-failed&quot;; console.log(&quot;Failed to load tile&quot;); return observer.onError(event); } ); }); observables.viewerZoom = Rx.Observable.create(function(observer) { viewer.addHandler( 'zoom', function( event ) { return observer.onNext(event); } ); }); observables.animationComplete = Rx.Observable.create(function(observer) { viewer.addHandler( 'animation-finish', function( event ) { return observer.onNext(event); } ); }); observables.viewportUpdate = Rx.Observable.create(function(observer) { viewer.addHandler( 'update-viewport', function( event ) { return observer.onNext(event); } ); }); observables.animation = Rx.Observable.create(function(observer) { viewer.addHandler( 'animation', function( event ) { return observer.onNext(event); } ); }); observables.viewerRotate = Rx.Observable.create(function(observer) { viewer.addHandler( 'rotate', function( event ) { event.osState = &quot;rotate&quot;; return observer.onNext(event); } ); }); observables.canvasResize = Rx.Observable.create(function(observer) { viewer.addHandler( 'resize', function( event ) { event.osState = &quot;resize&quot;; return observer.onNext(event); } ); }); observables.windowResize = Rx.Observable.fromEvent(window, &quot;resize&quot;).map(function(event) { event.osState = &quot;window resize&quot;; return event; }); observables.overlayRemove = Rx.Observable.create(function(observer) { viewer.addHandler( 'remove-overlay', function( event ) { return observer.onNext(event); } ); }); observables.overlayUpdate = Rx.Observable.create(function(observer) { viewer.addHandler( 'update-overlay', function( event ) { return observer.onNext(event); } ); }); observables.levelUpdate = Rx.Observable.create(function(observer) { viewer.addHandler( 'update-level', function( event ) { return observer.onNext(event); } ); }); observables.redrawRequired = observables.viewerOpen .merge(observables.viewerRotate .merge(observables.canvasResize) .debounce(10)) .map(function(event) { var location = {}; if(osViewer.controls) { location = osViewer.controls.getLocation(); } if(event.osState === &quot;open&quot;) { location.zoom = osViewer.viewer.viewport.getHomeZoom(); if(_defaults.image.location) { location = _defaults.image.location; } } event.targetLocation = location; return event; }).publish(); return observables; } function _calculateSizes(osViewer) { if ( _debug ) { console.log( &quot;viewImage: calcualte sizes&quot; ); console.log(&quot;Home zoom = &quot;, osViewer.viewer.viewport.getHomeZoom()); } osViewer.sizes = new viewImage.Measures( osViewer ); if ( _defaults.global.adaptContainerHeight ) { osViewer.sizes.resizeCanvas(); } if ( osViewer.viewer != null ) { osViewer.viewer.viewport.setMargins( {bottom: osViewer.sizes.footerHeight + osViewer.sizes.calculateExcessHeight()} ); } if ( _debug ) { console.log( &quot;sizes: &quot;, osViewer.sizes ); } }; function _overlayFooter( event ) { if ( _defaults.global.footerHeight &gt; 0 ) { var footerHeight = _defaults.global.footerHeight; var footerPos = new OpenSeadragon.Point( 0, _container.height() - footerHeight ); var footerSize = new OpenSeadragon.Point( _container.width(), footerHeight ); if ( !_canvasScale ) { _canvasScale = osViewer.viewer.drawer.context.canvas.width / osViewer.viewer.drawer.context.canvas.clientWidth; } if ( _canvasScale != 1 ) { footerPos = footerPos.times( _canvasScale ); footerSize = footerSize.times( _canvasScale ); } osViewer.viewer.drawer.context.drawImage( _footerImage, footerPos.x, footerPos.y, footerSize.x, footerSize.y ); } }; function _timeout(promise, time) { var deferred = new jQuery.Deferred(); $.when(promise).done(deferred.resolve).fail(deferred.reject).progress(deferred.notify); setTimeout(function() { deferred.reject(&quot;timeout&quot;); }, time); return deferred.promise(); } return osViewer; } )( jQuery, OpenSeadragon ); // browser backward compability if(!String.prototype.startsWith) { String.prototype.startsWith = function(subString) { var start = this.substring(0,subString.length); return start.localeCompare(subString) === 0; } } if(!String.prototype.endsWith) { String.prototype.endsWith = function(subString) { var start = this.substring(this.length-subString.length,this.length); return start.localeCompare(subString) === 0; } } if(!Array.prototype.find) { Array.prototype.find = function(comparator) { for ( var int = 0; int &lt; this.length; int++ ) { var element = this[int]; if(comparator(element)) { return element; } } } } if(!Number.isNaN) { Number.isNaN = function(number) { return number !== number; } } var viewImage = ( function( osViewer ) { 'use strict'; var _debug = false; var _currentZoom; var _zoomedOut = true; var _panning = false; var _fadeout = null; osViewer.controls = { init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'osViewer.controls.init' ); console.log( '##############################' ); } if(osViewer.controls.persistence) { osViewer.controls.persistence.init(config); } if(_debug) { console.log(&quot;Setting viewer location to&quot;, config.image.location); } if( osViewer.observables ) { // set location after viewport update osViewer.observables.redrawRequired .sample(osViewer.observables.viewportUpdate) .filter(function(event) {return osViewer.controls ? true : false}) .subscribe(function(event) { setLocation(event, osViewer) osViewer.controls.setPanning( false ); }); // zoom home if min zoom reached osViewer.observables.viewerZoom.subscribe( function( event ) { if ( _debug ) { console.log( &quot;zoom to &quot; + osViewer.viewer.viewport.getZoom( true ) ); } if ( !osViewer.controls.isPanning() ) { var currentZoom = osViewer.viewer.viewport.getZoom(); if ( currentZoom &lt;= osViewer.viewer.viewport.minZoomLevel ) { if ( _debug ) { console.log( &quot;Zoomed out: Panning home&quot; ); } osViewer.controls.setPanning(true); osViewer.controls.goHome( true ); osViewer.controls.setPanning(false); } } } ); } // fade out fullscreen controls if ( $( '#fullscreenTemplate' ).length &gt; 0 ) { $( '#fullscreenTemplate' ).on( 'mousemove', function() { osViewer.controls.fullscreenControlsFadeout(); } ); } }, getLocation: function() { return { x: osViewer.controls.getCenter().x, y: osViewer.controls.getCenter().y, zoom: osViewer.controls.getZoom()/osViewer.controls.getCurrentRotationZooming(), rotation: osViewer.controls.getRotation(), } }, getCenter: function() { if ( _debug ) { console.log( &quot;image center is &quot; + osViewer.viewer.viewport.getCenter( true ) ); } return osViewer.viewer.viewport.getCenter( true ); }, setCenter: function( center ) { if ( _debug ) { console.log( &quot;Setting image center to &quot; ); console.log( center ); } osViewer.viewer.viewport.panTo( center, true ); }, getZoom: function() { if ( _debug ) { console.log( 'osViewer.controls.getZoom' ); } return osViewer.viewer.viewport.getZoom( true ); }, zoomTo: function( zoomTo ) { if ( _debug ) { console.log( 'osViewer.controls.myZoomTo: zoomTo - ' + zoomTo ); } var zoomBy = parseFloat( zoomTo ) / osViewer.viewer.viewport.getZoom(); if ( _debug ) { console.log( 'osViewer.controls.myZoomTo: zoomBy - ' + zoomBy ); } osViewer.viewer.viewport.zoomBy( zoomBy, osViewer.viewer.viewport.getCenter( false ), true ); }, setFullScreen: function( enable ) { if ( _debug ) { console.log( 'osViewer.controls.setFullScreen: enable - ' + enable ); } osViewer.viewer.setFullScreen( enable ); }, goHome: function( immediate ) { if ( _debug ) { console.log( 'osViewer.controls.panHome - zoom : ' + osViewer.viewer.viewport.getHomeZoom() ); } osViewer.viewer.viewport.goHome( immediate ); _zoomedOut = true; }, reset: function( resetRotation ) { if ( _debug ) { console.log( 'osViewer.controls.goHome: bool - ' + resetRotation ); } // osViewer.viewer.viewport.goHome( true ); osViewer.controls.goHome( true ); osViewer.viewer.viewport.zoomTo( osViewer.viewer.viewport.getHomeZoom(), null, true ); if ( resetRotation ) { osViewer.controls.rotateTo( 0 ); } }, zoomIn: function() { if ( _debug ) { console.log( 'osViewer.controls.zoomIn: zoomSpeed - ' + osViewer.getConfig().global.zoomSpeed ); } osViewer.viewer.viewport.zoomBy( osViewer.getConfig().global.zoomSpeed, osViewer.viewer.viewport.getCenter( false ), false ); }, zoomOut: function() { if ( _debug ) { console.log( 'osViewer.controls.zoomOut: zoomSpeed - ' + osViewer.getConfig().global.zoomSpeed ); } osViewer.viewer.viewport.zoomBy( 1 / osViewer.getConfig().global.zoomSpeed, osViewer.viewer.viewport.getCenter( false ), false ); }, getHomeZoom: function( rotated ) { if ( rotated &amp;&amp; osViewer.getCanvasSize().x / osViewer.getCanvasSize().y &lt;= osViewer.getImageSize().x / osViewer.getImageSize().y ) { osViewer.viewer.viewport.homeFillsViewer = true; } var zoom = osViewer.viewer.viewport.getHomeZoom(); osViewer.viewer.viewport.homeFillsViewer = false; return zoom; }, rotateRight: function() { if ( _debug ) { console.log( 'osViewer.controls.rotateRight' ); } var newRotation = osViewer.viewer.viewport.getRotation() + 90; osViewer.controls.rotateTo( newRotation ); }, rotateLeft: function() { if ( _debug ) { console.log( 'osViewer.controls.rotateLeft' ); } var newRotation = osViewer.viewer.viewport.getRotation() - 90; osViewer.controls.rotateTo( newRotation ); }, getRotation: function() { if ( _debug ) { console.log( 'osViewer.controls.getRotation' ); } return osViewer.viewer.viewport.getRotation(); }, setRotation: function( rotation ) { if ( _debug ) { console.log( 'osViewer.controls.setRotation: rotation - ' + rotation ); } return osViewer.controls.rotateTo( rotation ); }, rotateTo: function( newRotation ) { if ( newRotation &lt; 0 ) { newRotation = newRotation + 360; } newRotation = newRotation % 360; if ( _debug ) { console.log( 'osViewer.controls.rotateTo: newRotation - ' + newRotation ); } _panning = true; _currentZoom = null; osViewer.viewer.viewport.setRotation( newRotation ); _panning = false; }, getCurrentRotationZooming: function() { var sizes = osViewer.getSizes(); if(sizes &amp;&amp; sizes.rotated()) { return 1/sizes.ratio(sizes.originalImageSize); } else { return 1; } }, setPanning: function(panning) { _panning = panning; }, isPanning: function() { return _panning; }, fullscreenControlsFadeout: function() { if ( _debug ) { console.log( '---------- osViewer.controls.fullscreenControlsFadeout() ----------' ); } if ( _fadeout ) { clearTimeout( _fadeout ); this.showFullscreenControls(); } _fadeout = setTimeout( this.hideFullscreenControls, 3000 ); }, hideFullscreenControls: function() { if ( _debug ) { console.log( '---------- osViewer.controls.hideFullscreenControls() ----------' ); } $( '#fullscreenRotateControlsWrapper, #fullscreenZoomSliderWrapper, #fullscreenExitWrapper, #fullscreenPrevWrapper, #fullscreenNextWrapper' ).stop().fadeOut( 'slow' ); }, showFullscreenControls: function() { if ( _debug ) { console.log( '---------- osViewer.controls.showFullscreenControls() ----------' ); } $( '#fullscreenRotateControlsWrapper, #fullscreenZoomSliderWrapper, #fullscreenExitWrapper, #fullscreenPrevWrapper, #fullscreenNextWrapper' ).show(); } }; // set correct location, zooming and rotation once viewport has been updated after // redraw function setLocation(event, osViewer) { if(_debug) { console.log(&quot;Viewer changed from &quot; + event.osState + &quot; event&quot;); console.log(&quot;target location: &quot;, event.targetLocation); console.log(&quot;Home zoom = &quot;, osViewer.viewer.viewport.getHomeZoom()); } osViewer.viewer.viewport.minZoomLevel = osViewer.viewer.viewport.getHomeZoom() * osViewer.getConfig().global.minZoomLevel; var targetZoom = event.targetLocation.zoom; var targetLocation = new OpenSeadragon.Point(event.targetLocation.x, event.targetLocation.y); var zoomDiff = targetZoom * osViewer.viewer.viewport.getHomeZoom() - (osViewer.viewer.viewport.minZoomLevel); // console.log(&quot;zoomDiff: &quot; + targetZoom + &quot; * &quot; + osViewer.viewer.viewport.getHomeZoom() // + &quot; - &quot; + osViewer.viewer.viewport.minZoomLevel + &quot; = &quot;, zoomDiff); // console.log(&quot;zoomDiff: &quot; + targetZoom + &quot; - &quot; + osViewer.viewer.viewport.minZoomLevel + // &quot;/&quot; + osViewer.controls.getCurrentRotationZooming() + &quot; = &quot;, zoomDiff); var zoomedOut = zoomDiff &lt; 0.001 || !targetZoom; if(zoomedOut) { if(_debug) { console.log(&quot;Zooming home&quot;) } osViewer.controls.goHome( true ); } else { if(_debug) { console.log( &quot;Zooming to &quot; + targetZoom + &quot; * &quot; + osViewer.controls.getCurrentRotationZooming() ); console.log(&quot;panning to &quot;, targetLocation); } osViewer.viewer.viewport.zoomTo( targetZoom * osViewer.controls.getCurrentRotationZooming(), null, true); osViewer.controls.setCenter( targetLocation); } if(event.osState === &quot;open&quot; &amp;&amp; event.targetLocation.rotation !== 0) { osViewer.controls.rotateTo(event.targetLocation.rotation); } } return osViewer; } )( viewImage || {}, jQuery ); var viewImage = ( function( osViewer ) { 'use strict'; var _debug = false; osViewer.controls.persistence = { init: function( config ) { if ( typeof ( Storage ) !== 'undefined' ) { /** * Set Location from local storage */ var location = null; var currentPersistenceId = osViewer.getConfig().global.persistenceId; if ( config.global.persistZoom || config.global.persistRotation ) { try { var location = JSON.parse( localStorage.imageLocation ); } catch ( err ) { if ( _debug ) { console.error( &quot;No readable image location in local storage&quot; ); } } if ( location &amp;&amp; _isValid( location ) &amp;&amp; location.persistenceId === currentPersistenceId ) { if ( _debug ) { console.log( &quot;Reading location from local storage&quot;, location ); } config.image.location = {}; if ( config.global.persistZoom ) { if ( _debug ) { console.log( &quot;setting zoom from local storage&quot; ); } config.image.location.zoom = location.zoom; config.image.location.x = location.x; config.image.location.y = location.y; } if ( config.global.persistRotation ) { if ( _debug ) { console.log( &quot;setting rotation from local storage&quot; ); } config.image.location.rotation = location.rotation; } else { config.image.location.rotation = 0; } } /** * save current location to local storage before navigating away */ window.onbeforeunload = function() { var loc = osViewer.controls.getLocation(); loc.persistenceId = osViewer.getConfig().global.persistenceId; localStorage.imageLocation = JSON.stringify( loc ); if ( _debug ) { console.log( &quot;storing zoom &quot; + localStorage.imageLocation ); } } } } } } function _isValid( location ) { return _isNumber( location.x ) &amp;&amp; _isNumber( location.y ) &amp;&amp; _isNumber( location.zoom ) &amp;&amp; _isNumber( location.rotation ); } function _isNumber( x ) { return typeof x === &quot;number&quot; &amp;&amp; !Number.isNaN( x ); } return osViewer; } )( viewImage || {}, jQuery ); var viewImage = ( function( osViewer ) { 'use strict'; var _debug = false; var _drawing = true; var _viewerInputHook = null; var _hbAdd = 5; var _deleteOldDrawElement = true; var _drawElement = null; var _startPoint = null; var _drawPoint = null; osViewer.drawLine = { init: function() { _viewerInputHook = osViewer.viewer.addViewerInputHook( { hooks: [ { tracker: &quot;viewer&quot;, handler: &quot;clickHandler&quot;, hookHandler: _disableViewerEvent }, { tracker: &quot;viewer&quot;, handler: &quot;scrollHandler&quot;, hookHandler: _disableViewerEvent }, { tracker: &quot;viewer&quot;, handler: &quot;dragHandler&quot;, hookHandler: _onViewerDrag }, { tracker: &quot;viewer&quot;, handler: &quot;pressHandler&quot;, hookHandler: _onViewerPress }, { tracker: &quot;viewer&quot;, handler: &quot;dragEndHandler&quot;, hookHandler: _onViewerDragEnd } ] } ); }, toggleDrawing: function() { _drawing = !_drawing; } } function _onViewerPress( event ) { if ( _drawing ) { if ( _drawElement &amp;&amp; _deleteOldDrawElement ) { osViewer.viewer.removeOverlay( _drawElement ); } _drawElement = document.createElement( &quot;div&quot; ); _drawElement.style.border = &quot;2px solid green&quot;; _drawPoint = osViewer.viewer.viewport.viewerElementToViewportCoordinates( event.position ); _drawPoint = osViewer.overlays.getRotated( _drawPoint ); var rect = new OpenSeadragon.Rect( _drawPoint.x, _drawPoint.y, 0, 0 ); osViewer.viewer.addOverlay( _drawElement, rect, 1 ); // console.log(osViewer.viewer.viewport // .viewerElementToImageCoordinates(event.position)); event.preventDefaultAction = true; return true; } } function _onViewerDrag( event ) { if ( _drawing ) { var newPoint = osViewer.viewer.viewport.viewerElementToViewportCoordinates( event.position ); newPoint = osViewer.overlays.getRotated( newPoint ); var rect = new OpenSeadragon.Rect( _drawPoint.x, _drawPoint.y, newPoint.x - _drawPoint.x, newPoint.y - _drawPoint.y ); if ( newPoint.x &lt; _drawPoint.x ) { rect.x = newPoint.x; rect.width = _drawPoint.x - newPoint.x; } if ( newPoint.y &lt; _drawPoint.y ) { rect.y = newPoint.y; rect.height = _drawPoint.y - newPoint.y; } osViewer.viewer.updateOverlay( _drawElement, rect, 0 ); event.preventDefaultAction = true; return true; } } function _onViewerDragEnd( event ) { if ( _drawing ) { var newPoint = osViewer.viewer.viewport.viewerElementToViewportCoordinates( event.position ); newPoint = osViewer.overlays.getRotated( newPoint ); var rect = new OpenSeadragon.Rect( _drawPoint.x, _drawPoint.y, newPoint.x - _drawPoint.x, newPoint.y - _drawPoint.y ); if ( newPoint.x &lt; _drawPoint.x ) { rect.x = newPoint.x; rect.width = _drawPoint.x - newPoint.x; } if ( newPoint.y &lt; _drawPoint.y ) { rect.y = newPoint.y; rect.height = _drawPoint.y - newPoint.y; } rect.hitBox = { l: rect.x - _hbAdd, t: rect.y - _hbAdd, r: rect.x + rect.width + _hbAdd, b: rect.y + rect.height + _hbAdd }; // osViewer.overlays.addRect({ // drawElement : _drawElement, // rect : rect // }); // console.log(osViewer.viewer.viewport // .viewerElementToImageCoordinates(event.position)); event.preventDefaultAction = true; return true; } } function _disableViewerEvent( event ) { if ( _drawing ) { event.preventDefaultAction = true; return true; } } function checkForRectHit( point ) { var i; for ( i = 0; i &lt; _rects.length; i++ ) { var x = _rects[ i ]; if ( point.x &gt; x.hitBox.l &amp;&amp; point.x &lt; x.hitBox.r &amp;&amp; point.y &gt; x.hitBox.t &amp;&amp; point.y &lt; x.hitBox.b ) { var topLeftHb = { l: x.x - _hbAdd, t: x.y - _hbAdd, r: x.x + _hbAdd, b: x.y + _hbAdd }; var topRightHb = { l: x.x + x.width - _hbAdd, t: x.y - _hbAdd, r: x.x + x.width + _hbAdd, b: x.y + _hbAdd }; var bottomRightHb = { l: x.x + x.width - _hbAdd, t: x.y + x.height - _hbAdd, r: x.x + x.width + _hbAdd, b: x.y + x.height + _hbAdd }; var bottomLeftHb = { l: x.x - _hbAdd, t: x.y + x.height - _hbAdd, r: x.x + _hbAdd, b: x.y + x.height + _hbAdd }; var topHb = { l: x.x + _hbAdd, t: x.y - _hbAdd, r: x.x + x.width - _hbAdd, b: x.y + _hbAdd }; var rightHb = { l: x.x + x.width - _hbAdd, t: x.y + _hbAdd, r: x.x + x.width + _hbAdd, b: x.y + x.height - _hbAdd }; var bottomHb = { l: x.x + _hbAdd, t: x.y + x.height - _hbAdd, r: x.x + x.width - _hbAdd, b: x.y + x.height + _hbAdd }; var leftHb = { l: x.x - _hbAdd, t: x.y + _hbAdd, r: x.x + _hbAdd, b: x.y + x.height - _hbAdd }; } } } return osViewer; } )( viewImage || {}, jQuery ); var viewImage = ( function( osViewer ) { 'use strict'; var _debug = false; var drawingStyleClass = &quot;drawing&quot;; var _active = false; var _drawing = false; var _overlayGroup = null; var _finishHook = null; var _viewerInputHook = null; var _hbAdd = 5; var _minDistanceToExistingRect = 0.01; var _deleteOldDrawElement = true; var _drawElement = null; var _drawPoint = null; osViewer.drawRect = { init: function() { if ( _debug ) { console.log( '##############################' ); console.log( 'osViewer.drawRect.init' ); console.log( '##############################' ); } _viewerInputHook = osViewer.viewer.addViewerInputHook( { hooks: [ { tracker: &quot;viewer&quot;, handler: &quot;clickHandler&quot;, hookHandler: _disableViewerEvent // }, { // tracker: &quot;viewer&quot;, // handler: &quot;scrollHandler&quot;, // hookHandler: _disableViewerEvent }, { tracker: &quot;viewer&quot;, handler: &quot;dragHandler&quot;, hookHandler: _onViewerDrag }, { tracker: &quot;viewer&quot;, handler: &quot;pressHandler&quot;, hookHandler: _onViewerPress }, { tracker: &quot;viewer&quot;, handler: &quot;dragEndHandler&quot;, hookHandler: _onViewerDragEnd } ] } ); }, startDrawing: function( overlayGroup, finishHook ) { _active = true; _overlayGroup = overlayGroup; _finishHook = finishHook; }, endDrawing: function( removeLastElement ) { _active = false; _overlayGroup = null; _finishHook = null; if ( _drawElement &amp;&amp; removeLastElement ) { osViewer.viewer.removeOverlay( _drawElement ); } else { $( _drawElement ).removeClass( drawingStyleClass ); } }, isActive: function() { return _active; }, isDrawing: function() { return _drawing; }, removeLastDrawnElement: function() { if ( _drawElement ) { osViewer.viewer.removeOverlay( _drawElement ); } }, } function _onViewerPress( event ) { if ( _active ) { _drawPoint = osViewer.viewer.viewport.viewerElementToViewportCoordinates( event.position ); event.preventDefaultAction = false; return true; } } function _onViewerDrag( event ) { // if(_debug) { // console.log(&quot;Dragging: &quot;); // console.log(&quot;_active = &quot; + _active); // console.log(&quot;_drawing = &quot; + _drawing); // console.log(&quot;_drawPoint = &quot; + _drawPoint); // } if ( _drawing ) { var newPoint = osViewer.viewer.viewport.viewerElementToViewportCoordinates( event.position ); var rect = new OpenSeadragon.Rect( _drawPoint.x, _drawPoint.y, newPoint.x - _drawPoint.x, newPoint.y - _drawPoint.y ); if ( newPoint.x &lt; _drawPoint.x ) { rect.x = newPoint.x; rect.width = _drawPoint.x - newPoint.x; } if ( newPoint.y &lt; _drawPoint.y ) { rect.y = newPoint.y; rect.height = _drawPoint.y - newPoint.y; } osViewer.viewer.updateOverlay( _drawElement, rect, 0 ); event.preventDefaultAction = true; return true; } else if ( _active &amp;&amp; _drawPoint ) { var activeOverlay = osViewer.overlays.getDrawingOverlay(); if ( activeOverlay &amp;&amp; osViewer.transformRect &amp;&amp; osViewer.transformRect.isActive() &amp;&amp; osViewer.overlays.contains( activeOverlay.rect, _drawPoint, _minDistanceToExistingRect ) ) { _drawPoint = null; if ( _debug ) console.log( &quot;Action overlaps active overlay&quot; ); } else { _drawing = true; if ( activeOverlay &amp;&amp; _deleteOldDrawElement ) { osViewer.overlays.removeOverlay( activeOverlay ); } _drawElement = document.createElement( &quot;div&quot; ); if ( _overlayGroup ) { $( _drawElement ).addClass( _overlayGroup.styleClass ); } $( _drawElement ).addClass( drawingStyleClass ); var rect = new OpenSeadragon.Rect( _drawPoint.x, _drawPoint.y, 0, 0 ); osViewer.viewer.addOverlay( _drawElement, rect, 1 ); } event.preventDefaultAction = true; return true; } } function _onViewerDragEnd( event ) { if ( _drawing ) { _drawing = false; var newPoint = osViewer.viewer.viewport.viewerElementToViewportCoordinates( event.position ); var rect = new OpenSeadragon.Rect( _drawPoint.x, _drawPoint.y, newPoint.x - _drawPoint.x, newPoint.y - _drawPoint.y ); if ( newPoint.x &lt; _drawPoint.x ) { rect.x = newPoint.x; rect.width = _drawPoint.x - newPoint.x; } if ( newPoint.y &lt; _drawPoint.y ) { rect.y = newPoint.y; rect.height = _drawPoint.y - newPoint.y; } rect.hitBox = { l: rect.x - _hbAdd, t: rect.y - _hbAdd, r: rect.x + rect.width + _hbAdd, b: rect.y + rect.height + _hbAdd }; var overlay = { type: osViewer.overlays.overlayTypes.RECTANGLE, element: _drawElement, rect: rect, group: _overlayGroup.name, }; osViewer.overlays.setDrawingOverlay( overlay ); if ( _finishHook ) { _finishHook( overlay ); } event.preventDefaultAction = true; return true; } } function _disableViewerEvent( event ) { if ( _active ) { event.preventDefaultAction = true; return true; } } function checkForRectHit( point ) { var i; for ( i = 0; i &lt; _rects.length; i++ ) { var x = _rects[ i ]; if ( point.x &gt; x.hitBox.l &amp;&amp; point.x &lt; x.hitBox.r &amp;&amp; point.y &gt; x.hitBox.t &amp;&amp; point.y &lt; x.hitBox.b ) { var topLeftHb = { l: x.x - _hbAdd, t: x.y - _hbAdd, r: x.x + _hbAdd, b: x.y + _hbAdd }; var topRightHb = { l: x.x + x.width - _hbAdd, t: x.y - _hbAdd, r: x.x + x.width + _hbAdd, b: x.y + _hbAdd }; var bottomRightHb = { l: x.x + x.width - _hbAdd, t: x.y + x.height - _hbAdd, r: x.x + x.width + _hbAdd, b: x.y + x.height + _hbAdd }; var bottomLeftHb = { l: x.x - _hbAdd, t: x.y + x.height - _hbAdd, r: x.x + _hbAdd, b: x.y + x.height + _hbAdd }; var topHb = { l: x.x + _hbAdd, t: x.y - _hbAdd, r: x.x + x.width - _hbAdd, b: x.y + _hbAdd }; var rightHb = { l: x.x + x.width - _hbAdd, t: x.y + _hbAdd, r: x.x + x.width + _hbAdd, b: x.y + x.height - _hbAdd }; var bottomHb = { l: x.x + _hbAdd, t: x.y + x.height - _hbAdd, r: x.x + x.width - _hbAdd, b: x.y + x.height + _hbAdd }; var leftHb = { l: x.x - _hbAdd, t: x.y + _hbAdd, r: x.x + _hbAdd, b: x.y + x.height - _hbAdd }; } } } return osViewer; } )( viewImage || {}, jQuery ); var viewImage = ( function( osViewer ) { 'use strict'; var _debug = false; osViewer.Measures = function( osViewer ) { this.config = osViewer.getConfig(); this.$container = $( &quot;#&quot; + this.config.global.divId ); this.outerCanvasSize = new OpenSeadragon.Point( this.$container.outerWidth(), this.$container.outerHeight() ); this.innerCanvasSize = new OpenSeadragon.Point( this.$container.width(), this.$container.height() ); this.originalImageSize = new OpenSeadragon.Point( this.getTotalImageWidth( osViewer.getImageInfo() ), this.getMaxImageHeight( osViewer.getImageInfo() ) ); // console.log(&quot;Original image size = &quot;, this.originalImageSize); this.footerHeight = this.config.global.footerHeight; this.rotation = osViewer.viewer != null ? osViewer.viewer.viewport.getRotation() : 0; this.xPadding = this.outerCanvasSize.x - this.innerCanvasSize.x; this.yPadding = this.outerCanvasSize.y - this.innerCanvasSize.y; this.innerCanvasSize.y -= this.footerHeight; // calculate image size as it should be displayed in relation to canvas size if ( this.fitToHeight() ) { this.imageDisplaySize = new OpenSeadragon.Point( this.innerCanvasSize.y / this.ratio( this.getRotatedSize( this.originalImageSize ) ), this.innerCanvasSize.y ) } else { this.imageDisplaySize = new OpenSeadragon.Point( this.innerCanvasSize.x, this.innerCanvasSize.x * this.ratio( this.getRotatedSize( this.originalImageSize ) ) ) } if ( this.rotated() ) { this.imageDisplaySize = this.getRotatedSize( this.imageDisplaySize ); } }; osViewer.Measures.prototype.getMaxImageWidth = function( imageInfo ) { var width = 0; if ( imageInfo &amp;&amp; imageInfo.length &gt; 0 ) { for ( var i = 0; i &lt; imageInfo.length; i++ ) { var tileSource = imageInfo[ i ]; if ( tileSource.tileSource ) { correction = tileSource.width; tileSource = tileSource.tileSource; } width = Math.max( width, tileSource.width * correction ); } } return width; }; osViewer.Measures.prototype.getMaxImageHeight = function( imageInfo ) { var height = 0; if ( imageInfo &amp;&amp; imageInfo.length &gt; 0 ) { for ( var i = 0; i &lt; imageInfo.length; i++ ) { var tileSource = imageInfo[ i ]; var correction = 1; if ( tileSource.tileSource ) { correction = tileSource.width; tileSource = tileSource.tileSource; } height = Math.max( height, tileSource.height * correction ); } } return height; }; osViewer.Measures.prototype.getTotalImageWidth = function( imageInfo ) { var width = 0; if ( imageInfo &amp;&amp; imageInfo.length &gt; 0 ) { for ( var i = 0; i &lt; imageInfo.length; i++ ) { var tileSource = imageInfo[ i ]; var correction = 1; if ( tileSource.tileSource ) { correction = tileSource.width; tileSource = tileSource.tileSource; } width += ( tileSource.width * correction ); } } return width; }; osViewer.Measures.prototype.getTotalImageHeight = function( imageInfo ) { var height = 0; if ( imageInfo &amp;&amp; imageInfo.length &gt; 0 ) { for ( var i = 0; i &lt; imageInfo.length; i++ ) { var tileSource = imageInfo[ i ]; var aspectRatio if ( tileSource.tileSource ) { correction = tileSource.width; tileSource = tileSource.tileSource; } height += tileSource.height * correction; } } return height; }; osViewer.Measures.prototype.getImageHomeSize = function() { var ratio = this.rotated() ? 1 / this.ratio( this.originalImageSize ) : this.ratio( this.originalImageSize ); if ( this.fitToHeight() ) { var height = this.innerCanvasSize.y; var width = height / ratio; } else { var width = this.innerCanvasSize.x; var height = width * ratio; } return this.getRotatedSize( new OpenSeadragon.Point( width, height ) ); }; osViewer.Measures.prototype.rotated = function() { return this.rotation % 180 !== 0; }; osViewer.Measures.prototype.landscape = function() { return this.ratio( this.originalImageSize ) &lt; 1; }; osViewer.Measures.prototype.ratio = function( size ) { return size.y / size.x; }; osViewer.Measures.prototype.getRotatedSize = function( size ) { return new OpenSeadragon.Point( this.rotated() ? size.y : size.x, this.rotated() ? size.x : size.y ); }; osViewer.Measures.prototype.fitToHeight = function() { return !this.config.global.adaptContainerHeight &amp;&amp; this.ratio( this.getRotatedSize( this.originalImageSize ) ) &gt; this.ratio( this.innerCanvasSize ); }; osViewer.Measures.prototype.resizeCanvas = function() { // Set height of container if required if ( this.config.global.adaptContainerHeight ) { if ( _debug ) { console.log( &quot;adapt container height&quot; ); } this.$container.height( this.getRotatedSize( this.imageDisplaySize ).y + this.footerHeight ); } this.outerCanvasSize = new OpenSeadragon.Point( this.$container.outerWidth(), this.$container.outerHeight() ); this.innerCanvasSize = new OpenSeadragon.Point( this.$container.width(), this.$container.height() - this.footerHeight ); }; osViewer.Measures.prototype.calculateExcessHeight = function() { var imageSize = this.getRotatedSize( this.getImageHomeSize() ); var excessHeight = this.config.global.adaptContainerHeight || this.fitToHeight() ? 0 : 0.5 * ( this.innerCanvasSize.y - imageSize.y ); return excessHeight; }; return osViewer; } )( viewImage || {}, jQuery ); var viewImage = ( function( osViewer ) { 'use strict'; var _debug = false; var _focusStyleClass = 'focus'; var _highlightStyleClass = 'highlight'; var _overlayFocusHook = null; var _overlayClickHook = null; var _drawingOverlay = null; var _overlays = []; var _defaults = {}; var _initializedCallback = null; osViewer.overlays = { init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'osViewer.overlays.init' ); console.log( '##############################' ); } $.extend( true, _defaults, config ); osViewer.observables.overlayRemove.subscribe(function( event ) { if ( event.element ) { $( event.element ).remove(); } }); if(_defaults.image.highlightCoords) { osViewer.observables.viewerOpen.subscribe( function( data ) { for ( var index=0; index&lt;_defaults.image.highlightCoords.length; index++) { var highlightCoords = _defaults.image.highlightCoords[ index ]; var imageIndex = highlightCoords.pageIndex; osViewer.overlays.draw( highlightCoords.name, highlightCoords.displayTooltip, imageIndex); } if ( _initializedCallback ) { _initializedCallback(); } } ); } }, onInitialized: function( callback ) { var oldCallback = _initializedCallback; _initializedCallback = function() { if ( oldCallback ) { oldCallback(); } callback(); } }, onFocus: function( hook ) { var tempHook = _overlayFocusHook; _overlayFocusHook = function( overlay, focus ) { if ( tempHook ) tempHook( overlay, focus ); hook( overlay, focus ); } }, onClick: function( hook ) { var tempHook = _overlayClickHook; _overlayClickHook = function( overlay ) { if ( tempHook ) tempHook( overlay ); hook( overlay ); } }, getOverlays: function() { return _overlays.slice(); }, getRects: function() { return _overlays.filter( function( overlay ) { return overlay.type === osViewer.overlays.overlayTypes.RECTANGLE } ).slice(); }, getLines: function() { return _overlays.filter( function( overlay ) { return overlay.type === osViewer.overlays.overlayTypes.LINE } ).slice(); }, draw: function( group, displayTitle, imageIndex ) { if ( _debug ) { console.log( 'osViewer.overlays.draw: group - ' + group ); console.log( 'osViewer.overlays.draw: displayTitle - ' + displayTitle ); console.log( 'osViewer.overlays.draw: imageIndex - ' + imageIndex ); } var coordList = _defaults.getCoordinates( group ); if ( coordList ) { for ( var index=0; index&lt;coordList.coordinates.length; index++ ) { var coords = coordList.coordinates[ index ]; var title = displayTitle &amp;&amp; coords.length &gt; 4 ? coords[ 4 ] : ''; var id = coords.length &gt; 5 ? coords[ 5 ] : index; _createRectangle( coords[ 0 ], coords[ 1 ], coords[ 2 ] - coords[ 0 ], coords[ 3 ] - coords[ 1 ], title, id, group, imageIndex ); } } }, unDraw: function( group ) { if ( _debug ) { console.log( 'osViewer.overlays.unDraw: group - ' + group ); } var newRects = []; _overlays = _overlays.filter( function( overlay ) { if ( overlay.group === group ) { osViewer.viewer.removeOverlay( overlay.element ); return false; } else { return true; } } ); }, highlight: function( group ) { if ( _debug ) { console.log( 'osViewer.overlays.highlight: group - ' + group ); } _overlays.filter( function( overlay ) { return overlay.group === group; } ).forEach( function( overlay ) { if ( overlay.element ) { overlay.element.highlight( true ); } } ); }, unHighlight: function( group ) { if ( _debug ) { console.log( 'osViewer.overlays.unHighlight: group - ' + group ); } _overlays.filter( function( overlay ) { return overlay.group === group; } ).forEach( function( overlay ) { if ( overlay.element ) { overlay.element.highlight( false ); } } ); }, focusBox: function( group, id ) { if ( _debug ) { console.log( 'osViewer.overlays.highlightBox: group - ' + group ); console.log( 'osViewer.overlays.highlightBox: id - ' + id ); } _overlays.filter( function( overlay ) { return overlay.group === group; } ).forEach( function( overlay ) { if ( overlay.element ) { overlay.element.focus( overlay.id === id ); } } ); }, addOverlay: function( overlay ) { if ( _debug ) { console.log( 'osViewer.overlays.addOverlay: overlay - ' + overlay ); } _overlays.push( overlay ); if ( overlay.element ) { osViewer.viewer.updateOverlay( overlay.element, overlay.rect, 0 ); } }, removeOverlay: function( overlay ) { if ( overlay ) { if ( _debug ) console.log( &quot;Removing overlay &quot; + overlay.id ); var index = _overlays.indexOf( overlay ); _overlays.splice( index, 1 ); if ( overlay.element ) { osViewer.viewer.removeOverlay( overlay.element ); } } }, drawRect: function( rectangle, group, title, id ) { if ( _debug ) { console.log( 'osViewer.overlays.drawRect: rectangle - ' + rectangle ); console.log( 'osViewer.overlays.drawRect: group - ' + group ); } _createRectangle( rectangle.x, rectangle.y, rectangle.width, rectangle.height, title ? title : &quot;&quot;, id ? id : &quot;&quot;, group ); }, drawLine: function( point1, point2, group ) { if ( _debug ) { console.log( 'osViewer.overlays.drawLine: point1 - ' + point1 ); console.log( 'osViewer.overlays.drawLine: point2 - ' + point2 ); console.log( 'osViewer.overlays.drawLine: group - ' + group ); } _createLine( point1.x, point1.y, point2.x, point2.y, &quot;&quot;, &quot;&quot;, group ); }, showOverlay: function( overlay ) { if ( overlay &amp;&amp; !overlay.element ) { _drawOverlay( overlay ); if ( _overlayFocusHook ) { _overlayFocusHook( overlay, true ); } } }, hideOverlay: function( overlay ) { if ( overlay &amp;&amp; overlay.element &amp;&amp; _drawingOverlay != overlay ) { _undrawOverlay( overlay ); if ( _overlayFocusHook ) { _overlayFocusHook( overlay, false ); } } }, getOverlay: function( id, group ) { var overlay = _overlays.find( function( overlay ) { if ( group ) { return overlay.id === id &amp;&amp; overlay.group === group; } else { return overlay.id === id } } ); // console.log(&quot;search for overlay with id = &quot; + id); // console.log(&quot;Found overlay &quot;, overlay); return overlay; }, getCoordinates: function( overlay ) { if(_debug){ console.log(&quot;getCoordinates - overlay&quot;, overlay); } if ( overlay.type === osViewer.overlays.overlayTypes.RECTANGLE ) { var transformedRect = osViewer.viewer.viewport.viewportToImageRectangle( overlay.rect ); transformedRect = transformedRect.times( osViewer.getScaleToOriginalSize() ); return transformedRect; } else if ( overlay.type === osViewer.overlays.overlayTypes.LINE ) { var p1 = osViewer.viewer.viewport.viewportToImageCoordinates( overlay.poin1 ); var p2 = osViewer.viewer.viewport.viewportToImageCoordinates( overlay.poin2 ); return { point1: p1, point2: p2 }; } }, getDrawingOverlay: function() { return _drawingOverlay; }, setDrawingOverlay: function( overlay ) { _drawingOverlay = overlay; }, showHiddenOverlays: function() { osViewer.viewer.addViewerInputHook( { hooks: [ { tracker: &quot;viewer&quot;, handler: &quot;moveHandler&quot;, hookHandler: _onViewerMove } ] } ); }, contains: function( rect, point, precision ) { if ( precision == null ) { precision = 0; } return _isInside( rect, point, precision ); }, overlayTypes: { RECTANGLE: &quot;rectangle&quot;, LINE: &quot;line&quot; }, getRotated: function(point) { // var rotation = osViewer.viewer.viewport.getRotation(); // var center = osViewer.viewer.viewport.getCenter( true ); // point = point.rotate(-rotation, center); return point; } }; function _createLine( x1, y1, x2, y2, title, id, group ) { if ( _debug ) { console.log( '------------------------------' ); console.log( 'Overlays _createLine: x1 - ' + x1 ); console.log( 'Overlays _createLine: y1 - ' + y1 ); console.log( 'Overlays _createLine: x2 - ' + x2 ); console.log( 'Overlays _createLine: y2 - ' + y2 ); console.log( 'Overlays _createLine: title - ' + title ); console.log( 'Overlays _createLine: id - ' + id ); console.log( 'Overlays _createLine: group - ' + group ); console.log( '------------------------------' ); } x1 = osViewer.scaleToImageSize( x1 ); y1 = osViewer.scaleToImageSize( y1 ); x2 = osViewer.scaleToImageSize( x2 ); y2 = osViewer.scaleToImageSize( y2 ); var p1 = new OpenSeadragon.Point( x1, y1 ); var p2 = new OpenSeadragon.Point( x2, y2 ); var length = p1.distanceTo( p2 ); var angle = _calculateAngle( p1, p2 ); var beta = ( 180 - angle ) / 2; // console.log( &quot;drawing line with length = &quot; + length + &quot; and angle = &quot; + angle ); y1 += length / 2 * Math.sin( angle * Math.PI / 180 ); x1 -= length / 2 * Math.sin( angle * Math.PI / 180 ) / Math.tan( beta * Math.PI / 180 ); var rectangle = osViewer.viewer.viewport.imageToViewportRectangle( x1, y1, length, 1 ); var p1Viewer = osViewer.viewer.viewport.imageToViewportCoordinates( p1 ); var p2Viewer = osViewer.viewer.viewport.imageToViewportCoordinates( p2 ); var overlay = { type: osViewer.overlays.overlayTypes.LINE, rect: rectangle, angle: angle, point1: p1Viewer, point2: p2Viewer, group: group, id: id, title: title }; var overlayStyle = _defaults.getOverlayGroup( overlay.group ); if ( !overlayStyle.hidden ) { _drawOverlay( overlay ); } _overlays.push( overlay ); } /** * coordinates are in original image space */ function _createRectangle( x, y, width, height, title, id, group, imageIndex ) { if ( _debug ) { console.log( '------------------------------' ); console.log( 'Overlays _createRectangle: x - ' + x ); console.log( 'Overlays _createRectangle: y - ' + y ); console.log( 'Overlays _createRectangle: width - ' + width ); console.log( 'Overlays _createRectangle: height - ' + height ); console.log( 'Overlays _createRectangle: title - ' + title ); console.log( 'Overlays _createRectangle: id - ' + id ); console.log( 'Overlays _createRectangle: group - ' + group ); console.log( 'Overlays _createRectangle: imageIndex - ' + imageIndex ); console.log( '------------------------------' ); } x = osViewer.scaleToImageSize( x ); y = osViewer.scaleToImageSize( y ); width = osViewer.scaleToImageSize( width ); height = osViewer.scaleToImageSize( height ); if(!imageIndex) { imageIndex = 0; } var tiledImage = osViewer.viewer.world.getItemAt(imageIndex); var rectangle = tiledImage.imageToViewportRectangle( x, y, width, height ); // console.log(&quot;Found rect &quot;, rectangle); // var rectangle = osViewer.viewer.viewport.imageToViewportRectangle( x, y, width, height // ); var overlay = { type: osViewer.overlays.overlayTypes.RECTANGLE, rect: rectangle, group: group, id: id, title: title }; var overlayStyle = _defaults.getOverlayGroup( overlay.group ); if ( !overlayStyle.hidden ) { _drawOverlay( overlay ); } _overlays.push( overlay ); } function _undrawOverlay( overlay ) { osViewer.viewer.removeOverlay( overlay.element ); overlay.element = null; } function _drawOverlay( overlay ) { if(_debug) { console.log(&quot;viewImage.overlays._drawOverlay&quot;); console.log(&quot;overlay: &quot;, overlay); } var element = document.createElement( &quot;div&quot; ); $(element).attr(&quot;id&quot;, &quot;overlay_&quot; + overlay.id) var overlayStyle = _defaults.getOverlayGroup( overlay.group ); if ( overlayStyle ) { if(_debug)console.log(&quot;overlay style&quot;, overlayStyle); // element.title = overlay.title; // $( element ).attr( &quot;data-toggle&quot;, &quot;tooltip&quot; ); // $( element ).attr( &quot;data-placement&quot;, &quot;auto top&quot; ); $( element ).addClass( overlayStyle.styleClass ); if ( overlay.type === osViewer.overlays.overlayTypes.LINE ) { _rotate( overlay.angle, element ); } if ( overlayStyle.interactive ) { element.focus = function( focus ) { if ( focus ) { $( element ).addClass( _focusStyleClass ); _createTooltip(element, overlay); // tooltip.height(100); // $( element ).tooltip( &quot;show&quot; ); } else { $( element ).removeClass( _focusStyleClass ); $(&quot;.tooltipp#tooltip_&quot; + overlay.id).remove(); } if ( _overlayFocusHook ) { _overlayFocusHook( overlay, focus ); } }; element.highlight = function( focus ) { if ( focus ) { $( element ).addClass( _highlightStyleClass ); } else { $( element ).removeClass( _highlightStyleClass ); } }; $( element ).on( &quot;mouseover&quot;, function() { if ( _debug ) { console.log( 'Overlays _drawOverlay: mouse over - ' + overlayStyle.name ); } osViewer.overlays.focusBox( overlay.group, overlay.id ); } ); $( element ).on( &quot;mouseout&quot;, function() { if ( _debug ) { console.log( 'Overlays _drawOverlay: mouse out - ' + overlayStyle.name ); } element.focus( false ); } ); $( element ).on( &quot;click&quot;, function() { if ( _overlayClickHook ) { _overlayClickHook( overlay ); } } ); } overlay.element = element; osViewer.viewer.addOverlay( element, overlay.rect, 0 ); } } function _createTooltip(element, overlay) { if(overlay.title) { var canvasCorner = osViewer.sizes.$container.offset(); var top = $( element ).offset().top; var left = $( element ).offset().left; var bottom = top + $( element ).outerHeight(); var right = left + $( element ).outerWidth(); // console.log(&quot;Tooltip at &quot;, left, top, right, bottom); var $tooltip = $(&quot;&lt;div class='tooltipp'&gt;&quot; + overlay.title + &quot;&lt;/div&gt;&quot;); $(&quot;body&quot;).append($tooltip); var tooltipPadding = parseFloat($tooltip.css(&quot;padding-top&quot;)); $tooltip.css(&quot;max-width&quot;,right-left); $tooltip.css(&quot;top&quot;, Math.max(canvasCorner.top + tooltipPadding, top-$tooltip.outerHeight()-tooltipPadding)); $tooltip.css(&quot;left&quot;, Math.max(canvasCorner.left + tooltipPadding, left)); $tooltip.attr(&quot;id&quot;, &quot;tooltip_&quot; + overlay.id); // console.log(&quot;tooltip width = &quot;, $tooltip.width()); // listener for zoom osViewer.observables.animation .do(function() { // console.log(&quot;element at: &quot;, $(element).offset()); var top = Math.max($( element ).offset().top, canvasCorner.top); var left = Math.max($( element ).offset().left, canvasCorner.left); $tooltip.css(&quot;top&quot;, Math.max(canvasCorner.top + tooltipPadding, top-$tooltip.outerHeight()-tooltipPadding)); $tooltip.css(&quot;left&quot;, Math.max(canvasCorner.left + tooltipPadding, left)); }) .takeWhile(function() { return $(&quot;.tooltipp&quot;).length &gt; 0; }) .subscribe(); } } function _rotate( angle, mapElement ) { if ( _debug ) { console.log( 'Overlays _rotate: angle - ' + angle ); console.log( 'Overlays _rotate: mapElement - ' + mapElement ); } if ( angle !== 0 ) { $( mapElement ).css( &quot;-moz-transform&quot;, &quot;rotate(&quot; + angle + &quot;deg)&quot; ); $( mapElement ).css( &quot;-webkit-transform&quot;, &quot;rotate(&quot; + angle + &quot;deg)&quot; ); $( mapElement ).css( &quot;-ms-transform&quot;, &quot;rotate(&quot; + angle + &quot;deg)&quot; ); $( mapElement ).css( &quot;-o-transform&quot;, &quot;rotate(&quot; + angle + &quot;deg)&quot; ); $( mapElement ).css( &quot;transform&quot;, &quot;rotate(&quot; + angle + &quot;deg)&quot; ); var sin = Math.sin( angle ); var cos = Math.cos( angle ); $( mapElement ).css( &quot;filter&quot;, &quot;progid:DXImageTransform.Microsoft.Matrix(M11=&quot; + cos + &quot;, M12=&quot; + sin + &quot;, M21=-&quot; + sin + &quot;, M22=&quot; + cos + &quot;, sizingMethod='auto expand'&quot; ); } } function _calculateAngle( p1, p2 ) { if ( _debug ) { console.log( 'Overlays _calculateAngle: p1 - ' + p1 ); console.log( 'Overlays _calculateAngle: p2 - ' + p2 ); } var dx = p2.x - p1.x; var dy = p2.y - p1.y; var radians = null; if ( dx &gt; 0 ) { radians = Math.atan( dy / dx ); return radians * 180 / Math.PI; } else if ( dx &lt; 0 ) { radians = Math.atan( dy / dx ); return radians * 180 / Math.PI + 180; } else if ( dy &lt; 0 ) { return 270; } else { return 90; } } // function _getScaleToOriginalSize() { // var displaySize = osViewer.viewer.world.getItemAt(0).source.dimensions.x;// // osViewer.viewer.viewport.contentSize.x; // return osViewer.getImageInfo().width / displaySize; // } // // function _scaleToOriginalSize( value ) { // if ( _debug ) { // console.log( 'Overlays _scaleToOriginalSize: value - ' + value ); // } // // var displaySize = osViewer.viewer.world.getItemAt(0).source.dimensions.x;// // osViewer.viewer.viewport.contentSize.x; // return value / displaySize * osViewer.getImageInfo().width; // } // // function _scaleToImageSize( value ) { // if ( _debug ) { // console.log( 'Overlays _scaleToImageSize: value - ' + value ); // } // // var displaySize = osViewer.viewer.world.getItemAt(0).source.dimensions.x;// // osViewer.viewer.viewport.contentSize.x; // return value * displaySize / osViewer.getImageInfo().width; // } function _isInside( rect, point, extra ) { return point.x &gt; rect.x - extra &amp;&amp; point.x &lt; ( rect.x + rect.width + extra ) &amp;&amp; point.y &gt; rect.y - extra &amp;&amp; point.y &lt; ( rect.y + rect.height + extra ); } function _onViewerMove( event ) { var position = event.position; var ieVersion = viewerJS.helper.detectIEVersion(); if(ieVersion &amp;&amp; ieVersion === 10) { // console.log(&quot;Correct position for ie &quot;, ieVersion); position.x += $(window).scrollLeft(); position.y += $(window).scrollTop(); } // console.log( &quot;viewer move &quot;, position); var point = osViewer.viewer.viewport.viewerElementToViewportCoordinates( position ); _overlays.forEach( function( o ) { if ( _isInside( o.rect, point, 0 ) ) { osViewer.overlays.showOverlay( o ); } else { osViewer.overlays.hideOverlay( o ); } } ); } return osViewer; } )( viewImage || {}, jQuery ); var viewImage = ( function( osViewer ) { 'use strict'; var _debug = false; var _localStoragePossible = true; var _activePanel = null; var _defaults = { navSelector: '.reading-mode__navigation', viewSelector: '#contentView', imageContainerSelector: '.reading-mode__content-view-image', imageSelector: '#readingModeImage', sidebarSelector: '#contentSidebar', sidebarToggleButton: '.reading-mode__content-sidebar-toggle', sidebarInnerSelector: '.reading-mode__content-sidebar-inner', sidebarTabsSelector: '.reading-mode__content-sidebar-tabs', sidebarTabContentSelector: '.tab-content', sidebarTocWrapperSelector: '.widget-toc-elem-wrapp', sidebarStatus: '', useTabs: true, useAccordeon: false, msg: {}, }; osViewer.readingMode = { /** * Method to initialize the viewer reading mode. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {String} config.navSelector A string which contains the selector for the * navigation. * @param {String} config.viewSelector A string which contains the selector for * the content view. * @param {String} config.imageContainerSelector A string which contains the * selector for the image container. * @param {String} config.imageSelector A string which contains the selector for * the image. * @param {String} config.sidebarSelector A string which contains the selector for * the sidebar. * @param {String} config.sidebarToggleButton A string which contains the selector * for the sidebar toggle button. * @param {String} config.sidebarInnerSelector A string which contains the * selector for the inner sidebar container. * @param {String} config.sidebarStatus A string which contains the current * sidebar status. */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'osViewer.readingMode.init' ); console.log( '##############################' ); console.log( 'osViewer.readingMode.init: config - ', config ); } $.extend( true, _defaults, config ); // check local storage _localStoragePossible = viewerJS.helper.checkLocalStorage(); if ( _localStoragePossible ) { _defaults.sidebarStatus = localStorage.getItem( 'sidebarStatus' ); if ( _defaults.sidebarStatus === '' || _defaults.sidebarStatus === undefined ) { localStorage.setItem( 'sidebarStatus', 'true' ); } // set viewport _setViewportHeight(); if ( _defaults.useTabs ) { _setSidebarTabHeight(); } _setSidebarButtonPosition(); _checkSidebarStatus(); setTimeout( function() { _showContent(); }, 500 ); // save panel status if ( _defaults.useAccordeon ) { _activePanel = localStorage.getItem( 'activePanel' ); $( '.panel-collapse' ).each( function() { $( this ).removeClass( 'in' ); } ); if ( _activePanel === null ) { localStorage.setItem( 'activePanel', '#collapseOne' ); _activePanel = localStorage.getItem( 'activePanel' ); $( _activePanel ).addClass( 'in' ); } else { $( _activePanel ).addClass( 'in' ); } // click panel event $( 'a[data-toggle=&quot;collapse&quot;]' ).on( 'click', function() { var currPanel = $( this ).attr( 'href' ); localStorage.setItem( 'activePanel', currPanel ); } ); } // events $( '[data-toggle=&quot;sidebar&quot;]' ).on( 'click', function() { $( this ).toggleClass( 'in' ); $( this ).parents( '.reading-mode__content-sidebar' ).toggleClass( 'in' ); $( this ).parents( '.reading-mode__content-sidebar' ).prev().toggleClass( 'in' ); // set sidebar status to local storage _defaults.sidebarStatus = localStorage.getItem( 'sidebarStatus' ); if ( _defaults.sidebarStatus === 'false' ) { localStorage.setItem( 'sidebarStatus', 'true' ); } else { localStorage.setItem( 'sidebarStatus', 'false' ); } } ); $( window ).on( 'resize', function() { _setViewportHeight(); if ( _defaults.useTabs ) { _setSidebarTabHeight(); } _setSidebarButtonPosition(); } ); $( window ).on( &quot;orientationchange&quot;, function() { _setViewportHeight(); if ( _defaults.useTabs ) { _setSidebarTabHeight(); } _setSidebarButtonPosition(); } ); // AJAX Loader Eventlistener if ( typeof jsf !== 'undefined' ) { jsf.ajax.addOnEvent( function( data ) { var ajaxstatus = data.status; switch ( ajaxstatus ) { case &quot;success&quot;: _setViewportHeight(); if ( _defaults.useTabs ) { _setSidebarTabHeight(); } _setSidebarButtonPosition(); break; } } ); } } else { return false; } }, }; /** * Method which sets the height of the viewport elements. * * @method _setViewportHeight */ function _setViewportHeight() { if ( _debug ) { console.log( '---------- _setViewportHeight() ----------' ); console.log( '_setViewportHeight: view = ', _defaults.viewSelector ); console.log( '_setViewportHeight: image = ', _defaults.imageSelector ); console.log( '_setViewportHeight: sidebar = ', _defaults.sidebarSelector ); console.log( '_setViewportHeight: sidebarInner = ', _defaults.sidebarInnerSelector ); console.log( '_setViewportHeight: sidebarTabs = ', _defaults.sidebarTabsSelector ); } var viewportHeight = $( window ).outerHeight(); var navHeight = $( _defaults.navSelector ).outerHeight(); var newHeight = viewportHeight - navHeight; if ( _debug ) { console.log( '_setViewportHeight: viewportHeight = ', viewportHeight ); console.log( '_setViewportHeight: navHeight = ', navHeight ); console.log( '_setViewportHeight: newHeight = ', newHeight ); } $( _defaults.viewSelector ).css( 'height', newHeight ); $( _defaults.imageSelector ).css( 'height', newHeight ); $( _defaults.sidebarSelector ).css( 'height', newHeight ); $( _defaults.sidebarInnerSelector ).css( 'height', newHeight ); } /** * Method which sets the height of the sidebar Tabs. * * @method _setSidebarTabHeight */ function _setSidebarTabHeight() { if ( _debug ) { console.log( '---------- _setSidebarTabHeight() ----------' ); console.log( '_setSidebarTabHeight: sidebarTabs = ', _defaults.sidebarTabsSelector ); } var viewportHeight = $( window ).outerHeight(); var navHeight = $( _defaults.navSelector ).outerHeight(); var newHeight = viewportHeight - navHeight; var tabPos = $( _defaults.sidebarTabsSelector ).position(); var tabHeight = newHeight - tabPos.top - 15; var navTabsHeight = $( '.nav-tabs' ).outerHeight(); if ( _debug ) { console.log( '_setSidebarTabHeight: tabPos = ', tabPos ); console.log( '_setSidebarTabHeight: tabHeight = ', tabHeight ); } if ( viewportHeight &gt; 768 ) { $( _defaults.sidebarTabsSelector ).css( 'height', tabHeight ); $( _defaults.sidebarTabContentSelector ).css( 'height', tabHeight - navTabsHeight ); $( _defaults.sidebarTocWrapperSelector ).css( 'min-height', tabHeight - navTabsHeight ); } } /** * Method which sets the position of the sidebar toggle button. * * @method _setSidebarButtonPosition */ function _setSidebarButtonPosition() { if ( _debug ) { console.log( '---------- _setSidebarButtonPosition() ----------' ); console.log( '_setSidebarButtonPosition: view = ', _defaults.viewSelector ); } var viewHalfHeight = $( _defaults.viewSelector ).outerHeight() / 2; if ( _debug ) { console.log( '_setSidebarButtonPosition: viewHalfHeight = ', viewHalfHeight ); } $( _defaults.sidebarToggleButton ).css( 'top', viewHalfHeight ); } /** * Method which checks the current sidebar status, based on a local storage value. * * @method _checkSidebarStatus * @returns {Boolean} Returns false if the sidebar is inactive, returns true if the * sidebar is active. */ function _checkSidebarStatus() { if ( _debug ) { console.log( '---------- _checkSidebarStatus() ----------' ); console.log( '_checkSidebarStatus: sidebarStatus = ', _defaults.sidebarStatus ); } if ( _defaults.sidebarStatus === 'false' ) { $( '[data-toggle=&quot;sidebar&quot;]' ).removeClass( 'in' ); $( '.reading-mode__content-sidebar' ).removeClass( 'in' ).prev().removeClass( 'in' ); return false; } else { return true; } } /** * Method which shows the content by removing CSS-Classes after loading every page * element. * * @method _showContent */ function _showContent() { if ( _debug ) { console.log( '---------- _showContent() ----------' ); } $( _defaults.viewSelector ).removeClass( 'invisible' ); $( _defaults.sidebarSelector ).removeClass( 'invisible' ); } return osViewer; } )( viewImage || {}, jQuery ); var viewImage = ( function( osViewer ) { 'use strict'; var _debug = false; osViewer.tileSourceResolver = { resolveAsJsonOrURI: function( imageInfo ) { var deferred = Q.defer(); if ( this.isJson( imageInfo ) ) { deferred.resolve( imageInfo ); } else if ( this.isStringifiedJson( imageInfo ) ) { deferred.resolve( JSON.parse( imageInfo ) ); } else { deferred.resolve( imageInfo ); } return deferred.promise; }, resolveAsJson: function( imageInfo ) { var deferred = Q.defer(); if ( this.isURI( imageInfo ) ) { if ( this.isJsonURI( imageInfo ) ) { return this.loadJsonFromURL( imageInfo ); } else { deferred.reject( &quot;Url does not lead to a json object&quot; ); } } else if ( typeof imageInfo === &quot;string&quot; ) { try { var json = JSON.parse( imageInfo ); deferred.resolve( json ); } catch ( error ) { deferred.reject( &quot;String does not contain valid json: &quot; + error ); } } else if ( typeof imageInfo === &quot;object&quot; ) { deferred.resolve( imageInfo ); } else { deferred.reject( &quot;Neither a url nor a json object&quot; ); } return deferred.promise; }, loadJsonFromURL: function( imageInfo ) { var deferred = Q.defer(); if ( this.isJsonURI( imageInfo ) ) { OpenSeadragon.makeAjaxRequest( imageInfo, // success function( request ) { try { deferred.resolve( JSON.parse( request.responseText ) ); } catch ( error ) { deferred.reject( error ) } }, // error function( error ) { deferred.reject( error ); } ) } else { deferred.reject( &quot;Not a json uri: &quot; + imageInfo ); } return deferred.promise; }, loadIfJsonURL: function( imageInfo ) { return Q.promise( function( resolve, reject ) { if ( osViewer.tileSourceResolver.isURI( imageInfo ) ) { var ajaxParams = { url: decodeURI( imageInfo ), type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true, crossDomain: true, accepts: { application_json: &quot;application/json&quot;, application_jsonLd: &quot;application/ld+json&quot;, text_json: &quot;text/json&quot;, text_jsonLd: &quot;text/ld+json&quot;, } } Q( $.ajax( ajaxParams ) ).then( function( data ) { resolve( data ); } ).fail( function( error ) { reject( &quot;Failed to retrieve json from &quot; + imageInfo ); } ); setTimeout( function() { reject( &quot;Timeout after 10s&quot; ); }, 10000 ) } else { reject( &quot;Not a uri: &quot; + imageInfo ); } } ); }, isJsonURI: function( imageInfo ) { if ( this.isURI( imageInfo ) ) { var shortened = imageInfo.replace( /\\?.*/, &quot;&quot; ); if ( shortened.endsWith( &quot;/&quot; ) ) { shortened = shortened.substring( 0, shortened.length - 1 ); } return shortened.toLowerCase().endsWith( &quot;.json&quot; ); } return false; }, isURI: function( imageInfo ) { if ( imageInfo &amp;&amp; typeof imageInfo === &quot;string&quot; ) { if ( imageInfo.startsWith( &quot;http://&quot; ) || imageInfo.startsWith( &quot;https://&quot; ) || imageInfo.startsWith( &quot;file:/&quot; ) ) { return true; } } return false; }, isStringifiedJson: function( imageInfo ) { if ( imageInfo &amp;&amp; typeof imageInfo === &quot;string&quot; ) { try { var json = JSON.parse( imageInfo ); return this.isJson( json ); } catch ( error ) { // no json return false; } } return false; }, isJson: function( imageInfo ) { return imageInfo &amp;&amp; typeof imageInfo === &quot;object&quot;; }, } return osViewer; } )( viewImage || {}, jQuery ); var viewImage = ( function( osViewer ) { 'use strict'; var DEFAULT_CURSOR = &quot;default&quot;; var _debug = false; var _drawingStyleClass = &quot;transforming&quot;; var _active = false; var _drawing = false; var _group = null; var _finishHook = null; var _viewerInputHook = null; var _hbAdd = 5; var _sideClickPrecision = 0.004; var _drawArea = &quot;&quot;; var _enterPoint = null; osViewer.transformRect = { init: function() { if ( _debug ) { console.log( '##############################' ); console.log( 'osViewer.transformRect.init' ); console.log( '##############################' ); } _viewerInputHook = osViewer.viewer.addViewerInputHook( { hooks: [ { tracker: &quot;viewer&quot;, handler: &quot;clickHandler&quot;, hookHandler: _disableViewerEvent // }, { // tracker : &quot;viewer&quot;, // handler : &quot;scrollHandler&quot;, // hookHandler : _disableViewerEvent }, { tracker: &quot;viewer&quot;, handler: &quot;dragHandler&quot;, hookHandler: _onViewerDrag }, { tracker: &quot;viewer&quot;, handler: &quot;pressHandler&quot;, hookHandler: _onViewerPress }, { tracker: &quot;viewer&quot;, handler: &quot;dragEndHandler&quot;, hookHandler: _onViewerDragEnd }, { tracker: &quot;viewer&quot;, handler: &quot;releaseHandler&quot;, hookHandler: _onViewerRelease }, { tracker: &quot;viewer&quot;, handler: &quot;moveHandler&quot;, hookHandler: _onViewerMove } ] } ); }, startDrawing: function( overlay, finishHook ) { if ( _debug ) console.log( &quot;Start drawing&quot; ); osViewer.overlays.setDrawingOverlay( overlay ); _active = true; _group = overlay.group; _finishHook = finishHook; $( overlay.element ).addClass( _drawingStyleClass ); }, endDrawing: function() { _drawing = false; _group = null; _finishHook = null; _active = false; var drawOverlay = osViewer.overlays.getDrawingOverlay(); if ( drawOverlay != null ) { $( drawOverlay.element ).removeClass( _drawingStyleClass ); $( drawOverlay.element ).css( { cursor: DEFAULT_CURSOR } ); } }, isActive: function() { return _active; }, hitAreas: { TOP: &quot;t&quot;, BOTTOM: &quot;b&quot;, RIGHT: &quot;r&quot;, LEFT: &quot;l&quot;, TOPLEFT: &quot;tl&quot;, TOPRIGHT: &quot;tr&quot;, BOTTOMLEFT: &quot;bl&quot;, BOTTOMRIGHT: &quot;br&quot;, CENTER: &quot;c&quot;, isCorner: function( area ) { return area === this.TOPRIGHT || area === this.TOPLEFT || area === this.BOTTOMLEFT || area === this.BOTTOMRIGHT; }, isEdge: function( area ) { return area === this.TOP || area === this.BOTTOM || area === this.LEFT || area === this.RIGHT; }, getCursor: function( area ) { var rotated = osViewer.viewer.viewport.getRotation() % 180 === 90; if ( area === this.TOPLEFT || area === this.BOTTOMRIGHT ) { return rotated ? &quot;nesw-resize&quot; : &quot;nwse-resize&quot;; } else if ( area === this.TOPRIGHT || area === this.BOTTOMLEFT ) { return rotated ? &quot;nwse-resize&quot; : &quot;nesw-resize&quot;; } else if ( area === this.TOP || area === this.BOTTOM ) { return rotated ? &quot;ew-resize&quot; : &quot;ns-resize&quot;; } else if ( area === this.RIGHT || area === this.LEFT ) { return rotated ? &quot;ns-resize&quot; : &quot;ew-resize&quot;; } else if ( area === this.CENTER ) { return &quot;move&quot;; } else { return DEFAULT_CURSOR; } } } } function _onViewerMove( event ) { if ( !_drawing &amp;&amp; _active ) { var drawPoint = osViewer.viewer.viewport.viewerElementToViewportCoordinates( event.position ); drawPoint = osViewer.overlays.getRotated( drawPoint ); var overlayRect = osViewer.overlays.getDrawingOverlay().rect; var overlayElement = osViewer.overlays.getDrawingOverlay().element; var viewerElement = osViewer.viewer.element; var area = _findCorner( overlayRect, drawPoint, _sideClickPrecision ); if ( !area ) { area = _findEdge( overlayRect, drawPoint, _sideClickPrecision ); } if ( !area &amp;&amp; osViewer.overlays.contains( overlayRect, drawPoint, 0 ) ) { area = osViewer.transformRect.hitAreas.CENTER; } if ( area ) { $( viewerElement ).css( { cursor: osViewer.transformRect.hitAreas.getCursor( area ) } ); } else { $( viewerElement ).css( { cursor: DEFAULT_CURSOR } ); } event.preventDefaultAction = true; return true; } } function _onViewerPress( event ) { if ( _active ) { if ( !osViewer.overlays.getDrawingOverlay() ) { return false; } var overlayRect = osViewer.overlays.getDrawingOverlay().rect; var overlayElement = osViewer.overlays.getDrawingOverlay().element; var drawPoint = osViewer.viewer.viewport.viewerElementToViewportCoordinates( event.position ); drawPoint = osViewer.overlays.getRotated( drawPoint ); var drawArea = _findCorner( overlayRect, drawPoint, _sideClickPrecision ); if ( !drawArea ) { drawArea = _findEdge( overlayRect, drawPoint, _sideClickPrecision ); } if ( !drawArea &amp;&amp; osViewer.overlays.contains( overlayRect, drawPoint, 0 ) ) { drawArea = osViewer.transformRect.hitAreas.CENTER; } if ( _debug ) console.log( &quot;draw area = &quot; + drawArea ); if ( drawArea ) { $( overlayElement ).tooltip( 'destroy' ); _enterPoint = drawPoint; } _drawArea = drawArea; event.preventDefaultAction = true; return true; } } function _onViewerDrag( event ) { if ( _drawing ) { var newPoint = osViewer.viewer.viewport.viewerElementToViewportCoordinates( event.position ); newPoint = osViewer.overlays.getRotated( newPoint ); var rect = osViewer.overlays.getDrawingOverlay().rect; var topLeft; var bottomRight; // if(_debug)console.log(&quot;Draw location = &quot; + newPoint); if ( _drawArea === osViewer.transformRect.hitAreas.TOPLEFT ) { topLeft = new OpenSeadragon.Point( Math.min( newPoint.x, rect.getBottomRight().x ), Math.min( newPoint.y, rect.getBottomRight().y ) ); bottomRight = rect.getBottomRight(); } else if ( _drawArea === osViewer.transformRect.hitAreas.TOPRIGHT ) { topLeft = new OpenSeadragon.Point( rect.getTopLeft().x, Math.min( newPoint.y, rect.getBottomRight().y ) ); bottomRight = new OpenSeadragon.Point( Math.max( newPoint.x, rect.getTopLeft().x ), rect.getBottomRight().y ); } else if ( _drawArea === osViewer.transformRect.hitAreas.BOTTOMLEFT ) { topLeft = new OpenSeadragon.Point( Math.min( newPoint.x, rect.getBottomRight().x ), rect.getTopLeft().y ); bottomRight = new OpenSeadragon.Point( rect.getBottomRight().x, Math.max( newPoint.y, rect.getTopLeft().y ) ); } else if ( _drawArea === osViewer.transformRect.hitAreas.BOTTOMRIGHT ) { topLeft = rect.getTopLeft(); bottomRight = new OpenSeadragon.Point( Math.max( newPoint.x, rect.getTopLeft().x ), Math.max( newPoint.y, rect.getTopLeft().y ) ); } else if ( _drawArea === osViewer.transformRect.hitAreas.LEFT ) { topLeft = new OpenSeadragon.Point( Math.min( newPoint.x, rect.getBottomRight().x ), rect.getTopLeft().y ); bottomRight = rect.getBottomRight(); } else if ( _drawArea === osViewer.transformRect.hitAreas.RIGHT ) { topLeft = rect.getTopLeft(); bottomRight = new OpenSeadragon.Point( Math.max( newPoint.x, rect.getTopLeft().x ), rect.getBottomRight().y ); } else if ( _drawArea === osViewer.transformRect.hitAreas.TOP ) { topLeft = new OpenSeadragon.Point( rect.getTopLeft().x, Math.min( newPoint.y, rect.getBottomRight().y ) ); bottomRight = rect.getBottomRight(); } else if ( _drawArea === osViewer.transformRect.hitAreas.BOTTOM ) { topLeft = rect.getTopLeft(); bottomRight = new OpenSeadragon.Point( rect.getBottomRight().x, Math.max( newPoint.y, rect.getTopLeft().y ) ); } else if ( _drawArea === osViewer.transformRect.hitAreas.CENTER &amp;&amp; _enterPoint ) { var dx = _enterPoint.x - newPoint.x; var dy = _enterPoint.y - newPoint.y; rect.x -= dx; rect.y -= dy; _enterPoint = newPoint; } if ( topLeft &amp;&amp; bottomRight ) { // if(_debug)console.log(&quot;Upper left point is &quot; + rect.getTopLeft()); // if(_debug)console.log(&quot;Lower right point is &quot; + rect.getBottomRight()); // if(_debug)console.log(&quot;Setting upper left point to &quot; + topLeft); // if(_debug)console.log(&quot;Setting lower right point to &quot; + bottomRight); rect.x = topLeft.x; rect.y = topLeft.y; rect.width = bottomRight.x - topLeft.x; rect.height = bottomRight.y - topLeft.y; } osViewer.viewer.updateOverlay( osViewer.overlays.getDrawingOverlay().element, rect, 0 ); event.preventDefaultAction = true; return true; } else if ( _drawArea ) { _drawing = true; event.preventDefaultAction = true; return true; } } function _onViewerRelease( event ) { if ( _active ) { if ( _drawing &amp;&amp; _finishHook ) { _finishHook( osViewer.overlays.getDrawingOverlay() ); } _drawing = false; if ( osViewer.overlays.getDrawingOverlay() ) { $( osViewer.overlays.getDrawingOverlay().element ).tooltip(); } _drawArea = &quot;&quot;; _enterPoint = null; event.preventDefaultAction = true; return true; } } function _onViewerDragEnd( event ) { if ( _drawing ) { _drawing = false; event.preventDefaultAction = true; return true; } } function _disableViewerEvent( event ) { if ( _drawing ) { event.preventDefaultAction = true; return true; } } function checkForRectHit( point ) { var i; for ( i = 0; i &lt; _rects.length; i++ ) { var x = _rects[ i ]; if ( point.x &gt; x.hitBox.l &amp;&amp; point.x &lt; x.hitBox.r &amp;&amp; point.y &gt; x.hitBox.t &amp;&amp; point.y &lt; x.hitBox.b ) { var topLeftHb = { l: x.x - _hbAdd, t: x.y - _hbAdd, r: x.x + _hbAdd, b: x.y + _hbAdd }; var topRightHb = { l: x.x + x.width - _hbAdd, t: x.y - _hbAdd, r: x.x + x.width + _hbAdd, b: x.y + _hbAdd }; var bottomRightHb = { l: x.x + x.width - _hbAdd, t: x.y + x.height - _hbAdd, r: x.x + x.width + _hbAdd, b: x.y + x.height + _hbAdd }; var bottomLeftHb = { l: x.x - _hbAdd, t: x.y + x.height - _hbAdd, r: x.x + _hbAdd, b: x.y + x.height + _hbAdd }; var topHb = { l: x.x + _hbAdd, t: x.y - _hbAdd, r: x.x + x.width - _hbAdd, b: x.y + _hbAdd }; var rightHb = { l: x.x + x.width - _hbAdd, t: x.y + _hbAdd, r: x.x + x.width + _hbAdd, b: x.y + x.height - _hbAdd }; var bottomHb = { l: x.x + _hbAdd, t: x.y + x.height - _hbAdd, r: x.x + x.width - _hbAdd, b: x.y + x.height + _hbAdd }; var leftHb = { l: x.x - _hbAdd, t: x.y + _hbAdd, r: x.x + _hbAdd, b: x.y + x.height - _hbAdd }; } } } /* * Determine the side of the rectangle rect the point lies on or closest at &lt;=maxDist * distance */ function _findEdge( rect, point, maxDist ) { var distanceToLeft = _distToSegment( point, rect.getTopLeft(), rect.getBottomLeft() ); var distanceToBottom = _distToSegment( point, rect.getBottomLeft(), rect.getBottomRight() ); var distanceToRight = _distToSegment( point, rect.getTopRight(), rect.getBottomRight() ); var distanceToTop = _distToSegment( point, rect.getTopLeft(), rect.getTopRight() ); var minDistance = Math.min( distanceToLeft, Math.min( distanceToRight, Math.min( distanceToTop, distanceToBottom ) ) ); if ( minDistance &lt;= maxDist ) { if ( distanceToLeft === minDistance ) { return osViewer.transformRect.hitAreas.LEFT; } if ( distanceToRight === minDistance ) { return osViewer.transformRect.hitAreas.RIGHT; } if ( distanceToTop === minDistance ) { return osViewer.transformRect.hitAreas.TOP; } if ( distanceToBottom === minDistance ) { return osViewer.transformRect.hitAreas.BOTTOM; } } return &quot;&quot;; } /* * Determine the cornder of the rectangle rect the point lies on or closest at * &lt;=maxDist distance */ function _findCorner( rect, point, maxDist ) { var distanceToTopLeft = _dist( point, rect.getTopLeft() ); var distanceToBottomLeft = _dist( point, rect.getBottomLeft() ); var distanceToTopRight = _dist( point, rect.getTopRight() ); var distanceToBottomRight = _dist( point, rect.getBottomRight() ); var minDistance = Math.min( distanceToTopLeft, Math.min( distanceToTopRight, Math.min( distanceToBottomLeft, distanceToBottomRight ) ) ); if ( minDistance &lt;= maxDist ) { if ( distanceToTopLeft === minDistance ) { return osViewer.transformRect.hitAreas.TOPLEFT; } if ( distanceToTopRight === minDistance ) { return osViewer.transformRect.hitAreas.TOPRIGHT; } if ( distanceToBottomLeft === minDistance ) { return osViewer.transformRect.hitAreas.BOTTOMLEFT; } if ( distanceToBottomRight === minDistance ) { return osViewer.transformRect.hitAreas.BOTTOMRIGHT; } } return &quot;&quot;; } function _sqr( x ) { return x * x } function _dist2( v, w ) { return _sqr( v.x - w.x ) + _sqr( v.y - w.y ) } function _dist( v, w ) { return Math.sqrt( _dist2( v, w ) ) } function _distToSegmentSquared( p, v, w ) { var l2 = _dist2( v, w ); if ( l2 == 0 ) return _dist2( p, v ); var t = ( ( p.x - v.x ) * ( w.x - v.x ) + ( p.y - v.y ) * ( w.y - v.y ) ) / l2; if ( t &lt; 0 ) return _dist2( p, v ); if ( t &gt; 1 ) return _dist2( p, w ); return _dist2( p, { x: v.x + t * ( w.x - v.x ), y: v.y + t * ( w.y - v.y ) } ); } function _distToSegment( point, lineP1, lineP2 ) { return Math.sqrt( _distToSegmentSquared( point, lineP1, lineP2 ) ); } return osViewer; } )( viewImage || {}, jQuery ); var viewImage = ( function( osViewer ) { 'use strict'; var _debug = false; var _zoomSlider = {}; var _defaults = { global: { /** * The position of the zoom-slider is &quot;dilated&quot; by a function d(zoom) = * 1/sliderDilation*tan[atan(sliderDilation)*zoom] This makes the slider * position change slower for small zoom and faster for larger zoom The * function is chosen so that d(0) = 0 and d(1) = 1 */ sliderDilation: 12 } }; osViewer.zoomSlider = { init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'osViewer.zoomSlider.init' ); console.log( '##############################' ); } $.extend( true, _defaults, config ); if ( $( _defaults.global.zoomSlider ) ) { osViewer.zoomSlider.addZoomSlider( _defaults.global.zoomSlider ); // handler for openSeadragon Object osViewer.viewer.addHandler( 'zoom', function( data ) { osViewer.zoomSlider.buttonToZoom( data.zoom ); } ); } }, buttonToMouse: function( mousePos ) { if ( _debug ) { console.log( 'osViewer.zoomSlider.buttonToMouse: mousePos - ' + mousePos ); } var offset = _zoomSlider.$button.width() / 2; var newPos = mousePos - offset; if ( newPos &lt; 0 ) { newPos = 0; } if ( newPos + 2 * offset &gt; _zoomSlider.absoluteWidth ) { newPos = _zoomSlider.absoluteWidth - 2 * offset; } _zoomSlider.$button.css( { left: newPos } ); _zoomSlider.buttonPosition = newPos; var factor = ( newPos / ( _zoomSlider.absoluteWidth - offset * 2 ) ); factor = 1 / _defaults.global.sliderDilation * Math.tan( Math.atan( _defaults.global.sliderDilation ) * factor ); var newScale = osViewer.viewer.viewport.getMinZoom() + ( osViewer.viewer.viewport.getMaxZoom() - osViewer.viewer.viewport.getMinZoom() ) * factor; if ( _debug ) { console.log( 'osViewer.zoomSlider.buttonToMouse: newScale - ' + newScale ); } osViewer.controls.zoomTo( newScale ); }, buttonToZoom: function( scale ) { if ( _debug ) { console.log( 'osViewer.zoomSlider.buttonToZoom: scale - ' + scale ); } if ( !_zoomSlider || !osViewer.viewer.viewport ) { return; } // console.log(&quot;Dilation = &quot;, osViewer.viewer.viewport.getMinZoom()) // console.log(&quot;minZoom = &quot;, osViewer.viewer.viewport.getMinZoom()); // console.log(&quot;maxZoom = &quot;, osViewer.viewer.viewport.getMaxZoom()) // console.log(&quot;scale = &quot;, scale); var factor = ( scale - osViewer.viewer.viewport.getMinZoom() ) / ( osViewer.viewer.viewport.getMaxZoom() - osViewer.viewer.viewport.getMinZoom() ); // console.log( &quot;factor = &quot;, factor ); // factor = 1 / Math.atan( _defaults.global.sliderDilation ) * Math.atan( _defaults.global.sliderDilation * factor ); var newPos = factor * ( _zoomSlider.absoluteWidth - _zoomSlider.$button.width() ); // var newPos = ( ( scale - osViewer.viewer.viewport.getMinZoom() ) / ( // osViewer.viewer.viewport.getMaxZoom() - // osViewer.viewer.viewport.getMinZoom() ) ) // * ( _zoomSlider.absoluteWidth - _zoomSlider.$button.width() ); // console.log( &quot;pos = &quot;, newPos ); if ( Math.abs( osViewer.viewer.viewport.getMaxZoom() - scale ) &lt; 0.0000000001 ) { newPos = _zoomSlider.absoluteWidth - _zoomSlider.$button.width(); } if ( newPos &lt; 0 ) { newPos = 0; } _zoomSlider.$button.css( { left: newPos } ); _zoomSlider.buttonPosition = newPos; }, zoomSliderMouseUp: function() { if ( _debug ) { console.log( 'osViewer.zoomSlider.zoomSliderMouseUp' ); } _zoomSlider.mousedown = false; }, zoomSliderMouseMove: function( evt ) { if ( _debug ) { console.log( 'osViewer.zoomSlider.zoomSliderMouseMove: evt - ' + evt ); } if ( !_zoomSlider.mousedown ) { return; } var offset = $( this ).offset(); var hitX = evt.pageX - offset.left; osViewer.zoomSlider.buttonToMouse( hitX ); if ( _debug ) { console.log( 'osViewer.zoomSlider.zoomSliderMouseMove: moving - ' + hitX ); } }, zoomSliderMouseDown: function( evt ) { if ( _debug ) { console.log( 'osViewer.zoomSlider.zoomSliderMouseDown: evt - ' + evt ); } _zoomSlider.mousedown = true; var offset = $( this ).offset(); var hitX = evt.pageX - offset.left; osViewer.zoomSlider.buttonToMouse( hitX ); }, buttonMouseDown: function() { if ( _debug ) { console.log( 'osViewer.zoomSlider.buttonMouseDown' ); } _zoomSlider.mousedown = true; return false; }, addZoomSlider: function( element ) { if ( _debug ) { console.log( 'osViewer.zoomSlider.addZoomSlider: element - ' + element ); } _zoomSlider.$element = $( element ); _zoomSlider.$button = _zoomSlider.$element.children( _defaults.global.zoomSliderHandle ); _zoomSlider.buttonPosition = 0; _zoomSlider.absoluteWidth = _zoomSlider.$element.innerWidth(); _zoomSlider.mousedown = false; _zoomSlider.$button.on( 'mousedown', osViewer.zoomSlider.buttonMouseDown ); _zoomSlider.$element.click( osViewer.zoomSlider._zoomSliderClick ); _zoomSlider.$element.mousedown( osViewer.zoomSlider.zoomSliderMouseDown ); _zoomSlider.$element.mousemove( osViewer.zoomSlider.zoomSliderMouseMove ); $( document ).on( 'mouseup', osViewer.zoomSlider.zoomSliderMouseUp ); } }; return osViewer; } )( viewImage || {}, jQuery ); Ã— Search results Close "},"viewer.js.html":{"id":"viewer.js.html","title":"Source: viewer.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer.js /*! * This file is part of the Goobi viewer - a content presentation and management application for digitized objects. * * Visit these websites for more information. * - http://www.intranda.com * - http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free * Software Foundation; either version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this program. If not, see &lt;http://www.gnu.org/licenses/&gt;. */var viewerJS = ( function() { 'use strict'; var _debug = false; var _defaults = { currentPage: '', browser: '', sidebarSelector: '#sidebar', contentSelector: '#main', equalHeightRSSInterval: 1000, equalHeightInterval: 500, messageBoxSelector: '.messages .alert', messageBoxInterval: 1000, messageBoxTimeout: 8000, pageScrollSelector: '.icon-totop', pageScrollAnchor: '#top', widgetNerSidebarRight: false }; var viewer = {}; viewer.init = function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.init' ); console.log( '##############################' ); console.log( 'viewer.init: config - ', config ); } $.extend( true, _defaults, config ); // detect current browser _defaults.browser = viewerJS.helper.getCurrentBrowser(); console.info( 'Current Page = ', _defaults.currentPage ); console.info( 'Current Browser = ', _defaults.browser ); /* * ! IE10 viewport hack for Surface/desktop Windows 8 bug Copyright 2014-2015 * Twitter, Inc. Licensed under MIT * (https://github.com/twbs/bootstrap/blob/master/LICENSE) */ // See the Getting Started docs for more information: // http://getbootstrap.com/getting-started/#support-ie10-width ( function() { 'use strict'; if ( navigator.userAgent.match( /IEMobile\\/10\\.0/ ) ) { var msViewportStyle = document.createElement( 'style' ) msViewportStyle.appendChild( document.createTextNode( '@-ms-viewport{width:auto!important}' ) ) document.querySelector( 'head' ).appendChild( msViewportStyle ) } } )(); // enable BS tooltips $( '[data-toggle=&quot;tooltip&quot;]' ).tooltip(); // render warning if local storage is not useable if ( !viewer.localStoragePossible ) { var warningPopover = this.helper .renderWarningPopover( 'Ihr Browser befindet sich im privaten Modus und unterstÃ¼tzt die MÃ¶glichkeit Informationen zur Seite lokal zu speichern nicht. Aus diesem Grund sind nicht alle Funktionen des viewers verfÃ¼gbar. Bitte verlasen Sie den privaten Modus oder benutzen einen alternativen Browser. Vielen Dank.' ); $( 'body' ).append( warningPopover ); $( '[data-toggle=&quot;warning-popover&quot;]' ).on( 'click', function() { $( '.warning-popover' ).fadeOut( 'fast', function() { $( '.warning-popover' ).remove(); } ); } ); } // off canvas $( '[data-toggle=&quot;offcanvas&quot;]' ).click( function() { var icon = $( this ).children( '.glyphicon' ); $( '.row-offcanvas' ).toggleClass( 'active' ); $( this ).toggleClass( 'in' ); if ( icon.hasClass( 'glyphicon-option-vertical' ) ) { icon.removeClass( 'glyphicon-option-vertical' ).addClass( 'glyphicon-option-horizontal' ); } else { icon.removeClass( 'glyphicon-option-horizontal' ).addClass( 'glyphicon-option-vertical' ); } } ); // toggle mobile navigation $( '[data-toggle=&quot;mobilenav&quot;]' ).on( 'click', function() { $( '.btn-toggle.search' ).removeClass( 'in' ); $( '.header-actions__search' ).hide(); $( '.btn-toggle.language' ).removeClass( 'in' ); $( '#changeLocal' ).hide(); $( '#mobileNav' ).slideToggle( 'fast' ); } ); $( '[data-toggle=&quot;mobile-image-controls&quot;]' ).on( 'click', function() { $( '.image-controls__actions' ).slideToggle( 'fast' ); } ); // toggle language $( '[data-toggle=&quot;language&quot;]' ).on( 'click', function() { $( '.btn-toggle.search' ).removeClass( 'in' ); $( '.header-actions__search' ).hide(); $( this ).toggleClass( 'in' ); $( '#changeLocal' ).fadeToggle( 'fast' ); } ); // toggle search $( '[data-toggle=&quot;search&quot;]' ).on( 'click', function() { $( '.btn-toggle.language' ).removeClass( 'in' ); $( '#changeLocal' ).hide(); $( this ).toggleClass( 'in' ); $( '.header-actions__search' ).fadeToggle( 'fast' ); } ); // set content height to sidebar height if ( window.matchMedia( '(max-width: 768px)' ).matches ) { if ( $( '.rss_wrapp' ).length &gt; 0 ) { setTimeout( function() { viewerJS.helper.equalHeight( _defaults.sidebarSelector, _defaults.contentSelector ); }, _defaults.equalHeightRSSInterval ); } else { setTimeout( function() { viewerJS.helper.equalHeight( _defaults.sidebarSelector, _defaults.contentSelector ); }, _defaults.equalHeightInterval ); } $( window ).on( &quot;orientationchange&quot;, function() { viewerJS.helper.equalHeight( _defaults.sidebarSelector, _defaults.contentSelector ); } ); } // fade out message box if it exists ( function() { var fadeoutScheduled = false; setInterval( function() { if ( $( _defaults.messageBoxSelector ).size() &gt; 0 ) { if ( !fadeoutScheduled ) { fadeoutScheduled = true; var messageTimer = setTimeout( function() { $( _defaults.messageBoxSelector ).each( function() { $( this ).fadeOut( 'slow', function() { $( this ).parent().remove(); } ) } ); fadeoutScheduled = false; }, _defaults.messageBoxTimeout ); } } }, _defaults.messageBoxInterval ); } )(); // add class on toggle sidebar widget (CMS individual sidebar widgets) $( '.collapse' ).on( 'show.bs.collapse', function() { $( this ).prev().find( '.glyphicon' ).removeClass( 'glyphicon-arrow-down' ).addClass( 'glyphicon-arrow-up' ); } ); $( '.collapse' ).on( 'hide.bs.collapse', function() { $( this ).prev().find( '.glyphicon' ).removeClass( 'glyphicon-arrow-up' ).addClass( 'glyphicon-arrow-down' ); } ); // scroll page animated this.pageScroll.init( _defaults.pageScrollSelector, _defaults.pageScrollAnchor ); // check for sidebar toc and set viewport position if ( viewer.localStoragePossible ) { if ( $( '#image_container' ).length &gt; 0 || currentPage === 'readingmode' ) { if ( localStorage.getItem( 'currIdDoc' ) === null ) { localStorage.setItem( 'currIdDoc', 'false' ); } this.helper.saveSidebarTocPosition(); } else { localStorage.setItem( 'sidebarTocScrollPosition', 0 ); } } // AJAX Loader Eventlistener if ( typeof jsf !== 'undefined' ) { jsf.ajax.addOnEvent( function( data ) { var ajaxstatus = data.status; var ajaxloader = document.getElementById( &quot;AJAXLoader&quot; ); var ajaxloaderSidebarToc = document.getElementById( &quot;AJAXLoaderSidebarToc&quot; ); if ( ajaxloaderSidebarToc &amp;&amp; ajaxloader ) { switch ( ajaxstatus ) { case &quot;begin&quot;: ajaxloaderSidebarToc.style.display = 'block'; ajaxloader.style.display = 'none'; break; case &quot;complete&quot;: ajaxloaderSidebarToc.style.display = 'none'; ajaxloader.style.display = 'none'; break; case &quot;success&quot;: // enable BS tooltips $( '[data-toggle=&quot;tooltip&quot;]' ).tooltip(); if ( viewer.localStoragePossible ) { viewer.helper.saveSidebarTocPosition(); $( '.widget-toc-elem-wrapp' ).scrollTop( localStorage.sidebarTocScrollPosition ); } // set content height to sidebar height if ( window.matchMedia( '(max-width: 768px)' ).matches ) { viewerJS.helper.equalHeight( _defaults.sidebarSelector, _defaults.contentSelector ); $( window ).off().on( &quot;orientationchange&quot;, function() { viewerJS.helper.equalHeight( _defaults.sidebarSelector, _defaults.contentSelector ); } ); } break; } } else if ( ajaxloader ) { switch ( ajaxstatus ) { case &quot;begin&quot;: ajaxloader.style.display = 'block'; break; case &quot;complete&quot;: ajaxloader.style.display = 'none'; break; case &quot;success&quot;: // enable BS tooltips $( '[data-toggle=&quot;tooltip&quot;]' ).tooltip(); // set content height to sidebar height if ( window.matchMedia( '(max-width: 768px)' ).matches ) { viewerJS.helper.equalHeight( _defaults.sidebarSelector, _defaults.contentSelector ); $( window ).off().on( &quot;orientationchange&quot;, function() { viewerJS.helper.equalHeight( _defaults.sidebarSelector, _defaults.contentSelector ); } ); } break; } } else { switch ( ajaxstatus ) { case &quot;success&quot;: // enable BS tooltips $( '[data-toggle=&quot;tooltip&quot;]' ).tooltip(); // set content height to sidebar height if ( window.matchMedia( '(max-width: 768px)' ).matches ) { viewerJS.helper.equalHeight( _defaults.sidebarSelector, _defaults.contentSelector ); $( window ).off().on( &quot;orientationchange&quot;, function() { viewerJS.helper.equalHeight( _defaults.sidebarSelector, _defaults.contentSelector ); } ); } break; } } } ); } // disable submit button on feedback if ( currentPage === 'feedback' ) { $( '#submitFeedbackBtn' ).attr( 'disabled', true ); } // set sidebar position for NER-Widget if ( $( '#widgetNerFacetting' ).length &gt; 0 ) { nerFacettingConfig.sidebarRight = _defaults.widgetNerSidebarRight; this.nerFacetting.init( nerFacettingConfig ); } // make sure only integer values may be entered in input fields of class // 'input-integer' $( '.input-integer' ).on( &quot;keypress&quot;, function( event ) { if ( event.which &lt; 48 || event.which &gt; 57 ) { return false; } } ); // make sure only integer values may be entered in input fields of class // 'input-integer' $( '.input-float' ).on( &quot;keypress&quot;, function( event ) { console.log( event ); switch ( event.which ) { case 8: // delete case 9: // tab case 13: // enter case 46: // dot case 44: // comma case 43: // plus case 45: // minus return true; case 118: return event.ctrlKey; // copy default: switch ( event.keyCode ) { case 8: // delete case 9: // tab case 13: // enter return true; default: if ( event.which &lt; 48 || event.which &gt; 57 ) { return false; } else { return true; } } } } ); // set tinymce language this.tinyConfig.language = currentLang; if ( currentPage === 'adminCmsCreatePage' ) { this.tinyConfig.setup = function( ed ) { // listen to changes on tinymce input fields ed.on( 'change input paste', function( e ) { tinymce.triggerSave(); createPageConfig.prevBtn.attr( 'disabled', true ); createPageConfig.prevDescription.show(); } ); }; // TODO: FÃ¼r ZLB in der custom.js einbauen // viewerJS.tinyConfig.textcolor_map = [ &quot;FFFFFF&quot;, &quot;ZLB-WeiÃŸ&quot;, &quot;333333&quot;, // &quot;ZLB-Schwarz&quot;, &quot;dedede&quot;, &quot;ZLB-Hellgrau&quot;, &quot;727c87&quot;, &quot;ZLB-Mittelgrau&quot;, // &quot;9a9a9a&quot;, &quot;ZLB-Dunkelgrau&quot;, // &quot;CD0000&quot;, &quot;ZLB-Rot&quot;, &quot;92406d&quot;, &quot;ZLB-Lila&quot;, &quot;6f2c40&quot;, &quot;ZLB-Bordeaux&quot;, // &quot;ffa100&quot;, &quot;ZLB-Orange&quot;, &quot;669933&quot;, &quot;ZLB-GrÃ¼n&quot;, &quot;3e5d1e&quot;, &quot;ZLB-DunkelgrÃ¼n&quot;, // &quot;a9d0f5&quot;, // &quot;ZLB-Hellblau&quot;, &quot;28779f&quot;, &quot;ZLB-Blau&quot; ]; } if ( currentPage === 'overview' ) { // activate menubar viewerJS.tinyConfig.menubar = true; viewerJS.tinyMce.overview(); } // AJAX Loader Eventlistener for tinyMCE if ( typeof jsf !== 'undefined' ) { jsf.ajax.addOnEvent( function( data ) { var ajaxstatus = data.status; switch ( ajaxstatus ) { case &quot;success&quot;: if ( currentPage === 'overview' ) { viewerJS.tinyMce.overview(); } viewerJS.tinyMce.init( viewerJS.tinyConfig ); break; } } ); } // init tinymce if it exists if ( $( '.tinyMCE' ).length &gt; 0 ) { viewerJS.tinyMce.init( this.tinyConfig ); } // handle browser bugs switch ( _defaults.browser ) { case 'Chrome': /* BROKEN IMAGES */ $( 'img' ).error( function() { $( this ).addClass( 'broken' ); } ); break; case 'Firefox': /* BROKEN IMAGES */ $( &quot;img&quot; ).error( function() { $( this ).hide(); } ); /* 1px BUG */ if ( $( '.image-doublePageView' ).length &gt; 0 ) { $( '.image-doublePageView' ).addClass( 'oneUp' ); } break; case 'IE': /* SET IE CLASS TO HTML */ $( 'html' ).addClass( 'is-IE' ); /* BROKEN IMAGES */ $( &quot;img&quot; ).error( function() { $( this ).hide(); } ); break; case 'Edge': /* BROKEN IMAGES */ $( &quot;img&quot; ).error( function() { $( this ).hide(); } ); break; case 'Safari': /* BROKEN IMAGES */ $( &quot;img&quot; ).error( function() { $( this ).hide(); } ); break; } }; // global object for tinymce config viewer.tinyConfig = {}; return viewer; } )( jQuery ); var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _confirmCounter = 0; var _defaults = { root: '', msg: { resetBookshelves: '', resetBookshelvesConfirm: '', saveItemToSession: '' } }; viewer.bookshelvesSession = { init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.bookshelvesSession.init' ); console.log( '##############################' ); console.log( 'viewer.bookshelvesSession.init: config - ', config ); } $.extend( true, _defaults, config ); // set confirm counter to local storage if ( localStorage.getItem( 'confirmCounter' ) == undefined ) { localStorage.setItem( 'confirmCounter', 0 ); } // render bookshelf dropdown list _renderDropdownList(); // toggle bookshelf dropdown $( '[data-bookshelf-type=&quot;dropdown&quot;]' ).off().on( 'click', function( event ) { event.stopPropagation(); // hide other dropdowns $( '.login-navigation__login-dropdown, .login-navigation__user-dropdown, .navigation__collection-panel' ).hide(); _getAllSessionElements( _defaults.root ).then( function( elements ) { if ( elements.items.length &gt; 0 ) { $( '.bookshelf-navigation__dropdown' ).slideToggle( 'fast' ); } else { return false; } } ).fail( function( error ) { console.error( 'ERROR - _getAllSessionElements: ', error.responseText ); } ); } ); // set element count of list to counter _setSessionElementCount(); // check add buttons if element is in list _setAddActiveState(); // add element to session $( '[data-bookshelf-type=&quot;add&quot;]' ).off().on( 'click', function() { var currBtn = $( this ); var currPi = currBtn.attr( 'data-pi' ); _isElementSet( _defaults.root, currPi ).then( function( isSet ) { // set confirm counter _confirmCounter = parseInt( localStorage.getItem( 'confirmCounter' ) ); if ( !isSet ) { if ( _confirmCounter == 0 ) { if ( confirm( _defaults.msg.saveItemToSession ) ) { currBtn.addClass( 'added' ); localStorage.setItem( 'confirmCounter', 1 ); _setSessionElement( _defaults.root, currPi ).then( function() { _setSessionElementCount(); _renderDropdownList(); } ); } else { return false; } } else { currBtn.addClass( 'added' ); _setSessionElement( _defaults.root, currPi ).then( function() { _setSessionElementCount(); _renderDropdownList(); } ); } } else { currBtn.removeClass( 'added' ); _deleteSessionElement( _defaults.root, currPi ).then( function() { _setSessionElementCount(); _renderDropdownList(); } ); } } ).fail( function( error ) { console.error( 'ERROR - _isElementSet: ', error.responseText ); } ); } ); // hide menus by clicking on body $( 'body' ).on( 'click', function( event ) { var target = $( event.target ); var dropdown = $( '.bookshelf-navigation__dropdown' ); var dropdownChild = dropdown.find( '*' ); if ( !target.is( dropdown ) &amp;&amp; !target.is( dropdownChild ) ) { $( '.bookshelf-navigation__dropdown' ).hide(); } } ); } }; /* ######## ADD (CREATE) ######## */ /* ######## GET (READ) ######## */ /** * Method to get all elements in watchlist from current session (user not logged in). * * @method _getAllSessionElements * @param {String} root The application root path. * @returns {Object} An JSON-Object which contains all session elements. */ function _getAllSessionElements( root ) { if ( _debug ) { console.log( '---------- _getAllSessionElements() ----------' ); console.log( '_getAllSessionElements: root - ', root ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/session/get/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to check if element is in list (user not logged in). * * @method _isElementSet * @param {String} root The application root path. * @param {String} pi The persistent identifier of the saved element. * @returns {Boolean} True if element is set. */ function _isElementSet( root, pi ) { if ( _debug ) { console.log( '---------- _isElementSet() ----------' ); console.log( '_isElementSet: root - ', root ); console.log( '_isElementSet: pi - ', pi ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/session/contains/' + pi + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise } /* ######## SET (UPDATE) ######## */ /** * Method to add an elements to watchlist in current session (user not logged in). * * @method _setSessionElement * @param {String} root The application root path. * @param {String} pi The persistent identifier of the saved element. */ function _setSessionElement( root, pi ) { if ( _debug ) { console.log( '---------- _setSessionElement() ----------' ); console.log( '_setSessionElement: root - ', root ); console.log( '_setSessionElement: pi - ', pi ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/session/add/' + pi + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise } /* ######## DELETE ######## */ /** * Method to delete an element from watchlist in current session (user not logged in). * * @method _deleteSessionElement * @param {String} root The application root path. * @param {String} pi The persistent identifier of the saved element. */ function _deleteSessionElement( root, pi ) { if ( _debug ) { console.log( '---------- _deleteSessionElement() ----------' ); console.log( '_deleteSessionElement: root - ', root ); console.log( '_deleteSessionElement: pi - ', pi ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/session/delete/' + pi + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise } /** * Method to delete all elements from watchlist in current session (user not logged * in). * * @method _deleteAllSessionElements * @param {String} root The application root path. */ function _deleteAllSessionElements( root ) { if ( _debug ) { console.log( '---------- _deleteAllSessionElements() ----------' ); console.log( '_deleteAllSessionElements: root - ', root ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/session/delete/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise } /* ######## BUILD ######## */ /** * Method to set the count of elements in watchlist from current session (user not * logged in). * * @method _setSessionElementCount * @param {String} root The application root path. */ function _setSessionElementCount() { if ( _debug ) { console.log( '---------- _setSessionElementCount() ----------' ); } _getAllSessionElements( _defaults.root ).then( function( elements ) { $( '[data-bookshelf-type=&quot;counter&quot;]' ).empty().text( elements.items.length ); } ).fail( function( error ) { console.error( 'ERROR - _getAllSessionElements: ', error.responseText ); } ); } /** * Method to render the element list in bookshelf dropdown (user not logged in). * * @method _renderDropdownList */ function _renderDropdownList() { if ( _debug ) { console.log( '---------- _renderDropdownList() ----------' ); } _getAllSessionElements( _defaults.root ).then( function( elements ) { // DOM-Elements var dropdownListReset = $( '&lt;button&gt;' ).addClass( 'btn-clean' ).attr( 'type', 'button' ).attr( 'data-bookshelf-type', 'reset' ).text( _defaults.msg.resetBookshelves ); var dropdownList = $( '&lt;ul /&gt;' ).addClass( 'list' ); var dropdownListItem = null; var dropdownListItemRow = null; var dropdownListItemColLeft = null; var dropdownListItemColCenter = null; var dropdownListItemColRight = null; var dropdownListItemImage = null; var dropdownListItemName = null; var dropdownListItemNameLink = null; var dropdownListItemDelete = null; // set confirm counter if ( elements.items.length &lt; 1 ) { localStorage.setItem( 'confirmCounter', 0 ); } elements.items .forEach( function( item ) { dropdownListItem = $( '&lt;li /&gt;' ); dropdownListItemRow = $( '&lt;div /&gt;' ).addClass( 'row no-margin' ); dropdownListItemColLeft = $( '&lt;div /&gt;' ).addClass( 'col-xs-4 no-padding' ); dropdownListItemColCenter = $( '&lt;div /&gt;' ).addClass( 'col-xs-7 no-padding' ); dropdownListItemColRight = $( '&lt;div /&gt;' ).addClass( 'col-xs-1 no-padding bookshelf-navigation__dropdown-list-remove' ); dropdownListItemImage = $( '&lt;div /&gt;' ).addClass( 'bookshelf-navigation__dropdown-list-image' ).css( 'background-image', 'url(' + item.representativeImageUrl + ')' ); dropdownListItemName = $( '&lt;h4 /&gt;' ); dropdownListItemNameLink = $( '&lt;a /&gt;' ).attr( 'href', _defaults.root + item.url ).text( item.name ); dropdownListItemDelete = $( '&lt;button /&gt;' ).addClass( 'btn-clean' ).attr( 'type', 'button' ).attr( 'data-bookshelf-type', 'delete' ) .attr( 'data-pi', item.pi ); // build bookshelf item dropdownListItemName.append( dropdownListItemNameLink ); dropdownListItemColLeft.append( dropdownListItemImage ); dropdownListItemColCenter.append( dropdownListItemName ); dropdownListItemColRight.append( dropdownListItemDelete ); dropdownListItemRow.append( dropdownListItemColLeft ).append( dropdownListItemColCenter ).append( dropdownListItemColRight ); dropdownListItem.append( dropdownListItemRow ); dropdownList.append( dropdownListItem ); } ); // render complete list $( '.bookshelf-navigation__dropdown-list' ).empty().append( dropdownList ); // render reset if items exist if ( elements.items.length &gt; 0 ) { $( '.bookshelf-navigation__dropdown-list-reset' ).empty().append( dropdownListReset ); } else { $( '.bookshelf-navigation__dropdown' ).hide(); $( '.bookshelf-navigation__dropdown-list-reset' ).empty(); } // delete single item $( '[data-bookshelf-type=&quot;delete&quot;]' ).on( 'click', function() { var currBtn = $( this ); var currPi = currBtn.attr( 'data-pi' ); _deleteSessionElement( _defaults.root, currPi ).then( function() { _setSessionElementCount(); _setAddActiveState(); _renderDropdownList(); } ); } ); // delete all items $( '[data-bookshelf-type=&quot;reset&quot;]' ).on( 'click', function() { if ( confirm( _defaults.msg.resetBookshelvesConfirm ) ) { _deleteAllSessionElements( _defaults.root ).then( function() { localStorage.setItem( 'confirmCounter', 0 ); _setSessionElementCount(); _setAddActiveState(); _renderDropdownList(); } ); } else { return false; } } ); } ).fail( function( error ) { console.error( 'ERROR - _getAllSessionElements: ', error.responseText ); } ); } /** * Method to set the active state of add buttons (user not logged in). * * @method _setAddActiveState */ function _setAddActiveState() { if ( _debug ) { console.log( '---------- _setAddActiveState() ----------' ); } $( '[data-bookshelf-type=&quot;add&quot;]' ).each( function() { var currBtn = $( this ); var currPi = currBtn.attr( 'data-pi' ); _isElementSet( _defaults.root, currPi ).then( function( isSet ) { if ( isSet ) { currBtn.addClass( 'added' ); } else { currBtn.removeClass( 'added' ); } } ).fail( function( error ) { console.error( 'ERROR - _isElementSet: ', error.responseText ); } ); } ); } return viewer; } )( viewerJS || {}, jQuery ); // /rest/bookshelves/session/add/{pi}/{logid}/{page} // FÃ¼gt der Merkliste ein Item mit der angegebenen pi, logId und Seitennummer an. Der Name // des Items wird automatisch aus dem zur pi gehÃ¶renden SOLR-Dokument erstellt // /rest/bookshelves/session/delete/{pi}/{logid}/{page} // LÃ¶scht das Item mit der angegebenen pi, logid und Seitennummer aus der Merkliste, wenn // es enthalten ist // /rest/bookshelves/session/contains/{pi}/{logid}/{page} // gibt &quot;true&quot; zurÃ¼ck, wenn die Merkliste ein Item mit der angegebenen pi, logid und // Seitennummer enthÃ¤lt; sonst &quot;false&quot; // /rest/bookshelves/session/count // Gibt die Zahl der in der Merkliste enthaltenen Items zurÃ¼ck. var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _defaults = { root: '', msg: { resetBookshelves: '', resetBookshelvesConfirm: '', noItemsAvailable: '', selectBookshelf: '', addNewBookshelf: '' } }; viewer.bookshelvesUser = { init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.bookshelvesUser.init' ); console.log( '##############################' ); console.log( 'viewer.bookshelvesUser.init: config - ', config ); } $.extend( true, _defaults, config ); // render bookshelf navigation list _renderBookshelfNavigationList(); // toggle bookshelf dropdown $( '[data-bookshelf-type=&quot;dropdown&quot;]' ).off().on( 'click', function( event ) { event.stopPropagation(); // hide other dropdowns $( '.login-navigation__login-dropdown, .login-navigation__user-dropdown, .navigation__collection-panel' ).hide(); $( '.bookshelf-popup' ).remove(); $( '.bookshelf-navigation__dropdown' ).slideToggle( 'fast' ); } ); // check if element is in any bookshelf _setAddedStatus(); // render bookshelf popup $( '[data-bookshelf-type=&quot;add&quot;]' ).off().on( 'click', function( event ) { event.stopPropagation(); // hide other dropdowns $( '.bookshelf-navigation__dropdown, .login-navigation__user-dropdown' ).hide(); var currBtn = $( this ); var currPi = currBtn.attr( 'data-pi' ); var currLogid = currBtn.attr( 'data-logid' ); var currPage = currBtn.attr( 'data-page' ); var currPos = currBtn.offset(); var currSize = { width: currBtn.outerWidth(), height: currBtn.outerHeight() }; // render bookshelf popup _renderBookshelfPopup( currPi, currLogid, currPage, currPos, currSize ); } ); // hide menus/popups by clicking on body $( 'body' ).on( 'click', function( event ) { $( '.bookshelf-navigation__dropdown' ).hide(); if ( $( '.bookshelf-popup' ).length &gt; 0 ) { var target = $( event.target ); var popup = $( '.bookshelf-popup' ); var popupChild = popup.find( '*' ); if ( !target.is( popup ) &amp;&amp; !target.is( popupChild ) ) { $( '.bookshelf-popup' ).remove(); } } } ); // add new bookshelf in overview $( '#addBookshelfBtn' ).off().on( 'click', function() { var bsName = $( '#addBookshelfInput' ).val(); if ( bsName != '' ) { _addNamedBookshelf( _defaults.root, bsName ).then( function() { location.reload(); } ).fail( function( error ) { console.error( 'ERROR - _addNamedBookshelf: ', error.responseText ); } ); } else { _addAutomaticNamedBookshelf( _defaults.root ).then( function() { location.reload(); } ).fail( function( error ) { console.error( 'ERROR - _addAutomaticNamedBookshelf: ', error.responseText ); } ); } } ); // add new bookshelf on enter in overview $( '#addBookshelfInput' ).on( 'keyup', function( event ) { if ( event.which == 13 ) { $( '#addBookshelfBtn' ).click(); } } ); } }; /* ######## ADD (CREATE) ######## */ /** * Method to add an item to the user bookshelf by PI. * * @method _addBookshelfItemByPi * @param {String} root The application root path. * @param {String} id The current bookshelf id. * @param {String} pi The pi of the item to add. * @returns {Promise} A promise that checks the existing items. */ function _addBookshelfItemByPi( root, id, pi ) { if ( _debug ) { console.log( '---------- _addBookshelfItemByPi() ----------' ); console.log( '_addBookshelfItemByPi: root - ', root ); console.log( '_addBookshelfItemByPi: id - ', id ); console.log( '_addBookshelfItemByPi: pi - ', pi ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/get/' + id + '/add/' + pi + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to add an item with PI, LOGID and PAGE to the user bookshelf. * * @method _addBookshelfItemByPiLogidPage * @param {String} root The application root path. * @param {String} id The current bookshelf id. * @param {String} pi The pi of the item to add. * @param {String} logid The logid of the item to add. * @param {String} page The page of the item to add. * @returns {Promise} A promise that checks the existing items. */ function _addBookshelfItemByPiLogidPage( root, id, pi, logid, page ) { if ( _debug ) { console.log( '---------- _addBookshelfItemByPiLogidPage() ----------' ); console.log( '_addBookshelfItemByPiLogidPage: root - ', root ); console.log( '_addBookshelfItemByPiLogidPage: id - ', id ); console.log( '_addBookshelfItemByPiLogidPage: pi - ', pi ); console.log( '_addBookshelfItemByPiLogidPage: logid - ', logid ); console.log( '_addBookshelfItemByPiLogidPage: page - ', page ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/get/' + id + '/add/' + pi + '/' + logid + '/' + page + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to add a named bookshelf to the user account. * * @method _addNamedBookshelf * @param {String} root The application root path. * @param {String} name The name of the bookshelf. * @returns {Promise} A promise that checks the existing items. */ function _addNamedBookshelf( root, name ) { if ( _debug ) { console.log( '---------- _addNamedBookshelf() ----------' ); console.log( '_addNamedBookshelf: root - ', root ); console.log( '_addNamedBookshelf: name - ', name ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/add/' + name + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to add a automatic named bookshelf to the user account. * * @method _addAutomaticNamedBookshelf * @param {String} root The application root path. * @returns {Promise} A promise that checks the existing items. */ function _addAutomaticNamedBookshelf( root ) { if ( _debug ) { console.log( '---------- _addAutomaticNamedBookshelf() ----------' ); console.log( '_addAutomaticNamedBookshelf: root - ', root ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/add/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to add the session bookshelf to the user account with an automatic generated * name. * * @method _addSessionBookshelf * @param {String} root The application root path. * @returns {Promise} A promise that checks the existing items. */ function _addSessionBookshelf( root ) { if ( _debug ) { console.log( '---------- _addSessionBookshelf() ----------' ); console.log( '_addSessionBookshelf: root - ', root ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/addSessionBookshelf/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to add the session bookshelf to the user account with a given name. * * @method _addSessionBookshelfNamed * @param {String} root The application root path. * @returns {Promise} A promise that checks the existing items. */ function _addSessionBookshelfNamed( root, name ) { if ( _debug ) { console.log( '---------- _addSessionBookshelfNamed() ----------' ); console.log( '_addSessionBookshelfNamed: root - ', root ); console.log( '_addSessionBookshelfNamed: name - ', name ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/addSessionBookshelf/' + name + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /* ######## GET (READ) ######## */ /** * Method to get all user bookshelves. * * @method _getAllBookshelves * @param {String} root The application root path. * @returns {Promise} A promise that checks the existing items. */ function _getAllBookshelves( root ) { if ( _debug ) { console.log( '---------- _getAllBookshelves() ----------' ); console.log( '_getAllBookshelves: root - ', root ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/get/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to get a bookshelf by id. * * @method _getBookshelfById * @param {String} root The application root path. * @param {String} id The current bookshelf id. * @returns {Promise} A promise that checks the existing items. */ function _getBookshelfById( root, id ) { if ( _debug ) { console.log( '---------- _getBookshelfById() ----------' ); console.log( '_getBookshelfById: root - ', root ); console.log( '_getBookshelfById: id - ', id ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/get/' + id + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to get the number of items in the selected bookshelf. * * @method _getBookshelfItemCount * @param {String} root The application root path. * @param {String} id The current bookshelf id. * @returns {Promise} A promise that checks the existing items. */ function _getBookshelfItemCount( root, id ) { if ( _debug ) { console.log( '---------- _getBookshelfItemCount() ----------' ); console.log( '_getBookshelfItemCount: root - ', root ); console.log( '_getBookshelfItemCount: id - ', id ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/get/' + id + '/count/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to get all public bookshelves. * * @method _getPublicBookshelves * @param {String} root The application root path. * @returns {Promise} A promise that checks the existing items. */ function _getPublicBookshelves( root ) { if ( _debug ) { console.log( '---------- _getPublicBookshelves() ----------' ); console.log( '_getPublicBookshelves: root - ', root ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/public/get/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to get all shared bookshelves. * * @method _getSharedBookshelves * @param {String} root The application root path. * @returns {Promise} A promise that checks the existing items. */ function _getSharedBookshelves( root ) { if ( _debug ) { console.log( '---------- _getSharedBookshelves() ----------' ); console.log( '_getSharedBookshelves: root - ', root ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/shared/get/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to check if an item by PI if it's in user bookshelf. It returns the * bookshelves or false if no items are in list. * * @method _getContainingBookshelfItemByPi * @param {String} root The application root path. * @param {String} pi The pi of the current item. * @returns {Promise} A promise that checks the existing items. */ function _getContainingBookshelfItemByPi( root, pi ) { if ( _debug ) { console.log( '---------- _getContainingBookshelfItemByPi() ----------' ); console.log( '_getContainingBookshelfItemByPi: root - ', root ); console.log( '_getContainingBookshelfItemByPi: pi - ', pi ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/contains/' + pi + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to check if an item by PI, LOGID and PAGE if it's in user bookshelf. It * returns the bookshelves or false if no items are in list. * * @method _getContainingBookshelfItemByPiLogidPage * @param {String} root The application root path. * @param {String} pi The pi of the current item. * @returns {Promise} A promise that checks the existing items. */ function _getContainingBookshelfItemByPiLogidPage( root, pi, logid, page ) { if ( _debug ) { console.log( '---------- _getContainingBookshelfItemByPiLogidPage() ----------' ); console.log( '_getContainingBookshelfItemByPiLogidPage: root - ', root ); console.log( '_getContainingBookshelfItemByPiLogidPage: pi - ', pi ); console.log( '_getContainingBookshelfItemByPiLogidPage: logid - ', logid ); console.log( '_getContainingBookshelfItemByPiLogidPage: page - ', page ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/contains/' + pi + '/' + logid + '/' + page + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /* ######## SET (UPDATE) ######## */ /** * Method to set the name of a bookshelf. * * @method _setBookshelfName * @param {String} root The application root path. * @param {String} id The current bookshelf id. * @param {String} name The name of the bookshelf. * @returns {Promise} A promise that checks the existing items. */ function _setBookshelfName( root, id, name ) { if ( _debug ) { console.log( '---------- _setBookshelfName() ----------' ); console.log( '_setBookshelfName: root - ', root ); console.log( '_setBookshelfName: id - ', id ); console.log( '_setBookshelfName: name - ', name ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/get/' + id + '/set/name/' + name + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /* ######## DELETE ######## */ /** * Method to delete an item from the user bookshelf by PI. * * @method _deleteBookshelfItemByPi * @param {String} root The application root path. * @param {String} id The current bookshelf id. * @param {String} pi The pi of the item to add. * @returns {Promise} A promise that checks the existing items. */ function _deleteBookshelfItemByPi( root, id, pi ) { if ( _debug ) { console.log( '---------- _deleteBookshelfItemByPi() ----------' ); console.log( '_deleteBookshelfItemByPi: root - ', root ); console.log( '_deleteBookshelfItemByPi: id - ', id ); console.log( '_deleteBookshelfItemByPi: pi - ', pi ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/get/' + id + '/delete/' + pi + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to delete an item with PI, LOGID and PAGE from the user bookshelf. * * @method _deleteBookshelfItemByPiLogidPage * @param {String} root The application root path. * @param {String} id The current bookshelf id. * @param {String} pi The pi of the item to add. * @param {String} logid The logid of the item to add. * @param {String} page The page of the item to add. * @returns {Promise} A promise that checks the existing items. */ function _deleteBookshelfItemByPiLogidPage( root, id, pi, logid, page ) { if ( _debug ) { console.log( '---------- _deleteBookshelfItemByPiLogidPage() ----------' ); console.log( '_deleteBookshelfItemByPiLogidPage: root - ', root ); console.log( '_deleteBookshelfItemByPiLogidPage: id - ', id ); console.log( '_deleteBookshelfItemByPiLogidPage: pi - ', pi ); console.log( '_deleteBookshelfItemByPiLogidPage: logid - ', logid ); console.log( '_deleteBookshelfItemByPiLogidPage: page - ', page ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/get/' + id + '/delete/' + pi + '/' + logid + '/' + page + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to delete a bookshelf by ID. * * @method _deleteBookshelfById * @param {String} root The application root path. * @param {String} id The current bookshelf id. * @returns {Promise} A promise that checks the existing items. */ function _deleteBookshelfById( root, id ) { if ( _debug ) { console.log( '---------- _deleteBookshelfById() ----------' ); console.log( '_deleteBookshelfById: root - ', root ); console.log( '_deleteBookshelfById: id - ', id ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/delete/' + id + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /* ######## BUILD ######## */ /** * Method to render a popup which contains bookshelf actions. * * @method _renderBookshelfPopup * @param {String} pi The pi of the item to add. * @param {String} logid The logid of the item to add. * @param {String} page The page of the item to add. * @param {Object} pos The position of the clicked button. * @param {Object} size The width and height of the clicked button. */ function _renderBookshelfPopup( pi, logid, page, pos, size ) { if ( _debug ) { console.log( '---------- _renderBookshelfPopup() ----------' ); console.log( '_renderBookshelfPopup: pi - ', pi ); console.log( '_renderBookshelfPopup: logid - ', logid ); console.log( '_renderBookshelfPopup: page - ', page ); console.log( '_renderBookshelfPopup: pos - ', pos ); console.log( '_renderBookshelfPopup: size - ', size ); } var pi = pi; var posTop = pos.top; var posLeft = pos.left; // remove all popups $( '.bookshelf-popup' ).remove(); // DOM-Elements var bookshelfPopup = $( '&lt;div /&gt;' ).addClass( 'bookshelf-popup bottom' ).css( { 'top': ( posTop + size.height ) + 10 + 'px', 'left': ( posLeft - 142 ) + ( size.width / 2 ) + 'px' } ); var bookshelfPopupLoader = $( '&lt;div /&gt;' ).addClass( 'bookshelf-popup__body-loader' ); bookshelfPopup.append( bookshelfPopupLoader ); // build popup header var bookshelfPopupHeader = $( '&lt;div /&gt;' ).addClass( 'bookshelf-popup__header' ).text( _defaults.msg.selectBookshelf ); // build popup body var bookshelfPopupBody = $( '&lt;div /&gt;' ).addClass( 'bookshelf-popup__body' ); // build popup footer var bookshelfPopupFooter = $( '&lt;div /&gt;' ).addClass( 'bookshelf-popup__footer' ); var bookshelfPopupFooterRow = $( '&lt;div /&gt;' ).addClass( 'row no-margin' ); var bookshelfPopupFooterColLeft = $( '&lt;div /&gt;' ).addClass( 'col-xs-11 no-padding' ); var bookshelfPopupFooterInput = $( '&lt;input /&gt;' ).attr( 'type', 'text' ).attr( 'placeholder', _defaults.msg.addNewBookshelf ); bookshelfPopupFooterColLeft.append( bookshelfPopupFooterInput ); var bookshelfPopupFooterColright = $( '&lt;div /&gt;' ).addClass( 'col-xs-1 no-padding' ); var bookshelfPopupFooterAddBtn = $( '&lt;button /&gt;' ).addClass( 'btn-clean' ).attr( 'type', 'button' ).attr( 'data-bookshelf-type', 'add' ).attr( 'data-pi', pi ); bookshelfPopupFooterColright.append( bookshelfPopupFooterAddBtn ); bookshelfPopupFooterRow.append( bookshelfPopupFooterColLeft ).append( bookshelfPopupFooterColright ); bookshelfPopupFooter.append( bookshelfPopupFooterRow ); // build popup bookshelfPopup.append( bookshelfPopupHeader ).append( bookshelfPopupBody ).append( bookshelfPopupFooter ); // append popup $( 'body' ).append( bookshelfPopup ); // render bookshelf list _renderBookshelfPopoverList( pi ); // add new bookshelf in popover $( '.bookshelf-popup__footer [data-bookshelf-type=&quot;add&quot;]' ).on( 'click', function() { var bsName = $( '.bookshelf-popup__footer input' ).val(); var currPi = $( this ).attr( 'data-pi' ); if ( bsName != '' ) { _addNamedBookshelf( _defaults.root, bsName ).then( function() { $( '.bookshelf-popup__footer input' ).val( '' ); _renderBookshelfPopoverList( currPi ); _renderBookshelfNavigationList(); } ).fail( function( error ) { console.error( 'ERROR - _addNamedBookshelf: ', error.responseText ); } ); } else { _addAutomaticNamedBookshelf( _defaults.root ).then( function() { $( '.bookshelf-popup__footer input' ).val( '' ); _renderBookshelfPopoverList( currPi ); _renderBookshelfNavigationList(); } ).fail( function( error ) { console.error( 'ERROR - _addAutomaticNamedBookshelf: ', error.responseText ); } ); } } ); // add new bookshelf on enter in popover $( '.bookshelf-popup__footer input' ).on( 'keyup', function( event ) { if ( event.which == 13 ) { $( '.bookshelf-popup__footer [data-bookshelf-type=&quot;add&quot;]' ).click(); } } ); } /** * Method to render the element list in bookshelf popover. * * @method _renderBookshelfPopoverList * @param {String} pi The current PI of the selected item. */ function _renderBookshelfPopoverList( pi ) { if ( _debug ) { console.log( '---------- _renderBookshelfPopoverList() ----------' ); console.log( '_renderBookshelfPopoverList: pi - ', pi ); } _getAllBookshelves( _defaults.root ).then( function( elements ) { // DOM-Elements var dropdownList = $( '&lt;ul /&gt;' ).addClass( 'bookshelf-popup__body-list list' ); var dropdownListItem = null; var dropdownListItemText = null; var dropdownListItemAdd = null; var dropdownListItemIsInBookshelf = null; var dropdownListItemAddCounter = null; if ( elements.length &gt; 0 ) { elements.forEach( function( item ) { dropdownListItem = $( '&lt;li /&gt;' ); dropdownListItemIsInBookshelf = ''; // check if item is in bookshelf item.items.forEach( function( object ) { if ( object.pi == pi ) { dropdownListItemIsInBookshelf = '&lt;i class=&quot;fa fa-check&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt; '; } } ); dropdownListItemAddCounter = $( '&lt;span /&gt;' ).text( item.items.length ); dropdownListItemAdd = $( '&lt;button /&gt;' ).addClass( 'btn-clean' ).attr( 'type', 'button' ).attr( 'data-bookshelf-type', 'add' ).attr( 'data-id', item.id ) .attr( 'data-pi', pi ).text( item.name ).prepend( dropdownListItemIsInBookshelf ).append( dropdownListItemAddCounter ); // build bookshelf item dropdownListItem.append( dropdownListItemAdd ); dropdownList.append( dropdownListItem ); } ); } else { // add empty list item dropdownListItem = $( '&lt;li /&gt;' ); dropdownListItemText = $( '&lt;span /&gt;' ).addClass( 'empty' ).text( _defaults.msg.noItemsAvailable ); dropdownListItem.append( dropdownListItemText ); dropdownList.append( dropdownListItem ); } // render complete list $( '.bookshelf-popup__body' ).empty().append( dropdownList ); // remove loader $( '.bookshelf-popup__body-loader' ).remove(); // add item to bookshelf $( '.bookshelf-popup__body-list [data-bookshelf-type=&quot;add&quot;]' ).on( 'click', function() { var currBtn = $( this ); var currId = currBtn.attr( 'data-id' ); var currPi = currBtn.attr( 'data-pi' ); var isChecked = currBtn.find( '.fa-check' ); if ( isChecked.length &gt; 0 ) { _deleteBookshelfItemByPi( _defaults.root, currId, currPi ).then( function() { _renderBookshelfPopoverList( currPi ); _renderBookshelfNavigationList(); _setAddedStatus(); } ).fail( function( error ) { console.error( 'ERROR - _deleteBookshelfItemByPi: ', error.responseText ); } ); } else { _addBookshelfItemByPi( _defaults.root, currId, currPi ).then( function() { _renderBookshelfPopoverList( currPi ); _renderBookshelfNavigationList(); _setAddedStatus(); } ).fail( function( error ) { console.error( 'ERROR - _addBookshelfItemByPi: ', error.responseText ); } ); } } ); } ).fail( function( error ) { console.error( 'ERROR - _getAllBookshelves: ', error.responseText ); } ); } /** * Method to render the element list in bookshelf navigation. * * @method _renderBookshelfNavigationList */ function _renderBookshelfNavigationList() { if ( _debug ) { console.log( '---------- _renderBookshelfNavigationList() ----------' ); } var allBookshelfItems = 0; _getAllBookshelves( _defaults.root ).then( function( elements ) { // DOM-Elements var dropdownList = $( '&lt;ul /&gt;' ).addClass( 'bookshelf-navigation__dropdown-list list' ); var dropdownListItem = null; var dropdownListItemRow = null; var dropdownListItemLeft = null; var dropdownListItemRight = null; var dropdownListItemText = null; var dropdownListItemLink = null; var dropdownListItemAddCounter = null; if ( elements.length &gt; 0 ) { elements.forEach( function( item ) { dropdownListItem = $( '&lt;li /&gt;' ); dropdownListItemRow = $( '&lt;div /&gt;' ).addClass( 'row no-margin' ); dropdownListItemLeft = $( '&lt;div /&gt;' ).addClass( 'col-xs-10 no-padding' ); dropdownListItemRight = $( '&lt;div /&gt;' ).addClass( 'col-xs-2 no-padding' ); dropdownListItemLink = $( '&lt;a /&gt;' ).attr( 'href', _defaults.root + '/bookshelf/' + item.id + '/' ).text( item.name ); dropdownListItemAddCounter = $( '&lt;span /&gt;' ).addClass( 'bookshelf-navigation__dropdown-list-counter' ).text( item.items.length ); // build bookshelf item dropdownListItemLeft.append( dropdownListItemLink ); dropdownListItemRight.append( dropdownListItemAddCounter ); dropdownListItemRow.append( dropdownListItemLeft ).append( dropdownListItemRight ) dropdownListItem.append( dropdownListItemRow ); dropdownList.append( dropdownListItem ); // raise bookshelf item counter allBookshelfItems += item.items.length; } ); // set bookshelf item counter $( '[data-bookshelf-type=&quot;counter&quot;]' ).empty().text( allBookshelfItems ); } else { // add empty list item dropdownListItem = $( '&lt;li /&gt;' ); dropdownListItemText = $( '&lt;span /&gt;' ).addClass( 'empty' ).text( _defaults.msg.noItemsAvailable ); dropdownListItem.append( dropdownListItemText ); dropdownList.append( dropdownListItem ); // set bookshelf item counter $( '[data-bookshelf-type=&quot;counter&quot;]' ).empty().text( allBookshelfItems ); } // render complete list $( '.bookshelf-navigation__dropdown-list' ).empty().append( dropdownList ); } ).fail( function( error ) { console.error( 'ERROR - _getAllBookshelves: ', error.responseText ); } ); } /** * Method to set an 'added' status to an object. * * @method _setAddedStatus */ function _setAddedStatus() { if ( _debug ) { console.log( '---------- _setAddedStatus() ----------' ); } $( '[data-bookshelf-type=&quot;add&quot;]' ).each( function() { var currTrigger = $( this ); var currTriggerPi = currTrigger.attr( 'data-pi' ); _isItemInBookshelf( currTrigger, currTriggerPi ); } ); } /** * Method to check if item is in any bookshelf. * * @method _isItemInBookshelf * @param {Object} object An jQuery-Object of the current item. * @param {String} pi The current PI of the selected item. */ function _isItemInBookshelf( object, pi ) { if ( _debug ) { console.log( '---------- _isItemInBookshelf() ----------' ); console.log( '_isItemInBookshelf: pi - ', pi ); console.log( '_isItemInBookshelf: object - ', object ); } _getContainingBookshelfItemByPi( _defaults.root, pi ).then( function( items ) { if ( items.length == 0 ) { object.removeClass( 'added' ); return false; } else { object.addClass( 'added' ); } } ).fail( function( error ) { console.error( 'ERROR - _getContainingBookshelfItemByPi: ', error.responseText ); } ); } return viewer; } )( viewerJS || {}, jQuery ); var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _this = null; var _currApiCall = ''; var _json = {}; var _popoverConfig = {}; var _popoverContent = null; var _defaults = { appUrl: '', calendarWrapperSelector: '.search-calendar__months', popoverTriggerSelector: '[data-popover-trigger=&quot;calendar-po-trigger&quot;]', popoverTitle: 'Bitte Ã¼bergeben Sie den Titel des Werks', }; viewer.calendarPopover = { init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.calendarPopover.init' ); console.log( '##############################' ); console.log( 'viewer.calendarPopover.init: config - ', config ); } $.extend( true, _defaults, config ); // TODO: Fehlermeldung in der Konsole beseitigen, wenn man auf den Tag ein // zweites Mal klickt. // show popover for current day $( _defaults.popoverTriggerSelector ).on( 'click', function() { _this = $( this ); _currApiCall = encodeURI( _this.attr( 'data-api' ) ); viewerJS.helper.getRemoteData( _currApiCall ).done( function( _json ) { _popoverContent = _getPopoverContent( _json, _defaults ); _popoverConfig = { placement: 'auto bottom', title: _defaults.popoverTitle, content: _popoverContent, viewport: { selector: _defaults.calendarWrapperSelector }, html: true }; $( _defaults.popoverTriggerSelector ).popover( 'destroy' ); _this.popover( _popoverConfig ); _this.popover( 'show' ); } ); } ); // remove all popovers by clicking on body $( 'body' ).on( 'click', function( event ) { if ( $( event.target ).closest( _defaults.popoverTriggerSelector ).length ) { return; } else { $( _defaults.popoverTriggerSelector ).popover( 'destroy' ); } } ); } }; /** * Method to render the popover content. * * @method _getPopoverContent * @param {Object} data A JSON-Object which contains the necessary data. * @param {Object} config The config object of the module. * @returns {String} The HTML-String of the popover content. */ function _getPopoverContent( data, config ) { if ( _debug ) { console.log( '---------- _getPopoverContent() ----------' ); console.log( '_getPopoverContent: data = ', data ); console.log( '_getPopoverContent: config = ', config ); } var workList = ''; var workListLink = ''; workList += '&lt;ul class=&quot;list&quot;&gt;'; $.each( data, function( works, values ) { workListLink = config.appUrl + 'image/' + values.PI_TOPSTRUCT + '/' + values.THUMBPAGENO + '/' + values.LOGID + '/'; workList += '&lt;li&gt;'; workList += '&lt;a href=&quot;' + workListLink + '&quot;&gt;'; workList += values.LABEL; workList += '&lt;/a&gt;'; workList += '&lt;/li&gt;'; } ); workList += '&lt;/ul&gt;'; return workList; } return viewer; } )( viewerJS || {}, jQuery ); var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _parsedFontSize = 0; var _currFontSize = ''; var _defaults = { fontDownBtn: '', fontUpBtn: '', maxFontSize: 18, minFontSize: 12, baseFontSize: '14px' }; viewer.changeFontSize = { /** * Method which initializes the font size switcher. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {String} config.fontDownBtn The ID/Class of the font degrade button. * @param {String} config.fontUpBtn The ID/Class of the font upgrade button. * @param {String} config.maxFontSize The maximum font size the document should * scale up. * @param {String} config.minFontSize The minimum font size the document should * scale down. * @param {String} config.baseFontSize The base font size of the HTML-Element. * @example * * &lt;pre&gt; * var changeFontSizeConfig = { * fontDownBtn: '#fontSizeDown', * fontUpBtn: '#fontSizeUp', * maxFontSize: 18, * minFontSize: 14 * }; * * viewerJS.changeFontSize.init( changeFontSizeConfig ); * &lt;/pre&gt; */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.changeFontSize.init' ); console.log( '##############################' ); console.log( 'viewer.changeFontSize.init: config - ' ); console.log( config ); } $.extend( true, _defaults, config ); if ( viewer.localStoragePossible ) { // set current font-size _setFontSize(); // set button state _setButtonState(); $( _defaults.fontDownBtn ).on( 'click', function() { // set current font-size _currFontSize = $( 'html' ).css( 'font-size' ); // save font-size _saveFontSize( _currFontSize ); // parse number of font-size _parsedFontSize = _parseFontSize( _currFontSize ); // degrade font-size _degradeFontSize( _parsedFontSize ); } ); $( _defaults.fontUpBtn ).on( 'click', function() { // set current font-size _currFontSize = $( 'html' ).css( 'font-size' ); // save font-size _saveFontSize( _currFontSize ); // parse number of font-size _parsedFontSize = _parseFontSize( _currFontSize ); // raise font-size _raiseFontSize( _parsedFontSize ); } ); } } }; /** * Method to degrade the page font-size. * * @method _degradeFontSize * @param {Number} current The current font-size of the HTML-Element. */ function _degradeFontSize( current ) { if ( _debug ) { console.log( '---------- _degradeFontSize() ----------' ); console.log( '_degradeFontSize: current = ', current ); } var size = current; size--; if ( size &gt;= _defaults.minFontSize ) { $( _defaults.fontDownBtn ).prop( 'disabled', false ); $( _defaults.fontUpBtn ).prop( 'disabled', false ); $( 'html' ).css( 'font-size', size + 'px' ); // save font-size _saveFontSize( size + 'px' ); } else { $( _defaults.fontDownBtn ).prop( 'disabled', true ); $( _defaults.fontUpBtn ).prop( 'disabled', false ); } } /** * Method to raise the page font-size. * * @method _raiseFontSize * @param {Number} current The current font-size of the HTML-Element. */ function _raiseFontSize( current ) { if ( _debug ) { console.log( '---------- _raiseFontSize() ----------' ); console.log( '_raiseFontSize: current = ', current ); } var size = current; size++; if ( size &lt;= _defaults.maxFontSize ) { $( _defaults.fontDownBtn ).prop( 'disabled', false ); $( _defaults.fontUpBtn ).prop( 'disabled', false ); $( 'html' ).css( 'font-size', size + 'px' ); // save font-size _saveFontSize( size + 'px' ); } else { $( _defaults.fontDownBtn ).prop( 'disabled', false ); $( _defaults.fontUpBtn ).prop( 'disabled', true ); } } /** * Method which parses a given pixel value to a number and returns it. * * @method _parseFontSize * @param {String} string The string to parse. */ function _parseFontSize( string ) { if ( _debug ) { console.log( '---------- _parseFontSize() ----------' ); console.log( '_parseFontSize: string = ', string ); } return parseInt( string.replace( 'px' ) ); } /** * Method to save the current font-size to local storage as a string. * * @method _saveFontSize * @param {String} size The String to save in local storage. */ function _saveFontSize( size ) { if ( _debug ) { console.log( '---------- _saveFontSize() ----------' ); console.log( '_parseFontSize: size = ', size ); } localStorage.setItem( 'currentFontSize', size ); } /** * Method to set the current font-size from local storage to the HTML-Element. * * @method _setFontSize */ function _setFontSize() { if ( _debug ) { console.log( '---------- _setFontSize() ----------' ); } var fontSize = localStorage.getItem( 'currentFontSize' ); if ( fontSize === null || fontSize === '' ) { localStorage.setItem( 'currentFontSize', _defaults.baseFontSize ); } else { $( 'html' ).css( 'font-size', fontSize ); } } /** * Method to set the state of the font-size change buttons. * * @method _setButtonState */ function _setButtonState() { if ( _debug ) { console.log( '---------- _setButtonState() ----------' ); } var fontSize = localStorage.getItem( 'currentFontSize' ); var newFontSize = _parseFontSize( fontSize ); if ( newFontSize === _defaults.minFontSize ) { $( _defaults.fontDownBtn ).prop( 'disabled', true ); } if ( newFontSize === _defaults.maxFontSize ) { $( _defaults.fontUpBtn ).prop( 'disabled', true ); } } return viewer; } )( viewerJS || {}, jQuery ); var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _dataTablePaginator = null; var _txtField1 = null; var _txtField2 = null; var _totalCount = null; var _reloadBtn = null; var _defaults = { dataTablePaginator: '', txtField1: '', txtField2: '', totalCount: '', reloadBtn: '', }; viewer.dataTable = { init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.dataTable.init' ); console.log( '##############################' ); console.log( 'viewer.dataTable.init: config = ', config ); } $.extend( true, _defaults, config ); viewer.dataTable.paginator.init(); if ( $( '.column-filter-wrapper' ).length &gt; 0 ) { viewer.dataTable.filter.init(); } }, /** * Pagination */ paginator: { setupAjax: false, init: function() { if ( _debug ) { console.log( '---------- dataTable.paginator.init() ----------' ); } _dataTablePaginator = $( _defaults.dataTablePaginator ); _txtField1 = $( _defaults.txtField1 ); _txtField2 = $( _defaults.txtField2 ); _totalCount = $( _defaults.totalCount ); _reloadBtn = $( _defaults.reloadBtn ); _txtField1.on( 'click', function() { $( this ).hide(); viewer.dataTable.paginator.inputFieldHandler(); } ); _totalCount.on( 'click', function() { _txtField1.hide(); viewer.dataTable.paginator.inputFieldHandler(); } ); /* * AJAX Eventlistener */ if ( !this.setupAjax ) { jsf.ajax.addOnEvent( function( data ) { var ajaxstatus = data.status; if ( _defaults.dataTablePaginator.length &gt; 0 ) { switch ( ajaxstatus ) { case &quot;begin&quot;: if ( _txtField1 !== null &amp;&amp; _txtField2 !== null ) { _txtField1.off(); _txtField2.off(); } break; case &quot;complete&quot;: break; case &quot;success&quot;: viewer.dataTable.paginator.init(); break; } } } ); this.setupAjax = true; } }, inputFieldHandler: function() { if ( _debug ) { console.log( '---------- dataTable.paginator.inputFieldHandler() ----------' ); } _txtField2.show().find( 'input' ).focus().select(); _txtField2.find( 'input' ).on( 'blur', function() { $( this ).hide(); _txtField1.show(); _reloadBtn.click(); } ); _txtField2.find( 'input' ).on( 'keypress', function( event ) { if ( event.keyCode == 13 ) { _reloadBtn.click(); } else { return; } } ); }, }, /** * Filter */ filter: { setupAjax: false, init: function() { if ( _debug ) { console.log( '---------- dataTable.filter.init() ----------' ); } $( '#adminAllUserForm' ).on( 'submit', function( event ) { event.preventDefault(); $( '.column-filter-wrapper' ).find( '.btn-filter' ).click(); } ); /* * AJAX Eventlistener */ if ( !this.setupAjax ) { jsf.ajax.addOnEvent( function( data ) { var ajaxstatus = data.status; if ( _defaults.dataTablePaginator.length &gt; 0 ) { switch ( ajaxstatus ) { case &quot;begin&quot;: break; case &quot;complete&quot;: break; case &quot;success&quot;: viewer.dataTable.filter.init(); break; } } } ); this.setupAjax = true; } }, }, }; return viewer; } )( viewerJS || {}, jQuery ); var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _promise = null; var _defaults = { path: null, dataSortOrder: null, dataCount: null, dataEncoding: null, feedBox: null, monthNames: [ '', 'Januar', 'Februar', 'MÃ¤rz', 'April', 'Mai', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember' ] }; viewer.dateSortedFeed = { /** * Method which initializes the date sorted RSS-Feed. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {String} config.path The rootpath of the application. * @param {Object} config.feedBox An jQuery object of the wrapper DIV. * @example * * &lt;pre&gt; * var dateSortedFeedConfig = { * path: '#{request.contextPath}', * feedBox: $( '#dateSortedFeed' ) * }; * * viewerJS.dateSortedFeed.setDataSortOrder( '#{cc.attrs.sorting}' ); * viewerJS.dateSortedFeed.setDataCount( '#{cc.attrs.count}' ); * viewerJS.dateSortedFeed.setDataEncoding( '#{cc.attrs.encoding}' ); * viewerJS.dateSortedFeed.init( dateSortedFeedConfig ); * &lt;/pre&gt; */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.dateSortedFeed.init' ); console.log( '##############################' ); console.log( 'viewer.dateSortedFeed.init: feedBoxObj - ' + feedBoxObj ); console.log( 'viewer.dateSortedFeed.init: path - ' + path ); } $.extend( true, _defaults, config ); var dataURL = _defaults.path; dataURL += '/api?action=query&amp;q=PI:*&amp;jsonFormat=datecentric&amp;sortField=DATECREATED'; dataURL += '&amp;sortOrder='; dataURL += _defaults.dataSortOrder; dataURL += '&amp;count='; dataURL += _defaults.dataCount; dataURL += '&amp;encoding='; dataURL += _defaults.dataEncoding; if ( _debug ) { console.log( 'viewer.dateSortedFeed.init: dataURL - ' + dataURL ); } // checking for feedbox element and render feed if ( _defaults.feedBox ) { _promise = viewer.helper.getRemoteData( dataURL ); _promise.then( function( data ) { _renderFeed( data ); } ).then( null, function() { console.error( 'ERROR: viewer.dateSortedFeed.init - ', error ); } ); } else { return; } }, /** * Returns the sorting order of the feed. * * @method getDataSortOrder * @returns {String} The sorting order. * */ getDataSortOrder: function() { return _defaults.dataSortOrder; }, /** * Sets the sorting order of the feed. * * @method getDataSortOrder * @param {String} str The sorting order (asc/desc) * */ setDataSortOrder: function( str ) { _defaults.dataSortOrder = str; }, /** * Returns the number of entries from the feed. * * @method getDataSortOrder * @returns {String} The number of entries. * */ getDataCount: function() { return _defaults.dataCount; }, /** * Sets the number of entries from the feed. * * @method setDataCount * @param {String} The number of entries. * */ setDataCount: function( num ) { _defaults.dataCount = num; }, /** * Returns the type of encoding. * * @method getDataEncoding * @returns {String} The type of encoding. * */ getDataEncoding: function() { return _defaults.dataEncoding; }, /** * Sets the type of encoding. * * @method setDataEncoding * @param {String} The type of encoding. * */ setDataEncoding: function( str ) { _defaults.dataEncoding = str; } }; /** * Renders the feed and appends it to the wrapper. * * @method _renderFeed * @param {Object} data An JSON object of the feed data. * */ function _renderFeed( data ) { var feed = ''; $.each( data, function( i, j ) { feed += '&lt;h4&gt;' + _dateConverter( j.date ) + '&lt;/h4&gt;'; $.each( j, function( m, n ) { if ( n.title ) { for ( var x = 0; x &lt;= n.title.length; x++ ) { if ( n.title[ x ] !== undefined ) { feed += '&lt;div class=&quot;sorted-feed-title&quot;&gt;&lt;a href=&quot;'; feed += n.url; feed += '&quot; title=&quot;'; feed += n.title[ x ]; feed += '&quot;&gt;'; feed += n.title[ x ]; feed += '&lt;/a&gt;&lt;/div&gt;'; } } } } ); } ); _defaults.feedBox.append( feed ); } /** * Converts a date to this form: 16. November 2015 * * @method _dateConverter * @param {String} str The date to convert. * @returns {String} The new formated date. * */ function _dateConverter( str ) { var strArr = str.split( '-' ); var monthIdx = parseInt( strArr[ 1 ] ); var newDate = strArr[ 2 ] + '. ' + _defaults.monthNames[ monthIdx ] + ' ' + strArr[ 0 ]; return newDate; } return viewer; } )( viewerJS || {}, jQuery ); var viewerJS = ( function( viewer ) { 'use strict'; // default variables var _debug = false; var _checkbox = null; var _downloadBtn = null; viewer.download = { /** * Method to initialize the download view. * * @method init */ init: function() { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.download.init' ); console.log( '##############################' ); } _checkbox = $( '#agreeLicense' ); _downloadBtn = $( '#downloadBtn' ); _downloadBtn.prop( 'disabled', true ); _checkbox.on( 'click', function() { var currState = $( this ).prop( 'checked' ); viewer.download.checkboxValidation( currState ); } ); }, /** * Method which validates the checkstate of a checkbox and enables the download * button. * * @method checkboxValidation * @param {String} state The current checkstate of the checkbox. */ checkboxValidation: function( state ) { if ( _debug ) { console.log( '---------- viewer.download.checkboxValidation() ----------' ); console.log( 'viewer.download.checkboxValidation: state = ', state ); } if ( state ) { _downloadBtn.prop( 'disabled', false ); } else { _downloadBtn.prop( 'disabled', true ); return false; } }, }; return viewer; } )( viewerJS || {}, jQuery ); var viewerJS = ( function( viewer ) { 'use strict'; // default variables var _debug = false; var _defaults = { dataType: null, dataTitle: null, dataId: null, dataPi: null, downloadBtn: null, reCaptchaSiteKey: '', useReCaptcha: true, path: '', iiifPath: '', apiUrl: '', userEmail: null, workInfo: {}, modal: { id: '', label: '', string: { title: '', body: '', closeBtn: '', saveBtn: '', } }, messages: { downloadInfo: { text: 'Informationen zum angeforderten Download', title: 'Werk', part: 'Teil', fileSize: 'GrÃ¶ÃŸe' }, reCaptchaText: 'Um die Generierung von Dokumenten durch Suchmaschinen zu verhindern bestÃ¤tigen Sie bitte das reCAPTCHA.', rcInvalid: 'Die ÃœberprÃ¼fung war nicht erfolgreich. Bitte bestÃ¤tigen Sie die reCAPTCHA Anfrage.', rcValid: 'Vielen Dank. Sie kÃ¶nnen nun ihre ausgewÃ¤hlte Datei generieren lassen.', eMailText: 'Um per E-Mail informiert zu werden sobald der Download zur VerfÃ¼gung steht, kÃ¶nnen Sie hier optional Ihre E-Mail Adresse hinterlassen', eMailTextLoggedIn: 'Sie werden Ã¼ber Ihre registrierte E-Mail Adresse von uns Ã¼ber den Fortschritt des Downloads informiert.', eMail: '' } }; var _loadingOverlay = null; viewer.downloadModal = { /** * Method to initialize the download modal mechanic. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {String} config.dataType The data type of the current file to download. * @param {String} config.dataTitle The title of the current file to download. * @param {String} config.dataId The LOG_ID of the current file to download. * @param {String} config.dataPi The PI of the current file to download. * @param {Object} config.downloadBtn A collection of all buttons with the class * attribute 'download-modal'. * @param {String} config.reCaptchaSiteKey The site key for the google reCAPTCHA, * fetched from the viewer config. * @param {String} config.path The current application path. * @param {String} config.apiUrl The URL to trigger the ITM download task. * @param {String} config.userEmail The current user email if the user is logged * in. Otherwise the one which the user enters or leaves blank. * @param {Object} config.modal A configuration object for the download modal. * @param {String} config.modal.id The ID of the modal. * @param {String} config.modal.label The label of the modal. * @param {Object} config.modal.string An object of strings for the modal content. * @param {String} config.modal.string.title The title of the modal. * @param {String} config.modal.string.body The content of the modal as HTML. * @param {String} config.modal.string.closeBtn Buttontext * @param {String} config.modal.string.saveBtn Buttontext * @param {Object} config.messages An object of strings for the used text * snippets. * @example * * &lt;pre&gt; * var downloadModalConfig = { * downloadBtn: $( '.download-modal' ), * path: '#{navigationHelper.applicationUrl}', * userEmail: $( '#userEmail' ).val(), * messages: { * reCaptchaText: '#{msg.downloadReCaptchaText}', * rcInvalid: '#{msg.downloadRcInvalid}', * rcValid: '#{msg.downloadRcValid}', * eMailText: '#{msg.downloadEMailText}', * eMailTextLoggedIn: '#{msg.downloadEMailTextLoggedIn}', * eMail: '#{msg.downloadEmail}', * closeBtn: '#{msg.downloadCloseModal}', * saveBtn: '#{msg.downloadGenerateFile}', * } * }; * * viewerJS.downloadModal.init( downloadModalConfig ); * &lt;/pre&gt; */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.downloadModal.init' ); console.log( '##############################' ); console.log( 'viewer.downloadModal.init: config = ', config ); } $.extend( true, _defaults, config ); // build loading overlay _loadingOverlay = $( '&lt;div /&gt;' ); _loadingOverlay.addClass( 'dl-modal__overlay' ); $( 'body' ).append( _loadingOverlay ); _defaults.downloadBtn.on( 'click', function() { // show loading overlay $( '.dl-modal__overlay' ).fadeIn( 'fast' ); _defaults.dataType = $( this ).attr( 'data-type' ); _defaults.dataTitle = $( this ).attr( 'data-title' ); if ( $( this ).attr( 'data-id' ) !== '' ) { _defaults.dataId = $( this ).attr( 'data-id' ); } else { _defaults.dataId = '-'; } _defaults.dataPi = $( this ).attr( 'data-pi' ); _getWorkInfo( _defaults.dataPi, _defaults.dataId, _defaults.dataType ).done( function( info ) { _defaults.workInfo = info; _defaults.modal = { id: _defaults.dataPi + '-Modal', label: _defaults.dataPi + '-Label', string: { title: _defaults.dataTitle, body: viewer.downloadModal.renderModalBody( _defaults.dataType, _defaults.workInfo ), closeBtn: _defaults.messages.closeBtn, saveBtn: _defaults.messages.saveBtn, } }; // hide loading overlay $( '.dl-modal__overlay' ).fadeOut( 'fast' ); // init modal viewer.downloadModal.initModal( _defaults ); } ); } ); }, /** * Method which initializes the download modal and its content. * * @method initModal * @param {Object} params An config object which overwrites the defaults. */ initModal: function( params ) { if ( _debug ) { console.log( '---------- viewer.downloadModal.initModal() ----------' ); console.log( 'viewer.downloadModal.initModal: params = ', params ); } $( 'body' ).append( viewer.helper.renderModal( params.modal ) ); // disable submit button $( '#submitModal' ).attr( 'disabled', 'disabled' ); // show modal $( '#' + params.modal.id ).modal( 'show' ); // render reCAPTCHA to modal $( '#' + params.modal.id ).on( 'shown.bs.modal', function( e ) { if ( _defaults.useReCaptcha ) { var rcWidget = grecaptcha.render( 'reCaptchaWrapper', { sitekey: _defaults.reCaptchaSiteKey, callback: function() { var rcWidgetResponse = viewer.downloadModal.validateReCaptcha( grecaptcha.getResponse( rcWidget ) ); if ( rcWidgetResponse ) { $( '#modalAlerts' ).append( viewer.helper.renderAlert( 'alert-success', _defaults.messages.rcValid, true ) ); // enable submit button $( '#submitModal' ).removeAttr( 'disabled' ).on( 'click', function() { _defaults.userEmail = $( '#recallEMail' ).val(); _defaults.apiUrl = viewer.downloadModal .buildAPICall( _defaults.path, _defaults.dataType, _defaults.dataPi, _defaults.dataId, _defaults.userEmail ); window.location.href = _defaults.apiUrl; } ); } else { $( '#modalAlerts' ).append( viewer.helper.renderAlert( 'alert-danger', _defaults.messages.rcInvalid, true ) ); } } } ); } else { // hide paragraph $( this ).find( '.modal-body h4' ).next( 'p' ).hide(); // enable submit button $( '#submitModal' ).removeAttr( 'disabled' ).on( 'click', function() { _defaults.userEmail = $( '#recallEMail' ).val(); _defaults.apiUrl = viewer.downloadModal.buildAPICall( _defaults.path, _defaults.dataType, _defaults.dataPi, _defaults.dataId, _defaults.userEmail ); window.location.href = _defaults.apiUrl; } ); } } ); // remove modal from DOM after closing $( '#' + params.modal.id ).on( 'hidden.bs.modal', function( e ) { $( this ).remove(); } ); }, /** * Method which returns a HTML-String to render the download modal body. * * @method renderModalBody * @param {String} type The current file type to download. * @param {String} title The title of the current download file. * @returns {String} The HTML-String to render the download modal body. */ renderModalBody: function( type, infos ) { if ( _debug ) { console.log( '---------- viewer.downloadModal.renderModalBody() ----------' ); console.log( 'viewer.downloadModal.renderModalBody: type = ', type ); console.log( 'viewer.downloadModal.renderModalBody: infos = ', infos ); } var rcResponse = null; var modalBody = ''; modalBody += ''; // alerts modalBody += '&lt;div id=&quot;modalAlerts&quot;&gt;&lt;/div&gt;'; // Title if ( type === 'pdf' ) { modalBody += '&lt;h4&gt;'; modalBody += '&lt;i class=&quot;fa fa-file-pdf-o&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt; PDF-Download: '; modalBody += '&lt;/h4&gt;'; } else { modalBody += '&lt;h4&gt;'; modalBody += '&lt;i class=&quot;fa fa-file-text-o&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt; ePub-Download: '; modalBody += '&lt;/h4&gt;'; } // Info modalBody += '&lt;p&gt;' + _defaults.messages.downloadInfo.text + ':&lt;/p&gt;'; modalBody += '&lt;dl class=&quot;dl-horizontal&quot;&gt;'; modalBody += '&lt;dt&gt;' + _defaults.messages.downloadInfo.title + ':&lt;/dt&gt;'; modalBody += '&lt;dd&gt;' + infos.title + '&lt;/dd&gt;'; if ( infos.div !== null ) { modalBody += '&lt;dt&gt;' + _defaults.messages.downloadInfo.part + ':&lt;/dt&gt;'; modalBody += '&lt;dd&gt;' + infos.div + '&lt;/dd&gt;'; } if ( infos.size ) { modalBody += '&lt;dt&gt;' + _defaults.messages.downloadInfo.fileSize + ':&lt;/dt&gt;'; modalBody += '&lt;dd&gt;~' + infos.size + '&lt;/dd&gt;'; modalBody += '&lt;/dl&gt;'; } // reCAPTCHA if ( _defaults.useReCaptcha ) { modalBody += '&lt;hr /&gt;'; modalBody += '&lt;p&gt;&lt;strong&gt;reCAPTCHA&lt;/strong&gt;&lt;/p&gt;'; modalBody += '&lt;p&gt;' + _defaults.messages.reCaptchaText + ':&lt;/p&gt;'; modalBody += '&lt;div id=&quot;reCaptchaWrapper&quot;&gt;&lt;/div&gt;'; } // E-Mail modalBody += '&lt;hr /&gt;'; modalBody += '&lt;form class=&quot;email-form&quot;&gt;'; modalBody += '&lt;div class=&quot;form-group&quot;&gt;'; modalBody += '&lt;label for=&quot;recallEMail&quot;&gt;' + _defaults.messages.eMail + '&lt;/label&gt;'; if ( _defaults.userEmail != undefined ) { modalBody += '&lt;p class=&quot;help-block&quot;&gt;' + _defaults.messages.eMailTextLoggedIn + '&lt;/p&gt;'; modalBody += '&lt;input type=&quot;email&quot; class=&quot;form-control&quot; id=&quot;recallEMail&quot; value=&quot;' + _defaults.userEmail + '&quot; disabled=&quot;disabled&quot; /&gt;'; } else { modalBody += '&lt;p class=&quot;help-block&quot;&gt;' + _defaults.messages.eMailText + ':&lt;/p&gt;'; modalBody += '&lt;input type=&quot;email&quot; class=&quot;form-control&quot; id=&quot;recallEMail&quot; /&gt;'; } modalBody += '&lt;/div&gt;'; modalBody += '&lt;/form&gt;'; return modalBody; }, /** * Method which checks the reCAPTCHA response. * * @method validateReCaptcha * @param {String} response The reCAPTCHA response. * @returns {Boolean} Returns true if the reCAPTCHA sent a response. */ validateReCaptcha: function( response ) { if ( _debug ) { console.log( '---------- viewer.downloadModal.validateReCaptcha() ----------' ); console.log( 'viewer.downloadModal.validateReCaptcha: response = ', response ); } if ( response == 0 ) { return false; } else { return true; } }, /** * Method which returns an URL to trigger the ITM download task. * * @method buildAPICall * @param {String} path The current application path. * @param {String} type The current file type to download. * @param {String} pi The PI of the current work. * @param {String} logid The LOG_ID of the current work. * @param {String} email The current user email. * @returns {String} The URL to trigger the ITM download task. */ buildAPICall: function( path, type, pi, logid, email ) { if ( _debug ) { console.log( '---------- viewer.downloadModal.buildAPICall() ----------' ); console.log( 'viewer.downloadModal.buildAPICall: path = ', path ); console.log( 'viewer.downloadModal.buildAPICall: type = ', type ); console.log( 'viewer.downloadModal.buildAPICall: pi = ', pi ); console.log( 'viewer.downloadModal.buildAPICall: logid = ', logid ); console.log( 'viewer.downloadModal.buildAPICall: email = ', email ); } var url = ''; url += path + 'rest/download'; if ( type == '' ) { url += '/-'; } else { url += '/' + type; } if ( pi == '' ) { url += '/-'; } else { url += '/' + pi; } if ( logid == '' ) { url += '/-'; } else { url += '/' + logid; } if ( email == '' || email == undefined ) { url += '/-/'; } else { url += '/' + email + '/'; } return encodeURI( url ); } }; /** * Method which returns a promise if the work info has been reached. * * @method getWorkInfo * @param {String} pi The PI of the work. * @param {String} logid The LOG_ID of the work. * @returns {Promise} A promise object if the info has been reached. */ function _getWorkInfo( pi, logid, type ) { if ( _debug ) { console.log( '---------- _getWorkInfo() ----------' ); console.log( '_getWorkInfo: pi = ', pi ); console.log( '_getWorkInfo: logid = ', logid ); console.log( '_getWorkInfo: type = ', type ); } var restCall = ''; var workInfo = {}; if ( logid !== '' || logid !== undefined ) { restCall = _defaults.iiifPath + type + '/mets/' + pi + '/' + logid + '/'; if ( _debug ) { console.log( 'if' ); console.log( '_getWorkInfo: restCall = ', restCall ); } } else { restCall = _defaults.iiifPath + type + '/mets/' + pi + '/-/'; if ( _debug ) { console.log( 'else' ); console.log( '_getWorkInfo: restCall = ', restCall ); } } return viewerJS.helper.getRemoteData( restCall ); } return viewer; } )( viewerJS || {}, jQuery ); var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _defaults = { commentCount: 0, editBtnCount: 0, deleteBtnCount: 0, deleteModalCount: 0, btnId: null, commentText: null }; viewer.editComment = { /** * Method which initializes all required events to edit comments. * * @method init * @example * * &lt;pre&gt; * $( document ).ready( function() { * viewerJS.editComment.init(); * } ); * &lt;/pre&gt; */ init: function() { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.editComment.init' ); console.log( '##############################' ); } // clear texarea for new comments if ( $( 'textarea[id*=&quot;newCommentInput&quot;]' ).val() !== '' ) { $( 'textarea[id*=&quot;newCommentInput&quot;]' ).focus().val( '' ); } // eventlisteners $( '.comment-edit' ).on( 'click', function() { // hide add new comment field $( '#newCommentField' ).fadeOut(); // get button id _defaults.btnId = $( this ).attr( 'id' ).replace( 'commentEditBtn-', '' ); // show textfield to edit comment and hide comment $( '#addComment' ).hide(); $( '#commentEditComment-' + _defaults.btnId ).prev().hide(); $( '#commentEditComment-' + _defaults.btnId ).show(); // hide edit button $( '.comment-edit' ).hide(); } ); $( '.comment-abort' ).on( 'click', function() { // show add new comment field $( '#newCommentField' ).fadeIn(); // show edit button and comment $( '.comments-comment-text' ).show(); $( '.comment-edit' ).show(); $( '#addComment' ).show(); // hide textfield to edit comment $( this ).parent().hide(); } ); // add counting ids to elements $( '.comment-edit' ).each( function() { $( this ).attr( 'id', 'commentEditBtn-' + _defaults.editBtnCount ); _defaults.editBtnCount++; } ); $( '.comments-comment-edit' ).each( function() { $( this ).attr( 'id', 'commentEditComment-' + _defaults.commentCount ); _defaults.commentCount++; } ); $.each( $( '.comments-delete-btn' ), function() { $( this ).attr( 'data-toggle', 'modal' ).attr( 'data-target', '#deleteCommentModal-' + _defaults.deleteBtnCount ); _defaults.deleteBtnCount++; } ); $.each( $( '.deleteCommentModal' ), function() { $( this ).attr( 'id', 'deleteCommentModal-' + _defaults.deleteModalCount ); _defaults.deleteModalCount++; } ); } }; return viewer; } )( viewerJS || {}, jQuery ); var viewerJS = ( function( viewer ) { 'use strict'; // default variables var _debug = false; viewer.helper = { /** * Method to truncate a string to a given length. * * @method truncateString * @param {String} str The string to truncate. * @param {Number} size The number of characters after the string should be * croped. * @returns {String} The truncated string. * @example * * &lt;pre&gt; * viewerJS.helper.truncateString( $( '.something' ).text(), 75 ); * &lt;/pre&gt; */ truncateString: function( str, size ) { if ( _debug ) { console.log( '---------- viewer.helper.truncateString() ----------' ); console.log( 'viewer.helper.truncateString: str = ', str ); console.log( 'viewer.helper.truncateString: size = ', size ); } var strSize = parseInt( str.length ); if ( strSize &gt; size ) { return str.substring( 0, size ) + '...'; } else { return str; } }, /** * Method which calculates the current position of the active element in sidebar * toc and the image container position and saves it to lacal storage. * * @method saveSidebarTocPosition * @example * * &lt;pre&gt; * viewerJS.helper.saveSidebarTocPosition(); * &lt;/pre&gt; */ saveSidebarTocPosition: function() { if ( _debug ) { console.log( '---------- viewer.helper.saveSidebarTocPosition() ----------' ); } var scrollSidebarTocPosition = null; var savedIdDoc = localStorage.getItem( 'currIdDoc' ); var sidebarTocWrapper = '.widget-toc-elem-wrapp'; var currElement = null; var currUrl = ''; var parentLogId = ''; if ( viewer.localStoragePossible ) { if ( savedIdDoc !== 'false' ) { currElement = $( 'li[data-iddoc=&quot;' + savedIdDoc + '&quot;]' ); if ( currElement.length &gt; 0 ) { $( sidebarTocWrapper ).scrollTop( currElement.offset().top - $( sidebarTocWrapper ).offset().top + $( sidebarTocWrapper ).scrollTop() ); localStorage.setItem( 'currIdDoc', 'false' ); } else { localStorage.setItem( 'currIdDoc', 'false' ); } $( '.widget-toc-elem-link a' ).on( 'click', function() { parentLogId = $( this ).parents( 'li' ).attr( 'data-iddoc' ); localStorage.setItem( 'currIdDoc', parentLogId ); } ); } else { localStorage.setItem( 'currIdDoc', 'false' ); // expand click $( '.widget-toc-elem-expand a' ).on( 'click', function() { scrollSidebarTocPosition = $( sidebarTocWrapper ).scrollTop(); localStorage.setItem( 'sidebarTocScrollPosition', scrollSidebarTocPosition ); } ); // link click $( '.widget-toc-elem-link a' ).on( 'click', function( event ) { event.preventDefault(); currUrl = $( this ).attr( 'href' ); scrollSidebarTocPosition = $( sidebarTocWrapper ).scrollTop(); localStorage.setItem( 'sidebarTocScrollPosition', scrollSidebarTocPosition ); location.href = currUrl; } ); // scroll to saved position $( sidebarTocWrapper ).scrollTop( localStorage.getItem( 'sidebarTocScrollPosition' ) ); } } else { return false; } }, /** * Returns an JSON object from a API call. * * @method getRemoteData * @param {String} url The API call URL. * @returns {Object} A promise object, which tells about the success of receiving * data. * @example * * &lt;pre&gt; * viewerJS.helper.getRemoteData( dataURL ); * &lt;/pre&gt; */ getRemoteData: function( url ) { if ( _debug ) { console.log( '---------- viewer.helper.getRemoteData() ----------' ); console.log( 'viewer.helper.getRemoteData: url = ', url ); } var promise = Q( $.ajax( { url: decodeURI( url ), type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; }, /** * Returns a BS Modal with dynamic content. * * @method renderModal * @param {Object} config An config object which includes the content of the * modal. * @param {String} config.id The ID of the modal. * @param {String} config.label The label of the modal. * @param {Object} config.string An object of strings for the modal content. * @param {String} config.string.title The title of the modal. * @param {String} config.string.body The content of the modal as HTML. * @param {String} config.string.closeBtn Buttontext * @param {String} config.string.saveBtn Buttontext * @returns {String} A HTML-String which renders the modal. */ renderModal: function( config ) { if ( _debug ) { console.log( '---------- viewer.helper.renderModal() ----------' ); console.log( 'viewer.helper.renderModal: config = ', config ); } var _defaults = { id: 'myModal', label: 'myModalLabel', closeId: 'closeModal', submitId: 'submitModal', string: { title: 'Modal title', body: '', closeBtn: 'Close', saveBtn: 'Save changes', } }; $.extend( true, _defaults, config ); var modal = ''; modal += '&lt;div class=&quot;modal fade&quot; id=&quot;' + _defaults.id + '&quot; tabindex=&quot;-1&quot; role=&quot;dialog&quot; aria-labelledby=&quot;' + _defaults.label + '&quot;&gt;'; modal += '&lt;div class=&quot;modal-dialog&quot; role=&quot;document&quot;&gt;'; modal += '&lt;div class=&quot;modal-content&quot;&gt;'; modal += '&lt;div class=&quot;modal-header&quot;&gt;'; modal += '&lt;button type=&quot;button&quot; class=&quot;close&quot; data-dismiss=&quot;modal&quot; aria-label=&quot;' + _defaults.string.closeBtn + '&quot;&gt;'; modal += '&lt;span aria-hidden=&quot;true&quot;&gt;&amp;times;&lt;/span&gt;'; modal += '&lt;/button&gt;'; modal += '&lt;h4 class=&quot;modal-title&quot; id=&quot;' + _defaults.label + '&quot;&gt;' + _defaults.string.title + '&lt;/h4&gt;'; modal += '&lt;/div&gt;'; modal += '&lt;div class=&quot;modal-body&quot;&gt;' + _defaults.string.body + '&lt;/div&gt;'; modal += '&lt;div class=&quot;modal-footer&quot;&gt;'; modal += '&lt;button type=&quot;button&quot; id=&quot;' + _defaults.closeId + '&quot; class=&quot;btn&quot; data-dismiss=&quot;modal&quot;&gt;' + _defaults.string.closeBtn + '&lt;/button&gt;'; modal += '&lt;button type=&quot;button&quot; id=&quot;' + _defaults.submitId + '&quot; class=&quot;btn&quot;&gt;' + _defaults.string.saveBtn + '&lt;/button&gt;'; modal += '&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;'; return modal; }, /** * Returns a BS Alert with dynamic content. * * @method renderAlert * @param {String} type The type of the alert. * @param {String} content The content of the alert. * @param {Boolean} dismissable Sets the option to make the alert dismissable, * true = dismissable. * @returns {String} A HTML-String which renders the alert. */ renderAlert: function( type, content, dismissable ) { if ( _debug ) { console.log( '---------- viewer.helper.renderAlert() ----------' ); console.log( 'viewer.helper.renderAlert: type = ', type ); console.log( 'viewer.helper.renderAlert: content = ', content ); console.log( 'viewer.helper.renderAlert: dismissable = ', dismissable ); } var bsAlert = ''; bsAlert += '&lt;div role=&quot;alert&quot; class=&quot;alert ' + type + ' alert-dismissible fade in&quot;&gt;'; if ( dismissable ) { bsAlert += '&lt;button aria-label=&quot;Close&quot; data-dismiss=&quot;alert&quot; class=&quot;close&quot; type=&quot;button&quot;&gt;&lt;span aria-hidden=&quot;true&quot;&gt;Ã—&lt;/span&gt;&lt;/button&gt;'; } bsAlert += content; bsAlert += '&lt;/div&gt;'; return bsAlert; }, /** * Method to get the version number of the used MS Internet Explorer. * * @method detectIEVersion * @returns {Number} The browser version. */ detectIEVersion: function() { var ua = window.navigator.userAgent; // IE 10 and older var msie = ua.indexOf( 'MSIE ' ); if ( msie &gt; 0 ) { // IE 10 or older =&gt; return version number return parseInt( ua.substring( msie + 5, ua.indexOf( '.', msie ) ), 10 ); } // IE 11 var trident = ua.indexOf( 'Trident/' ); if ( trident &gt; 0 ) { // IE 11 =&gt; return version number var rv = ua.indexOf( 'rv:' ); return parseInt( ua.substring( rv + 3, ua.indexOf( '.', rv ) ), 10 ); } // IE 12+ var edge = ua.indexOf( 'Edge/' ); if ( edge &gt; 0 ) { // Edge (IE 12+) =&gt; return version number return parseInt( ua.substring( edge + 5, ua.indexOf( '.', edge ) ), 10 ); } // other browser return false; }, /** * Method to check if itÂ´s possible to write to local Storage * * @method checkLocalStorage * @returns {Boolean} true or false */ checkLocalStorage: function() { if ( typeof localStorage === 'object' ) { try { localStorage.setItem( 'testLocalStorage', 1 ); localStorage.removeItem( 'testLocalStorage' ); return true; } catch ( error ) { console.error( 'Not possible to write in local Storage: ', error ); return false; } } }, /** * Method to render a warning popover. * * @method renderWarningPopover * @param {String} msg The message to show in the popover. * @returns {Object} An jQuery Object to append to DOM. */ renderWarningPopover: function( msg ) { var popover = $( '&lt;div /&gt;' ); var popoverText = $( '&lt;p /&gt;' ); var popoverButton = $( '&lt;button /&gt;' ); var popoverButtonIcon = $( '&lt;i aria-hidden=&quot;true&quot; /&gt;' ); popover.addClass( 'warning-popover' ); // build button popoverButton.addClass( 'btn-clean' ); popoverButton.attr( 'data-toggle', 'warning-popover' ); popoverButtonIcon.addClass( 'fa fa-times' ); popoverButton.append( popoverButtonIcon ); popover.append( popoverButton ); // build text popoverText.html( msg ); popover.append( popoverText ); return popover; }, /** * Method to equal height of sidebar and content. * * @method equalHeight * @param {String} sidebar The selector of the sidebar. * @param {String} content The selector of the content. */ equalHeight: function( sidebar, content ) { if ( _debug ) { console.log( '---------- viewer.helper.equalHeight() ----------' ); console.log( 'viewer.helper.equalHeight: sidebar = ', sidebar ); console.log( 'viewer.helper.equalHeight: content = ', content ); } var $sidebar = $( sidebar ); var $content = $( content ); var sidebarHeight = $sidebar.outerHeight(); var contentHeight = $content.outerHeight(); if ( sidebarHeight &gt; contentHeight ) { $content.css( { 'min-height': ( sidebarHeight ) + 'px' } ); } }, /** * Method to validate the reCAPTCHA response. * * @method validateReCaptcha * @param {String} wrapper The reCAPTCHA widget wrapper. * @param {String} key The reCAPTCHA site key. * @returns {Boolean} Returns true if the response is valid. */ validateReCaptcha: function( wrapper, key ) { var widget = grecaptcha.render( wrapper, { sitekey: key, callback: function() { var response = grecaptcha.getResponse( widget ); console.log( response ); if ( response == 0 ) { return false; } else { return true; } } } ); }, /** * Method to get the current used browser. * * @method getCurrentBrowser * @returns {String} The name of the current Browser. */ getCurrentBrowser: function() { // Opera 8.0+ var isOpera = ( !!window.opr &amp;&amp; !!opr.addons ) || !!window.opera || navigator.userAgent.indexOf( ' OPR/' ) &gt;= 0; // Firefox 1.0+ var isFirefox = typeof InstallTrigger !== 'undefined'; // Safari 3.0+ &quot;[object HTMLElementConstructor]&quot; var isSafari = /constructor/i.test( window.HTMLElement ) || ( function( p ) { return p.toString() === &quot;[object SafariRemoteNotification]&quot;; } )( !window[ 'safari' ] || ( typeof safari !== 'undefined' &amp;&amp; safari.pushNotification ) ); // Internet Explorer 6-11 var isIE = /* @cc_on!@ */false || !!document.documentMode; // Edge 20+ var isEdge = !isIE &amp;&amp; !!window.StyleMedia; // Chrome 1+ var isChrome = !!window.chrome &amp;&amp; !!window.chrome.webstore; // Blink engine detection // var isBlink = ( isChrome || isOpera ) &amp;&amp; !!window.CSS; if ( isOpera ) { return 'Opera'; } else if ( isFirefox ) { return 'Firefox'; } else if ( isSafari ) { return 'Safari'; } else if ( isIE ) { return 'IE'; } else if ( isEdge ) { return 'Edge'; } else if ( isChrome ) { return 'Chrome'; } }, }; viewer.localStoragePossible = viewer.helper.checkLocalStorage(); return viewer; } )( viewerJS || {}, jQuery ); var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _defaults = { navigationSelector: '#navigation', subMenuSelector: '[data-toggle=&quot;submenu&quot;]', megaMenuSelector: '[data-toggle=&quot;megamenu&quot;]', closeMegaMenuSelector: '[data-toggle=&quot;close&quot;]', }; viewer.navigation = { /** * Method to initialize the viewer main navigation. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {String} config.navigationSelector The selector for the navigation * element. * @param {String} config.subMenuSelector The selector for the submenu element. * @param {String} config.megaMenuSelector The selector for the mega menu element. * @param {String} config.closeMegaMenuSelector The selector for the close mega * menu element. */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.navigation.init' ); console.log( '##############################' ); console.log( 'viewer.navigation.init: config - ', config ); } $.extend( true, _defaults, config ); // TRIGGER STANDARD MENU $( _defaults.subMenuSelector ).on( 'click', function() { var currTrigger = $( this ); if ( $( this ).parents( '.navigation__submenu' ).hasClass( 'in' ) ) { _resetSubMenus(); currTrigger.parent().addClass( 'active' ); currTrigger.next( '.navigation__submenu' ).addClass( 'in' ); _calcSubMenuPosition( currTrigger.next( '.navigation__submenu' ) ); } else { _resetMenus(); currTrigger.parent().addClass( 'active' ); currTrigger.next( '.navigation__submenu' ).addClass( 'in' ); } } ); // TRIGGER MEGA MENU $( _defaults.megaMenuSelector ).on( 'click', function() { _resetMenus(); if ( $( this ).next( '.navigation__megamenu-wrapper' ).hasClass( 'in' ) ) { $( this ).parent().removeClass( 'active' ); $( this ).next( '.navigation__megamenu-wrapper' ).removeClass( 'in' ); } else { $( '.navigation__megamenu-trigger' ).removeClass( 'active' ); $( '.navigation__megamenu-wrapper' ).removeClass( 'in' ); $( this ).parent().addClass( 'active' ); $( this ).next( '.navigation__megamenu-wrapper' ).addClass( 'in' ); } } ); $( _defaults.closeMegaMenuSelector ).on( 'click', function() { _resetMenus(); } ); if ( $( '.navigation__megamenu-wrapper' ).length &gt; 0 ) { _resetMenus(); } // reset all menus by clicking on body $( 'body' ).on( 'click', function( event ) { if ( event.target.id == 'navigation' || $( event.target ).closest( _defaults.navigationSelector ).length ) { return; } else { _resetMenus(); } } ); }, }; /** * Method to reset all shown menus. * * @method _resetMenus */ function _resetMenus() { if ( _debug ) { console.log( '---------- _resetMenus() ----------' ); } $( '.navigation__submenu-trigger' ).removeClass( 'active' ); $( '.navigation__submenu' ).removeClass( 'in' ); $( '.navigation__megamenu-trigger' ).removeClass( 'active' ); $( '.navigation__megamenu-wrapper' ).removeClass( 'in' ); } /** * Method to reset all shown submenus. * * @method _resetSubMenus */ function _resetSubMenus() { $( '.level-2, .level-3, .level-4, .level-5' ).parent().removeClass( 'active' ); $( '.level-2, .level-3, .level-4, .level-5' ).removeClass( 'in' ).removeClass( 'left' ); } /** * Method to calculate the position of the shown submenu. * * @method _calcSubMenuPosition * @param {Object} menu An jQuery object of the current submenu. */ function _calcSubMenuPosition( menu ) { if ( _debug ) { console.log( '---------- _clacSubMenuPosition() ----------' ); console.log( '_clacSubMenuPosition: menu - ', menu ); } var currentOffsetLeft = menu.offset().left; var menuWidth = menu.outerWidth(); var windowWidth = $( window ).outerWidth(); var offsetWidth = currentOffsetLeft + menuWidth; if ( _debug ) { console.log( '_clacSubMenuPosition: currentOffsetLeft - ', currentOffsetLeft ); console.log( '_clacSubMenuPosition: menuWidth - ', menuWidth ); console.log( '_clacSubMenuPosition: windowWidth - ', windowWidth ); console.log( '_clacSubMenuPosition: offsetWidth - ', offsetWidth ); } if ( offsetWidth &gt;= windowWidth ) { menu.addClass( 'left' ).css( 'width', menuWidth ); } else { return false; } } return viewer; } )( viewerJS || {}, jQuery ); var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _json = null; var _apiCall = ''; var _html = ''; var _pageCount = 0; var _scaleCount = 0; var _scaleHeight = 0; var _sliderHandlePosition = {}; var _movedSliderHandlePosition = 0; var _recurrenceCount = 0; var _scaleValue = 0; var _sliderScaleHeight = 0; var _start = 0; var _end = 0; var _currentNerPageRangeSelected = ''; var _currentNerPageRange = ''; var _currentNerType = ''; var _promise = null; var _defaults = { currentPage: '', baseUrl: '', apiUrl: '/rest/ner/tags/', workId: '', overviewTrigger: '', overviewContent: '', sectionTrigger: '', sectionContent: '', facettingTrigger: '', setTagRange: '', slider: '', sliderScale: '', sectionTags: '', currentTags: '', sliderHandle: '', sliderSectionStripe: '', recurrenceNumber: 0, recurrenceSectionNumber: 0, sidebarRight: false, loader: '', msg: { noJSON: 'Es konnten keine Daten abgerufen werden.', emptyTag: 'Keine Tags vorhanden', page: 'Seite', tags: 'Tags', } }; viewer.nerFacetting = { /** * Method to initialize the NER-Widget or NER-View. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {String} config.currentPage The name of the current page. * @param {String} config.baseUrl The root URL. * @param {String} config.apiUrl The base URL for the API-Calls. * @param {String} config.workId The ID of the current work. * @param {String} config.overviewTrigger The ID/Class of the overview trigger. * @param {String} config.overviewContent The ID/Class of the content section from * overview. * @param {String} config.sectionTrigger The ID/Class of the section trigger. * @param {String} config.sectionContent The ID/Class of the content section from * section. * @param {String} config.facettingTrigger The ID/Class of the facetting trigger. * @param {String} config.setTagRange The ID/Class of the select menu for the * range. * @param {String} config.slider The ID/Class of the tag range slider. * @param {String} config.sliderScale The ID/Class of the slider scale. * @param {String} config.sectionTags The ID/Class of the tag section. * @param {String} config.currentTags The ID/Class of the tag container. * @param {String} config.sliderHandle The ID/Class of the slider handle. * @param {String} config.sliderSectionStripe The ID/Class of the range stripe on * the slider. * @param {Number} config.recurrenceNumber The number of displayed tags in a row. * @param {Number} config.recurrenceSectionNumber The number of displayed tags in * a section. * @param {Boolean} config.sidebarRight If true, the current tag row will show up * to the left of the sidebar widget. * @param {String} config.loader The ID/Class of the AJAX-Loader. * @param {Object} config.msg An object of strings for multi language use. */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.nerFacetting.init' ); console.log( '##############################' ); console.log( 'viewer.nerFacetting.init: config - ', config ); } $.extend( true, _defaults, config ); if ( viewer.localStoragePossible ) { // show loader $( _defaults.loader ).show(); // clean local storage _cleanUpLocalStorage(); // reset select menu $( _defaults.setTagRange ).find( 'option' ).attr( 'selected', false ); if ( _defaults.currentPage === 'nerfacetting' ) { $( _defaults.setTagRangeOverview ).find( 'option[value=&quot;1&quot;]' ).prop( 'selected', true ); } else { $( _defaults.setTagRangeOverview ).find( 'option[value=&quot;10&quot;]' ).prop( 'selected', true ); } // reset facetting icons _resetFacettingIcons(); // get data for current work if ( _defaults.currentPage === 'nerfacetting' ) { _apiCall = _getAllTagsOfARange( 1, '-' ); } else { _apiCall = _getAllTagsOfARange( 10, '-' ); } _promise = viewer.helper.getRemoteData( _apiCall ); _promise.then( function( json ) { _json = json; // check if data is not empty if ( _json !== null || _json !== 'undefinded' ) { // check if overview is already loaded if ( $( _defaults.overviewContent ).html() === '' ) { _renderOverview( _json ); } } else { _html = viewer.helper.renderAlert( 'alert-danger', _defaults.msg.noJSON + '&lt;br /&gt;&lt;br /&gt;URL: ' + _apiCall, true ); $( _defaults.overviewContent ).html( _html ); } } ).then( null, function( error ) { $( '.facetting-content' ).empty().append( viewer.helper .renderAlert( 'alert-danger', '&lt;strong&gt;Status: &lt;/strong&gt;' + error.status + ' ' + error.statusText, false ) ); console.error( 'ERROR: viewer.nerFacetting.init - ', error ); } ); /** * Event if overview tab is clicked. */ $( _defaults.overviewTrigger ).on( 'click', function() { // show loader $( _defaults.loader ).show(); // resets $( _defaults.setTagRange ).find( 'option' ).attr( 'selected', false ); if ( _defaults.currentPage === 'nerfacetting' ) { $( _defaults.setTagRangeOverview ).find( 'option[value=&quot;1&quot;]' ).prop( 'selected', true ); localStorage.setItem( 'currentNerPageRange', '1' ); } else { $( _defaults.setTagRangeOverview ).find( 'option[value=&quot;10&quot;]' ).prop( 'selected', true ); localStorage.setItem( 'currentNerPageRange', '10' ); } _currentNerPageRange = localStorage.getItem( 'currentNerPageRange' ); localStorage.setItem( 'currentNerType', '-' ); _currentNerType = localStorage.getItem( 'currentNerType' ); _resetFacettingIcons(); // check if tab is active if ( $( this ).parent().hasClass( 'active' ) ) { console.info( 'Overview is already active.' ); } else { if ( _defaults.currentPage === 'nerfacetting' ) { _apiCall = _getAllTagsOfARange( 1, '-' ); } else { _apiCall = _getAllTagsOfARange( 10, '-' ); } _promise = viewer.helper.getRemoteData( _apiCall ); _promise.then( function( json ) { _json = json; _renderOverview( _json ); } ).then( null, function( error ) { $( '.facetting-content' ).empty().append( viewer.helper.renderAlert( 'alert-danger', '&lt;strong&gt;Status: &lt;/strong&gt;' + error.status + ' ' + error.statusText, false ) ); console.error( 'ERROR: viewer.nerFacetting.init - ', error ); } ); } } ); /** * Event if section tab is clicked. */ $( _defaults.sectionTrigger ).on( 'click', function() { // show loader $( _defaults.loader ).show(); // reset select menu $( _defaults.setTagRange ).find( 'option' ).attr( 'selected', false ); if ( _defaults.currentPage === 'nerfacetting' ) { $( _defaults.setTagRangeSection ).find( 'option[value=&quot;5&quot;]' ).prop( 'selected', true ); } else { $( _defaults.setTagRangeSection ).find( 'option[value=&quot;10&quot;]' ).prop( 'selected', true ); } // reset facetting _resetFacettingIcons() // set local storage value if ( _defaults.currentPage === 'nerfacetting' ) { localStorage.setItem( 'currentNerPageRange', 5 ); } else { localStorage.setItem( 'currentNerPageRange', 10 ); } _currentNerPageRange = localStorage.getItem( 'currentNerPageRange' ); localStorage.setItem( 'currentNerType', '-' ); _currentNerType = localStorage.getItem( 'currentNerType' ); // check if tab is active if ( $( this ).parent().hasClass( 'active' ) ) { console.info( 'Section is already active.' ); } else { _renderSection(); // reset section stripe $( _defaults.sliderSectionStripe ).css( 'top', '0px' ); } } ); /** * Event if select menu changes. */ $( _defaults.setTagRange ).on( 'change', function() { var currVal = $( this ).val(); _currentNerType = localStorage.getItem( 'currentNerType' ); // show loader $( _defaults.loader ).show(); // save current value in local storage localStorage.setItem( 'currentNerPageRange', currVal ); _currentNerPageRange = localStorage.getItem( 'currentNerPageRange' ); // render overview if ( $( this ).hasClass( 'overview' ) ) { if ( _currentNerType === null || _currentNerType === '' ) { _currentNerType = '-'; } _apiCall = _getAllTagsOfARange( currVal, _currentNerType ); _promise = viewer.helper.getRemoteData( _apiCall ); _promise.then( function( json ) { _json = json; // check if data is not empty if ( _json !== null || _json !== 'undefinded' ) { _renderOverview( _json ); } else { _html = viewer.helper.renderAlert( 'alert-danger', _defaults.msg.noJSON + '&lt;br /&gt;&lt;br /&gt;URL: ' + _apiCall, true ); $( _defaults.overviewContent ).html( _html ); } } ).then( null, function( error ) { $( '.facetting-content' ).empty().append( viewer.helper.renderAlert( 'alert-danger', '&lt;strong&gt;Status: &lt;/strong&gt;' + error.status + ' ' + error.statusText, false ) ); console.error( 'ERROR: viewer.nerFacetting.init - ', error ); } ); } // render section else { // setup values localStorage.setItem( 'currentNerPageRange', currVal ); _currentNerPageRange = localStorage.getItem( 'currentNerPageRange' ); _renderSection(); // reset section stripe if ( _currentNerPageRange &gt; _pageCount ) { $( _defaults.sliderSectionStripe ).css( { 'top': '0px', 'height': '600px' } ); } else { $( _defaults.sliderSectionStripe ).css( { 'top': '0px', 'height': '100px' } ); } } } ); /** * Event if facetting icons are clicked. */ $( _defaults.facettingTrigger ).on( 'click', function() { var currType = $( this ).attr( 'data-type' ); // show loader $( _defaults.loader ).show(); // set values localStorage.setItem( 'currentNerType', currType ); _currentNerType = localStorage.getItem( 'currentNerType' ); if ( _defaults.currentPage === 'nerfacetting' ) { if ( _currentNerPageRange == null || _currentNerPageRange === '' ) { _currentNerPageRange = localStorage.setItem( 'currentNerPageRange', 1 ); } } else { if ( _currentNerPageRange == null || _currentNerPageRange === '' ) { _currentNerPageRange = localStorage.setItem( 'currentNerPageRange', 10 ); } } _currentNerPageRange = localStorage.getItem( 'currentNerPageRange' ); // activate icons $( '.facetting-trigger' ).removeClass( 'active' ); $( this ).addClass( 'active' ); $( '.reset-filter' ).show(); // filter overview if ( $( this ).parent().parent().parent().attr( 'id' ) === 'overview' ) { // setup data _apiCall = _getAllTagsOfARange( _currentNerPageRange, _currentNerType ); _promise = viewer.helper.getRemoteData( _apiCall ); _promise.then( function( json ) { _json = json; _renderOverview( _json ); // hide select all if ( $( this ).parent().hasClass( 'reset-filter' ) ) { $( this ).parent().hide(); } // set icons to active if &quot;all&quot; is selected if ( _currentNerType === '-' ) { $( '.facetting-trigger' ).addClass( 'active' ); } } ).then( null, function( error ) { $( '.facetting-content' ).empty().append( viewer.helper.renderAlert( 'alert-danger', '&lt;strong&gt;Status: &lt;/strong&gt;' + error.status + ' ' + error.statusText, false ) ); console.error( 'ERROR: viewer.nerFacetting.init - ', error ); } ); } // filter section else { _renderSection(); // hide select all if ( $( this ).parent().hasClass( 'reset-filter' ) ) { $( this ).parent().hide(); } // set icons to active if &quot;all&quot; is selected if ( _currentNerType === '-' ) { $( '.facetting-trigger' ).addClass( 'active' ); } // reset section stripe $( _defaults.sliderSectionStripe ).css( 'top', '0px' ); } } ); } else { $( '.facetting-content' ).empty().append( viewer.helper .renderAlert( 'alert-danger', '&lt;strong&gt;Deactivated: &lt;/strong&gt;Not possible to write in local Storage!', false ) ); } } }; /** * Method to render the NER overview. * * @method _renderOverview * @param {Object} data A JSON-Object. * @returns {Sting} A HTML-String which renders the overview. */ function _renderOverview( data ) { if ( _debug ) { console.log( '---------- _renderOverview() ----------' ); console.log( '_renderOverview: data = ', data ); } _html = ''; _html += '&lt;ul class=&quot;overview-scale&quot;&gt;'; // render page number $.each( data.pages, function( p, page ) { _html += '&lt;li&gt;'; _html += '&lt;div class=&quot;page-number&quot;&gt;'; if ( data.rangeSize == 1 ) { if ( _defaults.currentPage === 'nerfacetting' ) { _html += '&lt;a href=&quot;' + _defaults.baseUrl + '/image/' + _defaults.workId + '/' + page.pageOrder + '/&quot;&gt;'; } else { _html += '&lt;a href=&quot;' + _defaults.baseUrl + '/' + _defaults.currentPage + '/' + _defaults.workId + '/' + page.pageOrder + '/&quot;&gt;'; } _html += page.pageOrder; _html += '&lt;/a&gt;'; } else { if ( _defaults.currentPage === 'nerfacetting' ) { if ( page.firstPage !== undefined || page.lastPage !== undefined ) { _html += '&lt;a href=&quot;' + _defaults.baseUrl + '/image/' + _defaults.workId + '/' + page.firstPage + '/&quot;&gt;'; _html += page.firstPage + '-' + page.lastPage; _html += '&lt;/a&gt;'; } else { _html += '&lt;a href=&quot;' + _defaults.baseUrl + '/image/' + _defaults.workId + '/' + page.pageOrder + '/&quot;&gt;'; _html += page.pageOrder; _html += '&lt;/a&gt;'; } } else { if ( page.firstPage !== undefined || page.lastPage !== undefined ) { _html += '&lt;a href=&quot;' + _defaults.baseUrl + '/' + _defaults.currentPage + '/' + _defaults.workId + '/' + page.firstPage + '/&quot;&gt;'; _html += page.firstPage + '-' + page.lastPage; _html += '&lt;/a&gt;'; } else { _html += '&lt;a href=&quot;' + _defaults.baseUrl + '/' + _defaults.currentPage + '/' + _defaults.workId + '/' + page.pageOrder + '/&quot;&gt;'; _html += page.pageOrder; _html += '&lt;/a&gt;'; } } } _html += '&lt;/div&gt;'; _html += '&lt;div class=&quot;tag-container&quot;&gt;'; // render tags if ( page.tags.length === 0 || page.tags.length === 'undefined' ) { _html += '&lt;span class=&quot;page-tag empty&quot;&gt;' + _defaults.msg.emptyTag + '&lt;/span&gt;'; } else { $.each( page.tags, function( t, tag ) { _html += '&lt;span class=&quot;page-tag ' + tag.type + '&quot;&gt;' + tag.value + '&lt;/span&gt;'; } ); } _html += '&lt;/div&gt;'; _html += '&lt;/li&gt;'; } ); _html += '&lt;/ul&gt;'; $( _defaults.overviewContent ).hide().html( _html ).find( '.tag-container' ).each( function() { $( this ).children( '.page-tag' ).slice( _defaults.recurrenceNumber ).remove(); } ); $( _defaults.overviewContent ).show(); // hide loader $( _defaults.loader ).hide(); $( '.tag-container' ).on( { 'mouseover': function() { var $this = $( this ); _showCurrentTags( $this ); }, 'mouseout': function() { _hideCurrentTags(); } } ); } /** * Method which shows the current tag row in a tooltip. * * @method _showCurrentTags * @param {Object} $obj An jQuery object of the current tag row. */ function _showCurrentTags( $obj ) { var content = $obj.html(); var pos = $obj.position(); if ( _defaults.sidebarRight ) { if ( _defaults.currentPage === 'nerfacetting' ) { $( _defaults.currentTags ).html( content ).css( { 'display': 'block', 'top': pos.top + 25 + 'px', } ); } else { $( _defaults.currentTags ).addClass( 'right' ).html( content ).css( { 'display': 'block', 'top': pos.top - 2 + 'px', 'left': 'auto', 'right': '100%' } ); } } else { if ( _defaults.currentPage === 'nerfacetting' ) { $( _defaults.currentTags ).html( content ).css( { 'display': 'block', 'top': pos.top + 25 + 'px' } ); } else { $( _defaults.currentTags ).html( content ).css( { 'display': 'block', 'top': pos.top - 2 + 'px' } ); } } } /** * Method which hides the current tag row tooltip. * * @method _hideCurrentTags */ function _hideCurrentTags() { $( _defaults.currentTags ).hide(); } /** * Method to render the NER section. * * @method _renderSection * @param {Object} data A JSON-Object. */ function _renderSection() { if ( _debug ) { console.log( '---------- _renderSection() ----------' ); console.log( '_renderSection: _currentNerPageRange = ', _currentNerPageRange ); console.log( '_renderSection: _currentNerType = ', _currentNerType ); } // set values _apiCall = _getAllTags(); _promise = viewer.helper.getRemoteData( _apiCall ); _promise.then( function( workCall ) { _pageCount = _getPageCount( workCall ); if ( _currentNerPageRange === null || _currentNerPageRange === '' ) { _currentNerPageRange = localStorage.getItem( 'currentNerPageRange' ); } if ( _currentNerType === null || _currentNerType === '' ) { _currentNerType = localStorage.getItem( 'currentNerType' ) } // render page count to scale if ( _defaults.currentPage === 'nerfacetting' ) { $( '#sliderScale .scale-page.end' ).html( _pageCount ); } else { if ( _pageCount &gt; 1000 ) { $( '#sliderScale .scale-page.end' ).html( '999+' ); } else { $( '#sliderScale .scale-page.end' ).html( _pageCount ); } } // init slider $( _defaults.slider ).slider( { orientation: &quot;vertical&quot;, range: false, min: 1, max: _pageCount, value: _pageCount, slide: function( event, ui ) { _sliderHandlePosition = $( _defaults.sliderHandle ).position(); _scaleValue = ( _pageCount + 1 ) - ui.value; // show bubble $( '.page-bubble' ).show(); _renderPageBubble( _scaleValue ); }, start: function() { _sliderHandlePosition = $( _defaults.sliderHandle ).position(); _movedSliderHandlePosition = _sliderHandlePosition.top; }, stop: function( event, ui ) { _currentNerType = localStorage.getItem( 'currentNerType' ); _sliderScaleHeight = $( _defaults.sliderScale ).height(); // set position of section stripe if ( _currentNerPageRange &gt; _pageCount ) { $( _defaults.sliderSectionStripe ).css( { 'top': '0px', 'height': '600px' } ); } else { if ( _sliderHandlePosition.top &lt; 100 ) { $( _defaults.sliderSectionStripe ).animate( { 'top': '0px', 'height': '100px' } ); } else if ( _sliderHandlePosition.top &gt; 100 ) { if ( _sliderHandlePosition.top &gt; 500 ) { $( _defaults.sliderSectionStripe ).animate( { 'top': ( _sliderScaleHeight - 100 ) + 'px', 'height': '100px' } ); } else { if ( _movedSliderHandlePosition &lt; _sliderHandlePosition.top ) { $( _defaults.sliderSectionStripe ).animate( { 'top': _sliderHandlePosition.top - 25 + 'px', 'height': '100px' } ); } else { $( _defaults.sliderSectionStripe ).animate( { 'top': _sliderHandlePosition.top - 50 + 'px', 'height': '100px' } ); } } } } // render tags switch ( _currentNerPageRange ) { case '5': _start = _scaleValue - 2; _end = _scaleValue + 3; while ( _start &lt; 1 ) { _start++; _end++; } while ( _end &gt; _pageCount ) { _start--; _end--; } _apiCall = _getAllTagsOfPageSection( _start, _end, _currentNerType ); break; case '10': _start = _scaleValue - 5; _end = _scaleValue + 5; while ( _start &lt; 1 ) { _start++; _end++; } while ( _end &gt; _pageCount ) { _start--; _end--; } _apiCall = _getAllTagsOfPageSection( _start, _end, _currentNerType ); break; case '50': _start = _scaleValue - 25; _end = _scaleValue + 25; while ( _start &lt; 1 ) { _start++; _end++; } while ( _end &gt; _pageCount ) { _start--; _end--; } _apiCall = _getAllTagsOfPageSection( _start, _end, _currentNerType ); break; case '100': _start = _scaleValue - 50; _end = _scaleValue + 50; while ( _start &lt; 1 ) { _start++; _end++; } while ( _end &gt; _pageCount ) { _start--; _end--; } _apiCall = _getAllTagsOfPageSection( _start, _end, _currentNerType ); break; } _promise = viewer.helper.getRemoteData( _apiCall ); _promise.then( function( json ) { _json = json; _html = _renderSectionTags( _json ); if ( _html === '' ) { $( _defaults.sectionTags ).hide().html( viewer.helper.renderAlert( 'alert-warning', _defaults.msg.emptyTag, false ) ).show(); } else { $( _defaults.sectionTags ).hide().html( _html ).each( function() { $( this ).children( '.page-tag' ).slice( _defaults.recurrenceSectionNumber ).remove(); } ); $( _defaults.sectionTags ).show(); } // hide bubble $( '.page-bubble' ).fadeOut(); } ).then( null, function( error ) { $( '.facetting-content' ).empty().append( viewer.helper .renderAlert( 'alert-danger', '&lt;strong&gt;Status: &lt;/strong&gt;' + error.status + ' ' + error.statusText, false ) ); console.error( 'ERROR: viewer.nerFacetting.init - ', error ); } ); } } ); // render section tags _apiCall = _getAllTagsOfPageSection( 0, _currentNerPageRange, _currentNerType ); _promise = viewer.helper.getRemoteData( _apiCall ); _promise.then( function( json ) { _json = json; _html = _renderSectionTags( _json ); if ( _html === '' ) { $( _defaults.sectionTags ).hide().html( viewer.helper.renderAlert( 'alert-warning', _defaults.msg.emptyTag, false ) ).show(); } else { $( _defaults.sectionTags ).hide().html( _html ).each( function() { $( this ).children( '.page-tag' ).slice( _defaults.recurrenceSectionNumber ).remove(); } ); $( _defaults.sectionTags ).show(); } // hide loader $( _defaults.loader ).hide(); } ) .then( null, function( error ) { $( '.facetting-content' ).empty().append( viewer.helper .renderAlert( 'alert-danger', '&lt;strong&gt;Status: &lt;/strong&gt;' + error.status + ' ' + error.statusText, false ) ); console.error( 'ERROR: viewer.nerFacetting.init - ', error ); } ); } ).then( null, function( error ) { $( '.facetting-content' ).empty().append( viewer.helper.renderAlert( 'alert-danger', '&lt;strong&gt;Status: &lt;/strong&gt;' + error.status + ' ' + error.statusText, false ) ); console.error( 'ERROR: viewer.nerFacetting.init - ', error ); } ); } /** * Method which renders the tags in the section area. * * @method _renderSectionTags * @param {Object} data A JSON-Object. * @returns {Sting} A HTML-String which renders the tag section. */ function _renderSectionTags( data ) { if ( _debug ) { console.log( '---------- _renderSectionTags() ----------' ); console.log( '_renderSectionTags: data - ', data ); } _html = ''; // render tags $.each( data.pages, function( p, page ) { if ( page.tags.length === 0 || page.tags.length === 'undefined' ) { _html += ''; } else { $.each( page.tags, function( t, tag ) { if ( _defaults.currentPage === 'nerfacetting' ) { if ( tag.counter &lt; 10 ) { _html += '&lt;span class=&quot;page-tag ' + tag.type + '&quot; style=&quot;font-size: 1.' + tag.counter + 'rem;&quot;&gt;' + tag.value + '&lt;/span&gt;'; } else { _html += '&lt;span class=&quot;page-tag ' + tag.type + '&quot; style=&quot;font-size: 2rem;&quot;&gt;' + tag.value + '&lt;/span&gt;'; } } else { if ( tag.counter &lt; 10 ) { _html += '&lt;span class=&quot;page-tag ' + tag.type + '&quot; style=&quot;font-size: 1' + tag.counter + 'px;&quot;&gt;' + tag.value + '&lt;/span&gt;'; } else { _html += '&lt;span class=&quot;page-tag ' + tag.type + '&quot; style=&quot;font-size: 19px;&quot;&gt;' + tag.value + '&lt;/span&gt;'; } } } ); } } ); return _html; } /** * Method which renders a span showing the current page section. * * @method _renderPageBubble * @param {Number} page The current pagenumber. */ function _renderPageBubble( page ) { if ( _debug ) { console.log( '---------- _renderPageBubble() ----------' ); console.log( '_renderPageBubble: page - ', page ); } var pageBubble = ''; switch ( _currentNerPageRange ) { case '5': _start = page - 2; _end = page + 3; while ( _start &lt; 1 ) { _start++; _end++; } while ( _end &gt; _pageCount ) { _start--; _end--; } pageBubble += '&lt;span class=&quot;page-bubble&quot;&gt;' + _start + '-' + _end + '&lt;/span&gt;'; break; case '10': _start = page - 5; _end = page + 5; while ( _start &lt; 1 ) { _start++; _end++; } while ( _end &gt; _pageCount ) { _start--; _end--; } pageBubble += '&lt;span class=&quot;page-bubble&quot;&gt;' + _start + '-' + _end + '&lt;/span&gt;'; break; case '50': _start = page - 25; _end = page + 25; while ( _start &lt; 1 ) { _start++; _end++; } while ( _end &gt; _pageCount ) { _start--; _end--; } pageBubble += '&lt;span class=&quot;page-bubble&quot;&gt;' + _start + '-' + _end + '&lt;/span&gt;'; break; case '100': _start = page - 50; _end = page + 50; while ( _start &lt; 1 ) { _start++; _end++; } while ( _end &gt; _pageCount ) { _start--; _end--; } pageBubble += '&lt;span class=&quot;page-bubble&quot;&gt;' + _start + '-' + _end + '&lt;/span&gt;'; break; } $( '#sliderVertical .ui-slider-handle' ).html( pageBubble ); } /** * Method which returns the page count of the current work. * * @method _getPageCount * @param {Object} work The current wor object. * @returns {Number} The page count of the current work. */ function _getPageCount( work ) { if ( _debug ) { console.log( '---------- _getPageCount() ----------' ); console.log( '_getPageCount: work - ', work ); } return work.pages.length; } /** * Method which resets all facetting icons to default * * @method _resetFacettingIcons */ function _resetFacettingIcons() { if ( _debug ) { console.log( '---------- _resetFacettingIcons() ----------' ); } $( '.facetting-trigger' ).addClass( 'active' ); $( '.reset-filter' ).hide(); } /** * Method which removes all set local storage values. * * @method _cleanUpLocalStorage */ function _cleanUpLocalStorage() { if ( _debug ) { console.log( '---------- _cleanUpLocalStorage() ----------' ); } localStorage.removeItem( 'currentNerPageRange' ); localStorage.removeItem( 'currentNerType' ); } /** * API-Calls */ // get all tags from all pages: /rest/ner/tags/{pi}/ function _getAllTags() { return _defaults.baseUrl + _defaults.apiUrl + _defaults.workId; } // get all tags of a range: /viewer/rest/ner/tags/ranges/{range}/{type}/{pi}/ function _getAllTagsOfARange( range, type ) { return _defaults.baseUrl + _defaults.apiUrl + 'ranges/' + range + '/' + type + '/' + _defaults.workId + '/'; } // get all tags sorted of type: /rest/ner/tags/{type}/{pi}/ function _getAllTagsOfAType( type ) { return _defaults.baseUrl + _defaults.apiUrl + type + '/' + _defaults.workId + '/'; } // get all tags sorted of recurrence (asc/desc): // /rest/ner/tags/recurrence/{type}/{order}/{pi}/ function _getAllTagsOfRecurrence( type, order ) { if ( type === '-' ) { return _defaults.baseUrl + _defaults.apiUrl + 'recurrence/-/' + order + '/' + _defaults.workId + '/'; } else { return _defaults.baseUrl + _defaults.apiUrl + 'recurrence/' + type + '/' + order + '/' + _defaults.workId + '/'; } } // get all tags sorted of page section: /rest/ner/tags/{start}/{end}/{pi}/ function _getAllTagsOfPageSection( start, end, type ) { return _defaults.baseUrl + _defaults.apiUrl + start + '/' + end + '/' + type + '/' + _defaults.workId + '/'; } return viewer; } )( viewerJS || {}, jQuery ); var viewerJS = ( function( viewer ) { 'use strict'; // define variables var _debug = false; var _defaults = { path: null, lang: {} }; var _contextPath = null; var _lang = null; viewer.nerFulltext = { /** * Method which initializes the NER Popover methods. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {String} config.path The rootpath of the application. * @example * * &lt;pre&gt; * var nerConfig = { * path: '#{request.contextPath}' * }; * * viewerJS.nerFulltext.init( nerConfig ); * &lt;/pre&gt; */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.nerFulltext.init' ); console.log( '##############################' ); console.log( 'viewer.nerFulltext.init: config - ' ); console.log( config ); } $.extend( true, _defaults, config ); _initNerPopover( _defaults.path ); } }; /** * Method which fetches data from the API and returns an JSON object. * * @method _getRemoteData * @param {String} target The API call URL. * @returns {Object} The JSON object with the API data. * */ function _getRemoteData( target ) { if ( _debug ) { console.log( 'viewer.nerFulltext _getRemoteData: target - ' ); console.log( target ); } // show preloader for current element $( '.ner-detail-loader', target ).css( { display: 'inline-block' } ); // AJAX call var data = $.ajax( { url: decodeURI( $( target ).attr( 'data-remotecontent' ) ), type: 'POST', dataType: 'JSON', async: false, complete: function() { $( '.ner-detail-loader' ).hide(); } } ).responseText; return data; } /** * Method which initializes the events for the NER-Popovers. * * @method _initNerPopover * @param {String} path The root path of the application. * */ function _initNerPopover( path ) { if ( _debug ) { console.log( 'viewer.nerFulltext _initNerPopover: path - ' + path ); } var data, position, title, triggerCoords, textBox, textBoxPosition, textBoxCoords; $( '.ner-trigger' ).on( 'click', function() { $( 'body' ).find( '.ner-popover-pointer' ).hide(); $( 'body' ).find( '.ner-popover' ).remove(); data = _getRemoteData( $( this ) ); position = $( this ).position(); triggerCoords = { top: position.top, left: position.left, width: $( this ).outerWidth() }; textBox = $( '#view_fulltext_wrapp' ); textBoxPosition = textBox.position(); textBoxCoords = { top: textBoxPosition.top, left: 0, right: textBoxPosition.left + textBox.outerWidth() }; title = $( this ).attr( 'title' ); textBox.append( _renderNerPopover( data, _calculateNerPopoverPosition( triggerCoords, textBoxCoords ), title, path ) ); if ( $( '.ner-popover' ) ) { $( this ).find( '.ner-popover-pointer' ).show(); _removeNerPopover(); $( '.ner-detail-trigger' ).on( 'click', function() { data = _getRemoteData( $( this ) ); title = $( this ).attr( 'title' ); $( this ).parent().next( '.ner-popover-detail' ).html( _renderNerPopoverDetail( data, title ) ); } ); } } ); } /** * Method which renders a popover to the DOM. * * @method _renderNerPopover * @param {Object} data The JSON object from the API. * @param {Object} position A jQuery object including the position of the clicked * trigger. * @param {String} title The value of the title attribute from the clicked trigger. * @param {String} path The root path of the application. * @returns {String} The HTML string which renders the popover. * */ function _renderNerPopover( data, position, title, path ) { if ( _debug ) { console.log( 'viewer.nerFulltext _renderNerPopover: data - ' ); console.log( data ); console.log( 'viewer.nerFulltext _renderNerPopover: position - ' ); console.log( position ); console.log( 'viewer.nerFulltext _renderNerPopover: title - ' + title ); console.log( 'viewer.nerFulltext _renderNerPopover: path - ' + path ); } var positionTop = position.top; var positionLeft = position.left; var popover = ''; popover += '&lt;div class=&quot;ner-popover&quot; style=&quot;top:' + positionTop + 'px; left:' + positionLeft + 'px&quot;&gt;'; popover += '&lt;div class=&quot;ner-popover-close&quot; title=&quot;Fenster schlie&amp;szlig;en&quot;&gt;&amp;times;&lt;/div&gt;'; popover += '&lt;div class=&quot;ner-popover-header&quot;&gt;&lt;h4&gt;' + title + '&lt;/h4&gt;&lt;/div&gt;'; popover += '&lt;div class=&quot;ner-popover-body&quot;&gt;'; popover += '&lt;dl class=&quot;dl-horizontal&quot;&gt;'; $.each( $.parseJSON( data ), function( i, object ) { $.each( object, function( property, value ) { popover += '&lt;dt title=&quot;' + property + '&quot;&gt;' + property + ':&lt;/dt&gt;'; var objValue = ''; $.each( value, function( p, v ) { var icon = ''; switch ( property ) { case 'Beruf': icon = 'glyphicon-briefcase'; break; case 'Verwandte Begriffe': icon = 'glyphicon-briefcase'; break; case 'Sohn': icon = 'glyphicon-user'; break; case 'Vater': icon = 'glyphicon-user'; break; case 'Geburtsort': icon = 'glyphicon-map-marker'; break; case 'Sterbeort': icon = 'glyphicon-map-marker'; break; } if ( v.url ) { objValue += '&lt;span '; objValue += 'class=&quot;ner-detail-trigger&quot; '; objValue += 'title=&quot;' + v.text + '&quot; '; objValue += 'tabindex=&quot;-1&quot;'; objValue += 'data-remotecontent=&quot;' + path + '/api?action=normdata&amp;url=' + v.url + '&quot;&gt;'; objValue += '&lt;span class=&quot;glyphicon ' + icon + '&quot;&gt;&lt;/span&gt;&amp;nbsp;'; objValue += v.text; objValue += '&lt;span class=&quot;ner-detail-loader&quot;&gt;&lt;/span&gt;'; objValue += '&lt;/span&gt;'; } else { if ( property === 'URI' ) { objValue += '&lt;a href=&quot;' + v.text + '&quot; target=&quot;_blank&quot;&gt;' + v.text + '&lt;/a&gt;'; } else { objValue += v.text; } } objValue += '&lt;br /&gt;'; } ); popover += '&lt;dd&gt;' + objValue + '&lt;/dd&gt;'; popover += '&lt;div class=&quot;ner-popover-detail&quot;&gt;&lt;/div&gt;'; } ); } ); popover += '&lt;/dl&gt;'; popover += '&lt;/div&gt;'; popover += '&lt;/div&gt;'; return popover; } /** * Method which renders detail information into the popover. * * @method _renderNerPopoverDetail * @param {Object} data The JSON object from the API. * @param {String} title The value of the title attribute from the clicked trigger. * @returns {String} The HTML string which renders the details. * */ function _renderNerPopoverDetail( data, title ) { if ( _debug ) { console.log( 'viewer.nerFulltext _renderNerPopoverDetail: data - ' ); console.log( data ); console.log( 'viewer.nerFulltext _renderNerPopoverDetail: title - ' + title ); } var popoverDetail = ''; popoverDetail += '&lt;div class=&quot;ner-popover-detail&quot;&gt;'; popoverDetail += '&lt;div class=&quot;ner-popover-detail-header&quot;&gt;&lt;h4&gt;' + title + '&lt;/h4&gt;&lt;/div&gt;'; popoverDetail += '&lt;div class=&quot;ner-popover-detail-body&quot;&gt;'; popoverDetail += '&lt;dl class=&quot;dl-horizontal&quot;&gt;'; $.each( $.parseJSON( data ), function( i, object ) { $.each( object, function( property, value ) { popoverDetail += '&lt;dt title=&quot;' + property + '&quot;&gt;' + property + ':&lt;/dt&gt;'; var objValue = ''; $.each( value, function( p, v ) { if ( property === 'URI' ) { objValue += '&lt;a href=&quot;' + v.text + '&quot; target=&quot;_blank&quot;&gt;' + v.text + '&lt;/a&gt;'; } else { objValue += v.text; } objValue += '&lt;br /&gt;'; } ); popoverDetail += '&lt;dd&gt;' + objValue + '&lt;/dd&gt;'; popoverDetail += '&lt;div class=&quot;ner-popover-detail&quot;&gt;&lt;/div&gt;'; } ); } ); popoverDetail += '&lt;/dl&gt;'; popoverDetail += '&lt;/div&gt;'; popoverDetail += '&lt;/div&gt;'; return popoverDetail; } /** * Method which calculates the position of the popover in the DOM. * * @method _calculateNerPopoverPosition * @param {Object} triggerCoords A jQuery object including the position of the clicked * trigger. * @param {Object} textBoxCoords A jQuery object including the position of the parent * DIV. * @returns {Object} An object which includes the position of the popover. * */ function _calculateNerPopoverPosition( triggerCoords, textBoxCoords ) { if ( _debug ) { console.log( 'viewer.nerFulltext _calculateNerPopoverPosition: triggerCoords - ' ); console.log( triggerCoords ); console.log( 'viewer.nerFulltext _calculateNerPopoverPosition: textBoxCoords - ' ); console.log( textBoxCoords ); } var poLeftBorder = triggerCoords.left - ( 150 - ( triggerCoords.width / 2 ) ), poRightBorder = poLeftBorder + 300, tbLeftBorder = textBoxCoords.left, tbRightBorder = textBoxCoords.right, poTop, poLeft = poLeftBorder; poTop = triggerCoords.top + 27; if ( poLeftBorder &lt;= tbLeftBorder ) { poLeft = tbLeftBorder; } if ( poRightBorder &gt;= tbRightBorder ) { poLeft = textBoxCoords.right - 300; } return { top: poTop, left: poLeft }; } /** * Method to remove a popover from the DOM. * * @method _removeNerPopover * */ function _removeNerPopover() { if ( _debug ) { console.log( 'viewer.nerFulltext _removeNerPopover' ); } $( '.ner-popover-close' ).on( 'click', function() { $( 'body' ).find( '.ner-popover-pointer' ).hide(); $( this ).parent().remove(); } ); } return viewer; } )( viewerJS || {}, jQuery ); var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _data = null; var _dataURL = ''; var _data = ''; var _linkPos = null; var _popover = ''; var _id = ''; var _$this = null; var _normdataIcon = null; var _preloader = null; var _defaults = { id: 0, path: null, lang: {}, elemWrapper: null }; viewer.normdata = { /** * Method to initialize the timematrix slider and the events which builds the * matrix and popovers. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {String} config.id The starting ID of the popover. * @param {String} config.path The rootpath of the application. * @param {Object} config.lang An object of localized strings. * @param {Object} config.elemWrapper An jQuery object of the wrapper DIV. * @example * * &lt;pre&gt; * var normdataConfig = { * path: '#{request.contextPath}', * lang: { * popoverTitle: '#{msg.normdataPopverTitle}', * popoverClose: '#{msg.normdataPopoverClose}' * }, * elemWrapper: $( '#metadataElementWrapper' ) * }; * * viewerJS.normdata.init( normdataConfig ); * &lt;/pre&gt; */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.normdata.init' ); console.log( '##############################' ); console.log( 'viewer.normdata.init: config = ', config ); } $.extend( true, _defaults, config ); // hide close icons $( '.closeAllPopovers' ).hide(); // first level click // console.log(&quot;Init Click on normdata&quot;); // console.log(&quot;normdatalink = &quot;, $( '.normdataLink') ) $( '.normdataLink' ).on( 'click', function() { console.log( &quot;Click on normdata&quot; ); _$this = $( this ); _$this.off( 'focus' ); _renderPopoverAction( _$this, _defaults.id ); } ); }, }; /** * Method which executes the click event action of the popover. * * @method _renderPopoverAction * @param {Object} $Obj The jQuery object of the current clicked link. * @param {String} id The current id of the popover. */ function _renderPopoverAction( $Obj, id ) { if ( _debug ) { console.log( '---------- _renderPopoverAction() ----------' ); console.log( '_renderPopoverAction: $Obj = ', $Obj ); console.log( '_renderPopoverAction: id = ', id ); } _normdataIcon = $Obj.find( '.fa-list-ul' ); _preloader = $Obj.find( '.normdata-preloader' ); // set variables _dataURL = $Obj.attr( 'data-remotecontent' ); _data = _getRemoteData( _dataURL, _preloader, _normdataIcon ); _linkPos = $Obj.offset(); _popover = _buildPopover( _data, id ); if ( _debug ) { console.log( '_renderPopoverAction: _dataURL = ', _dataURL ); console.log( '_renderPopoverAction: _data = ', _data ); console.log( '_renderPopoverAction: _linkPos = ', _linkPos ); } // append popover to body $( 'body' ).append( _popover ); // set popover position _calculatePopoverPosition( id, _linkPos, $Obj ); // show popover $( document ).find( '#normdataPopover-' + id ).hide().fadeIn( 'fast', function() { // disable source button $Obj.attr( 'disabled', 'disabled' ).addClass( 'disabled' ); // hide tooltip $Obj.tooltip( 'hide' ); // set event for nth level popovers $( '.normdataDetailLink' ).off( 'click' ).on( 'click', function() { _$this = $( this ); _renderPopoverAction( _$this, _defaults.id ); } ); } ).draggable(); // init close method _closeNormdataPopover( $Obj ); // increment id _defaults.id++; // init close all method _closeAllNormdataPopovers( $Obj ); } /** * Returns an HTML-String which renders the fetched data into a popover. * * @method _buildPopover * @param {Object} data The JSON-Object which includes the data. * @param {String} id The incremented id of the popover. * @returns {String} The HTML-String with the fetched data. */ function _buildPopover( data, id ) { if ( _debug ) { console.log( '---------- _buildPopover() ----------' ); console.log( '_buildPopover: data = ', data ); console.log( '_buildPopover: id = ', id ); } var html = ''; html += '&lt;div id=&quot;normdataPopover-' + id + '&quot; class=&quot;normdata-popover&quot;&gt;'; html += '&lt;div class=&quot;normdata-popover-title&quot;&gt;'; html += '&lt;h4&gt;' + _defaults.lang.popoverTitle + '&lt;/h4&gt;'; html += '&lt;span class=&quot;normdata-popover-close glyphicon glyphicon-remove&quot; title=&quot;' + _defaults.lang.popoverClose + '&quot;&gt;&lt;/span&gt;'; html += '&lt;/div&gt;'; html += '&lt;div class=&quot;normdata-popover-content&quot;&gt;'; html += '&lt;dl class=&quot;dl-horizontal&quot;&gt;'; $.each( data, function( i, object ) { $.each( object, function( property, value ) { html += '&lt;dt title=&quot;' + property + '&quot;&gt;' + property + '&lt;/dt&gt;'; html += '&lt;dd&gt;'; $.each( value, function( p, v ) { if ( v.text ) { if ( property === &quot;URI&quot; ) { html += '&lt;a href=&quot;' + v.text + '&quot; target=&quot;_blank&quot;&gt;'; html += v.text; html += '&lt;/a&gt;'; } else { html += v.text; } } if ( v.identifier ) { html += '&lt;a href=&quot;' + _defaults.path + '/search/-/' + v.identifier + '/1/&quot;&gt;'; html += '&lt;span class=&quot;glyphicon glyphicon-search&quot;&gt;&lt;/span&gt;'; html += '&lt;/a&gt;'; } if ( v.url ) { html += '&lt;button type=&quot;button&quot; class=&quot;normdataDetailLink&quot; data-remotecontent=&quot;'; html += _defaults.path; html += '/api?action=normdata&amp;amp;url='; html += v.url; html += '&quot; title=&quot;' + _defaults.lang.showNormdata + '&quot;&gt;'; html += '&lt;i class=&quot;fa fa-list-ul&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;'; html += '&lt;div class=&quot;normdata-preloader&quot;&gt;&lt;/div&gt;'; html += '&lt;/button&gt;'; } html += '&lt;br /&gt;'; } ); html += '&lt;/dd&gt;' } ); } ); html += &quot;&lt;/dl&gt;&quot;; html += &quot;&lt;/div&gt;&quot;; html += &quot;&lt;/div&gt;&quot;; return html; } /** * Sets the position to the first level popovers. * * @method _calculateFirstLevelPopoverPosition * @param {String} id The incremented id of the popover. * @param {Object} pos An Object with the current position oft the clicked link. * @param {Object} $Obj An jQuery-Object of the clicked link. * */ function _calculatePopoverPosition( id, pos, $Obj ) { if ( _debug ) { console.log( '---------- _calculatePopoverPosition() ----------' ); console.log( '_calculatePopoverPosition: id = ', id ); console.log( '_calculatePopoverPosition: pos = ', pos ); console.log( '_calculatePopoverPosition: $Obj = ', $Obj ); } var _bodyWidth = $( 'body' ).outerWidth(); var _popoverWidth = $( '#normdataPopover-' + id ).outerWidth(); var _popoverRight = pos.left + _popoverWidth; if ( _debug ) { console.log( '_calculatePopoverPosition: _bodyWidth = ', _bodyWidth ); console.log( '_calculatePopoverPosition: _popoverWidth = ', _popoverWidth ); console.log( '_calculatePopoverPosition: _popoverLeft = ', pos.left ); console.log( '_calculatePopoverPosition: _popoverRight = ', _popoverRight ); } if ( _popoverRight &gt; _bodyWidth ) { var _diff = _popoverRight - _bodyWidth; if ( _debug ) { console.log( '_calculatePopoverPosition: _diff = ', _diff ); } $( document ).find( '#normdataPopover-' + id ).css( { top: pos.top + $Obj.outerHeight() + 5, left: pos.left - _diff } ); } else { $( document ).find( '#normdataPopover-' + id ).css( { top: pos.top + $Obj.outerHeight() + 5, left: pos.left } ); } } /** * Removes current popover from the DOM on click. * * @method _closeNormdataPopover * */ function _closeNormdataPopover( $Obj ) { if ( _debug ) { console.log( '---------- _closeNormdataPopover() ----------' ); console.log( '_closeNormdataPopover: $Obj = ', $Obj ); } $( document ).find( '.normdata-popover-close' ).on( 'click', function() { $( this ).parent().parent().remove(); $Obj.removeAttr( 'disabled' ).removeClass( 'disabled' ); if ( $( '.normdata-popover' ).length &lt; 1 ) { $( '.closeAllPopovers' ).hide(); } } ); } /** * Removes all popovers from the DOM on click. * * @method _closeAllNormdataPopovers * */ function _closeAllNormdataPopovers( $Obj ) { if ( _debug ) { console.log( '---------- _closeAllNormdataPopovers() ----------' ); console.log( '_closeAllNormdataPopovers: $Obj = ', $Obj ); } var _close = $Obj.parent().find( 'i.closeAllPopovers' ); if ( $( '.normdata-popover' ).length &gt; 0 ) { _close.show(); _close.on( 'click', function() { // close all popovers $( '.normdata-popover' ).each( function() { $( this ).remove(); } ); // hide all close icons $( '.closeAllPopovers' ).each( function() { $( this ).hide(); } ); // set trigger to enable $( '.normdataLink' ).removeAttr( 'disabled' ).removeClass( 'disabled' ); } ); } else { _close.hide(); } } /** * Returns an JSON object from a API call. * * @method _getRemoteData * @returns {Object} The JSON object with the API data. */ function _getRemoteData( url, loader, icon ) { if ( _debug ) { console.log( '---------- _getRemoteData() ----------' ); console.log( '_getRemoteData: url = ', url ); console.log( '_getRemoteData: loader = ', loader ); console.log( '_getRemoteData: icon = ', icon ); } loader.show(); icon.hide(); var data = $.ajax( { url: decodeURI( url ), type: &quot;POST&quot;, dataType: &quot;JSON&quot;, async: false, success: function() { loader.hide(); icon.show(); } } ).responseText; return jQuery.parseJSON( data ); } return viewer; } )( viewerJS || {}, jQuery ); var viewerJS = ( function( viewer ) { 'use strict'; var _elem = null; var _text = null; viewer.pageScroll = { /** * Initializes the animated pagescroll. * * @method init * @param {String} obj The selector of the jQuery object. * @param {String} anchor The name of the anchor to scroll to. */ init: function( obj, anchor ) { _elem = $( obj ); _text = anchor; // eventlistener $( window ).on( 'scroll', function() { if ( window.pageYOffset &gt; 200 ) { _elem.fadeIn(); } else { _elem.hide(); } } ); _elem.on( 'click', function() { _scrollPage( _text ); } ); } }; /** * Method which scrolls the page animated. * * @method _scrollPage * @param {String} anchor The name of the anchor to scroll to. */ function _scrollPage( anchor ) { $( 'html,body' ).animate( { scrollTop: $( anchor ).offset().top }, 1000 ); return false; } return viewer; } )( viewerJS || {}, jQuery ); var viewerJS = ( function( viewer ) { 'use strict'; // default variables var _debug = false; var _defaults = { themePath: '', imagePath: '', imageDataFile: '', galleryObject: null, maxColumnCount: null, maxImagesPerColumn: null, fixedHeight: false, maxHeight: '', caption: true, overlayColor: '', lang: {}, lightbox: { active: true, caption: true }, }; var _promise = null; var _imageData = null; var _parentImage = null; var _lightboxImage = null; var _imageLightbox = null; var _smallViewport = null; var _dataUrl = null; viewer.responsiveColumnGallery = { /** * Method which initializes the column gallery. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {String} config.themePath The path to the current activated viewer * theme. * @param {String} config.imagePath The path to the used images. * @param {String} config.imageDataFile The path to the JSON-File, which contains * the images data. * @param {Object} config.galleryObject The DIV where the gallery should be * rendered. * @param {Number} config.maxColumnCount Count count of the gallery, 4 column are * maximum. * @param {Number} config.maxImagesPerColumn Count of the images per column. * @param {Boolean} config.fixedHeight If true the images have a fixed height, * default is false. * @param {String} config.maxHeight Sets the given max height value for the * images. * @param {Boolean} config.caption If true the gallery images have a caption with * the title text, default is true. * @param {String} config.overlayColor Takes a HEX-value to set the color of the * image overlay. * @param {Object} config.lang An object of strings for multilanguage * functionality. * @param {Object} config.lightbox An Object to configure the image lightbox. * @param {Boolean} config.lightbox.active If true the lightbox functionality is * enabled, default is true. * @param {Boolean} config.lightbox.caption If true the lightbox has a caption * text, default is true. */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.responsiveColumnGallery.init' ); console.log( '##############################' ); console.log( 'viewer.responsiveColumnGallery.init: config = ', config ); } $.extend( true, _defaults, config ); // fetch image data and check the viewport _dataUrl = _defaults.themePath + _defaults.imageDataFile; _promise = viewer.helper.getRemoteData( _dataUrl ); _promise.then( function( imageData ) { _imageData = imageData; _smallViewport = viewer.responsiveColumnGallery.checkForSmallViewport(); // render columns if ( _defaults.maxColumnCount &gt; 4 ) { _defaults.galleryObject.append( viewer.helper.renderAlert( 'alert-danger', 'Die maximale Spaltenanzahl fÃ¼r die Galerie betrÃ¤gt 4!', true ) ); return false; } else { for ( var i = 0; i &lt; _defaults.maxColumnCount; i++ ) { _defaults.galleryObject.append( viewer.responsiveColumnGallery.renderColumns( _defaults.maxColumnCount ) ); } } // render images while ( _imageData.length ) { $.each( $( '.rcg-col' ), function() { $( this ).append( viewer.responsiveColumnGallery.renderImages( _imageData.splice( 0, _defaults.maxImagesPerColumn ) ) ); } ); } // set fixed height if activated and viewport is &gt; 375px if ( _defaults.fixedHeight &amp;&amp; !_smallViewport ) { $.each( $( '.rcg-image-body' ), function() { viewer.responsiveColumnGallery.fixedHeight( $( this ) ); } ); } // prepare lightbox if ( _defaults.lightbox.active ) { $( '.lightbox-toggle' ).on( 'click', function( event ) { event.preventDefault(); _parentImage = $( this ).parent().children( 'img' ); _lightboxImage = viewer.responsiveColumnGallery.prepareLightbox( _parentImage ); _imageLightbox = viewer.responsiveColumnGallery.renderLightbox( _lightboxImage ); $( 'body' ).append( _imageLightbox ); $( '.rcg-lightbox-body' ).hide(); $( '.rcg-lightbox-overlay' ).fadeIn( 'slow' ); // first load image, then center it and show it up $( '.rcg-lightbox-image img' ).load( function() { viewer.responsiveColumnGallery.centerLightbox( $( '.rcg-lightbox-body' ) ); $( '.rcg-lightbox-body' ).show(); } ); // close lightbox via button $( '.rcg-lightbox-close' ).on( 'click', function() { $( '.rcg-lightbox-overlay' ).remove(); } ); // close lightbox via esc $( document ).keypress( function( event ) { if ( event.keyCode === 27 ) { $( '.rcg-lightbox-overlay' ).remove(); } } ); // close lightbox via click on picture $( '.rcg-lightbox-image img' ).on( 'click', function() { $( '.rcg-lightbox-overlay' ).remove(); } ); } ); } } ).then( null, function( error ) { _defaults.galleryObject.append( viewer.helper.renderAlert( 'alert-danger', '&lt;strong&gt;Status: &lt;/strong&gt;' + error.status + ' ' + error.statusText, false ) ); console.error( 'ERROR: viewer.responsiveColumnGallery.init - ', error ); } ); }, /** * Method which renders the gallery columns. * * @method renderColumns * @param {String} count The column count of the gallery. * @returns {String} A HTML-String which renders a column. */ renderColumns: function( count ) { if ( _debug ) { console.log( '---------- viewer.responsiveColumnGallery.renderColumns() ----------' ); console.log( 'viewer.responsiveColumnGallery.renderColumns: count = ', count ); } var column = ''; column += '&lt;div class=&quot;rcg-col col-' + count + '&quot;&gt;&lt;/div&gt;'; return column; }, /** * Method which renders the gallery images. * * @method renderImages * @param {Object} data An object of image data to render the images. * @returns {String} A HTML-String which renders the gallery images. */ renderImages: function( data ) { if ( _debug ) { console.log( '---------- viewer.responsiveColumnGallery.renderImages() ----------' ); console.log( 'viewer.responsiveColumnGallery.renderImages: data = ', data ); } var image = ''; $.each( data, function( i, j ) { $.each( j, function( m, n ) { image += '&lt;div class=&quot;rcg-image-container&quot;&gt;'; image += '&lt;div class=&quot;rcg-image-body&quot;&gt;'; image += '&lt;a href=&quot;' + n.url + '&quot;&gt;'; image += '&lt;div class=&quot;rcg-image-overlay&quot; style=&quot;background-color:' + _defaults.overlayColor + '&quot;&gt;&lt;/div&gt;'; image += '&lt;/a&gt;'; image += '&lt;div class=&quot;rcg-image-title&quot;&gt;'; image += '&lt;h4&gt;' + n.title + '&lt;/h4&gt;'; image += '&lt;/div&gt;'; image += '&lt;img src=&quot;' + _defaults.themePath + _defaults.imagePath + n.name + '&quot; alt=&quot;' + n.alt + '&quot; /&gt;'; if ( _defaults.lightbox.active ) { image += '&lt;div class=&quot;lightbox-toggle&quot; title=&quot;' + _defaults.lang.showLightbox + '&quot;&gt;'; image += '&lt;span class=&quot;glyphicon glyphicon-fullscreen&quot;&gt;&lt;/span&gt;'; image += '&lt;/div&gt;'; } image += '&lt;/div&gt;'; if ( _defaults.caption ) { image += '&lt;div class=&quot;rcg-image-footer&quot;&gt;'; image += '&lt;p&gt;' + n.caption + '&lt;a href=&quot;' + n.url + '&quot; title=&quot;' + n.title + '&quot;&gt;'; image += _defaults.lang.goToWork + ' &lt;span class=&quot;glyphicon glyphicon glyphicon-picture&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;'; image += '&lt;/div&gt;'; } image += '&lt;/div&gt;'; } ); } ); return image; }, /** * Method which sets a fixed height to the gallery images. * * @method fixedHeight * @param {Object} $obj An jQuery object of the element which height should be * fixed. */ fixedHeight: function( $obj ) { if ( _debug ) { console.log( '---------- viewer.responsiveColumnGallery.fixedHeight() ----------' ); console.log( 'viewer.responsiveColumnGallery.fixedHeight: $obj = ', $obj ); } $obj.children( 'img' ).css( { 'height': _defaults.maxHeight } ); }, /** * Method which checks the viewport width and returns true if itÂ´s smaller then * 375px. * * @method checkForSmallViewport * @returns {Boolean} Returns true if itÂ´s smaller then 375px. */ checkForSmallViewport: function() { if ( _debug ) { console.log( '---------- viewer.responsiveColumnGallery.checkForSmallViewport() ----------' ); } var windowWidth = $( window ).outerWidth(); if ( windowWidth &lt;= 375 ) { return true; } else { return false; } }, /** * Method which prepares the lightbox object with the required data. * * @method prepareLightbox * @param {Object} $obj An jQuery object which includes the required data * attributes. * @returns {Object} An Object which includes the required data. */ prepareLightbox: function( $obj ) { if ( _debug ) { console.log( '---------- viewer.responsiveColumnGallery.prepareLightbox() ----------' ); console.log( 'viewer.responsiveColumnGallery.prepareLightbox: $obj = ', $obj ); } var lightboxData = {}; lightboxData.src = $obj.attr( 'src' ); lightboxData.caption = $obj.attr( 'alt' ); return lightboxData; }, /** * Method which renders a lightbox for the selected image. * * @method renderLightbox * @param {Object} data An object which includes the required data. * @returns {String} A HTML-String which renders the lightbox. */ renderLightbox: function( data ) { if ( _debug ) { console.log( '---------- viewer.responsiveColumnGallery.renderLightbox() ----------' ); console.log( 'viewer.responsiveColumnGallery.renderLightbox: data = ', data ); } var lightbox = ''; lightbox += '&lt;div class=&quot;rcg-lightbox-overlay&quot;&gt;'; lightbox += '&lt;div class=&quot;rcg-lightbox-body&quot;&gt;'; lightbox += '&lt;div class=&quot;rcg-lightbox-close&quot; title=&quot;' + _defaults.lang.close + '&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-remove&quot;&gt;&lt;/span&gt;&lt;/div&gt;'; lightbox += '&lt;div class=&quot;rcg-lightbox-image&quot;&gt;'; lightbox += '&lt;img src=&quot;' + data.src + '&quot; alt=&quot;' + data.alt + '&quot; /&gt;'; lightbox += '&lt;/div&gt;'; // .rcg-lightbox-image if ( _defaults.lightbox.caption ) { lightbox += '&lt;div class=&quot;rcg-lightbox-caption&quot;&gt;'; lightbox += '&lt;p&gt;' + data.caption + '&lt;/p&gt;'; lightbox += '&lt;/div&gt;'; // .rcg-lightbox-caption } lightbox += '&lt;/div&gt;'; // .rcg-lightbox-body lightbox += '&lt;/div&gt;'; // .rcg-lightbox-overlay return lightbox; }, /** * Method which centers the given object to the viewport. * * @method centerLightbox * @param {Object} $obj An jQuery object of the element to center. */ centerLightbox: function( $obj ) { if ( _debug ) { console.log( '---------- viewer.responsiveColumnGallery.centerLightbox() ----------' ); console.log( 'viewer.responsiveColumnGallery.centerLightbox: $obj = ', $obj ); } var boxWidth = $obj.outerWidth(); var boxHeight = $obj.outerHeight(); $obj.css( { 'margin-top': '-' + boxHeight / 2 + 'px', 'margin-left': '-' + boxWidth / 2 + 'px' } ); }, }; return viewer; } )( viewerJS || {}, jQuery ); var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _advSearchValues = {}; var _defaults = { loaderSelector: '.search-advanced__loader', inputSelector: '.value-text', resetSelector: '.reset', }; viewer.searchAdvanced = { /** * Method to initialize the search advanced features. * * @method init * @param {Object} config An config object which overwrites the defaults. */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.searchAdvanced.init' ); console.log( '##############################' ); console.log( 'viewer.searchAdvanced.init: config = ', config ); } $.extend( true, _defaults, config ); // init bs tooltips $( '[data-toggle=&quot;tooltip&quot;]' ).tooltip(); if ( viewer.localStoragePossible ) { localStorage.setItem( 'advSearchValues', JSON.stringify( _advSearchValues ) ); // set search values _setAdvSearchValues(); _resetValue(); // ajax eventlistener jsf.ajax.addOnEvent( function( data ) { var ajaxstatus = data.status; switch ( ajaxstatus ) { case &quot;begin&quot;: // show loader $( _defaults.loaderSelector ).show(); break; case &quot;success&quot;: // init bs tooltips $( '[data-toggle=&quot;tooltip&quot;]' ).tooltip(); // set search values _setAdvSearchValues(); _getAdvSearchValues(); _resetValue(); // set disabled state to select wrapper $( 'select' ).each( function() { if ( $( this ).attr( 'disabled' ) === 'disabled' ) { $( this ).parent().addClass( 'disabled' ); } else { $( this ).parent().removeClass( 'disabled' ); } } ); // hide loader $( _defaults.loaderSelector ).hide(); break; } } ); } else { return false; } }, }; function _setAdvSearchValues() { if ( _debug ) { console.log( '---------- _setAdvSearchValues() ----------' ); } $( _defaults.inputSelector ).off().on( 'keyup', function() { var currId = $( this ).attr( 'id' ); var currVal = $( this ).val(); var currValues = JSON.parse( localStorage.getItem( 'advSearchValues' ) ); // check if values are in local storage if ( !currValues.hasOwnProperty( currVal ) ) { currValues[ currId ] = currVal; } else { return false; } // write values to local storage localStorage.setItem( 'advSearchValues', JSON.stringify( currValues ) ); } ); } function _getAdvSearchValues() { if ( _debug ) { console.log( '---------- _getAdvSearchValues() ----------' ); } var values = JSON.parse( localStorage.getItem( 'advSearchValues' ) ); $.each( values, function( id, value ) { $( '#' + id ).val( value ); } ); } function _resetValue() { if ( _debug ) { console.log( '---------- _resetValue() ----------' ); } $( _defaults.resetSelector ).off().on( 'click', function() { var inputId = $( this ).parents( '.input-group' ).find( 'input' ).attr( 'id' ); var currValues = JSON.parse( localStorage.getItem( 'advSearchValues' ) ); // delete value from local storage object if ( currValues.hasOwnProperty( inputId ) ) { delete currValues[ inputId ]; } // write new values to local storage localStorage.setItem( 'advSearchValues', JSON.stringify( currValues ) ); $( this ).parents( '.input-group' ).find( 'input' ).val( '' ); } ); } return viewer; } )( viewerJS || {}, jQuery ); var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _promise = null; var _childHits = null; var _defaults = { contextPath: '', restApiPath: '/rest/search/hit/', hitsPerCall: 20, resetSearchSelector: '#resetCurrentSearch', searchInputSelector: '#currentSearchInput', searchTriggerSelector: '#slCurrentSearchTrigger', saveSearchModalSelector: '#saveSearchModal', saveSearchInputSelector: '#saveSearchInput', excelExportSelector: '.excel-export-trigger', excelExportLoaderSelector: '.excel-export-loader', hitContentLoaderSelector: '.search-list__loader', hitContentSelector: '.search-list__hit-content', msg: { getMoreChildren: 'Mehr Treffer laden', } }; viewer.searchList = { /** * Method to initialize the search list features. * * @method init * @param {Object} config An config object which overwrites the defaults. */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.searchList.init' ); console.log( '##############################' ); console.log( 'viewer.searchList.init: config = ', config ); } $.extend( true, _defaults, config ); // init bs tooltips $( '[data-toggle=&quot;tooltip&quot;]' ).tooltip(); // focus save search modal input on show $( _defaults.saveSearchModalSelector ).on( 'shown.bs.modal', function() { $( _defaults.saveSearchInputSelector ).focus(); } ); // reset current search and redirect to standard search $( _defaults.resetSearchSelector ).on( 'click', function() { $( _defaults.searchInputSelector ).val( '' ); location.href = _defaults.contextPath + '/search/'; } ); // show/hide loader for excel export $( _defaults.excelExportSelector ).on( 'click', function() { var trigger = $( this ); var excelLoader = $( _defaults.excelExportLoaderSelector ); trigger.hide(); excelLoader.show(); var url = _defaults.contextPath + '/rest/download/search/waitFor/'; var promise = Q( $.ajax( { url: decodeURI( url ), type: &quot;GET&quot;, dataType: &quot;text&quot;, async: true } ) ); promise.then( function( data ) { if ( _debug ) { console.log(&quot;Download started&quot;); } excelLoader.hide(); trigger.show(); } ).catch( function( error ) { if ( _debug ) { console.log(&quot;Error downloading excel sheet: &quot;, error.responseText); } excelLoader.hide(); trigger.show(); }); } ); // get child hits $( '[data-toggle=&quot;hit-content&quot;]' ).each( function() { var currBtn = $( this ); var currIdDoc = $( this ).attr( 'data-iddoc' ); var currUrl = _getApiUrl( currIdDoc, _defaults.hitsPerCall ); if ( _debug ) { console.log( 'Current API Call URL: ', currUrl ); } _promise = viewer.helper.getRemoteData( currUrl ); currBtn.find( _defaults.hitContentLoaderSelector ).css( 'display', 'inline-block' ); // get data and render hits if data is valid _promise.then( function( data ) { if ( data.hitsDisplayed &lt; _defaults.hitsPerCall ) { // render child hits into the DOM _renderChildHits( data, currBtn ); // set current button active, remove loader and show content currBtn.toggleClass( 'in' ).find( _defaults.hitContentLoaderSelector ).hide(); currBtn.next().show(); // set event to toggle current hits currBtn.off().on( 'click', function() { $( this ).toggleClass( 'in' ).next().slideToggle(); } ); } else { // remove loader currBtn.find( _defaults.hitContentLoaderSelector ).hide(); // set event to toggle current hits currBtn.off().on( 'click', function() { // render child hits into the DOM _renderChildHits( data, currBtn ); // check if more children exist and render link _renderGetMoreChildren( data, currIdDoc, currBtn ); $( this ).toggleClass( 'in' ).next().slideToggle(); } ); } } ).then( null, function() { currBtn.next().append( viewer.helper.renderAlert( 'alert-danger', '&lt;strong&gt;Status: &lt;/strong&gt;' + error.status + ' ' + error.statusText, false ) ); console.error( 'ERROR: viewer.searchList.init - ', error ); } ); } ); }, }; /** * Method to get the full REST-API URL. * * @method _getApiUrl * @param {String} id The current IDDoc of the hit set. * @returns {String} The full REST-API URL. */ function _getApiUrl( id, hits ) { if ( _debug ) { console.log( '---------- _getApiUrl() ----------' ); console.log( '_getApiUrl: id = ', id ); } return _defaults.contextPath + _defaults.restApiPath + id + '/' + hits + '/'; } /** * Method which renders the child hits into the DOM. * * @method _renderChildHits * @param {Object} data The data object which contains the child hits. * @param {Object} $this The current child hits trigger. * @returns {Object} An jquery object which contains the child hits. */ function _renderChildHits( data, $this ) { if ( _debug ) { console.log( '---------- _renderChildHits() ----------' ); console.log( '_renderChildHits: data = ', data ); console.log( '_renderChildHits: $this = ', $this ); } var hitSet = null; // clean hit sets $this.next().empty(); // build hits $.each( data.children, function( children, child ) { hitSet = $( '&lt;div class=&quot;search-list__hit-content-set&quot; /&gt;' ); // build title hitSet.append( _renderHitSetTitle( child.browseElement ) ); // append metadata if exist hitSet.append( _renderMetdataInfo( child.foundMetadata, child.url ) ); // build child hits if ( child.hasChildren ) { $.each( child.children, function( subChildren, subChild ) { hitSet.append( _renderSubChildHits( subChild.browseElement, subChild.type ) ); } ); } // append complete set $this.next().append( hitSet ); } ); } /** * Method which renders the hit set title. * * @method _renderHitSetTitle * @param {Object} data The data object which contains the hit set title values. * @returns {Object} A jquery object which contains the hit set title. */ function _renderHitSetTitle( data ) { if ( _debug ) { console.log( '---------- _renderHitSetTitle() ----------' ); console.log( '_renderHitSetTitle: data = ', data ); } var hitSetTitle = null; var hitSetTitleH5 = null; var hitSetTitleDl = null; var hitSetTitleDt = null; var hitSetTitleDd = null; var hitSetTitleLink = null; hitSetTitle = $( '&lt;div class=&quot;search-list__struct-title&quot; /&gt;' ); hitSetTitleH5 = $( '&lt;h5 /&gt;' ); hitSetTitleLink = $( '&lt;a /&gt;' ); hitSetTitleLink.attr( 'href', _defaults.contextPath + '/' + data.url ); hitSetTitleLink.append( data.labelShort ); hitSetTitleH5.append( hitSetTitleLink ); hitSetTitle.append( hitSetTitleH5 ); return hitSetTitle; } /** * Method which renders metadata info. * * @method _renderMetdataInfo * @param {Object} data The data object which contains the sub hit values. * @param {String} url The URL for the current work. * @returns {Object} A jquery object which contains the metadata info. */ function _renderMetdataInfo( data, url ) { if ( _debug ) { console.log( '---------- _renderMetdataInfo() ----------' ); console.log( '_renderMetdataInfo: data = ', data ); console.log( '_renderMetdataInfo: url = ', url ); } var metadataWrapper = null; var metadataTable = null; var metadataTableBody = null; var metadataTableRow = null; var metadataTableCellLeft = null; var metadataTableCellRight = null; var metadataKeyIcon = null; var metadataKeyLink = null; var metadataValueLink = null; if ( !$.isEmptyObject( data ) ) { metadataWrapper = $( '&lt;div class=&quot;search-list__metadata-info&quot; /&gt;' ); metadataTable = $( '&lt;table /&gt;' ); metadataTableBody = $( '&lt;tbody /&gt;' ); data.forEach( function( metadata ) { // left cell metadataTableCellLeft = $( '&lt;td /&gt;' ); metadataKeyIcon = $( '&lt;i /&gt;' ).attr( 'aria-hidden', 'true' ).addClass( 'fa fa-bookmark-o' ); metadataKeyLink = $( '&lt;a /&gt;' ).attr( 'href', _defaults.contextPath + '/' + url ).html( metadata.one + ':' ); metadataTableCellLeft.append( metadataKeyIcon ).append( metadataKeyLink ); // right cell metadataTableCellRight = $( '&lt;td /&gt;' ); metadataValueLink = $( '&lt;a /&gt;' ).attr( 'href', _defaults.contextPath + '/' + url ).html( metadata.two ); metadataTableCellRight.append( metadataValueLink ); // row metadataTableRow = $( '&lt;tr /&gt;' ); metadataTableRow.append( metadataTableCellLeft ).append( metadataTableCellRight ); // body metadataTableBody.append( metadataTableRow ); } ); metadataTable.append( metadataTableBody ); metadataWrapper.append( metadataTable ); return metadataWrapper; } } /** * Method which renders sub child hits. * * @method _renderSubChildHits * @param {Object} data The data object which contains the sub hit values. * @param {String} type The type of hit to render. * @returns {Object} A jquery object which contains the sub child hits. */ function _renderSubChildHits( data, type ) { if ( _debug ) { console.log( '---------- _renderSubChildHits() ----------' ); console.log( '_renderSubChildHits: data = ', data ); console.log( '_renderSubChildHits: type = ', type ); } var hitSetChildren = null; var hitSetChildrenDl = null; var hitSetChildrenDt = null; var hitSetChildrenDd = null; var hitSetChildrenLink = null; hitSetChildren = $( '&lt;div class=&quot;search-list__struct-child-hits&quot; /&gt;' ); hitSetChildrenDl = $( '&lt;dl class=&quot;dl-horizontal&quot; /&gt;' ); hitSetChildrenDt = $( '&lt;dt /&gt;' ); // check hit type switch ( type ) { case 'PAGE': hitSetChildrenDt.append( '&lt;i class=&quot;fa fa-file-text&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;' ); break; case 'PERSON': hitSetChildrenDt.append( '&lt;i class=&quot;fa fa-user&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;' ); break; case 'CORPORATION': hitSetChildrenDt.append( '&lt;i class=&quot;fa fa-university&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;' ); break; case 'LOCATION': hitSetChildrenDt.append( '&lt;i class=&quot;fa fa-location-arrow&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;' ); break; case 'SUBJECT': hitSetChildrenDt.append( '&lt;i class=&quot;fa fa-question-circle-o&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;' ); break; case 'PUBLISHER': hitSetChildrenDt.append( '&lt;i class=&quot;fa fa-copyright&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;' ); break; case 'EVENT': hitSetChildrenDt.append( '&lt;i class=&quot;fa fa-calendar&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;' ); break; case 'ACCESSDENIED': hitSetChildrenDt.append( '&lt;i class=&quot;fa fa-lock&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;' ); break; } hitSetChildrenDd = $( '&lt;dd /&gt;' ); hitSetChildrenLink = $( '&lt;a /&gt;' ).attr( 'href', _defaults.contextPath + '/' + data.url ); switch ( type ) { case 'PAGE': case 'ACCESSDENIED': hitSetChildrenLink.append( data.fulltextForHtml ); break; default: hitSetChildrenLink.append( data.labelShort ); break; } hitSetChildrenDd.append( hitSetChildrenLink ); hitSetChildrenDl.append( hitSetChildrenDt ).append( hitSetChildrenDd ); hitSetChildren.append( hitSetChildrenDl ); return hitSetChildren; } /** * Method to render a get more children link. * * @method _renderGetMoreChildren */ function _renderGetMoreChildren( data, iddoc, $this ) { if ( _debug ) { console.log( '---------- _renderGetMoreChildren() ----------' ); console.log( '_renderGetMoreChildren: data = ', data ); console.log( '_renderGetMoreChildren: iddoc = ', iddoc ); console.log( '_renderGetMoreChildren: $this = ', $this ); } var apiUrl = _getApiUrl( iddoc, _defaults.hitsPerCall + data.hitsDisplayed ); var hitContentMore = $( '&lt;div /&gt;' ); var getMoreChildrenLink = $( '&lt;button type=&quot;button&quot; /&gt;' ); if ( data.hasMoreChildren ) { // build get more link hitContentMore.addClass( 'search-list__hit-content-more' ); getMoreChildrenLink.addClass( 'btn-clean' ); getMoreChildrenLink.attr( 'data-api', apiUrl ); getMoreChildrenLink.attr( 'data-iddoc', iddoc ); getMoreChildrenLink.append( _defaults.msg.getMoreChildren ); hitContentMore.append( getMoreChildrenLink ); // append links $this.next().append( hitContentMore ); // render new hit set getMoreChildrenLink.off().on( 'click', function( event ) { var currApiUrl = $( this ).attr( 'data-api' ); var parentOffset = $this.parent().offset().top; // get data and render hits if data is valid _promise = viewer.helper.getRemoteData( currApiUrl ); _promise.then( function( data ) { // render child hits into the DOM _renderChildHits( data, $this ); // check if more children exist and render link _renderGetMoreChildren( data, iddoc, $this ); } ).then( null, function() { $this.next().append( viewer.helper.renderAlert( 'alert-danger', '&lt;strong&gt;Status: &lt;/strong&gt;' + error.status + ' ' + error.statusText, false ) ); console.error( 'ERROR: _renderGetMoreChildren - ', error ); } ); } ); } else { // clear and hide current get more link $this.next().find( _defaults.hitContentMoreSelector ).empty().hide(); console.info( '_renderGetMoreChildren: No more child hits available' ); return false; } } return viewer; } )( viewerJS || {}, jQuery ); var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _selectedSorting = ''; var _dataSortFieldState = ''; var _currUrl = ''; var _valueUrl = ''; var _checkValUrl = ''; var _dataSortField = ''; var _defaults = { select: '#sortSelect', }; viewer.searchSortingDropdown = { /** * Method to initialize the search sorting widget. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {Object} config.select An jQuery object which holds the sorting menu. */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.searchSortingDropdown.init' ); console.log( '##############################' ); console.log( 'viewer.searchSortingDropdown.init: config = ', config ); } $.extend( true, _defaults, config ); if ( viewer.localStoragePossible ) { _selectedSorting = localStorage.dataSortField; _currUrl = location.href; // get selected sorting type from local storage an set the menu option to // selected if ( _selectedSorting !== '' || _selectedSorting !== 'undefinded' ) { $( _defaults.select ).children( 'option' ).each( function() { _dataSortFieldState = $( this ).attr( 'data-sortField' ); _checkValUrl = $( this ).val(); if ( _dataSortFieldState === _selectedSorting &amp;&amp; _checkValUrl === _currUrl ) { $( this ).attr( 'selected', 'selected' ); } } ); } // get the sorting URL from the option value and reload the page on change $( _defaults.select ).on( 'change', function() { _valueUrl = $( this ).val(); _dataSortField = $( this ).children( 'option:selected' ).attr( 'data-sortField' ); if ( _valueUrl !== '' ) { // save current sorting state to local storage if ( typeof ( Storage ) !== &quot;undefined&quot; ) { localStorage.dataSortField = _dataSortField; } else { console.info( 'Local Storage is not defined. Current sorting state could not be saved.' ); return false; } window.location.href = _valueUrl; } } ); } else { return false; } }, }; return viewer; } )( viewerJS || {}, jQuery ); var viewerJS = ( function( viewer ) { 'use strict'; var _box = null; var _imgpath = null; var _imgname = null; viewer.simpleLightBox = { /** * Initializes an event (click) which renders a lightbox with an bigger image. * * @method init * @example * * &lt;pre&gt; * viewerJS.simpleLightBox.init(); * &lt;/pre&gt; * */ init: function() { // eventlisteners $( '.lightbox-image' ).on( 'click', function( event ) { event.preventDefault(); var $this = $( this ); _imgpath = _getImagePath( $this ); _imgname = _getImageName( $this ); _box = _setupLightBox( _imgpath, _imgname ); $( 'body' ).append( _box ); _centerModalBox( $( '.lightbox-modal-box' ) ); $( '.lightbox-overlay' ).fadeIn(); $( '.lightbox-close-btn' ).on( 'click', function() { $( '.lightbox-overlay' ).remove(); } ); } ); } }; /** * Returns the image path from the 'data-imgpath' attribute. * * @method _getImagePath * @param {Object} $Obj Must be a jQuery-Object like $('.something') * @returns {String} The image path from the 'data-imgpath' attribute. * */ function _getImagePath( $Obj ) { _imgpath = $Obj.attr( 'data-imgpath' ); return _imgpath; } /** * Returns the image name from the 'data-imgname' attribute. * * @method _getImageName * @param {Object} $Obj Must be a jQuery-Object like $('.something') * @returns {String} The image name from the 'data-imgname' attribute. * */ function _getImageName( $Obj ) { _imgname = $Obj.attr( 'data-imgname' ); return _imgname; } /** * Returns a HTML-String which renders the lightbox. * * @method _setupLightBox * @param {String} path The path to the big image. * @param {String} name The name of the big image. * @returns {String} The HTML-Code to render the lightbox. * */ function _setupLightBox( path, name ) { var lightbox = ''; lightbox = '&lt;div class=&quot;lightbox-overlay&quot;&gt;'; lightbox += '&lt;div class=&quot;lightbox-modal-box&quot;&gt;'; lightbox += '&lt;div class=&quot;lightbox-close&quot;&gt;'; lightbox += '&lt;span class=&quot;lightbox-close-btn&quot; title=&quot;Fenster schlie&amp;szlig;en&quot;&gt;&amp;times;&lt;/span&gt;'; lightbox += '&lt;/div&gt;'; lightbox += '&lt;img src=&quot;' + path + name + '&quot; alt=&quot;' + name + '&quot; /&gt;&lt;/div&gt;&lt;/div&gt;'; return lightbox; } /** * Puts the lightbox to the center of the screen. * * @method _centerModalBox * @param {Object} $Obj Must be a jQuery-Object like $('.something') */ function _centerModalBox( $Obj ) { var boxWidth = $Obj.outerWidth(); var boxHeight = $Obj.outerHeight(); $Obj.css( { 'margin-top': '-' + boxHeight / 2 + 'px', 'margin-left': '-' + boxWidth / 2 + 'px' } ); } return viewer; } )( viewerJS || {}, jQuery ); var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _imgWidth = null; var _imgHeight = null; var _defaults = { thumbs: '.stacked-thumbnail', thumbsBefore: '.stacked-thumbnail-before', thumbsAfter: '.stacked-thumbnail-after', }; viewer.stackedThumbnails = { /** * Method to initialize the timematrix slider and the events which builds the * matrix and popovers. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {Object} config.thumbs All jQuery objects of the stacked thumbnails. * @param {String} config.thumbsBefore The classname of the stacked thumbnail * before element. * @param {String} config.thumbsAfter The classname of the stacked thumbnail after * element. */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.stackedThumbnails.init' ); console.log( '##############################' ); console.log( 'viewer.stackedThumbnails.init: config - ' ); console.log( config ); } $.extend( true, _defaults, config ); // hide stacked thumbs $( _defaults.thumbs ).hide(); $( _defaults.thumbs ).siblings().hide(); // iterate through thumbnails and set width and height for image stack $( _defaults.thumbs ).each( function() { _imgWidth = $( this ).outerWidth(); _imgHeight = $( this ).outerHeight(); $( this ).css( { 'margin-left': '-' + ( _imgWidth / 2 ) + 'px' } ); $( this ).siblings().css( { 'width': _imgWidth, 'height': _imgHeight, 'margin-left': '-' + ( _imgWidth / 2 ) + 'px' } ); // show stacked thumbs after building them $( this ).show(); $( this ).siblings( _defaults.thumbsBefore ).fadeIn( 'slow', function() { $( this ).siblings( _defaults.thumbsAfter ).fadeIn(); } ); } ); }, }; return viewer; } )( viewerJS || {}, jQuery ); var viewerJS = ( function( viewer ) { 'use strict'; // default variables var _debug = false; var _promise = null; var _apiData = null; var _defaults = { contextPath: null, apiQuery: 'api?action=timeline', startDateQuery: '&amp;startDate=', rangeInput1: null, startDate: null, endDateQuery: '&amp;endDate=', rangeInput2: null, endDate: null, countQuery: '&amp;count=', count: null, $tmCanvas: null, $tmCanvasPos: null, $tmCanvasCoords: {}, lang: {} }; viewer.timematrix = { /** * Method to initialize the timematrix slider and the events which builds the * matrix and popovers. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {String} config.contextPath The rootpath of the application. * @param {String} config.apiQuery The API action to call. * @param {String} config.startDateQuery The GET-Parameter for the start date. * @param {Object} config.rangeInput1 An jQuery object of the first range input. * @param {String} config.startDate The value of the first range input. * @param {String} config.endDateQuery The GET-Parameter for the end date. * @param {Object} config.rangeInput2 An jQuery object of the second range input. * @param {String} config.endDate The value of the second range input. * @param {String} config.countQuery The GET-Parameter for the count query. * @param {String} config.count The number of results from the query. * @param {Object} config.$tmCanvas An jQuery object of the timematrix canvas. * @param {Object} config.$tmCanvasPos An jQuery object of the timematrix canvas * position. * @param {Object} config.lang An object of localized strings. * @example * * &lt;pre&gt; * $( document ).ready( function() { * var timematrixConfig = { * path: '#{request.contextPath}/', * lang: { * closeWindow: '#{msg.timematrixCloseWindow}', * goToWork: '#{msg.timematrixGoToWork}' * } * }; * viewerJS.timematrix.init( timematrixConfig ); * } ); * &lt;/pre&gt; */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.timematrix.init' ); console.log( '##############################' ); console.log( 'viewer.timematrix.init: config - ' ); console.log( config ); } $.extend( true, _defaults, config ); _defaults.$tmCanvasCoords = { top: _defaults.$tmCanvasPos.top, left: 0, right: _defaults.$tmCanvasPos.left + _defaults.$tmCanvas.outerWidth() }; // range slider settings $( '#slider-range' ).slider( { range: true, min: parseInt( _defaults.startDate ), max: parseInt( _defaults.endDate ), values: [ parseInt( _defaults.startDate ), parseInt( _defaults.endDate ) ], slide: function( event, ui ) { _defaults.rangeInput1.val( ui.values[ 0 ] ); $( '.timematrix-slider-bubble-startDate' ).html( ui.values[ 0 ] ); _defaults.startDate = ui.values[ 0 ]; _defaults.rangeInput1.val( ui.values[ 1 ] ); $( '.timematrix-slider-bubble-endDate' ).html( ui.values[ 1 ] ); _defaults.endDate = ui.values[ 1 ]; } } ); // append slider bubble to slider handle $( '#slider-range .ui-slider-range' ).next().append( _renderSliderBubble( 'startDate', _defaults.startDate ) ); $( '#slider-range .ui-slider-range' ).next().next().append( _renderSliderBubble( 'endDate', _defaults.endDate ) ); // set active slider handle to top $( '.ui-slider-handle' ).on( 'mousedown', function() { $( '.ui-slider-handle' ).removeClass( 'top' ); $( this ).addClass( 'top' ); } ); // listen to submit event of locate timematrix form $( '#locateTimematrix' ).on( 'submit', function( e ) { e.preventDefault(); // check for popovers and remove them if ( $( '.timematrix-popover' ).length ) { $( '.timematrix-popover' ).remove(); } // build api target var apiTarget = _defaults.contextPath; apiTarget += _defaults.apiQuery; apiTarget += _defaults.startDateQuery; apiTarget += _defaults.startDate; apiTarget += _defaults.endDateQuery; apiTarget += _defaults.endDate; apiTarget += _defaults.countQuery; apiTarget += _defaults.count; // get data from api _promise = viewer.helper.getRemoteData( apiTarget ); // render thumbnails _promise.then( function( data ) { _apiData = data; _defaults.$tmCanvas.html( _renderThumbs( _apiData ) ); $( '.timematrix-thumb' ).css( { height: $( '.timematrix-thumb' ).outerWidth() } ); // show thumbs after theyÂ´ve been loaded $( '.timematrix-thumb img' ).load( function() { $( this ).css( { visibility: 'visible' } ); } ); // listen to click event on thumbnails $( '.timematrix-thumb' ).on( 'click', function() { if ( !$( '.timematrix-popover' ) ) { $( '.timematrix-thumb' ).removeClass( 'marker' ); $( this ).addClass( 'marker' ); _renderPopover( $( this ), _defaults.lang ); } else { $( '.timematrix-popover' ).remove(); $( '.timematrix-thumb' ).removeClass( 'marker' ); $( this ).addClass( 'marker' ); _renderPopover( $( this ), _defaults.lang ); } // close popover $( '.timematrix-popover-close' ).on( 'click', function() { $( this ).parent().remove(); $( '.timematrix-thumb' ).removeClass( 'marker' ); } ); // check if image is loaded and reset loader $( '.timematrix-popover-body img' ).load( function() { $( '.timematrix-popover-imageloader' ).hide(); } ); } ); } ).then( null, function() { _defaults.$tmCanvas.append( viewer.helper.renderAlert( 'alert-danger', '&lt;strong&gt;Status: &lt;/strong&gt;' + error.status + ' ' + error.statusText, false ) ); console.error( 'ERROR: viewer.timematrix.init - ', error ); } ) } ); // remove all popovers by clicking on body $( 'body' ).on( 'click', function( event ) { if ( $( event.target ).closest( '.timematrix-thumb' ).length ) { return; } else { _removePopovers(); } } ); } }; /** * Method to render image thumbnails to the timematrix canvas. * * @method _renderThumbs * @param {Object} json An JSON-Object which contains the image data. * @returns {String} HTML-String which displays the image thumbnails. */ function _renderThumbs( json ) { if ( _debug ) { console.log( 'viewer.timematrix _renderThumbs: json - ' ); console.log( json ); } var tlbox = ''; tlbox += '&lt;div class=&quot;timematrix-box&quot;&gt;'; tlbox += '&lt;header class=&quot;timematrix-header&quot;&gt;'; if ( _defaults.startDate !== '' &amp;&amp; _defaults.endDate !== '' ) { tlbox += '&lt;h3&gt;' + _defaults.startDate + ' - ' + _defaults.endDate + '&lt;/h3&gt;'; } tlbox += '&lt;/header&gt;'; tlbox += '&lt;section class=&quot;timematrix-body&quot;&gt;'; $.each( json, function( i, j ) { tlbox += '&lt;div class=&quot;timematrix-thumb&quot; data-title=&quot;' + j.title + '&quot; data-mediumimage=&quot;' + j.mediumimage + '&quot; data-url=&quot;' + j.url + '&quot;&gt;'; if ( j.thumbnailUrl ) { tlbox += '&lt;img src=&quot;' + j.thumbnailUrl + '&quot; style=&quot;visibility: hidden;&quot; /&gt;'; } else { tlbox += ''; } tlbox += '&lt;/div&gt;'; } ); tlbox += '&lt;/section&gt;'; tlbox += '&lt;footer class=&quot;timematrix-footer&quot;&gt;&lt;/footer&gt;'; tlbox += '&lt;/div&gt;'; return tlbox; } /** * Method to render a popover with a thumbnail image. * * @method _renderPopover * @param {Object} $Obj Must be an jQuery-Object like $(this). * @param {Object} lang An Object with localized strings in the selected language. */ function _renderPopover( $Obj, lang ) { if ( _debug ) { console.log( 'viewer.timematrix _renderPopover: obj - ' ); console.log( $Obj ); console.log( 'viewer.timematrix _renderPopover: lang - ' + lang ); } var title = $Obj.attr( 'data-title' ); var mediumimage = $Obj.attr( 'data-mediumimage' ); var url = $Obj.attr( 'data-url' ); var $objPos = $Obj.position(); var $objCoords = { top: $objPos.top, left: $objPos.left, width: $Obj.outerWidth() }; var popoverPos = _calculatePopoverPosition( $objCoords, _defaults.$tmCanvasCoords ); var popover = ''; popover += '&lt;div class=&quot;timematrix-popover&quot; style=&quot;top: ' + popoverPos.top + 'px; left: ' + popoverPos.left + 'px;&quot;&gt;'; popover += '&lt;span class=&quot;timematrix-popover-close&quot; title=&quot;' + lang.closeWindow + '&quot;&gt;&amp;times;&lt;/span&gt;'; popover += '&lt;header class=&quot;timematrix-popover-header&quot;&gt;'; popover += '&lt;h4 title=&quot;' + title + '&quot;&gt;' + viewer.helper.truncateString( title, 75 ) + '&lt;/h4&gt;'; popover += '&lt;/header&gt;'; popover += '&lt;section class=&quot;timematrix-popover-body&quot;&gt;'; popover += '&lt;div class=&quot;timematrix-popover-imageloader&quot;&gt;&lt;/div&gt;'; popover += '&lt;a href=&quot;' + url + '&quot;&gt;&lt;img src=&quot;' + mediumimage + '&quot; /&gt;&lt;/a&gt;'; popover += '&lt;/section&gt;'; popover += '&lt;footer class=&quot;timematrix-popover-footer&quot;&gt;'; popover += '&lt;a href=&quot;' + url + '&quot; title=&quot;' + title + '&quot;&gt;' + lang.goToWork + '&lt;/a&gt;'; popover += '&lt;/footer&gt;'; popover += '&lt;/div&gt;'; _defaults.$tmCanvas.append( popover ); } /** * Method which calculates the position of the popover. * * @method _calculatePopoverPosition * @param {Object} triggerCoords An object which contains the coordinates of the * element has been clicked. * @param {Object} tmCanvasCoords An object which contains the coordinates of the * wrapper element from the timematrix. * @returns {Object} An object which contains the top and the left position of the * popover. */ function _calculatePopoverPosition( triggerCoords, tmCanvasCoords ) { if ( _debug ) { console.log( 'viewer.timematrix _calculatePopoverPosition: triggerCoords - ' ); console.log( triggerCoords ); console.log( 'viewer.timematrix _calculatePopoverPosition: tmCanvasCoords - ' ); console.log( tmCanvasCoords ); } var poLeftBorder = triggerCoords.left - ( 150 - ( triggerCoords.width / 2 ) ); var poRightBorder = poLeftBorder + 300; var tbLeftBorder = tmCanvasCoords.left; var tbRightBorder = tmCanvasCoords.right; var poTop; var poLeft = poLeftBorder; poTop = ( triggerCoords.top + $( '.timematrix-thumb' ).outerHeight() ) - 1; if ( poLeftBorder &lt;= tbLeftBorder ) { poLeft = tbLeftBorder; } if ( poRightBorder &gt;= tbRightBorder ) { poLeft = tmCanvasCoords.right - 300; } return { top: poTop, left: poLeft }; } /** * Method which renders the bubbles for the slider. * * @method _renderSliderBubble * @param {String} time The string for the time value. * @param {String} val The string for the value. * @returns {String} HTML-String which renders the slider-bubble. */ function _renderSliderBubble( time, val ) { if ( _debug ) { console.log( 'viewer.timematrix _renderSliderBubble: time - ' + time ); console.log( 'viewer.timematrix _renderSliderBubble: val - ' + val ); } return '&lt;div class=&quot;timematrix-slider-bubble-' + time + '&quot;&gt;' + val + '&lt;/div&gt;'; } /** * Method which removes all popovers. * * @method _removePopovers */ function _removePopovers() { if ( _debug ) { console.log( '---------- _removePopovers() ----------' ); } $( '.timematrix-popover' ).remove(); $( '.timematrix-thumb' ).removeClass( 'marker' ); } return viewer; } )( viewerJS || {}, jQuery ); var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _defaults = { currLang: 'de', selector: 'textarea.tinyMCE', width: '100%', height: 400, theme: 'modern', plugins: 'print preview paste searchreplace autolink directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount spellchecker imagetools media contextmenu colorpicker textpattern help', toolbar: 'formatselect | undo redo | bold italic underline strikethrough forecolor backcolor | link | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | fullscreen code', menubar: false, statusbar: false, pagebreak_separator: '&lt;span class=&quot;pagebreak&quot;&gt;&lt;/span&gt;', relative_urls: false, force_br_newlines: false, force_p_newlines: false, forced_root_block: '', language: 'de' }; viewer.tinyMce = { init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.tinyMce.init' ); console.log( '##############################' ); console.log( 'viewer.tinyMce.init: config - ', config ); } $.extend( true, _defaults, config ); // check current language switch ( _defaults.currLang ) { case 'de': _defaults.language = 'de'; break; case 'es': _defaults.language = 'es'; break; case 'pt': _defaults.language = 'pt_PT'; break; case 'ru': _defaults.language = 'ru'; break; } // init editor tinymce.init( _defaults ); }, overview: function() { // check if description or publication editing is enabled and // set fullscreen options if ( $( '.overview__description-editor' ).length &gt; 0 ) { viewerJS.tinyConfig.setup = function( editor ) { editor.on( 'init', function( e ) { $( '.overview__publication-action .btn' ).hide(); } ); editor.on( 'FullscreenStateChanged', function( e ) { if ( e.state ) { $( '.overview__description-action-fullscreen' ).addClass( 'in' ); } else { $( '.overview__description-action-fullscreen' ).removeClass( 'in' ); } } ); }; } else { viewerJS.tinyConfig.setup = function( editor ) { editor.on( 'init', function( e ) { $( '.overview__description-action .btn' ).hide(); } ); editor.on( 'FullscreenStateChanged', function( e ) { if ( e.state ) { $( '.overview__publication-action-fullscreen' ).addClass( 'in' ); } else { $( '.overview__publication-action-fullscreen' ).removeClass( 'in' ); } } ); }; } }, }; return viewer; } )( viewerJS || {}, jQuery ); var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _bookselfDropdown = false; var _defaults = {}; viewer.userDropdown = { init: function() { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.userDropdown.init' ); console.log( '##############################' ); } // check if bookshelfdropdown exist if ( $( '.bookshelf-navigation__dropdown' ).length &gt; 0 ) { _bookselfDropdown = true; } // login dropdown $( '[data-toggle=&quot;login-dropdown&quot;]' ).on( 'click', function( event ) { event.stopPropagation(); // hide bookshelfdropdow if exist if ( _bookselfDropdown ) { $( '.bookshelf-navigation__dropdown' ).hide(); $( '.bookshelf-popup' ).remove(); } // hide collection panel if exist if ( $( '.navigation__collection-panel' ).length &gt; 0 ) { $( '.navigation__collection-panel' ).hide(); } $( '.login-navigation__login-dropdown' ).slideToggle( 'fast' ); } ); // user dropdown $( '[data-toggle=&quot;user-dropdown&quot;]' ).on( 'click', function( event ) { event.stopPropagation(); // hide bookshelfdropdow if exist if ( _bookselfDropdown ) { $( '.bookshelf-navigation__dropdown' ).hide(); $( '.bookshelf-popup' ).remove(); } // hide collection panel if exist if ( $( '.navigation__collection-panel' ).length &gt; 0 ) { $( '.navigation__collection-panel' ).hide(); } $( '.login-navigation__user-dropdown' ).slideToggle( 'fast' ); } ); // retrieve account $( '[data-toggle=&quot;retrieve-account&quot;]' ).on( 'click', function() { $( '.login-navigation__retrieve-account' ).addClass( 'in' ); } ); $( '[data-dismiss=&quot;retrieve-account&quot;]' ).on( 'click', function() { $( '.login-navigation__retrieve-account' ).removeClass( 'in' ); } ); // remove dropdown by clicking on body $( 'body' ).on( 'click', function( event ) { var target = $( event.target ); var dropdown = $( '.login-navigation__user-dropdown, .login-navigation__login-dropdown' ); var dropdownChild = dropdown.find( '*' ); if ( !target.is( dropdown ) &amp;&amp; !target.is( dropdownChild ) ) { dropdown.hide(); } } ); } }; return viewer; } )( viewerJS || {}, jQuery ); var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _defaults = { versions: [], json: null, imgUrl: '', imgPi: '', versionLink: '', widgetInputs: '', widgetList: '', }; viewer.versionHistory = { /** * Method to initialize the version history widget. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {Array} config.versions An array which holds all versions. * @param {Object} config.json An JSON-Object which takes all versions. * @param {String} config.imgUrl The image URL for the current work. * @param {String} config.imgPi The PI for the image of the current work. * @param {String} config.versionLink A string placeholder for the final HTML. * @param {String} config.widgetInputs A string placeholder for the final HTML. * @param {String} config.widgetList A string placeholder for the final HTML. */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.versionHistory.init' ); console.log( '##############################' ); console.log( 'viewer.versionHistory.init: config = ', config ); } $.extend( true, _defaults, config ); // push versions into an array $( _defaults.widgetInputs ).each( function() { _defaults.versions.push( $( this ).val() ); } ); if ( _debug ) { console.log( 'viewer.versionHistory: versions = ', _defaults.versions ); } // append list elements to widget for ( var i = 0; i &lt; _defaults.versions.length; i++ ) { _defaults.json = JSON.parse( _defaults.versions[ i ] ); if ( _defaults.json.id === _defaults.imgPi ) { // Aktuell geÃ¶ffnete Version - kein Link _defaults.versionLink = '&lt;li&gt;&lt;span&gt;'; if ( _defaults.json.label != undefined &amp;&amp; _defaults.json.label != '' ) { _defaults.versionLink += _defaults.json.label; } else { _defaults.versionLink += _defaults.json.id; if ( _defaults.json.year != undefined &amp;&amp; _defaults.json.year != '' ) { _defaults.versionLink += ' (' + _defaults.json.year + ')'; } } _defaults.versionLink += '&lt;/span&gt;&lt;/li&gt;'; $( _defaults.widgetList ).append( _defaults.versionLink ); } else { // VorgÃ¤nger und Nachfolger jeweils mit Link _defaults.versionLink = '&lt;li&gt;&lt;a href=&quot;' + _defaults.imgUrl + '/' + _defaults.json.id + '/1/&quot;&gt;'; if ( _defaults.json.label != undefined &amp;&amp; _defaults.json.label != '' ) { _defaults.versionLink += _defaults.json.label; } else { _defaults.versionLink += _defaults.json.id; if ( _defaults.json.year != undefined &amp;&amp; _defaults.json.year != '' ) { _defaults.versionLink += ' (' + _defaults.json.year + ')'; } } _defaults.versionLink += '&lt;/a&gt;&lt;/li&gt;'; $( _defaults.widgetList ).append( _defaults.versionLink ); } } } }; return viewer; } )( viewerJS || {}, jQuery ); var cmsJS = ( function() { 'use strict'; var _debug = false; var cms = {}; /** * Method which initializes the CMS. * * @method init * @example * * &lt;pre&gt; * cmsJS.init(); * &lt;/pre&gt; */ cms.init = function() { if ( _debug ) { console.log( '##############################' ); console.log( 'cmsJS.init' ); console.log( '##############################' ); } // AJAX Loader Eventlistener jsf.ajax.addOnEvent( function( data ) { var ajaxstatus = data.status; // Can be &quot;begin&quot;, &quot;complete&quot; and &quot;success&quot; var ajaxloader = document.getElementById( &quot;AJAXLoader&quot; ); if ( ajaxloader ) { switch ( ajaxstatus ) { case &quot;begin&quot;: // This is called right before ajax request is been // sent. ajaxloader.style.display = 'block'; break; case &quot;complete&quot;: // This is called right after ajax response is // received. ajaxloader.style.display = 'none'; break; case &quot;success&quot;: // This is called when ajax response is successfully // processed. // NOOP. break; } } } ); }; cms.dataTables_de = { &quot;sEmptyTable&quot;: &quot;Keine Daten in der Tabelle vorhanden&quot;, &quot;sInfo&quot;: &quot;_START_ bis _END_ von _TOTAL_ EintrÃ¤gen&quot;, &quot;sInfoEmpty&quot;: &quot;0 bis 0 von 0 EintrÃ¤gen&quot;, &quot;sInfoFiltered&quot;: &quot;(gefiltert von _MAX_ EintrÃ¤gen)&quot;, &quot;sInfoPostFix&quot;: &quot;&quot;, &quot;sInfoThousands&quot;: &quot;.&quot;, &quot;sLengthMenu&quot;: &quot;_MENU_ EintrÃ¤ge anzeigen&quot;, &quot;sLoadingRecords&quot;: &quot;Wird geladen...&quot;, &quot;sProcessing&quot;: &quot;Bitte warten...&quot;, &quot;sSearch&quot;: &quot;Suchen&quot;, &quot;sZeroRecords&quot;: &quot;Keine EintrÃ¤ge vorhanden.&quot;, &quot;oPaginate&quot;: { &quot;sFirst&quot;: &quot;Erste&quot;, &quot;sPrevious&quot;: &quot;ZurÃ¼ck&quot;, &quot;sNext&quot;: &quot;NÃ¤chste&quot;, &quot;sLast&quot;: &quot;Letzte&quot; }, &quot;oAria&quot;: { &quot;sSortAscending&quot;: &quot;: aktivieren, um Spalte aufsteigend zu sortieren&quot;, &quot;sSortDescending&quot;: &quot;: aktivieren, um Spalte absteigend zu sortieren&quot; } }; cms.dataTables_en = { &quot;sEmptyTable&quot;: &quot;No data available in table&quot;, &quot;sInfo&quot;: &quot;Showing _START_ to _END_ of _TOTAL_ entries&quot;, &quot;sInfoEmpty&quot;: &quot;Showing 0 to 0 of 0 entries&quot;, &quot;sInfoFiltered&quot;: &quot;(filtered from _MAX_ total entries)&quot;, &quot;sInfoPostFix&quot;: &quot;&quot;, &quot;sInfoThousands&quot;: &quot;,&quot;, &quot;sLengthMenu&quot;: &quot;Show _MENU_ entries&quot;, &quot;sLoadingRecords&quot;: &quot;Loading...&quot;, &quot;sProcessing&quot;: &quot;Processing...&quot;, &quot;sSearch&quot;: &quot;Search:&quot;, &quot;sZeroRecords&quot;: &quot;No matching records found&quot;, &quot;oPaginate&quot;: { &quot;sFirst&quot;: &quot;First&quot;, &quot;sLast&quot;: &quot;Last&quot;, &quot;sNext&quot;: &quot;Next&quot;, &quot;sPrevious&quot;: &quot;Previous&quot; }, &quot;oAria&quot;: { &quot;sSortAscending&quot;: &quot;: activate to sort column ascending&quot;, &quot;sSortDescending&quot;: &quot;: activate to sort column descending&quot; } }; cms.dataTables_es = { &quot;sProcessing&quot;: &quot;Procesando...&quot;, &quot;sLengthMenu&quot;: &quot;Mostrar _MENU_ registros&quot;, &quot;sZeroRecords&quot;: &quot;No se encontraron resultados&quot;, &quot;sEmptyTable&quot;: &quot;NingÃºn dato disponible en esta tabla&quot;, &quot;sInfo&quot;: &quot;Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros&quot;, &quot;sInfoEmpty&quot;: &quot;Mostrando registros del 0 al 0 de un total de 0 registros&quot;, &quot;sInfoFiltered&quot;: &quot;(filtrado de un total de _MAX_ registros)&quot;, &quot;sInfoPostFix&quot;: &quot;&quot;, &quot;sSearch&quot;: &quot;Buscar:&quot;, &quot;sUrl&quot;: &quot;&quot;, &quot;sInfoThousands&quot;: &quot;,&quot;, &quot;sLoadingRecords&quot;: &quot;Cargando...&quot;, &quot;oPaginate&quot;: { &quot;sFirst&quot;: &quot;Primero&quot;, &quot;sLast&quot;: &quot;Ãšltimo&quot;, &quot;sNext&quot;: &quot;Siguiente&quot;, &quot;sPrevious&quot;: &quot;Anterior&quot; }, &quot;oAria&quot;: { &quot;sSortAscending&quot;: &quot;: Activar para ordenar la columna de manera ascendente&quot;, &quot;sSortDescending&quot;: &quot;: Activar para ordenar la columna de manera descendente&quot; } }; return cms; } )( jQuery ); var cmsJS = ( function( cms ) { 'use strict'; var _debug = false; var _previewStatus = ''; var _defaults = { selectedPageID: null, inputFields: null, prevBtn: null, prevDescription: null, saveBtn: null, sortablesConfig: {} }; cms.createPage = { /** * Method which initializes the CMS create page module. * * @method init * @param {Object} settings */ init: function( settings ) { if ( _debug ) { console.log( '##############################' ); console.log( 'cmsJS.createPage.init' ); console.log( '##############################' ); console.log( 'cmsJS.createPage.init: settings - ', settings ); } $.extend( true, _defaults, settings ); if ( _defaults.selectedPageID === null ) { cmsJS.createPage.disablePreview(); _defaults.prevDescription.show(); } // listen to changes on input fields _defaults.inputFields.on( 'change input paste', function() { cmsJS.createPage.disablePreview(); _defaults.prevDescription.show(); } ); cmsJS.createPage.initSortables( _defaults ); // set preview button status _previewStatus = localStorage.getItem( 'previewStatus' ); if ( _previewStatus === 'false' ) { _defaults.prevBtn.attr( 'disabled', true ); _defaults.prevDescription.show(); } else { _defaults.prevBtn.attr( 'disabled', false ); _defaults.prevDescription.hide(); _defaults.prevBtn.on( 'click', function() { var url = $( this ).attr( 'data-previewUrl' ); window.open( url, '_blank' ); } ); } }, /** * Method which * * @method initSortables * @param {Object} config */ initSortables: function( config ) { if ( _debug ) { console.log( 'cmsJS.createPage.initSortables: config - ', config ); } config.sortablesConfig.visibleItemList = $( config.sortablesConfig.visibleItemList ); config.sortablesConfig.availableItemList = $( config.sortablesConfig.availableItemList ); if ( config.sortablesConfig.availableItemList.length &gt; 0 ) { cmsJS.sortableList.init( 0, false, config ); config.sortablesConfig.editButton.on( 'click', function() { if ( $( this ).hasClass( 'glyphicon-edit' ) ) { $( this ).removeClass( 'glyphicon-edit' ).addClass( 'glyphicon-remove' ); } else { $( this ).removeClass( 'glyphicon-remove' ).addClass( 'glyphicon-edit' ); } $( this ).parent( '.sidebar-editor-widget-item-header' ).next( '.sidebar-editor-widget-item-body' ).slideToggle( 'slow' ); } ); config.sortablesConfig.availableItemList.on( 'sortbeforestop', function( event, ui ) { if ( $( ui.item ).parent().attr( 'id' ) === 'visibleItemList' ) { cmsJS.createPage.disablePreview(); } } ); config.sortablesConfig.visibleItemList.on( 'sortbeforestop', function() { cmsJS.createPage.disablePreview(); } ); } else { if ( _debug ) console.log( &quot;No sortable list elements available&quot; ); return false; } }, /** * Method which disables the preview button by setting a local storage value. * * @method disablePreview */ disablePreview: function() { if ( _debug ) { console.log( '---------- cmsJS.createPage.disablePreview() ----------' ); } localStorage.setItem( 'previewStatus', 'false' ); }, /** * Method which enables the preview button by setting a local storage value. * * @method enablePreview */ enablePreview: function() { if ( _debug ) { console.log( '---------- cmsJS.createPage.enablePreview() ----------' ); } localStorage.setItem( 'previewStatus', 'true' ); }, }; return cms; } )( cmsJS || {}, jQuery ); var cmsJS = ( function( cms ) { 'use strict'; // variables var _debug = false; var _map = {}; var _mapEnlarged = {}; var _features = []; var _centerCoords = []; var _defaults = { appUrl: '', locations: '', mapboxAccessToken: 'pk.eyJ1IjoibGlydW1nYnYiLCJhIjoiY2lobjRzamkyMDBnM3U5bTR4cHp0NDdyeCJ9.AjNCRBlBb57j-dziFxf58A', mapBoxContainerSelector: 'widgetGeoLocationsMap', mapBoxContainerEnlargedSelector: 'widgetGeoLocationsMapEnlarged', mapBoxStyle: 'mapbox://styles/lirumgbv/cii024wxn009aiolzgy2zlycj', msg: { propertiesLink: '' } }; cms.geoLocations = { init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'cms.geoLocations.init' ); console.log( '##############################' ); console.log( 'cms.geoLocations.init: config - ', config ); } $.extend( true, _defaults, config ); if ( $( '#widgetGeoLocationsMap' ).length &gt; 0 ) { mapboxgl.accessToken = _defaults.mapboxAccessToken; // get map data and infos _centerCoords = _getCenterCoords( _defaults.locations ); _features = _getMapFeatures( _defaults.locations ); // create map _map = new mapboxgl.Map( { container: _defaults.mapBoxContainerSelector, style: _defaults.mapBoxStyle, center: _centerCoords, zoom: 12.5, interactive: true } ); // build markers _map.on( 'style.load', function() { _map.addSource( &quot;markers&quot;, { &quot;type&quot;: &quot;geojson&quot;, &quot;data&quot;: { &quot;type&quot;: &quot;FeatureCollection&quot;, &quot;features&quot;: _features } } ); _map.addLayer( { &quot;id&quot;: &quot;markers&quot;, &quot;type&quot;: &quot;symbol&quot;, &quot;source&quot;: &quot;markers&quot;, &quot;layout&quot;: { &quot;icon-image&quot;: &quot;pin&quot;, &quot;icon-allow-overlap&quot;: true } } ); _map.addControl( new mapboxgl.FullscreenControl() ); _map.addControl( new mapboxgl.NavigationControl() ); } ); // add popups _map.on( 'click', 'markers', function( e ) { new mapboxgl.Popup().setLngLat( e.features[ 0 ].geometry.coordinates ).setHTML( e.features[ 0 ].properties.infos ).addTo( _map ); // GAUGS: save collection to local storage for slider use $( '.mapboxgl-popup-content a' ).on( 'click', function( event ) { event.preventDefault(); var url = $( this ).attr( 'href' ); var collection = $( this ).attr( 'data-collection' ); if ( collection === 'false' ) { localStorage.setItem( 'sliderImagesFrom', 0 ); } else { localStorage.setItem( 'sliderImagesFrom', collection ); } window.location.href = url; } ); } ); } } }; /** * Method which returns an object of map features. * * @method _getMapFeatures * @param {String} infos A JSON-String which contains the feature infos. * @returns {Array} An array of features. */ function _getMapFeatures( infos ) { if ( _debug ) { console.log( '---------- _getMapFeatures() ----------' ); console.log( '_getMapFeatures: infos - ', infos ); } var features = []; var collection = ''; var infos = JSON.parse( infos ); $.each( infos.locations, function( key, location ) { // GAUGS: special condition to get the right collection number for image // slider if ( location.link != undefined ) { if ( location.link.indexOf( '/sammlung/' ) != -1 ) { var str = location.link; collection = str.replace( '/sammlung/', '' ).replace( '/', '' ); } } var feature = { 'type': 'Feature', 'geometry': { 'type': 'Point', 'coordinates': [ location.longitude, location.latitude ] }, 'properties': { 'infos': location.infos + '&lt;br /&gt;&lt;a href=&quot;' + _defaults.appUrl + location.link + '&quot; data-collection=&quot;' + ( ( collection !== '' ) ? collection : 'false' ) + '&quot;&gt;' + _defaults.msg.propertiesLink + '&lt;/a&gt;' } } features.push( feature ); } ); return features; } /** * Method which returns an array of coordinates for centering the map. * * @method _getCenterCoords * @param {String} infos A JSON-String which contains the feature infos. * @returns {Array} An array of coords. */ function _getCenterCoords( infos ) { if ( _debug ) { console.log( '---------- _getCenterCoords() ----------' ); } var coords = []; var infos = JSON.parse( infos ); if ( infos.centerLocation.longitude != '' || infos.centerLocation.latitude != '' ) { coords.push( infos.centerLocation.longitude ); coords.push( infos.centerLocation.latitude ); } else { coords.push( infos.locations[ 0 ].longitude ); coords.push( infos.locations[ 0 ].latitude ); } return coords; } return cms; } )( cmsJS || {}, jQuery ); var cmsJS = ( function( cms ) { 'use strict'; // variables var _debug = false; var _data = null; var _lazyGrid = null; var _defaults = { $grid: null, loaderSelector: '.tpl-masonry__loader' }; // DOM-Elements var $gridItem = null; var $gridItemImage = null; var $gridItemImageLink = null; var $gridItemTitle = null; var $gridItemTitleLink = null; var $gridItemCaption = null; var $gridItemCaptionHeading = null; var $gridItemCaptionLink = null; cms.masonry = { /** * Method which initializes the Masonry Grid. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {Object} config.$grid An jQuery object which represents the grid * container. * @param {Object} data An data object which contains the images sources for the * grid. */ init: function( config, data ) { if ( _debug ) { console.log( '##############################' ); console.log( 'cmsJS.masonry.init' ); console.log( '##############################' ); console.log( 'cmsJS.masonry.init: config - ', config ); console.log( 'cmsJS.masonry.init: data - ', data ); } $.extend( true, _defaults, config ); // show loader $( _defaults.loaderSelector ).show(); // render grid _renderMasonryGrid( data ); // init masonry _lazyGrid = _defaults.$grid.imagesLoaded( function() { // init Masonry after all images have loaded _lazyGrid.masonry( { itemSelector: '.grid-item', columnWidth: '.grid-sizer', gutter: '.gutter-sizer', percentPosition: true } ); } ); // fade in grid after rendering _lazyGrid.on( 'layoutComplete', function( event, laidOutItems ) { // hide loader $( _defaults.loaderSelector ).hide(); // show images _defaults.$grid.addClass( 'ready' ); } ); } }; /** * Method which renders the masonry grid. * * @method _renderMasonryGrid * @param {Object} data An data object which contains the images sources for the grid. */ function _renderMasonryGrid( data ) { if ( _debug ) { console.log( '---------- _renderMasonryGrid() ----------' ); console.log( '_renderMasonryGrid: data = ', data ); } // create items data.items.forEach( function( item ) { // grid item $gridItem = $( '&lt;div /&gt;' ); if ( item.important ) { $gridItem.addClass( 'grid-item important' ); } else { $gridItem.addClass( 'grid-item' ); } // grid item title $gridItemTitle = $( '&lt;div /&gt;' ); if ( item.url !== '' ) { $gridItemTitleLink = $( '&lt;a /&gt;' ); $gridItemTitleLink.attr( 'href', item.url ); $gridItemTitleLink.attr( 'title', item.title ); } $gridItemTitle.addClass( 'grid-item-title' ); $gridItemTitle.text( item.title ); if ( item.url !== '' ) { $gridItemTitleLink.append( $gridItemTitle ); $gridItem.append( $gridItemTitleLink ); } else { $gridItem.append( $gridItemTitle ); } // grid item caption if ( item.caption !== '' ) { $gridItemCaption = $( '&lt;div /&gt;' ); $gridItemCaption.addClass( 'grid-item-caption' ); $gridItemCaption.html( item.caption ); // grid item caption heading $gridItemCaptionHeading = $( '&lt;h4 /&gt;' ); $gridItemCaptionHeading.text( item.title ); $gridItemCaption.prepend( $gridItemCaptionHeading ); if ( item.url !== '' ) { // grid item caption link $gridItemCaptionLink = $( '&lt;a /&gt;' ); $gridItemCaptionLink.attr( 'href', item.url ); $gridItemCaptionLink.attr( 'title', item.title ); // append to grid item $gridItemCaptionLink.append( $gridItemCaption ); $gridItem.append( $gridItemCaptionLink ); } else { $gridItem.append( $gridItemCaption ); } } // grid item image $gridItemImage = $( '&lt;img /&gt;' ); $gridItemImage.attr( 'src', item.name ); $gridItemImage.addClass( 'img-responsive' ); if ( item.url !== '' ) { // grid item image link $gridItemImageLink = $( '&lt;a /&gt;' ); $gridItemImageLink.attr( 'href', item.url ); $gridItemImageLink.attr( 'title', item.title ); $gridItemImageLink.append( $gridItemImage ); $gridItem.append( $gridItemImageLink ); } else { $gridItem.append( $gridItemImage ); } // append to grid _defaults.$grid.append( $gridItem ); } ); } return cms; } )( cmsJS || {}, jQuery ); var cmsJS = ( function( cms ) { 'use strict'; // variables var _debug = false; var _defaults = { rssFeedSelector: '.tpl-rss__feed', }; cms.rssFeed = { /** * Method which initializes the RSS Feed. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {Object} data An data object which contains the images sources for the * grid. */ init: function( config, data ) { if ( _debug ) { console.log( '##############################' ); console.log( 'cmsJS.rssFeed.init' ); console.log( '##############################' ); console.log( 'cmsJS.rssFeed.init: config - ', config ); console.log( 'cmsJS.rssFeed.init: data - ', data ); } $.extend( true, _defaults, config ); // render RSS Feed _renderRssFeed( data ); } }; /** * Method which renders the RSS feed into the DOM. * * @method _renderRssFeed * @param {Object} data The RSS information data object. */ function _renderRssFeed( data ) { if ( _debug ) { console.log( '---------- _renderRssFeed() ----------' ); console.log( '_renderRssFeed: data = ', data ); } // DOM elements var rssItem = null; var rssItemTitle = null; var rssItemTitleH3 = null; var rssItemTitleLink = null; var rssItemRow = null; var rssItemColLeft = null; var rssItemColRight = null; var rssItemImageWrapper = null; var rssItemImage = null; var rssItemImageLink = null; var rssItemDate = null; var rssItemTime = null; var rssItemMetadata = null; var rssItemMetadataKey = null; var rssItemMetadataValue = null; // create items data.items.forEach( function( item ) { // create item wrapper rssItem = $( '&lt;div /&gt;' ); rssItem.addClass( 'tpl-rss__item' ); // create item content rssItemRow = $( '&lt;div /&gt;' ).addClass( 'row' ); // left rssItemColLeft = $( '&lt;div /&gt;' ).addClass( 'col-xs-3' ); rssItemImageWrapper = $( '&lt;div /&gt;' ).addClass( 'tpl-rss__item-image' ); rssItemImageLink = $( '&lt;a /&gt;' ).attr( 'href', item.link ); rssItemImage = $( '&lt;img /&gt;' ).attr( 'src', item.description.image ).addClass( 'img-responsive' ); rssItemImageLink.append( rssItemImage ); rssItemImageWrapper.append( rssItemImageLink ); rssItemColLeft.append( rssItemImageWrapper ); // right rssItemColRight = $( '&lt;div /&gt;' ).addClass( 'col-xs-9' ); // create item title rssItemTitle = $( '&lt;div /&gt;' ).addClass( 'tpl-rss__item-title' ); rssItemTitleH3 = $( '&lt;h3 /&gt;' ); rssItemTitleLink = $( '&lt;a /&gt;' ).attr( 'href', item.link ).text( item.title ); rssItemTitleH3.append( rssItemTitleLink ); rssItemTitle.append( rssItemTitleH3 ); // create date rssItemDate = $( '&lt;div /&gt;' ).addClass( 'tpl-rss__item-date' ); rssItemTime = new Date( item.pubDate ); rssItemDate.text( rssItemTime.toLocaleString() ); // create metadata rssItemMetadata = $( '&lt;dl /&gt;' ).addClass( 'tpl-rss__item-metadata dl-horizontal' ); item.description.metadata.forEach( function( metadata ) { rssItemMetadataKey = $( '&lt;dt /&gt;' ).text( metadata.label + ':' ); rssItemMetadataValue = $( '&lt;dd /&gt;' ).text( metadata.value ); rssItemMetadata.append( rssItemMetadataKey ).append( rssItemMetadataValue ); } ); rssItemColRight.append( rssItemTitle ).append( rssItemDate ).append( rssItemMetadata ); // append to row rssItemRow.append( rssItemColLeft ).append( rssItemColRight ); // create item rssItem.append( rssItemRow ); $( _defaults.rssFeedSelector ).append( rssItem ); } ); } return cms; } )( cmsJS || {}, jQuery ); var cmsJS = ( function( cms ) { 'use strict'; var _debug = false; var _levelIndent = 0; var _allowMultipleOccurances = false; var _inputField = null; var _sortingAttribute = 'sortposition'; cms.sortableList = { /** * Method which initializes the CMS sortable list items and sets events. * * @method init * @param {String} indent * @param {Boolean} allowMultiple * @param {Object} config */ init: function( indent, allowMultiple, config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'cmsJS.sortableList.init' ); console.log( '##############################' ); console.log( 'cmsJS.sortableList.init: indent - ', indent ); console.log( 'cmsJS.sortableList.init: allowMultiple - ', allowMultiple ); console.log( 'cmsJS.sortableList.init: inputTextField - ', config.sortablesConfig.componentListInput ); } _levelIndent = indent; _allowMultipleOccurances = allowMultiple; _inputField = config.sortablesConfig.componentListInput; // validation if ( _inputField === null ) { console.warn( &quot;Input field for item order not found: No order information can be saved!&quot; ); } if ( config.sortablesConfig.visibleItemList.length === 0 ) { console.error( &quot;No container for active items found. Cannot initialize sortable&quot; ); } if ( config.sortablesConfig.availableItemList.length === 0 ) { console.error( &quot;No container for available items found. Cannot initialize sortable&quot; ); } _updateAllSortIcons(); if ( _debug ) console.log( &quot;Make sortable &quot;, config.sortablesConfig.visibleItemList ); config.sortablesConfig.visibleItemList.sortable( { update: _serializeVisibleItems, connectWith: &quot;#availableItemList&quot; } ); if ( _debug ) console.log( &quot;Make sortable &quot;, config.sortablesConfig.availableItemList ); config.sortablesConfig.availableItemList.sortable( { update: _serializeVisibleItems, connectWith: &quot;#visibleItemList&quot;, helper: &quot;clone&quot; } ); _serializeVisibleItems(); $( &quot;#availableItemList&quot; ).on( &quot;sortbeforestop&quot;, _handleBeforeDropFromAvailable ); $( &quot;#visibleItemList&quot; ).on( &quot;sortbeforestop&quot;, _handleBeforeDropFromVisible ); $( &quot;#availableItemList&quot; ).on( &quot;sortstop&quot;, _handleDrop ); $( &quot;#visibleItemList&quot; ).on( &quot;sortstop&quot;, _handleDrop ); }, /** * Method which * * @method decreaseLevel * @param {String} element * @param {String} applyToNext */ decreaseLevel: function( element, applyToNext ) { if ( _debug ) { console.log( 'cmsJS.sortableList.decreaseLevel: element - ', element ); console.log( 'cmsJS.sortableList.decreaseLevel: applyToNext - ', applyToNext ); } var item = _getJQueryItem( element ); var level; if ( _getLevel( item ) &gt; 0 ) { level = _changePos( item, -1 ); if ( applyToNext ) { var nextItem = item.next(); while ( nextItem !== null &amp;&amp; _getLevel( nextItem ) &gt; _getLevel( item ) + 1 ) { cms.sortableList.decreaseLevel( nextItem, false ); nextItem = nextItem.next(); } } } _serializeVisibleItems(); _updateAllSortIcons(); }, /** * Method which * * @method increaseLevel * @param {String} element * @param {String} applyToNext */ increaseLevel: function( element, applyToNext ) { if ( _debug ) { console.log( 'cmsJS.sortableList.increaseLevel: element - ', element ); console.log( 'cmsJS.sortableList.increaseLevel: applyToNext - ', applyToNext ); } var item = _getJQueryItem( element ); var prevItem = item.prev(); if ( _getLevel( item ) &lt;= _getLevel( prevItem ) ) { _changePos( item, 1 ); if ( applyToNext ) { var nextItem = item.next(); while ( nextItem !== null &amp;&amp; _getLevel( nextItem ) &gt;= _getLevel( item ) ) { cms.sortableList.increaseLevel( nextItem, false ); nextItem = nextItem.next(); } } } _serializeVisibleItems(); _updateAllSortIcons(); }, save: function( ajaxData ) { if ( typeof ajaxData === &quot;undefined&quot; || ajaxData.status === &quot;begin&quot; ) { _serializeVisibleItems(); } } }; /** * (Privat) Method which * * @method _handleBeforeDropFromAvailable * @param {String} event * @param {String} ui */ function _handleBeforeDropFromAvailable( event, ui ) { if ( _debug ) { console.log( 'cmsJS.sortableList _handleBeforeDropFromAvailable: event - ', event ); console.log( 'cmsJS.sortableList _handleBeforeDropFromAvailable: ui - ', ui ); } var $item = $( ui.item ); var $radioMenues = $item.find(&quot;table&quot;); $radioMenues.each(function(index, element) { var $checkboxes = $(element).find(&quot;input&quot;); if($checkboxes.length &gt; 0) { var anychecked = false; $checkboxes.each(function(index, element) { if($(element).prop('checked')) { anychecked = true; return false; } }) if(!anychecked) { $checkboxes.first().prop('checked', true); } } }) if ( _allowMultipleOccurances &amp;&amp; $item.parent().attr( &quot;id&quot; ) === &quot;visibleItemList&quot; ) { $item.clone().appendTo( $( &quot;#availableItemList&quot; ) ); } } /** * (Privat) Method which * * @method _handleBeforeDropFromAvailable * @param {String} event * @param {String} ui */ function _handleBeforeDropFromVisible( event, ui ) { if ( _debug ) { console.log( 'cmsJS.sortableList _handleBeforeDropFromVisible: event - ', event ); console.log( 'cmsJS.sortableList _handleBeforeDropFromVisible: ui - ', ui ); } var item = $( ui.item ); if ( _allowMultipleOccurances &amp;&amp; item.parent().attr( &quot;id&quot; ) === &quot;availableItemList&quot; ) { ui.item.remove(); } } /** * (Privat) Method which * * @method _handleDrop */ function _handleDrop() { if ( _debug ) { console.log( 'cmsJS.sortableList _handleDrop' ); } _updateAllSortIcons(); } /** * (Privat) Method which * * @method _updateAllSortIcons */ function _updateAllSortIcons() { if ( _debug ) { console.log( 'cmsJS.sortableList _updateAllSortIcons' ); } var childrenVL = $( &quot;#visibleItemList&quot; ).children( &quot;li&quot; ); childrenVL.each( function() { if ( $( this ).attr( _sortingAttribute ) != null ) { _updateSortIcons( $( this ) ); } } ); var childrenAL = $( &quot;#availableItemList&quot; ).children( &quot;li&quot; ); childrenAL.each( function() { if ( $( this ).attr( _sortingAttribute ) != null ) { _updateSortIcons( $( this ) ); } } ); } /** * (Privat) Method which * * @method _updateSortIcons * @param {Object} item */ function _updateSortIcons( item ) { if ( _debug ) { console.log( 'cmsJS.sortableList _updateSortIcons: item - ', item ); } var parent = item.parent(); if ( parent.attr( &quot;id&quot; ) === &quot;visibleItemList&quot; ) { item.children( '.menu-item__level' ).show(); if ( _getLevel( item.prev() ) === -1 ) { while ( _getLevel( item ) &gt; 0 ) { cms.sortableList.decreaseLevel( item ); } } if ( _getLevel( item ) === 0 ) { item.find( '.left' ).css( &quot;visibility&quot;, &quot;hidden&quot; ); item.find( '.right' ).css( &quot;visibility&quot;, &quot;hidden&quot; ); item.css( &quot;margin-left&quot;, &quot;0px&quot; ); } else { item.find( '.left' ).css( &quot;visibility&quot;, &quot;visible&quot; ); item.find( '.right' ).css( &quot;visibility&quot;, &quot;visible&quot; ); item.css( &quot;margin-left&quot;, _getLevel( item ) * _levelIndent + &quot;px&quot; ); } if ( _getLevel( item ) &gt; _getLevel( item.prev() ) ) { item.find( '.left' ).css( &quot;visibility&quot;, &quot;visible&quot; ); item.find( '.right' ).css( &quot;visibility&quot;, &quot;hidden&quot; ); } else { item.find( '.left' ).css( &quot;visibility&quot;, &quot;visible&quot; ); item.find( '.right' ).css( &quot;visibility&quot;, &quot;visible&quot; ); } } else { item.children( '.menu-item__level' ).hide(); } } /** * (Privat) Method which * * @method _getJQueryItem * @param {Object} element */ function _getJQueryItem( element ) { if ( _debug ) { console.log( 'cmsJS.sortableList _getJQueryItem: element - ', element ); } var item = $( element ); while ( item !== null &amp;&amp; item.attr( _sortingAttribute ) === undefined ) { item = item.parent(); } return item; } /** * (Privat) Method which * * @method _getLevel * @param {Object} item */ function _getLevel( item ) { if ( _debug ) { console.log( 'cmsJS.sortableList _getLevel: item - ', item ); } var pos = item.attr( _sortingAttribute ); if ( pos === null || pos === undefined ) { return -1; } var curLevel = pos.substr( pos.indexOf( '?' ) + 1 ); var level = parseInt( curLevel ); return level; } /** * (Privat) Method which * * @method _changePos * @param {Object} item * @param {String} diff */ function _changePos( item, diff ) { if ( _debug ) { console.log( 'cmsJS.sortableList _changePos: item - ', item ); console.log( 'cmsJS.sortableList _changePos: diff - ', diff ); } var pos = item.attr( _sortingAttribute ); if ( pos === null || pos === undefined ) { return -1; } var curLevel = pos.substr( pos.indexOf( '?' ) + 1 ); var curItem = pos.substr( pos.indexOf( '_' ) + 1 ); var curItemInt = parseInt( curItem ); var level = parseInt( curLevel ) + diff; item.attr( _sortingAttribute, &quot;item_&quot; + curItemInt + '?' + level ); return level; } /** * (Privat) Method which * * @method _serializeVisibleItems */ function _serializeVisibleItems() { if ( _debug ) { console.log( 'cmsJS.sortableList _serializeVisibleItems' ); } var postData = $( &quot;#visibleItemList&quot; ).sortable( &quot;serialize&quot;, { key: &quot;item&quot;, attribute: _sortingAttribute } ); if ( _inputField !== null ) { _inputField.value = postData; // postData = $(&quot;#itemOrderInput&quot;).val(); } } return cms; } )( cmsJS || {}, jQuery ); var cmsJS = ( function( cms ) { 'use strict'; // variables var _debug = false; var _toggleAttr = false; var _defaults = { collectionsSelector: '.tpl-stacked-collection__collections', collectionDefaultThumb: '', msg: { noSubCollectionText: '' } }; cms.stackedCollection = { /** * Method which initializes the RSS Feed. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {Object} data An data object which contains the images sources for the * grid. */ init: function( config, data ) { if ( _debug ) { console.log( '##############################' ); console.log( 'cmsJS.stackedCollections.init' ); console.log( '##############################' ); console.log( 'cmsJS.stackedCollections.init: config - ', config ); console.log( 'cmsJS.stackedCollections.init: data - ', data ); } $.extend( true, _defaults, config ); // render RSS Feed _renderCollections( data ); } }; /** * Method which renders the collection accordion. * * @method _renderCollections * @param {Object} data The RSS information data object. */ function _renderCollections( data ) { if ( _debug ) { console.log( '---------- _renderCollections() ----------' ); console.log( '_renderCollections: data = ', data ); } var counter = 0; // DOM elements var panelGroup = $( '&lt;div /&gt;' ).attr( 'id', 'stackedCollections' ).attr( 'role', 'tablist' ).addClass( 'panel-group' ); var panel = null; var panelHeading = null; var panelThumbnail = null; var panelThumbnailImage = null; var panelTitle = null; var panelTitleLink = null; var panelRSS = null; var panelRSSLink = null; var panelCollapse = null; var panelBody = null; // create members data.members.forEach( function( member ) { // increase counter counter++; // create panels panel = $( '&lt;div /&gt;' ).addClass( 'panel' ); // create panel title panelHeading = $( '&lt;div /&gt;' ).addClass( 'panel-heading' ); panelTitle = $( '&lt;h4 /&gt;' ).addClass( 'panel-title' ); panelTitleLink = $( '&lt;a /&gt;' ).text( member.label + ' (' + _getMetadataValue( member, 'volumes' ) + ')' ); // check if subcollections exist if ( _getMetadataValue( member, 'subCollections' ) &gt; 0 ) { panelTitleLink.attr( 'href', '#collapse-' + counter ).attr( 'role', 'button' ).attr( 'data-toggle', 'collapse' ).attr( 'data-parent', '#stackedCollections' ) .attr( 'aria-expanded', 'false' ); } else { panelTitleLink.attr( 'href', member.rendering[ '@id' ] ); } panelTitle.append( panelTitleLink ); // create RSS link panelRSS = $( '&lt;div /&gt;' ).addClass( 'panel-rss' ); panelRSSLink = $( '&lt;a /&gt;' ).attr( 'href', member.related[ '@id' ] ).attr( 'target', '_blank' ).html( '&lt;i class=&quot;fa fa-rss&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;' ); panelRSS.append( panelRSSLink ); // create panel thumbnail if exist panelThumbnail = $( '&lt;div /&gt;' ).addClass( 'panel-thumbnail' ); if ( member.thumbnail ) { panelThumbnailImage = $( '&lt;img /&gt;' ).attr( 'src', member.thumbnail ).addClass( 'img-responsive' ); panelThumbnail.append( panelThumbnailImage ); } else { panelThumbnailImage = $( '&lt;img /&gt;' ).attr( 'src', _defaults.collectionDefaultThumb ).addClass( 'img-responsive' ); panelThumbnail.append( panelThumbnailImage ); } // build title panelHeading.append( panelThumbnail ).append( panelTitle ).append( panelRSS ); // create collapse panelCollapse = $( '&lt;div /&gt;' ).attr( 'id', 'collapse-' + counter ).attr( 'role', 'tabpanel' ).attr( 'aria-expanded', 'false' ).addClass( 'panel-collapse collapse' ); // create panel body panelBody = $( '&lt;div /&gt;' ).addClass( 'panel-body' ).append( _renderSubCollections( member[ &quot;@id&quot; ] ) ); // build collapse panelCollapse.append( panelBody ); // build panel panel.append( panelHeading ).append( panelCollapse ); // build panel group panelGroup.append( panel ); $( _defaults.collectionsSelector ).append( panelGroup ); } ); } /** * Method to retrieve metadata value of the metadata object with the given label and * within the given collection object. * * @param collection {Object} The iiif-presentation collection object cotaining the * metadata. * @param label {String} The label property value of the metadata to return. * @returns {String} The count of works in the collection. */ function _getMetadataValue( collection, label ) { if ( _debug ) { console.log( '---------- _getMetadataValue() ----------' ); console.log( '_getMetadataValue: collection = ', collection ); console.log( '_getMetadataValue: label = ', label ); } var value = ''; collection.metadata.forEach( function( metadata ) { if ( metadata.label == label ) { value = metadata.value; } } ); return value; } /** * Method which renders the subcollections. * * @method _renderSubCollections * @param {String} url The URL to the API which fetches the subcollection data. * @returns {String} The HTML string of the subcollections. */ function _renderSubCollections( url ) { if ( _debug ) { console.log( '---------- _renderSubCollections() ----------' ); console.log( '_renderSubCollections: url = ', url ); } // DOM elements var subCollections = $( '&lt;ul /&gt;' ).addClass( 'list' ); var subCollectionItem = null; var subCollectionItemLink = null; var subCollectionItemRSSLink = null; // get subcollection data $.ajax( { url: url, type: 'GET', datatype: 'JSON' } ).then( function( data ) { subCollectionItem = $( '&lt;li /&gt;' ); if ( !$.isEmptyObject( data.members ) ) { // add subcollection items data.members.forEach( function( member ) { subCollectionItemLink = $( '&lt;a /&gt;' ).attr( 'href', member.rendering[ '@id' ] ).addClass( 'panel-body__collection' ).text( member.label + ' (' + _getMetadataValue( member, 'volumes' ) + ')' ); subCollectionItemRSSLink = $( '&lt;a /&gt;' ).attr( 'href', member.related[ '@id' ] ).attr( 'target', '_blank' ).addClass( 'panel-body__rss' ) .html( '&lt;i class=&quot;fa fa-rss&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;' ); // build subcollection item subCollectionItem.append( subCollectionItemLink ).append( subCollectionItemRSSLink ); subCollections.append( subCollectionItem ); } ); } else { // create empty item link subCollectionItemLink = $( '&lt;a /&gt;' ).attr( 'href', data.rendering[ '@id' ] ).text( _defaults.msg.noSubCollectionText + '.' ); // build empty item subCollectionItem.append( subCollectionItemLink ); subCollections.append( subCollectionItem ); } } ); return subCollections; } return cms; } )( cmsJS || {}, jQuery ); var cmsJS = ( function( cms ) { 'use strict'; // variables var _debug = false; var _data = null; var _defaults = { gridSelector: '.tpl-static-grid__grid' }; // DOM elements var _grid = null; var _gridRow = null; var _gridCol = null; var _gridTile = null; var _gridTileTitle = null; var _gridTileTitleLink = null; var _gridTileTitleH4 = null; var _gridTileImage = null; var _gridTileImageLink = null; cms.staticGrid = { /** * Method which initializes the Masonry Grid. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {String} config.gridSelector The selector for the grid container. * @param {Object} data An data object which contains the images sources for the * grid. */ init: function( config, data ) { if ( _debug ) { console.log( '##############################' ); console.log( 'cmsJS.staticGrid.init' ); console.log( '##############################' ); console.log( 'cmsJS.staticGrid.init: config - ', config ); console.log( 'cmsJS.staticGrid.init: data - ', data ); } $.extend( true, _defaults, config ); // render grid _grid = _buildGrid( data ); $( _defaults.gridSelector ).append( _grid ); } }; /** * Method to build the elements of the static grid. * * @method _buildGrid * @param {Object} data A JSON data object which contains the image informations. * @returns {Object} An jQuery object which contains all grid elements. */ function _buildGrid( data ) { if ( _debug ) { console.log( '---------- _buildGrid() ----------' ); console.log( '_buildGrid: data = ', data ); } _gridRow = $( '&lt;div class=&quot;row&quot; /&gt;' ); data.items.forEach( function( item ) { _gridCol = $( '&lt;div class=&quot;col-xs-6 col-sm-3&quot; /&gt;' ); // tile _gridTile = $( '&lt;div class=&quot;grid-tile&quot; /&gt;' ); // title _gridTileTitle = $( '&lt;div class=&quot;grid-tile__title&quot; /&gt;' ); _gridTileTitleH4 = $( '&lt;h4 /&gt;' ); _gridTileTitleLink = $( '&lt;a /&gt;' ); if ( item.url !== '' ) { _gridTileTitleLink.attr( 'href', item.url ); } else { _gridTileTitleLink.attr( 'href', '#' ); } _gridTileTitleLink.attr( 'title', item.title ); _gridTileTitleLink.append( item.title ); _gridTileTitleH4.append( _gridTileTitleLink ); // image _gridTileImage = $( '&lt;div class=&quot;grid-tile__image&quot; /&gt;' ); _gridTileImage.css( 'background-image', 'url(' + item.name + ')' ); _gridTileImageLink = $( '&lt;a /&gt;' ); if ( item.url !== '' ) { _gridTileImageLink.attr( 'href', item.url ); } else { _gridTileImageLink.attr( 'href', '#' ); } // concat everything _gridTileTitle.append( _gridTileTitleH4 ); _gridTile.append( _gridTileTitle ); _gridTileImage.append( _gridTileImageLink ); _gridTile.append( _gridTileTitle ); _gridTile.append( _gridTileImage ); _gridCol.append( _gridTile ); _gridRow.append( _gridCol ); } ); return _gridRow; } return cms; } )( cmsJS || {}, jQuery ); var cmsJS = ( function( cms ) { 'use strict'; var _debug = false; var _defaults = { inputFieldId: 'tagInput', tagListId: 'tagList', autoSuggestUrl: '', msg: { addTagLabel: 'Tag hinzufÃ¼gen' } }; cms.tagList = { tags: [], $tagListElement: null, autoSuggestUrl: null, /** * Method which initializes the tag list. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {String} config.inputFieldId The Selector for the tag input field. * @param {String} config.tagList The Selector for the tag list. * @param {String} config.autoSuggestUrl The URL for the tag auto suggest. * @param {Object} config.msg An object with message keys. */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'cmsJS.tagList.init' ); console.log( '##############################' ); console.log( 'cmsJS.tagList.init: config - ', config ); } $.extend( true, _defaults, config ); this.$inputField = $( '#' + _defaults.inputFieldId ); if ( this.$inputField.length === 0 ) { console.log( 'Data input field not found' ); } this.$tagListElement = $( '#' + _defaults.tagListId ); if ( this.$tagListElement.length === 0 ) { throw 'Tag list element not found'; } this.autoSuggestUrl = _defaults.autoSuggestUrl; this.tags = _readTags( this.$inputField ); _renderList( this.tags, this.$tagListElement ); }, /** * Method which adds a tag to the list. * * @method addTag * @param {String} tagName The current tag name. */ addTag: function( tagName ) { if ( _debug ) { console.log( '---------- cms.tagList.addTag() ----------' ); console.log( 'cmsJS.tagList.addTag: tagName = ', tagName ); } var containedTag = this.getTag( tagName ); if ( containedTag ) { var duration = 200; $( containedTag ).fadeOut( duration / 2, function() { $( containedTag ).fadeIn( duration / 2 ); } ); } else { if ( this.$tagListElement ) { _createListElement( tagName, this.$tagListElement ); } this.saveTags(); } }, /** * Method which deletes a tag from the list. * * @method deleteTag * @param {Object} tag The current tag to delete. */ deleteTag: function( tag ) { if ( _debug ) { console.log( '---------- cms.tagList.deleteTag() ----------' ); console.log( 'cmsJS.tagList.deleteTag: tag = ', tag ); } tag.remove(); this.saveTags(); }, /** * Method to save the tag list. * * @method saveTags */ saveTags: function() { if ( _debug ) { console.log( '---------- cms.tagList.saveTags() ----------' ); } _writeTags( cms.tagList.$tagListElement.children( '[id$=_item]' ), cms.tagList.$inputField ); }, /** * Method to ... * * @method contains */ contains: function( tagName ) { if ( _debug ) { console.log( '---------- cms.tagList.contains() ----------' ); console.log( 'cmsJS.tagList.contains: tagName = ', tagName ); } var found = false; var $tags = cms.tagList.$tagListElement.children( '[id$=_item]' ); $tags.each( function() { var text = $( this ).text(); if ( tagName.trim().toUpperCase() === text.trim().toUpperCase() ) { found = true; return false; } } ); return found; }, /** * Method to ... * * @method close */ close: function() { if ( _debug ) { console.log( '---------- cms.tagList.close() ----------' ); } this.$inputField.off(); this.$tagListElement.off(); this.$tagListElement.find( '.tag-terminator' ).off(); this.$tagListElement.find( 'input' ).off(); }, /** * Method to get all tags. * * @method getTags */ getTags: function() { if ( _debug ) { console.log( '---------- cms.tagList.getTags() ----------' ); } return cms.tagList.$tagListElement.children( '[id$=_item]' ); }, /** * Method to get all tag values. * * @method getTagValues */ getTagValues: function() { if ( _debug ) { console.log( '---------- cms.tagList.getTagValues() ----------' ); } var values = cmsJS.tagList.getTags().map( function( index, tag ) { return $( tag ).text(); } ); return values; }, /** * Method to get a single tag. * * @method getTag */ getTag: function( value ) { if ( _debug ) { console.log( '---------- cms.tagList.getTag() ----------' ); console.log( 'cmsJS.tagList.getTag: value = ', value ); } var selectedTag = undefined; cmsJS.tagList.getTags().each( function( index, tag ) { if ( cmsJS.tagList.getValue( tag ).trim().toUpperCase() === value.trim().toUpperCase() ) { selectedTag = tag; return false; } } ); return selectedTag; }, /** * Method to get a single Value. * * @method getValue */ getValue: function( tag ) { if ( _debug ) { console.log( '---------- cms.tagList.getValue() ----------' ); console.log( 'cmsJS.tagList.getValue: tag = ', tag ); } return $( tag ).text(); } }; /** * Method to ... * * @method _readTags * @param {Object} $input ... */ function _readTags( $input ) { if ( _debug ) { console.log( '---------- _readTags() ----------' ); console.log( '_readTags: $input = ', $input ); } var tagString = $input.val(); if ( !tagString ) { tagString = '[]'; } if ( tagString.length &gt; 0 ) { if ( _debug ) { console.log( '---------- _readTags() ----------' ); console.log( 'tagString: ', tagString ); } try { var tagList = JSON.parse( tagString ); return tagList; } catch ( error ) { console.log( 'Error reading tags from ' + tagString ); return []; } } else { return []; } } /** * Method to ... * * @method _writeTags * @param {Object} $tags ... * @param {Object} $input ... */ function _writeTags( $tags, $input ) { if ( _debug ) { console.log( '---------- _writeTags() ----------' ); console.log( '_writeTags: $tags = ', $tags ); console.log( '_writeTags: $input = ', $input ); } var tags = []; $tags.each( function() { if ( $( this ).text().length &gt; 0 ) { tags.push( $( this ).text() ); } } ) var tagString = JSON.stringify( tags ); $input.val( tagString ); } /** * Method to ... * * @method _renderList * @param {Array} tags ... * @param {Object} $ul ... */ function _renderList( tags, $ul ) { if ( _debug ) { console.log( '---------- _renderList() ----------' ); console.log( '_renderList: tags = ', tags ); console.log( '_renderList: $ul = ', $ul ); } var count = 0; var ulId = $ul.attr( 'id' ); for ( var index = 0; index &lt; tags.length; index++ ) { var tag = tags[ index ]; _createListElement( tag, $ul, count ); count++; } _createTagInputElement( $ul.parent() ); } /** * Method to ... * * @method _createListElement * @param {String} value ... * @param {Object} $parent ... * @param {Number} count */ function _createListElement( value, $parent, count ) { if ( _debug ) { console.log( '---------- _createListElement() ----------' ); console.log( '_createListElement: value = ', value ); console.log( '_createListElement: $parent = ', $parent ); console.log( '_createListElement: count = ', count ); } if ( !count ) { count = $parent.children( '[id$=_item]' ).length; } var ulId = $parent.attr( 'id' ); var $tagInput = $( '.tag-input' ); var $li = $( '&lt;li/&gt;' ); $li.attr( 'id', ulId + '_' + count + '_item' ); var $liText = $( '&lt;span class=&quot;tag label&quot;/&gt;' ); $liText.text( value ); var $terminator = $( '&lt;span /&gt;' ); $terminator.addClass( 'tag-terminator' ); $terminator.on( 'click', _handleClickTerminator ); $li.append( $liText ); $liText.append( $terminator ); if ( $tagInput.length &gt; 0 ) { $li.insertBefore( $tagInput ); } else { $parent.append( $li ); } } /** * Method to ... * * @method _createTagInputElement * @param {Object} $parent ... */ function _createTagInputElement( $parent ) { if ( _debug ) { console.log( '---------- _createTagInputElement() ----------' ); console.log( '_createTagInputElement: $parent = ', $parent ); } var $container = $( '.media-modal__tags' ); var sizeCount = 1; var ulId = $parent.attr( 'id' ); var $inputListElement = $( '&lt;li /&gt;' ); $inputListElement.addClass( 'tag-input' ); var $input = $( '&lt;input type=&quot;text&quot; /&gt;' ); $input.attr( 'id', ulId + '_inputField' ); $input.attr( 'size', sizeCount ); $inputListElement.append( $input ); $parent.find( 'ul' ).append( $inputListElement ); // handler $container.on( 'click', function() { $input.focus(); } ); $input.on( 'change', _handleInputChange ); $input.on( 'keypress', function( event ) { // change size of input sizeCount++; $input.attr( 'size', sizeCount ); // press enter if ( event.keyCode == 13 ) { sizeCount = 1; $input.attr( 'size', sizeCount ); return _handleInputChange( event ); } } ); // autocomplete $input.autocomplete( { source: function( request, response ) { Q( $.ajax( { url: cms.tagList.autoSuggestUrl + request.term + '/', type: 'GET', datatype: 'json', } ) ).then( function( data ) { response( data ); } ) }, appendTo: $input.parent(), select: function( event, ui ) { _handleInputChange( event, ui.item.value ); } } ); } /** * Method to ... * * @method _handleInputChange * @param {Object} event ... * @param {String} text ... */ function _handleInputChange( event, text ) { if ( _debug ) { console.log( '---------- _handleInputChange() ----------' ); console.log( '_handleInputChange: event = ', event ); console.log( '_handleInputChange: text = ', text ); console.log( 'on change occured in: ', event.target ); } if ( !text || text.length === 0 ) { text = $( event.target ).val(); } if ( text.trim().length &gt; 0 ) { cms.tagList.addTag( text ); $( event.target ).val( '' ); } event.preventDefault(); event.stopPropagation(); return false; } /** * Method to ... * * @method _handleClickTerminator * @param {Object} event ... */ function _handleClickTerminator( event ) { if ( _debug ) { console.log( '---------- _handleClickTerminator() ----------' ); console.log( '_handleClickTerminator: event = ', event ); console.log( 'Click on: ', event.currentTarget ); } var $li = $( event.target ).parent().parent(); cms.tagList.deleteTag( $li ); } return cms; } )( cmsJS || {}, jQuery ); var cmsJS = ( function( cms ) { 'use strict'; // variables var _debug = false; var _data = null; var _tiles = []; var _defaults = { $highlights: null, $grid: null }; // DOM-Elements var $gridItem = null; var $gridItemLink = null; var $gridItemCaptionLink = null; var $gridItemCaptionIcon = null; var $gridItemFigure = null; var $gridItemFigcaption = null; var $gridItemFigcaptionHeader = null; var $gridItemImage = null; cms.tileGrid = { init: function( config, data ) { if ( _debug ) { console.log( '##############################' ); console.log( 'cmsJS.tileGrid.init' ); console.log( '##############################' ); console.log( 'cmsJS.tileGrid.init: config - ', config ); console.log( 'cmsJS.tileGrid.init: data - ', data ); } $.extend( true, _defaults, config ); _tiles = _getTiles( data ); _renderTileGrid( _tiles ); } }; function _getTiles( data ) { if ( _debug ) { console.log( '---------- _getTiles() ----------' ); console.log( '_getTiles: data = ', data ); } var tiles = []; data.items.forEach( function( item ) { $gridItem = $( '&lt;div /&gt;' ); $gridItemLink = $( '&lt;a /&gt;' ); $gridItemCaptionLink = $( '&lt;a /&gt;' ); $gridItemCaptionIcon = $( '&lt;i aria-hidden=&quot;true&quot; /&gt;' ); $gridItemFigure = $( '&lt;figure /&gt;' ); $gridItemFigcaption = $( '&lt;figcaption /&gt;' ); $gridItemFigcaptionHeader = $( '&lt;h3 /&gt;' ); $gridItemImage = $( '&lt;img /&gt;' ); // create item if ( item.important ) { $gridItem.addClass( 'tpl-tile-grid__grid-item important' ); } else { $gridItem.addClass( 'tpl-tile-grid__grid-item' ); } if ( item.size !== '' ) { $gridItem.addClass( item.size ); } $gridItemImage.attr( 'src', item.name ); // $gridItemImage.attr( 'class', 'img-responsive' ); $gridItemImage.attr( 'alt', item.title ); if ( item.url !== '' ) { $gridItemLink.attr( 'href', item.url ); $gridItemLink.append( $gridItemImage ); $gridItemFigure.append( $gridItemLink ); } else { $gridItemFigure.append( $gridItemImage ); } $gridItemFigcaptionHeader.text( item.title ); $gridItemFigure.append( $gridItemFigcaptionHeader ); $gridItemFigcaption.append( item.caption ); if ( item.url !== '' ) { $gridItemCaptionLink.attr( 'href', item.url ); $gridItemCaptionIcon.addClass( 'fa fa-arrow-right' ); $gridItemCaptionLink.append( $gridItemCaptionIcon ); $gridItemFigcaption.append( $gridItemCaptionLink ); } $gridItemFigure.append( $gridItemFigcaption ); $gridItem.append( $gridItemFigure ); // push tile into tiles array tiles.push( $gridItem ); } ); return tiles; } function _renderTileGrid( tiles ) { if ( _debug ) { console.log( '---------- _renderTileGrid() ----------' ); console.log( '_renderTileGrid: tiles = ', tiles ); } tiles.forEach( function( tile ) { if ( tile.hasClass( 'important' ) ) { _defaults.$highlights.append( tile ); } else { _defaults.$grid.append( tile ); } } ); } return cms; } )( cmsJS || {}, jQuery ); Ã— Search results Close "},"cms_cmsJS.createPage.js.html":{"id":"cms_cmsJS.createPage.js.html","title":"Source: cms/cmsJS.createPage.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: cms/cmsJS.createPage.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which creates new CMS pages and sets their status. * * @version 3.2.0 * @module cmsJS.createPage * @requires jQuery * */ var cmsJS = ( function( cms ) { 'use strict'; var _debug = false; var _previewStatus = ''; var _defaults = { selectedPageID: null, inputFields: null, prevBtn: null, prevDescription: null, saveBtn: null, sortablesConfig: {} }; cms.createPage = { /** * Method which initializes the CMS create page module. * * @method init * @param {Object} settings */ init: function( settings ) { if ( _debug ) { console.log( '##############################' ); console.log( 'cmsJS.createPage.init' ); console.log( '##############################' ); console.log( 'cmsJS.createPage.init: settings - ', settings ); } $.extend( true, _defaults, settings ); if ( _defaults.selectedPageID === null ) { cmsJS.createPage.disablePreview(); _defaults.prevDescription.show(); } // listen to changes on input fields _defaults.inputFields.on( 'change input paste', function() { cmsJS.createPage.disablePreview(); _defaults.prevDescription.show(); } ); cmsJS.createPage.initSortables( _defaults ); // set preview button status _previewStatus = localStorage.getItem( 'previewStatus' ); if ( _previewStatus === 'false' ) { _defaults.prevBtn.attr( 'disabled', true ); _defaults.prevDescription.show(); } else { _defaults.prevBtn.attr( 'disabled', false ); _defaults.prevDescription.hide(); _defaults.prevBtn.on( 'click', function() { var url = $( this ).attr( 'data-previewUrl' ); window.open( url, '_blank' ); } ); } }, /** * Method which * * @method initSortables * @param {Object} config */ initSortables: function( config ) { if ( _debug ) { console.log( 'cmsJS.createPage.initSortables: config - ', config ); } config.sortablesConfig.visibleItemList = $( config.sortablesConfig.visibleItemList ); config.sortablesConfig.availableItemList = $( config.sortablesConfig.availableItemList ); if ( config.sortablesConfig.availableItemList.length &gt; 0 ) { cmsJS.sortableList.init( 0, false, config ); config.sortablesConfig.editButton.on( 'click', function() { if ( $( this ).hasClass( 'glyphicon-edit' ) ) { $( this ).removeClass( 'glyphicon-edit' ).addClass( 'glyphicon-remove' ); } else { $( this ).removeClass( 'glyphicon-remove' ).addClass( 'glyphicon-edit' ); } $( this ).parent( '.sidebar-editor-widget-item-header' ).next( '.sidebar-editor-widget-item-body' ).slideToggle( 'slow' ); } ); config.sortablesConfig.availableItemList.on( 'sortbeforestop', function( event, ui ) { if ( $( ui.item ).parent().attr( 'id' ) === 'visibleItemList' ) { cmsJS.createPage.disablePreview(); } } ); config.sortablesConfig.visibleItemList.on( 'sortbeforestop', function() { cmsJS.createPage.disablePreview(); } ); } else { if ( _debug ) console.log( &quot;No sortable list elements available&quot; ); return false; } }, /** * Method which disables the preview button by setting a local storage value. * * @method disablePreview */ disablePreview: function() { if ( _debug ) { console.log( '---------- cmsJS.createPage.disablePreview() ----------' ); } localStorage.setItem( 'previewStatus', 'false' ); }, /** * Method which enables the preview button by setting a local storage value. * * @method enablePreview */ enablePreview: function() { if ( _debug ) { console.log( '---------- cmsJS.createPage.enablePreview() ----------' ); } localStorage.setItem( 'previewStatus', 'true' ); }, }; return cms; } )( cmsJS || {}, jQuery ); Ã— Search results Close "},"cms_cmsJS.mapBox.js.html":{"id":"cms_cmsJS.mapBox.js.html","title":"Source: cms/cmsJS.mapBox.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: cms/cmsJS.mapBox.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module to initialize the mapbox view. * * @version 3.2.0 * @module cmsJS.geoLocations * @requires jQuery */ var cmsJS = ( function( cms ) { 'use strict'; // variables var _debug = false; var _map = {}; var _mapEnlarged = {}; var _features = []; var _centerCoords = []; var _defaults = { appUrl: '', locations: '', mapboxAccessToken: 'pk.eyJ1IjoibGlydW1nYnYiLCJhIjoiY2lobjRzamkyMDBnM3U5bTR4cHp0NDdyeCJ9.AjNCRBlBb57j-dziFxf58A', mapBoxContainerSelector: 'widgetGeoLocationsMap', mapBoxContainerEnlargedSelector: 'widgetGeoLocationsMapEnlarged', mapBoxStyle: 'mapbox://styles/lirumgbv/cii024wxn009aiolzgy2zlycj', msg: { propertiesLink: '' } }; cms.geoLocations = { init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'cms.geoLocations.init' ); console.log( '##############################' ); console.log( 'cms.geoLocations.init: config - ', config ); } $.extend( true, _defaults, config ); if ( $( '#widgetGeoLocationsMap' ).length &gt; 0 ) { mapboxgl.accessToken = _defaults.mapboxAccessToken; // get map data and infos _centerCoords = _getCenterCoords( _defaults.locations ); _features = _getMapFeatures( _defaults.locations ); // create map _map = new mapboxgl.Map( { container: _defaults.mapBoxContainerSelector, style: _defaults.mapBoxStyle, center: _centerCoords, zoom: 12.5, interactive: true } ); // build markers _map.on( 'style.load', function() { _map.addSource( &quot;markers&quot;, { &quot;type&quot;: &quot;geojson&quot;, &quot;data&quot;: { &quot;type&quot;: &quot;FeatureCollection&quot;, &quot;features&quot;: _features } } ); _map.addLayer( { &quot;id&quot;: &quot;markers&quot;, &quot;type&quot;: &quot;symbol&quot;, &quot;source&quot;: &quot;markers&quot;, &quot;layout&quot;: { &quot;icon-image&quot;: &quot;pin&quot;, &quot;icon-allow-overlap&quot;: true } } ); _map.addControl( new mapboxgl.FullscreenControl() ); _map.addControl( new mapboxgl.NavigationControl() ); } ); // add popups _map.on( 'click', 'markers', function( e ) { new mapboxgl.Popup().setLngLat( e.features[ 0 ].geometry.coordinates ).setHTML( e.features[ 0 ].properties.infos ).addTo( _map ); // GAUGS: save collection to local storage for slider use $( '.mapboxgl-popup-content a' ).on( 'click', function( event ) { event.preventDefault(); var url = $( this ).attr( 'href' ); var collection = $( this ).attr( 'data-collection' ); if ( collection === 'false' ) { localStorage.setItem( 'sliderImagesFrom', 0 ); } else { localStorage.setItem( 'sliderImagesFrom', collection ); } window.location.href = url; } ); } ); } } }; /** * Method which returns an object of map features. * * @method _getMapFeatures * @param {String} infos A JSON-String which contains the feature infos. * @returns {Array} An array of features. */ function _getMapFeatures( infos ) { if ( _debug ) { console.log( '---------- _getMapFeatures() ----------' ); console.log( '_getMapFeatures: infos - ', infos ); } var features = []; var collection = ''; var infos = JSON.parse( infos ); $.each( infos.locations, function( key, location ) { // GAUGS: special condition to get the right collection number for image // slider if ( location.link != undefined ) { if ( location.link.indexOf( '/sammlung/' ) != -1 ) { var str = location.link; collection = str.replace( '/sammlung/', '' ).replace( '/', '' ); } } var feature = { 'type': 'Feature', 'geometry': { 'type': 'Point', 'coordinates': [ location.longitude, location.latitude ] }, 'properties': { 'infos': location.infos + '&lt;br /&gt;&lt;a href=&quot;' + _defaults.appUrl + location.link + '&quot; data-collection=&quot;' + ( ( collection !== '' ) ? collection : 'false' ) + '&quot;&gt;' + _defaults.msg.propertiesLink + '&lt;/a&gt;' } } features.push( feature ); } ); return features; } /** * Method which returns an array of coordinates for centering the map. * * @method _getCenterCoords * @param {String} infos A JSON-String which contains the feature infos. * @returns {Array} An array of coords. */ function _getCenterCoords( infos ) { if ( _debug ) { console.log( '---------- _getCenterCoords() ----------' ); } var coords = []; var infos = JSON.parse( infos ); if ( infos.centerLocation.longitude != '' || infos.centerLocation.latitude != '' ) { coords.push( infos.centerLocation.longitude ); coords.push( infos.centerLocation.latitude ); } else { coords.push( infos.locations[ 0 ].longitude ); coords.push( infos.locations[ 0 ].latitude ); } return coords; } return cms; } )( cmsJS || {}, jQuery ); Ã— Search results Close "},"cms_cmsJS.masonry.js.html":{"id":"cms_cmsJS.masonry.js.html","title":"Source: cms/cmsJS.masonry.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: cms/cmsJS.masonry.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which initializes a masonry grid. * * @version 3.2.0 * @module cmsJS.masonry * @requires jQuery */ var cmsJS = ( function( cms ) { 'use strict'; // variables var _debug = false; var _data = null; var _lazyGrid = null; var _defaults = { $grid: null, loaderSelector: '.tpl-masonry__loader' }; // DOM-Elements var $gridItem = null; var $gridItemImage = null; var $gridItemImageLink = null; var $gridItemTitle = null; var $gridItemTitleLink = null; var $gridItemCaption = null; var $gridItemCaptionHeading = null; var $gridItemCaptionLink = null; cms.masonry = { /** * Method which initializes the Masonry Grid. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {Object} config.$grid An jQuery object which represents the grid * container. * @param {Object} data An data object which contains the images sources for the * grid. */ init: function( config, data ) { if ( _debug ) { console.log( '##############################' ); console.log( 'cmsJS.masonry.init' ); console.log( '##############################' ); console.log( 'cmsJS.masonry.init: config - ', config ); console.log( 'cmsJS.masonry.init: data - ', data ); } $.extend( true, _defaults, config ); // show loader $( _defaults.loaderSelector ).show(); // render grid _renderMasonryGrid( data ); // init masonry _lazyGrid = _defaults.$grid.imagesLoaded( function() { // init Masonry after all images have loaded _lazyGrid.masonry( { itemSelector: '.grid-item', columnWidth: '.grid-sizer', gutter: '.gutter-sizer', percentPosition: true } ); } ); // fade in grid after rendering _lazyGrid.on( 'layoutComplete', function( event, laidOutItems ) { // hide loader $( _defaults.loaderSelector ).hide(); // show images _defaults.$grid.addClass( 'ready' ); } ); } }; /** * Method which renders the masonry grid. * * @method _renderMasonryGrid * @param {Object} data An data object which contains the images sources for the grid. */ function _renderMasonryGrid( data ) { if ( _debug ) { console.log( '---------- _renderMasonryGrid() ----------' ); console.log( '_renderMasonryGrid: data = ', data ); } // create items data.items.forEach( function( item ) { // grid item $gridItem = $( '&lt;div /&gt;' ); if ( item.important ) { $gridItem.addClass( 'grid-item important' ); } else { $gridItem.addClass( 'grid-item' ); } // grid item title $gridItemTitle = $( '&lt;div /&gt;' ); if ( item.url !== '' ) { $gridItemTitleLink = $( '&lt;a /&gt;' ); $gridItemTitleLink.attr( 'href', item.url ); $gridItemTitleLink.attr( 'title', item.title ); } $gridItemTitle.addClass( 'grid-item-title' ); $gridItemTitle.text( item.title ); if ( item.url !== '' ) { $gridItemTitleLink.append( $gridItemTitle ); $gridItem.append( $gridItemTitleLink ); } else { $gridItem.append( $gridItemTitle ); } // grid item caption if ( item.caption !== '' ) { $gridItemCaption = $( '&lt;div /&gt;' ); $gridItemCaption.addClass( 'grid-item-caption' ); $gridItemCaption.html( item.caption ); // grid item caption heading $gridItemCaptionHeading = $( '&lt;h4 /&gt;' ); $gridItemCaptionHeading.text( item.title ); $gridItemCaption.prepend( $gridItemCaptionHeading ); if ( item.url !== '' ) { // grid item caption link $gridItemCaptionLink = $( '&lt;a /&gt;' ); $gridItemCaptionLink.attr( 'href', item.url ); $gridItemCaptionLink.attr( 'title', item.title ); // append to grid item $gridItemCaptionLink.append( $gridItemCaption ); $gridItem.append( $gridItemCaptionLink ); } else { $gridItem.append( $gridItemCaption ); } } // grid item image $gridItemImage = $( '&lt;img /&gt;' ); $gridItemImage.attr( 'src', item.name ); $gridItemImage.addClass( 'img-responsive' ); if ( item.url !== '' ) { // grid item image link $gridItemImageLink = $( '&lt;a /&gt;' ); $gridItemImageLink.attr( 'href', item.url ); $gridItemImageLink.attr( 'title', item.title ); $gridItemImageLink.append( $gridItemImage ); $gridItem.append( $gridItemImageLink ); } else { $gridItem.append( $gridItemImage ); } // append to grid _defaults.$grid.append( $gridItem ); } ); } return cms; } )( cmsJS || {}, jQuery ); Ã— Search results Close "},"cms_cmsJS.rssFeed.js.html":{"id":"cms_cmsJS.rssFeed.js.html","title":"Source: cms/cmsJS.rssFeed.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: cms/cmsJS.rssFeed.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which renders the RSS Feed. * * @version 3.2.0 * @module cmsJS.rssFeed * @requires jQuery */ var cmsJS = ( function( cms ) { 'use strict'; // variables var _debug = false; var _defaults = { rssFeedSelector: '.tpl-rss__feed', }; cms.rssFeed = { /** * Method which initializes the RSS Feed. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {Object} data An data object which contains the images sources for the * grid. */ init: function( config, data ) { if ( _debug ) { console.log( '##############################' ); console.log( 'cmsJS.rssFeed.init' ); console.log( '##############################' ); console.log( 'cmsJS.rssFeed.init: config - ', config ); console.log( 'cmsJS.rssFeed.init: data - ', data ); } $.extend( true, _defaults, config ); // render RSS Feed _renderRssFeed( data ); } }; /** * Method which renders the RSS feed into the DOM. * * @method _renderRssFeed * @param {Object} data The RSS information data object. */ function _renderRssFeed( data ) { if ( _debug ) { console.log( '---------- _renderRssFeed() ----------' ); console.log( '_renderRssFeed: data = ', data ); } // DOM elements var rssItem = null; var rssItemTitle = null; var rssItemTitleH3 = null; var rssItemTitleLink = null; var rssItemRow = null; var rssItemColLeft = null; var rssItemColRight = null; var rssItemImageWrapper = null; var rssItemImage = null; var rssItemImageLink = null; var rssItemDate = null; var rssItemTime = null; var rssItemMetadata = null; var rssItemMetadataKey = null; var rssItemMetadataValue = null; // create items data.items.forEach( function( item ) { // create item wrapper rssItem = $( '&lt;div /&gt;' ); rssItem.addClass( 'tpl-rss__item' ); // create item content rssItemRow = $( '&lt;div /&gt;' ).addClass( 'row' ); // left rssItemColLeft = $( '&lt;div /&gt;' ).addClass( 'col-xs-3' ); rssItemImageWrapper = $( '&lt;div /&gt;' ).addClass( 'tpl-rss__item-image' ); rssItemImageLink = $( '&lt;a /&gt;' ).attr( 'href', item.link ); rssItemImage = $( '&lt;img /&gt;' ).attr( 'src', item.description.image ).addClass( 'img-responsive' ); rssItemImageLink.append( rssItemImage ); rssItemImageWrapper.append( rssItemImageLink ); rssItemColLeft.append( rssItemImageWrapper ); // right rssItemColRight = $( '&lt;div /&gt;' ).addClass( 'col-xs-9' ); // create item title rssItemTitle = $( '&lt;div /&gt;' ).addClass( 'tpl-rss__item-title' ); rssItemTitleH3 = $( '&lt;h3 /&gt;' ); rssItemTitleLink = $( '&lt;a /&gt;' ).attr( 'href', item.link ).text( item.title ); rssItemTitleH3.append( rssItemTitleLink ); rssItemTitle.append( rssItemTitleH3 ); // create date rssItemDate = $( '&lt;div /&gt;' ).addClass( 'tpl-rss__item-date' ); rssItemTime = new Date( item.pubDate ); rssItemDate.text( rssItemTime.toLocaleString() ); // create metadata rssItemMetadata = $( '&lt;dl /&gt;' ).addClass( 'tpl-rss__item-metadata dl-horizontal' ); item.description.metadata.forEach( function( metadata ) { rssItemMetadataKey = $( '&lt;dt /&gt;' ).text( metadata.label + ':' ); rssItemMetadataValue = $( '&lt;dd /&gt;' ).text( metadata.value ); rssItemMetadata.append( rssItemMetadataKey ).append( rssItemMetadataValue ); } ); rssItemColRight.append( rssItemTitle ).append( rssItemDate ).append( rssItemMetadata ); // append to row rssItemRow.append( rssItemColLeft ).append( rssItemColRight ); // create item rssItem.append( rssItemRow ); $( _defaults.rssFeedSelector ).append( rssItem ); } ); } return cms; } )( cmsJS || {}, jQuery ); Ã— Search results Close "},"cms_cmsJS.sortableList.js.html":{"id":"cms_cmsJS.sortableList.js.html","title":"Source: cms/cmsJS.sortableList.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: cms/cmsJS.sortableList.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which enables a sortable List based on jQuery UI. This list is used for the * mainmenu items and dynamic sidebar elements. * * @version 3.2.0 * @module cmsJS.sortableList * @requires jQuery, jQuery UI */ var cmsJS = ( function( cms ) { 'use strict'; var _debug = false; var _levelIndent = 0; var _allowMultipleOccurances = false; var _inputField = null; var _sortingAttribute = 'sortposition'; cms.sortableList = { /** * Method which initializes the CMS sortable list items and sets events. * * @method init * @param {String} indent * @param {Boolean} allowMultiple * @param {Object} config */ init: function( indent, allowMultiple, config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'cmsJS.sortableList.init' ); console.log( '##############################' ); console.log( 'cmsJS.sortableList.init: indent - ', indent ); console.log( 'cmsJS.sortableList.init: allowMultiple - ', allowMultiple ); console.log( 'cmsJS.sortableList.init: inputTextField - ', config.sortablesConfig.componentListInput ); } _levelIndent = indent; _allowMultipleOccurances = allowMultiple; _inputField = config.sortablesConfig.componentListInput; // validation if ( _inputField === null ) { console.warn( &quot;Input field for item order not found: No order information can be saved!&quot; ); } if ( config.sortablesConfig.visibleItemList.length === 0 ) { console.error( &quot;No container for active items found. Cannot initialize sortable&quot; ); } if ( config.sortablesConfig.availableItemList.length === 0 ) { console.error( &quot;No container for available items found. Cannot initialize sortable&quot; ); } _updateAllSortIcons(); if ( _debug ) console.log( &quot;Make sortable &quot;, config.sortablesConfig.visibleItemList ); config.sortablesConfig.visibleItemList.sortable( { update: _serializeVisibleItems, connectWith: &quot;#availableItemList&quot; } ); if ( _debug ) console.log( &quot;Make sortable &quot;, config.sortablesConfig.availableItemList ); config.sortablesConfig.availableItemList.sortable( { update: _serializeVisibleItems, connectWith: &quot;#visibleItemList&quot;, helper: &quot;clone&quot; } ); _serializeVisibleItems(); $( &quot;#availableItemList&quot; ).on( &quot;sortbeforestop&quot;, _handleBeforeDropFromAvailable ); $( &quot;#visibleItemList&quot; ).on( &quot;sortbeforestop&quot;, _handleBeforeDropFromVisible ); $( &quot;#availableItemList&quot; ).on( &quot;sortstop&quot;, _handleDrop ); $( &quot;#visibleItemList&quot; ).on( &quot;sortstop&quot;, _handleDrop ); }, /** * Method which * * @method decreaseLevel * @param {String} element * @param {String} applyToNext */ decreaseLevel: function( element, applyToNext ) { if ( _debug ) { console.log( 'cmsJS.sortableList.decreaseLevel: element - ', element ); console.log( 'cmsJS.sortableList.decreaseLevel: applyToNext - ', applyToNext ); } var item = _getJQueryItem( element ); var level; if ( _getLevel( item ) &gt; 0 ) { level = _changePos( item, -1 ); if ( applyToNext ) { var nextItem = item.next(); while ( nextItem !== null &amp;&amp; _getLevel( nextItem ) &gt; _getLevel( item ) + 1 ) { cms.sortableList.decreaseLevel( nextItem, false ); nextItem = nextItem.next(); } } } _serializeVisibleItems(); _updateAllSortIcons(); }, /** * Method which * * @method increaseLevel * @param {String} element * @param {String} applyToNext */ increaseLevel: function( element, applyToNext ) { if ( _debug ) { console.log( 'cmsJS.sortableList.increaseLevel: element - ', element ); console.log( 'cmsJS.sortableList.increaseLevel: applyToNext - ', applyToNext ); } var item = _getJQueryItem( element ); var prevItem = item.prev(); if ( _getLevel( item ) &lt;= _getLevel( prevItem ) ) { _changePos( item, 1 ); if ( applyToNext ) { var nextItem = item.next(); while ( nextItem !== null &amp;&amp; _getLevel( nextItem ) &gt;= _getLevel( item ) ) { cms.sortableList.increaseLevel( nextItem, false ); nextItem = nextItem.next(); } } } _serializeVisibleItems(); _updateAllSortIcons(); }, save: function( ajaxData ) { if ( typeof ajaxData === &quot;undefined&quot; || ajaxData.status === &quot;begin&quot; ) { _serializeVisibleItems(); } } }; /** * (Privat) Method which * * @method _handleBeforeDropFromAvailable * @param {String} event * @param {String} ui */ function _handleBeforeDropFromAvailable( event, ui ) { if ( _debug ) { console.log( 'cmsJS.sortableList _handleBeforeDropFromAvailable: event - ', event ); console.log( 'cmsJS.sortableList _handleBeforeDropFromAvailable: ui - ', ui ); } var $item = $( ui.item ); var $radioMenues = $item.find(&quot;table&quot;); $radioMenues.each(function(index, element) { var $checkboxes = $(element).find(&quot;input&quot;); if($checkboxes.length &gt; 0) { var anychecked = false; $checkboxes.each(function(index, element) { if($(element).prop('checked')) { anychecked = true; return false; } }) if(!anychecked) { $checkboxes.first().prop('checked', true); } } }) if ( _allowMultipleOccurances &amp;&amp; $item.parent().attr( &quot;id&quot; ) === &quot;visibleItemList&quot; ) { $item.clone().appendTo( $( &quot;#availableItemList&quot; ) ); } } /** * (Privat) Method which * * @method _handleBeforeDropFromAvailable * @param {String} event * @param {String} ui */ function _handleBeforeDropFromVisible( event, ui ) { if ( _debug ) { console.log( 'cmsJS.sortableList _handleBeforeDropFromVisible: event - ', event ); console.log( 'cmsJS.sortableList _handleBeforeDropFromVisible: ui - ', ui ); } var item = $( ui.item ); if ( _allowMultipleOccurances &amp;&amp; item.parent().attr( &quot;id&quot; ) === &quot;availableItemList&quot; ) { ui.item.remove(); } } /** * (Privat) Method which * * @method _handleDrop */ function _handleDrop() { if ( _debug ) { console.log( 'cmsJS.sortableList _handleDrop' ); } _updateAllSortIcons(); } /** * (Privat) Method which * * @method _updateAllSortIcons */ function _updateAllSortIcons() { if ( _debug ) { console.log( 'cmsJS.sortableList _updateAllSortIcons' ); } var childrenVL = $( &quot;#visibleItemList&quot; ).children( &quot;li&quot; ); childrenVL.each( function() { if ( $( this ).attr( _sortingAttribute ) != null ) { _updateSortIcons( $( this ) ); } } ); var childrenAL = $( &quot;#availableItemList&quot; ).children( &quot;li&quot; ); childrenAL.each( function() { if ( $( this ).attr( _sortingAttribute ) != null ) { _updateSortIcons( $( this ) ); } } ); } /** * (Privat) Method which * * @method _updateSortIcons * @param {Object} item */ function _updateSortIcons( item ) { if ( _debug ) { console.log( 'cmsJS.sortableList _updateSortIcons: item - ', item ); } var parent = item.parent(); if ( parent.attr( &quot;id&quot; ) === &quot;visibleItemList&quot; ) { item.children( '.menu-item__level' ).show(); if ( _getLevel( item.prev() ) === -1 ) { while ( _getLevel( item ) &gt; 0 ) { cms.sortableList.decreaseLevel( item ); } } if ( _getLevel( item ) === 0 ) { item.find( '.left' ).css( &quot;visibility&quot;, &quot;hidden&quot; ); item.find( '.right' ).css( &quot;visibility&quot;, &quot;hidden&quot; ); item.css( &quot;margin-left&quot;, &quot;0px&quot; ); } else { item.find( '.left' ).css( &quot;visibility&quot;, &quot;visible&quot; ); item.find( '.right' ).css( &quot;visibility&quot;, &quot;visible&quot; ); item.css( &quot;margin-left&quot;, _getLevel( item ) * _levelIndent + &quot;px&quot; ); } if ( _getLevel( item ) &gt; _getLevel( item.prev() ) ) { item.find( '.left' ).css( &quot;visibility&quot;, &quot;visible&quot; ); item.find( '.right' ).css( &quot;visibility&quot;, &quot;hidden&quot; ); } else { item.find( '.left' ).css( &quot;visibility&quot;, &quot;visible&quot; ); item.find( '.right' ).css( &quot;visibility&quot;, &quot;visible&quot; ); } } else { item.children( '.menu-item__level' ).hide(); } } /** * (Privat) Method which * * @method _getJQueryItem * @param {Object} element */ function _getJQueryItem( element ) { if ( _debug ) { console.log( 'cmsJS.sortableList _getJQueryItem: element - ', element ); } var item = $( element ); while ( item !== null &amp;&amp; item.attr( _sortingAttribute ) === undefined ) { item = item.parent(); } return item; } /** * (Privat) Method which * * @method _getLevel * @param {Object} item */ function _getLevel( item ) { if ( _debug ) { console.log( 'cmsJS.sortableList _getLevel: item - ', item ); } var pos = item.attr( _sortingAttribute ); if ( pos === null || pos === undefined ) { return -1; } var curLevel = pos.substr( pos.indexOf( '?' ) + 1 ); var level = parseInt( curLevel ); return level; } /** * (Privat) Method which * * @method _changePos * @param {Object} item * @param {String} diff */ function _changePos( item, diff ) { if ( _debug ) { console.log( 'cmsJS.sortableList _changePos: item - ', item ); console.log( 'cmsJS.sortableList _changePos: diff - ', diff ); } var pos = item.attr( _sortingAttribute ); if ( pos === null || pos === undefined ) { return -1; } var curLevel = pos.substr( pos.indexOf( '?' ) + 1 ); var curItem = pos.substr( pos.indexOf( '_' ) + 1 ); var curItemInt = parseInt( curItem ); var level = parseInt( curLevel ) + diff; item.attr( _sortingAttribute, &quot;item_&quot; + curItemInt + '?' + level ); return level; } /** * (Privat) Method which * * @method _serializeVisibleItems */ function _serializeVisibleItems() { if ( _debug ) { console.log( 'cmsJS.sortableList _serializeVisibleItems' ); } var postData = $( &quot;#visibleItemList&quot; ).sortable( &quot;serialize&quot;, { key: &quot;item&quot;, attribute: _sortingAttribute } ); if ( _inputField !== null ) { _inputField.value = postData; // postData = $(&quot;#itemOrderInput&quot;).val(); } } return cms; } )( cmsJS || {}, jQuery ); Ã— Search results Close "},"cms_cmsJS.stackedCollection.js.html":{"id":"cms_cmsJS.stackedCollection.js.html","title":"Source: cms/cmsJS.stackedCollection.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: cms/cmsJS.stackedCollection.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which renders collections as an accordion view. * * @version 3.2.0 * @module cmsJS.stackedCollection * @requires jQuery */ var cmsJS = ( function( cms ) { 'use strict'; // variables var _debug = false; var _toggleAttr = false; var _defaults = { collectionsSelector: '.tpl-stacked-collection__collections', collectionDefaultThumb: '', msg: { noSubCollectionText: '' } }; cms.stackedCollection = { /** * Method which initializes the RSS Feed. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {Object} data An data object which contains the images sources for the * grid. */ init: function( config, data ) { if ( _debug ) { console.log( '##############################' ); console.log( 'cmsJS.stackedCollections.init' ); console.log( '##############################' ); console.log( 'cmsJS.stackedCollections.init: config - ', config ); console.log( 'cmsJS.stackedCollections.init: data - ', data ); } $.extend( true, _defaults, config ); // render RSS Feed _renderCollections( data ); } }; /** * Method which renders the collection accordion. * * @method _renderCollections * @param {Object} data The RSS information data object. */ function _renderCollections( data ) { if ( _debug ) { console.log( '---------- _renderCollections() ----------' ); console.log( '_renderCollections: data = ', data ); } var counter = 0; // DOM elements var panelGroup = $( '&lt;div /&gt;' ).attr( 'id', 'stackedCollections' ).attr( 'role', 'tablist' ).addClass( 'panel-group' ); var panel = null; var panelHeading = null; var panelThumbnail = null; var panelThumbnailImage = null; var panelTitle = null; var panelTitleLink = null; var panelRSS = null; var panelRSSLink = null; var panelCollapse = null; var panelBody = null; // create members data.members.forEach( function( member ) { // increase counter counter++; // create panels panel = $( '&lt;div /&gt;' ).addClass( 'panel' ); // create panel title panelHeading = $( '&lt;div /&gt;' ).addClass( 'panel-heading' ); panelTitle = $( '&lt;h4 /&gt;' ).addClass( 'panel-title' ); panelTitleLink = $( '&lt;a /&gt;' ).text( member.label + ' (' + _getMetadataValue( member, 'volumes' ) + ')' ); // check if subcollections exist if ( _getMetadataValue( member, 'subCollections' ) &gt; 0 ) { panelTitleLink.attr( 'href', '#collapse-' + counter ).attr( 'role', 'button' ).attr( 'data-toggle', 'collapse' ).attr( 'data-parent', '#stackedCollections' ) .attr( 'aria-expanded', 'false' ); } else { panelTitleLink.attr( 'href', member.rendering[ '@id' ] ); } panelTitle.append( panelTitleLink ); // create RSS link panelRSS = $( '&lt;div /&gt;' ).addClass( 'panel-rss' ); panelRSSLink = $( '&lt;a /&gt;' ).attr( 'href', member.related[ '@id' ] ).attr( 'target', '_blank' ).html( '&lt;i class=&quot;fa fa-rss&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;' ); panelRSS.append( panelRSSLink ); // create panel thumbnail if exist panelThumbnail = $( '&lt;div /&gt;' ).addClass( 'panel-thumbnail' ); if ( member.thumbnail ) { panelThumbnailImage = $( '&lt;img /&gt;' ).attr( 'src', member.thumbnail ).addClass( 'img-responsive' ); panelThumbnail.append( panelThumbnailImage ); } else { panelThumbnailImage = $( '&lt;img /&gt;' ).attr( 'src', _defaults.collectionDefaultThumb ).addClass( 'img-responsive' ); panelThumbnail.append( panelThumbnailImage ); } // build title panelHeading.append( panelThumbnail ).append( panelTitle ).append( panelRSS ); // create collapse panelCollapse = $( '&lt;div /&gt;' ).attr( 'id', 'collapse-' + counter ).attr( 'role', 'tabpanel' ).attr( 'aria-expanded', 'false' ).addClass( 'panel-collapse collapse' ); // create panel body panelBody = $( '&lt;div /&gt;' ).addClass( 'panel-body' ).append( _renderSubCollections( member[ &quot;@id&quot; ] ) ); // build collapse panelCollapse.append( panelBody ); // build panel panel.append( panelHeading ).append( panelCollapse ); // build panel group panelGroup.append( panel ); $( _defaults.collectionsSelector ).append( panelGroup ); } ); } /** * Method to retrieve metadata value of the metadata object with the given label and * within the given collection object. * * @param collection {Object} The iiif-presentation collection object cotaining the * metadata. * @param label {String} The label property value of the metadata to return. * @returns {String} The count of works in the collection. */ function _getMetadataValue( collection, label ) { if ( _debug ) { console.log( '---------- _getMetadataValue() ----------' ); console.log( '_getMetadataValue: collection = ', collection ); console.log( '_getMetadataValue: label = ', label ); } var value = ''; collection.metadata.forEach( function( metadata ) { if ( metadata.label == label ) { value = metadata.value; } } ); return value; } /** * Method which renders the subcollections. * * @method _renderSubCollections * @param {String} url The URL to the API which fetches the subcollection data. * @returns {String} The HTML string of the subcollections. */ function _renderSubCollections( url ) { if ( _debug ) { console.log( '---------- _renderSubCollections() ----------' ); console.log( '_renderSubCollections: url = ', url ); } // DOM elements var subCollections = $( '&lt;ul /&gt;' ).addClass( 'list' ); var subCollectionItem = null; var subCollectionItemLink = null; var subCollectionItemRSSLink = null; // get subcollection data $.ajax( { url: url, type: 'GET', datatype: 'JSON' } ).then( function( data ) { subCollectionItem = $( '&lt;li /&gt;' ); if ( !$.isEmptyObject( data.members ) ) { // add subcollection items data.members.forEach( function( member ) { subCollectionItemLink = $( '&lt;a /&gt;' ).attr( 'href', member.rendering[ '@id' ] ).addClass( 'panel-body__collection' ).text( member.label + ' (' + _getMetadataValue( member, 'volumes' ) + ')' ); subCollectionItemRSSLink = $( '&lt;a /&gt;' ).attr( 'href', member.related[ '@id' ] ).attr( 'target', '_blank' ).addClass( 'panel-body__rss' ) .html( '&lt;i class=&quot;fa fa-rss&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;' ); // build subcollection item subCollectionItem.append( subCollectionItemLink ).append( subCollectionItemRSSLink ); subCollections.append( subCollectionItem ); } ); } else { // create empty item link subCollectionItemLink = $( '&lt;a /&gt;' ).attr( 'href', data.rendering[ '@id' ] ).text( _defaults.msg.noSubCollectionText + '.' ); // build empty item subCollectionItem.append( subCollectionItemLink ); subCollections.append( subCollectionItem ); } } ); return subCollections; } return cms; } )( cmsJS || {}, jQuery ); Ã— Search results Close "},"cms_cmsJS.staticGrid.js.html":{"id":"cms_cmsJS.staticGrid.js.html","title":"Source: cms/cmsJS.staticGrid.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: cms/cmsJS.staticGrid.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which initializes a static grid. * * @version 3.2.0 * @module cmsJS.staticGrid * @requires jQuery */ var cmsJS = ( function( cms ) { 'use strict'; // variables var _debug = false; var _data = null; var _defaults = { gridSelector: '.tpl-static-grid__grid' }; // DOM elements var _grid = null; var _gridRow = null; var _gridCol = null; var _gridTile = null; var _gridTileTitle = null; var _gridTileTitleLink = null; var _gridTileTitleH4 = null; var _gridTileImage = null; var _gridTileImageLink = null; cms.staticGrid = { /** * Method which initializes the Masonry Grid. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {String} config.gridSelector The selector for the grid container. * @param {Object} data An data object which contains the images sources for the * grid. */ init: function( config, data ) { if ( _debug ) { console.log( '##############################' ); console.log( 'cmsJS.staticGrid.init' ); console.log( '##############################' ); console.log( 'cmsJS.staticGrid.init: config - ', config ); console.log( 'cmsJS.staticGrid.init: data - ', data ); } $.extend( true, _defaults, config ); // render grid _grid = _buildGrid( data ); $( _defaults.gridSelector ).append( _grid ); } }; /** * Method to build the elements of the static grid. * * @method _buildGrid * @param {Object} data A JSON data object which contains the image informations. * @returns {Object} An jQuery object which contains all grid elements. */ function _buildGrid( data ) { if ( _debug ) { console.log( '---------- _buildGrid() ----------' ); console.log( '_buildGrid: data = ', data ); } _gridRow = $( '&lt;div class=&quot;row&quot; /&gt;' ); data.items.forEach( function( item ) { _gridCol = $( '&lt;div class=&quot;col-xs-6 col-sm-3&quot; /&gt;' ); // tile _gridTile = $( '&lt;div class=&quot;grid-tile&quot; /&gt;' ); // title _gridTileTitle = $( '&lt;div class=&quot;grid-tile__title&quot; /&gt;' ); _gridTileTitleH4 = $( '&lt;h4 /&gt;' ); _gridTileTitleLink = $( '&lt;a /&gt;' ); if ( item.url !== '' ) { _gridTileTitleLink.attr( 'href', item.url ); } else { _gridTileTitleLink.attr( 'href', '#' ); } _gridTileTitleLink.attr( 'title', item.title ); _gridTileTitleLink.append( item.title ); _gridTileTitleH4.append( _gridTileTitleLink ); // image _gridTileImage = $( '&lt;div class=&quot;grid-tile__image&quot; /&gt;' ); _gridTileImage.css( 'background-image', 'url(' + item.name + ')' ); _gridTileImageLink = $( '&lt;a /&gt;' ); if ( item.url !== '' ) { _gridTileImageLink.attr( 'href', item.url ); } else { _gridTileImageLink.attr( 'href', '#' ); } // concat everything _gridTileTitle.append( _gridTileTitleH4 ); _gridTile.append( _gridTileTitle ); _gridTileImage.append( _gridTileImageLink ); _gridTile.append( _gridTileTitle ); _gridTile.append( _gridTileImage ); _gridCol.append( _gridTile ); _gridRow.append( _gridCol ); } ); return _gridRow; } return cms; } )( cmsJS || {}, jQuery ); Ã— Search results Close "},"cms_cmsJS.tagList.js.html":{"id":"cms_cmsJS.tagList.js.html","title":"Source: cms/cmsJS.tagList.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: cms/cmsJS.tagList.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which initializes the tags for the CMS media files. * * @version 3.2.0 * @module cmsJS.tagList * @requires jQuery */ var cmsJS = ( function( cms ) { 'use strict'; var _debug = false; var _defaults = { inputFieldId: 'tagInput', tagListId: 'tagList', autoSuggestUrl: '', msg: { addTagLabel: 'Tag hinzufÃ¼gen' } }; cms.tagList = { tags: [], $tagListElement: null, autoSuggestUrl: null, /** * Method which initializes the tag list. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {String} config.inputFieldId The Selector for the tag input field. * @param {String} config.tagList The Selector for the tag list. * @param {String} config.autoSuggestUrl The URL for the tag auto suggest. * @param {Object} config.msg An object with message keys. */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'cmsJS.tagList.init' ); console.log( '##############################' ); console.log( 'cmsJS.tagList.init: config - ', config ); } $.extend( true, _defaults, config ); this.$inputField = $( '#' + _defaults.inputFieldId ); if ( this.$inputField.length === 0 ) { console.log( 'Data input field not found' ); } this.$tagListElement = $( '#' + _defaults.tagListId ); if ( this.$tagListElement.length === 0 ) { throw 'Tag list element not found'; } this.autoSuggestUrl = _defaults.autoSuggestUrl; this.tags = _readTags( this.$inputField ); _renderList( this.tags, this.$tagListElement ); }, /** * Method which adds a tag to the list. * * @method addTag * @param {String} tagName The current tag name. */ addTag: function( tagName ) { if ( _debug ) { console.log( '---------- cms.tagList.addTag() ----------' ); console.log( 'cmsJS.tagList.addTag: tagName = ', tagName ); } var containedTag = this.getTag( tagName ); if ( containedTag ) { var duration = 200; $( containedTag ).fadeOut( duration / 2, function() { $( containedTag ).fadeIn( duration / 2 ); } ); } else { if ( this.$tagListElement ) { _createListElement( tagName, this.$tagListElement ); } this.saveTags(); } }, /** * Method which deletes a tag from the list. * * @method deleteTag * @param {Object} tag The current tag to delete. */ deleteTag: function( tag ) { if ( _debug ) { console.log( '---------- cms.tagList.deleteTag() ----------' ); console.log( 'cmsJS.tagList.deleteTag: tag = ', tag ); } tag.remove(); this.saveTags(); }, /** * Method to save the tag list. * * @method saveTags */ saveTags: function() { if ( _debug ) { console.log( '---------- cms.tagList.saveTags() ----------' ); } _writeTags( cms.tagList.$tagListElement.children( '[id$=_item]' ), cms.tagList.$inputField ); }, /** * Method to ... * * @method contains */ contains: function( tagName ) { if ( _debug ) { console.log( '---------- cms.tagList.contains() ----------' ); console.log( 'cmsJS.tagList.contains: tagName = ', tagName ); } var found = false; var $tags = cms.tagList.$tagListElement.children( '[id$=_item]' ); $tags.each( function() { var text = $( this ).text(); if ( tagName.trim().toUpperCase() === text.trim().toUpperCase() ) { found = true; return false; } } ); return found; }, /** * Method to ... * * @method close */ close: function() { if ( _debug ) { console.log( '---------- cms.tagList.close() ----------' ); } this.$inputField.off(); this.$tagListElement.off(); this.$tagListElement.find( '.tag-terminator' ).off(); this.$tagListElement.find( 'input' ).off(); }, /** * Method to get all tags. * * @method getTags */ getTags: function() { if ( _debug ) { console.log( '---------- cms.tagList.getTags() ----------' ); } return cms.tagList.$tagListElement.children( '[id$=_item]' ); }, /** * Method to get all tag values. * * @method getTagValues */ getTagValues: function() { if ( _debug ) { console.log( '---------- cms.tagList.getTagValues() ----------' ); } var values = cmsJS.tagList.getTags().map( function( index, tag ) { return $( tag ).text(); } ); return values; }, /** * Method to get a single tag. * * @method getTag */ getTag: function( value ) { if ( _debug ) { console.log( '---------- cms.tagList.getTag() ----------' ); console.log( 'cmsJS.tagList.getTag: value = ', value ); } var selectedTag = undefined; cmsJS.tagList.getTags().each( function( index, tag ) { if ( cmsJS.tagList.getValue( tag ).trim().toUpperCase() === value.trim().toUpperCase() ) { selectedTag = tag; return false; } } ); return selectedTag; }, /** * Method to get a single Value. * * @method getValue */ getValue: function( tag ) { if ( _debug ) { console.log( '---------- cms.tagList.getValue() ----------' ); console.log( 'cmsJS.tagList.getValue: tag = ', tag ); } return $( tag ).text(); } }; /** * Method to ... * * @method _readTags * @param {Object} $input ... */ function _readTags( $input ) { if ( _debug ) { console.log( '---------- _readTags() ----------' ); console.log( '_readTags: $input = ', $input ); } var tagString = $input.val(); if ( !tagString ) { tagString = '[]'; } if ( tagString.length &gt; 0 ) { if ( _debug ) { console.log( '---------- _readTags() ----------' ); console.log( 'tagString: ', tagString ); } try { var tagList = JSON.parse( tagString ); return tagList; } catch ( error ) { console.log( 'Error reading tags from ' + tagString ); return []; } } else { return []; } } /** * Method to ... * * @method _writeTags * @param {Object} $tags ... * @param {Object} $input ... */ function _writeTags( $tags, $input ) { if ( _debug ) { console.log( '---------- _writeTags() ----------' ); console.log( '_writeTags: $tags = ', $tags ); console.log( '_writeTags: $input = ', $input ); } var tags = []; $tags.each( function() { if ( $( this ).text().length &gt; 0 ) { tags.push( $( this ).text() ); } } ) var tagString = JSON.stringify( tags ); $input.val( tagString ); } /** * Method to ... * * @method _renderList * @param {Array} tags ... * @param {Object} $ul ... */ function _renderList( tags, $ul ) { if ( _debug ) { console.log( '---------- _renderList() ----------' ); console.log( '_renderList: tags = ', tags ); console.log( '_renderList: $ul = ', $ul ); } var count = 0; var ulId = $ul.attr( 'id' ); for ( var index = 0; index &lt; tags.length; index++ ) { var tag = tags[ index ]; _createListElement( tag, $ul, count ); count++; } _createTagInputElement( $ul.parent() ); } /** * Method to ... * * @method _createListElement * @param {String} value ... * @param {Object} $parent ... * @param {Number} count */ function _createListElement( value, $parent, count ) { if ( _debug ) { console.log( '---------- _createListElement() ----------' ); console.log( '_createListElement: value = ', value ); console.log( '_createListElement: $parent = ', $parent ); console.log( '_createListElement: count = ', count ); } if ( !count ) { count = $parent.children( '[id$=_item]' ).length; } var ulId = $parent.attr( 'id' ); var $tagInput = $( '.tag-input' ); var $li = $( '&lt;li/&gt;' ); $li.attr( 'id', ulId + '_' + count + '_item' ); var $liText = $( '&lt;span class=&quot;tag label&quot;/&gt;' ); $liText.text( value ); var $terminator = $( '&lt;span /&gt;' ); $terminator.addClass( 'tag-terminator' ); $terminator.on( 'click', _handleClickTerminator ); $li.append( $liText ); $liText.append( $terminator ); if ( $tagInput.length &gt; 0 ) { $li.insertBefore( $tagInput ); } else { $parent.append( $li ); } } /** * Method to ... * * @method _createTagInputElement * @param {Object} $parent ... */ function _createTagInputElement( $parent ) { if ( _debug ) { console.log( '---------- _createTagInputElement() ----------' ); console.log( '_createTagInputElement: $parent = ', $parent ); } var $container = $( '.media-modal__tags' ); var sizeCount = 1; var ulId = $parent.attr( 'id' ); var $inputListElement = $( '&lt;li /&gt;' ); $inputListElement.addClass( 'tag-input' ); var $input = $( '&lt;input type=&quot;text&quot; /&gt;' ); $input.attr( 'id', ulId + '_inputField' ); $input.attr( 'size', sizeCount ); $inputListElement.append( $input ); $parent.find( 'ul' ).append( $inputListElement ); // handler $container.on( 'click', function() { $input.focus(); } ); $input.on( 'change', _handleInputChange ); $input.on( 'keypress', function( event ) { // change size of input sizeCount++; $input.attr( 'size', sizeCount ); // press enter if ( event.keyCode == 13 ) { sizeCount = 1; $input.attr( 'size', sizeCount ); return _handleInputChange( event ); } } ); // autocomplete $input.autocomplete( { source: function( request, response ) { Q( $.ajax( { url: cms.tagList.autoSuggestUrl + request.term + '/', type: 'GET', datatype: 'json', } ) ).then( function( data ) { response( data ); } ) }, appendTo: $input.parent(), select: function( event, ui ) { _handleInputChange( event, ui.item.value ); } } ); } /** * Method to ... * * @method _handleInputChange * @param {Object} event ... * @param {String} text ... */ function _handleInputChange( event, text ) { if ( _debug ) { console.log( '---------- _handleInputChange() ----------' ); console.log( '_handleInputChange: event = ', event ); console.log( '_handleInputChange: text = ', text ); console.log( 'on change occured in: ', event.target ); } if ( !text || text.length === 0 ) { text = $( event.target ).val(); } if ( text.trim().length &gt; 0 ) { cms.tagList.addTag( text ); $( event.target ).val( '' ); } event.preventDefault(); event.stopPropagation(); return false; } /** * Method to ... * * @method _handleClickTerminator * @param {Object} event ... */ function _handleClickTerminator( event ) { if ( _debug ) { console.log( '---------- _handleClickTerminator() ----------' ); console.log( '_handleClickTerminator: event = ', event ); console.log( 'Click on: ', event.currentTarget ); } var $li = $( event.target ).parent().parent(); cms.tagList.deleteTag( $li ); } return cms; } )( cmsJS || {}, jQuery ); Ã— Search results Close "},"cms_cmsJS.tileGrid.js.html":{"id":"cms_cmsJS.tileGrid.js.html","title":"Source: cms/cmsJS.tileGrid.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: cms/cmsJS.tileGrid.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which initializes a tile grid. * * @version 3.2.0 * @module cmsJS.tileGrid * @requires jQuery */ var cmsJS = ( function( cms ) { 'use strict'; // variables var _debug = false; var _data = null; var _tiles = []; var _defaults = { $highlights: null, $grid: null }; // DOM-Elements var $gridItem = null; var $gridItemLink = null; var $gridItemCaptionLink = null; var $gridItemCaptionIcon = null; var $gridItemFigure = null; var $gridItemFigcaption = null; var $gridItemFigcaptionHeader = null; var $gridItemImage = null; cms.tileGrid = { init: function( config, data ) { if ( _debug ) { console.log( '##############################' ); console.log( 'cmsJS.tileGrid.init' ); console.log( '##############################' ); console.log( 'cmsJS.tileGrid.init: config - ', config ); console.log( 'cmsJS.tileGrid.init: data - ', data ); } $.extend( true, _defaults, config ); _tiles = _getTiles( data ); _renderTileGrid( _tiles ); } }; function _getTiles( data ) { if ( _debug ) { console.log( '---------- _getTiles() ----------' ); console.log( '_getTiles: data = ', data ); } var tiles = []; data.items.forEach( function( item ) { $gridItem = $( '&lt;div /&gt;' ); $gridItemLink = $( '&lt;a /&gt;' ); $gridItemCaptionLink = $( '&lt;a /&gt;' ); $gridItemCaptionIcon = $( '&lt;i aria-hidden=&quot;true&quot; /&gt;' ); $gridItemFigure = $( '&lt;figure /&gt;' ); $gridItemFigcaption = $( '&lt;figcaption /&gt;' ); $gridItemFigcaptionHeader = $( '&lt;h3 /&gt;' ); $gridItemImage = $( '&lt;img /&gt;' ); // create item if ( item.important ) { $gridItem.addClass( 'tpl-tile-grid__grid-item important' ); } else { $gridItem.addClass( 'tpl-tile-grid__grid-item' ); } if ( item.size !== '' ) { $gridItem.addClass( item.size ); } $gridItemImage.attr( 'src', item.name ); // $gridItemImage.attr( 'class', 'img-responsive' ); $gridItemImage.attr( 'alt', item.title ); if ( item.url !== '' ) { $gridItemLink.attr( 'href', item.url ); $gridItemLink.append( $gridItemImage ); $gridItemFigure.append( $gridItemLink ); } else { $gridItemFigure.append( $gridItemImage ); } $gridItemFigcaptionHeader.text( item.title ); $gridItemFigure.append( $gridItemFigcaptionHeader ); $gridItemFigcaption.append( item.caption ); if ( item.url !== '' ) { $gridItemCaptionLink.attr( 'href', item.url ); $gridItemCaptionIcon.addClass( 'fa fa-arrow-right' ); $gridItemCaptionLink.append( $gridItemCaptionIcon ); $gridItemFigcaption.append( $gridItemCaptionLink ); } $gridItemFigure.append( $gridItemFigcaption ); $gridItem.append( $gridItemFigure ); // push tile into tiles array tiles.push( $gridItem ); } ); return tiles; } function _renderTileGrid( tiles ) { if ( _debug ) { console.log( '---------- _renderTileGrid() ----------' ); console.log( '_renderTileGrid: tiles = ', tiles ); } tiles.forEach( function( tile ) { if ( tile.hasClass( 'important' ) ) { _defaults.$highlights.append( tile ); } else { _defaults.$grid.append( tile ); } } ); } return cms; } )( cmsJS || {}, jQuery ); Ã— Search results Close "},"cms_cmsJS.js.html":{"id":"cms_cmsJS.js.html","title":"Source: cms/cmsJS.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: cms/cmsJS.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Base-Module which initialize the global Content Management System (CMS) object. * * @version 3.2.0 * @module cmsJS * @requires jQuery */ var cmsJS = ( function() { 'use strict'; var _debug = false; var cms = {}; /** * Method which initializes the CMS. * * @method init * @example * * &lt;pre&gt; * cmsJS.init(); * &lt;/pre&gt; */ cms.init = function() { if ( _debug ) { console.log( '##############################' ); console.log( 'cmsJS.init' ); console.log( '##############################' ); } // AJAX Loader Eventlistener jsf.ajax.addOnEvent( function( data ) { var ajaxstatus = data.status; // Can be &quot;begin&quot;, &quot;complete&quot; and &quot;success&quot; var ajaxloader = document.getElementById( &quot;AJAXLoader&quot; ); if ( ajaxloader ) { switch ( ajaxstatus ) { case &quot;begin&quot;: // This is called right before ajax request is been // sent. ajaxloader.style.display = 'block'; break; case &quot;complete&quot;: // This is called right after ajax response is // received. ajaxloader.style.display = 'none'; break; case &quot;success&quot;: // This is called when ajax response is successfully // processed. // NOOP. break; } } } ); }; cms.dataTables_de = { &quot;sEmptyTable&quot;: &quot;Keine Daten in der Tabelle vorhanden&quot;, &quot;sInfo&quot;: &quot;_START_ bis _END_ von _TOTAL_ EintrÃ¤gen&quot;, &quot;sInfoEmpty&quot;: &quot;0 bis 0 von 0 EintrÃ¤gen&quot;, &quot;sInfoFiltered&quot;: &quot;(gefiltert von _MAX_ EintrÃ¤gen)&quot;, &quot;sInfoPostFix&quot;: &quot;&quot;, &quot;sInfoThousands&quot;: &quot;.&quot;, &quot;sLengthMenu&quot;: &quot;_MENU_ EintrÃ¤ge anzeigen&quot;, &quot;sLoadingRecords&quot;: &quot;Wird geladen...&quot;, &quot;sProcessing&quot;: &quot;Bitte warten...&quot;, &quot;sSearch&quot;: &quot;Suchen&quot;, &quot;sZeroRecords&quot;: &quot;Keine EintrÃ¤ge vorhanden.&quot;, &quot;oPaginate&quot;: { &quot;sFirst&quot;: &quot;Erste&quot;, &quot;sPrevious&quot;: &quot;ZurÃ¼ck&quot;, &quot;sNext&quot;: &quot;NÃ¤chste&quot;, &quot;sLast&quot;: &quot;Letzte&quot; }, &quot;oAria&quot;: { &quot;sSortAscending&quot;: &quot;: aktivieren, um Spalte aufsteigend zu sortieren&quot;, &quot;sSortDescending&quot;: &quot;: aktivieren, um Spalte absteigend zu sortieren&quot; } }; cms.dataTables_en = { &quot;sEmptyTable&quot;: &quot;No data available in table&quot;, &quot;sInfo&quot;: &quot;Showing _START_ to _END_ of _TOTAL_ entries&quot;, &quot;sInfoEmpty&quot;: &quot;Showing 0 to 0 of 0 entries&quot;, &quot;sInfoFiltered&quot;: &quot;(filtered from _MAX_ total entries)&quot;, &quot;sInfoPostFix&quot;: &quot;&quot;, &quot;sInfoThousands&quot;: &quot;,&quot;, &quot;sLengthMenu&quot;: &quot;Show _MENU_ entries&quot;, &quot;sLoadingRecords&quot;: &quot;Loading...&quot;, &quot;sProcessing&quot;: &quot;Processing...&quot;, &quot;sSearch&quot;: &quot;Search:&quot;, &quot;sZeroRecords&quot;: &quot;No matching records found&quot;, &quot;oPaginate&quot;: { &quot;sFirst&quot;: &quot;First&quot;, &quot;sLast&quot;: &quot;Last&quot;, &quot;sNext&quot;: &quot;Next&quot;, &quot;sPrevious&quot;: &quot;Previous&quot; }, &quot;oAria&quot;: { &quot;sSortAscending&quot;: &quot;: activate to sort column ascending&quot;, &quot;sSortDescending&quot;: &quot;: activate to sort column descending&quot; } }; cms.dataTables_es = { &quot;sProcessing&quot;: &quot;Procesando...&quot;, &quot;sLengthMenu&quot;: &quot;Mostrar _MENU_ registros&quot;, &quot;sZeroRecords&quot;: &quot;No se encontraron resultados&quot;, &quot;sEmptyTable&quot;: &quot;NingÃºn dato disponible en esta tabla&quot;, &quot;sInfo&quot;: &quot;Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros&quot;, &quot;sInfoEmpty&quot;: &quot;Mostrando registros del 0 al 0 de un total de 0 registros&quot;, &quot;sInfoFiltered&quot;: &quot;(filtrado de un total de _MAX_ registros)&quot;, &quot;sInfoPostFix&quot;: &quot;&quot;, &quot;sSearch&quot;: &quot;Buscar:&quot;, &quot;sUrl&quot;: &quot;&quot;, &quot;sInfoThousands&quot;: &quot;,&quot;, &quot;sLoadingRecords&quot;: &quot;Cargando...&quot;, &quot;oPaginate&quot;: { &quot;sFirst&quot;: &quot;Primero&quot;, &quot;sLast&quot;: &quot;Ãšltimo&quot;, &quot;sNext&quot;: &quot;Siguiente&quot;, &quot;sPrevious&quot;: &quot;Anterior&quot; }, &quot;oAria&quot;: { &quot;sSortAscending&quot;: &quot;: Activar para ordenar la columna de manera ascendente&quot;, &quot;sSortDescending&quot;: &quot;: Activar para ordenar la columna de manera descendente&quot; } }; return cms; } )( jQuery ); Ã— Search results Close "},"viewer_viewerJS.js.html":{"id":"viewer_viewerJS.js.html","title":"Source: viewer/viewerJS.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Base-Module which initialize the global viewer object. * * @version 3.2.0 * @module viewerJS */ var viewerJS = ( function() { 'use strict'; var _debug = false; var _defaults = { currentPage: '', browser: '', sidebarSelector: '#sidebar', contentSelector: '#main', equalHeightRSSInterval: 1000, equalHeightInterval: 500, messageBoxSelector: '.messages .alert', messageBoxInterval: 1000, messageBoxTimeout: 8000, pageScrollSelector: '.icon-totop', pageScrollAnchor: '#top', widgetNerSidebarRight: false }; var viewer = {}; viewer.init = function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.init' ); console.log( '##############################' ); console.log( 'viewer.init: config - ', config ); } $.extend( true, _defaults, config ); // detect current browser _defaults.browser = viewerJS.helper.getCurrentBrowser(); console.info( 'Current Page = ', _defaults.currentPage ); console.info( 'Current Browser = ', _defaults.browser ); /* * ! IE10 viewport hack for Surface/desktop Windows 8 bug Copyright 2014-2015 * Twitter, Inc. Licensed under MIT * (https://github.com/twbs/bootstrap/blob/master/LICENSE) */ // See the Getting Started docs for more information: // http://getbootstrap.com/getting-started/#support-ie10-width ( function() { 'use strict'; if ( navigator.userAgent.match( /IEMobile\\/10\\.0/ ) ) { var msViewportStyle = document.createElement( 'style' ) msViewportStyle.appendChild( document.createTextNode( '@-ms-viewport{width:auto!important}' ) ) document.querySelector( 'head' ).appendChild( msViewportStyle ) } } )(); // enable BS tooltips $( '[data-toggle=&quot;tooltip&quot;]' ).tooltip(); // render warning if local storage is not useable if ( !viewer.localStoragePossible ) { var warningPopover = this.helper .renderWarningPopover( 'Ihr Browser befindet sich im privaten Modus und unterstÃ¼tzt die MÃ¶glichkeit Informationen zur Seite lokal zu speichern nicht. Aus diesem Grund sind nicht alle Funktionen des viewers verfÃ¼gbar. Bitte verlasen Sie den privaten Modus oder benutzen einen alternativen Browser. Vielen Dank.' ); $( 'body' ).append( warningPopover ); $( '[data-toggle=&quot;warning-popover&quot;]' ).on( 'click', function() { $( '.warning-popover' ).fadeOut( 'fast', function() { $( '.warning-popover' ).remove(); } ); } ); } // off canvas $( '[data-toggle=&quot;offcanvas&quot;]' ).click( function() { var icon = $( this ).children( '.glyphicon' ); $( '.row-offcanvas' ).toggleClass( 'active' ); $( this ).toggleClass( 'in' ); if ( icon.hasClass( 'glyphicon-option-vertical' ) ) { icon.removeClass( 'glyphicon-option-vertical' ).addClass( 'glyphicon-option-horizontal' ); } else { icon.removeClass( 'glyphicon-option-horizontal' ).addClass( 'glyphicon-option-vertical' ); } } ); // toggle mobile navigation $( '[data-toggle=&quot;mobilenav&quot;]' ).on( 'click', function() { $( '.btn-toggle.search' ).removeClass( 'in' ); $( '.header-actions__search' ).hide(); $( '.btn-toggle.language' ).removeClass( 'in' ); $( '#changeLocal' ).hide(); $( '#mobileNav' ).slideToggle( 'fast' ); } ); $( '[data-toggle=&quot;mobile-image-controls&quot;]' ).on( 'click', function() { $( '.image-controls__actions' ).slideToggle( 'fast' ); } ); // toggle language $( '[data-toggle=&quot;language&quot;]' ).on( 'click', function() { $( '.btn-toggle.search' ).removeClass( 'in' ); $( '.header-actions__search' ).hide(); $( this ).toggleClass( 'in' ); $( '#changeLocal' ).fadeToggle( 'fast' ); } ); // toggle search $( '[data-toggle=&quot;search&quot;]' ).on( 'click', function() { $( '.btn-toggle.language' ).removeClass( 'in' ); $( '#changeLocal' ).hide(); $( this ).toggleClass( 'in' ); $( '.header-actions__search' ).fadeToggle( 'fast' ); } ); // set content height to sidebar height if ( window.matchMedia( '(max-width: 768px)' ).matches ) { if ( $( '.rss_wrapp' ).length &gt; 0 ) { setTimeout( function() { viewerJS.helper.equalHeight( _defaults.sidebarSelector, _defaults.contentSelector ); }, _defaults.equalHeightRSSInterval ); } else { setTimeout( function() { viewerJS.helper.equalHeight( _defaults.sidebarSelector, _defaults.contentSelector ); }, _defaults.equalHeightInterval ); } $( window ).on( &quot;orientationchange&quot;, function() { viewerJS.helper.equalHeight( _defaults.sidebarSelector, _defaults.contentSelector ); } ); } // fade out message box if it exists ( function() { var fadeoutScheduled = false; setInterval( function() { if ( $( _defaults.messageBoxSelector ).size() &gt; 0 ) { if ( !fadeoutScheduled ) { fadeoutScheduled = true; var messageTimer = setTimeout( function() { $( _defaults.messageBoxSelector ).each( function() { $( this ).fadeOut( 'slow', function() { $( this ).parent().remove(); } ) } ); fadeoutScheduled = false; }, _defaults.messageBoxTimeout ); } } }, _defaults.messageBoxInterval ); } )(); // add class on toggle sidebar widget (CMS individual sidebar widgets) $( '.collapse' ).on( 'show.bs.collapse', function() { $( this ).prev().find( '.glyphicon' ).removeClass( 'glyphicon-arrow-down' ).addClass( 'glyphicon-arrow-up' ); } ); $( '.collapse' ).on( 'hide.bs.collapse', function() { $( this ).prev().find( '.glyphicon' ).removeClass( 'glyphicon-arrow-up' ).addClass( 'glyphicon-arrow-down' ); } ); // scroll page animated this.pageScroll.init( _defaults.pageScrollSelector, _defaults.pageScrollAnchor ); // check for sidebar toc and set viewport position if ( viewer.localStoragePossible ) { if ( $( '#image_container' ).length &gt; 0 || currentPage === 'readingmode' ) { if ( localStorage.getItem( 'currIdDoc' ) === null ) { localStorage.setItem( 'currIdDoc', 'false' ); } this.helper.saveSidebarTocPosition(); } else { localStorage.setItem( 'sidebarTocScrollPosition', 0 ); } } // AJAX Loader Eventlistener if ( typeof jsf !== 'undefined' ) { jsf.ajax.addOnEvent( function( data ) { var ajaxstatus = data.status; var ajaxloader = document.getElementById( &quot;AJAXLoader&quot; ); var ajaxloaderSidebarToc = document.getElementById( &quot;AJAXLoaderSidebarToc&quot; ); if ( ajaxloaderSidebarToc &amp;&amp; ajaxloader ) { switch ( ajaxstatus ) { case &quot;begin&quot;: ajaxloaderSidebarToc.style.display = 'block'; ajaxloader.style.display = 'none'; break; case &quot;complete&quot;: ajaxloaderSidebarToc.style.display = 'none'; ajaxloader.style.display = 'none'; break; case &quot;success&quot;: // enable BS tooltips $( '[data-toggle=&quot;tooltip&quot;]' ).tooltip(); if ( viewer.localStoragePossible ) { viewer.helper.saveSidebarTocPosition(); $( '.widget-toc-elem-wrapp' ).scrollTop( localStorage.sidebarTocScrollPosition ); } // set content height to sidebar height if ( window.matchMedia( '(max-width: 768px)' ).matches ) { viewerJS.helper.equalHeight( _defaults.sidebarSelector, _defaults.contentSelector ); $( window ).off().on( &quot;orientationchange&quot;, function() { viewerJS.helper.equalHeight( _defaults.sidebarSelector, _defaults.contentSelector ); } ); } break; } } else if ( ajaxloader ) { switch ( ajaxstatus ) { case &quot;begin&quot;: ajaxloader.style.display = 'block'; break; case &quot;complete&quot;: ajaxloader.style.display = 'none'; break; case &quot;success&quot;: // enable BS tooltips $( '[data-toggle=&quot;tooltip&quot;]' ).tooltip(); // set content height to sidebar height if ( window.matchMedia( '(max-width: 768px)' ).matches ) { viewerJS.helper.equalHeight( _defaults.sidebarSelector, _defaults.contentSelector ); $( window ).off().on( &quot;orientationchange&quot;, function() { viewerJS.helper.equalHeight( _defaults.sidebarSelector, _defaults.contentSelector ); } ); } break; } } else { switch ( ajaxstatus ) { case &quot;success&quot;: // enable BS tooltips $( '[data-toggle=&quot;tooltip&quot;]' ).tooltip(); // set content height to sidebar height if ( window.matchMedia( '(max-width: 768px)' ).matches ) { viewerJS.helper.equalHeight( _defaults.sidebarSelector, _defaults.contentSelector ); $( window ).off().on( &quot;orientationchange&quot;, function() { viewerJS.helper.equalHeight( _defaults.sidebarSelector, _defaults.contentSelector ); } ); } break; } } } ); } // disable submit button on feedback if ( currentPage === 'feedback' ) { $( '#submitFeedbackBtn' ).attr( 'disabled', true ); } // set sidebar position for NER-Widget if ( $( '#widgetNerFacetting' ).length &gt; 0 ) { nerFacettingConfig.sidebarRight = _defaults.widgetNerSidebarRight; this.nerFacetting.init( nerFacettingConfig ); } // make sure only integer values may be entered in input fields of class // 'input-integer' $( '.input-integer' ).on( &quot;keypress&quot;, function( event ) { if ( event.which &lt; 48 || event.which &gt; 57 ) { return false; } } ); // make sure only integer values may be entered in input fields of class // 'input-integer' $( '.input-float' ).on( &quot;keypress&quot;, function( event ) { console.log( event ); switch ( event.which ) { case 8: // delete case 9: // tab case 13: // enter case 46: // dot case 44: // comma case 43: // plus case 45: // minus return true; case 118: return event.ctrlKey; // copy default: switch ( event.keyCode ) { case 8: // delete case 9: // tab case 13: // enter return true; default: if ( event.which &lt; 48 || event.which &gt; 57 ) { return false; } else { return true; } } } } ); // set tinymce language this.tinyConfig.language = currentLang; if ( currentPage === 'adminCmsCreatePage' ) { this.tinyConfig.setup = function( ed ) { // listen to changes on tinymce input fields ed.on( 'change input paste', function( e ) { tinymce.triggerSave(); createPageConfig.prevBtn.attr( 'disabled', true ); createPageConfig.prevDescription.show(); } ); }; // TODO: FÃ¼r ZLB in der custom.js einbauen // viewerJS.tinyConfig.textcolor_map = [ &quot;FFFFFF&quot;, &quot;ZLB-WeiÃŸ&quot;, &quot;333333&quot;, // &quot;ZLB-Schwarz&quot;, &quot;dedede&quot;, &quot;ZLB-Hellgrau&quot;, &quot;727c87&quot;, &quot;ZLB-Mittelgrau&quot;, // &quot;9a9a9a&quot;, &quot;ZLB-Dunkelgrau&quot;, // &quot;CD0000&quot;, &quot;ZLB-Rot&quot;, &quot;92406d&quot;, &quot;ZLB-Lila&quot;, &quot;6f2c40&quot;, &quot;ZLB-Bordeaux&quot;, // &quot;ffa100&quot;, &quot;ZLB-Orange&quot;, &quot;669933&quot;, &quot;ZLB-GrÃ¼n&quot;, &quot;3e5d1e&quot;, &quot;ZLB-DunkelgrÃ¼n&quot;, // &quot;a9d0f5&quot;, // &quot;ZLB-Hellblau&quot;, &quot;28779f&quot;, &quot;ZLB-Blau&quot; ]; } if ( currentPage === 'overview' ) { // activate menubar viewerJS.tinyConfig.menubar = true; viewerJS.tinyMce.overview(); } // AJAX Loader Eventlistener for tinyMCE if ( typeof jsf !== 'undefined' ) { jsf.ajax.addOnEvent( function( data ) { var ajaxstatus = data.status; switch ( ajaxstatus ) { case &quot;success&quot;: if ( currentPage === 'overview' ) { viewerJS.tinyMce.overview(); } viewerJS.tinyMce.init( viewerJS.tinyConfig ); break; } } ); } // init tinymce if it exists if ( $( '.tinyMCE' ).length &gt; 0 ) { viewerJS.tinyMce.init( this.tinyConfig ); } // handle browser bugs switch ( _defaults.browser ) { case 'Chrome': /* BROKEN IMAGES */ $( 'img' ).error( function() { $( this ).addClass( 'broken' ); } ); break; case 'Firefox': /* BROKEN IMAGES */ $( &quot;img&quot; ).error( function() { $( this ).hide(); } ); /* 1px BUG */ if ( $( '.image-doublePageView' ).length &gt; 0 ) { $( '.image-doublePageView' ).addClass( 'oneUp' ); } break; case 'IE': /* SET IE CLASS TO HTML */ $( 'html' ).addClass( 'is-IE' ); /* BROKEN IMAGES */ $( &quot;img&quot; ).error( function() { $( this ).hide(); } ); break; case 'Edge': /* BROKEN IMAGES */ $( &quot;img&quot; ).error( function() { $( this ).hide(); } ); break; case 'Safari': /* BROKEN IMAGES */ $( &quot;img&quot; ).error( function() { $( this ).hide(); } ); break; } }; // global object for tinymce config viewer.tinyConfig = {}; return viewer; } )( jQuery ); Ã— Search results Close "},"viewImage_viewImage.js.html":{"id":"viewImage_viewImage.js.html","title":"Source: viewImage/viewImage.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewImage/viewImage.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which initializes the viewerJS module. * * @version 3.2.0 * @module viewImage * @requires jQuery */ var viewImage = ( function() { 'use strict'; var osViewer = {}; var _debug = false; var _footerImage = null; var _canvasScale; var _container; var _defaults = { global: { divId: &quot;map&quot;, zoomSlider: &quot;.zoom-slider&quot;, zoomSliderHandle: '.zoom-slider-handle', overlayGroups: [ { name: &quot;searchHighlighting&quot;, styleClass: &quot;coords-highlighting&quot;, interactive: false }, { name: &quot;ugc&quot;, styleClass: &quot;ugcBox&quot;, interactive: true } ], zoomSpeed: 1.25, maxZoomLevel: 20, minZoomLevel: 1, imageControlsActive: true, visibilityRatio: 0.4, loadImageTimeout: 10 * 60 * 1000, maxParallelImageLoads: 4, adaptContainerHeight: false, footerHeight: 50, rememberZoom: false, rememberRotation: false, }, image: {}, getOverlayGroup: function( name ) { var allGroups = _defaults.global.overlayGroups; for ( var int = 0; int &lt; allGroups.length; int++ ) { var group = allGroups[ int ]; if ( group.name === name ) { return group; } } }, getCoordinates: function( name ) { var coodinatesArray = _defaults.image.highlightCoords; if ( coodinatesArray ) { for ( var int = 0; int &lt; coodinatesArray.length; int++ ) { var coords = coodinatesArray[ int ]; if ( coords.name === name ) { return coords; } } } }, }; osViewer = { viewer: null, init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'osViewer.init' ); console.log( '##############################' ); } // constructor $.extend( true, _defaults, config ); // convert mimeType &quot;image/jpeg&quot; to &quot;image/jpg&quot; to provide correct // iiif calls _defaults.image.mimeType = _defaults.image.mimeType.replace(&quot;jpeg&quot;,&quot;jpg&quot;); _container = $( &quot;#&quot; + _defaults.global.divId ); var sources = _defaults.image.tileSource; if(typeof sources === 'string' &amp;&amp; sources.startsWith(&quot;[&quot;)) { sources = JSON.parse(sources); } else if(!$.isArray(sources)) { sources = [sources]; } var promises = []; for ( var i=0; i&lt;sources.length; i++) { var source = sources[i]; // returns the OpenSeadragon.TileSource if it can be created, // otherweise // rejects the promise var promise = viewImage.createTileSource(source); promises.push(promise); } return Q.all(promises).then(function(tileSources) { var minWidth = Number.MAX_VALUE; var minHeight = Number.MAX_VALUE; var minAspectRatio = Number.MAX_VALUE; for ( var j=0; j&lt;tileSources.length; j++) { var tileSource = tileSources[j]; minWidth = Math.min(minWidth, tileSource.width); minHeight = Math.min(minHeight, tileSource.height); minAspectRatio = Math.min(minAspectRatio, tileSource.aspectRatio); } if(_debug) { console.log(&quot;Min aspect ratio = &quot; + minAspectRatio); } var x = 0; for ( var i=0; i&lt;tileSources.length; i++) { var tileSource = tileSources[i]; tileSources[i] = { tileSource: tileSource, width: tileSource.aspectRatio/minAspectRatio, // height: minHeight/tileSource.height, x : x, y: 0, } x += tileSources[i].width; } return viewImage.loadImage(tileSources); }); }, loadImage : function(tileSources) { if ( _debug ) { console.log( 'Loading image with tilesource: ', tileSources ); } osViewer.loadFooter(); osViewer.viewer = new OpenSeadragon( { immediateRender: false, visibilityRatio: _defaults.global.visibilityRatio, sequenceMode: false, id: _defaults.global.divId, controlsEnabled: false, prefixUrl: &quot;/openseadragon-bin/images/&quot;, zoomPerClick: 1, maxZoomLevel: _defaults.global.maxZoomLevel, minZoomLevel: _defaults.global.minZoomLevel, zoomPerScroll: _defaults.global.zoomSpeed, mouseNavEnabled: _defaults.global.zoomSpeed &gt; 1, showNavigationControl: false, showZoomControl: false, showHomeControl: false, showFullPageControl: true, timeout: _defaults.global.loadImageTimeout, tileSources: tileSources, blendTime: .5, alwaysBlend: false, imageLoaderLimit: _defaults.global.maxParallelImageLoads, viewportMargins: { top: 0, left: 0, right: 0, bottom: _defaults.global.footerHeight } } ); var result = Q.defer(); osViewer.observables = createObservables(window, osViewer.viewer); osViewer.observables.viewerOpen.subscribe(function(openevent, loadevent) { result.resolve(osViewer); }, function(error) { result.reject(error); }); // Calculate sizes if redraw is required osViewer.observables.redrawRequired.subscribe(function(event) { if(_debug) { console.log(&quot;viewer &quot; + event.osState + &quot;ed with target location &quot;, event.targetLocation); } osViewer.redraw(); }); if ( osViewer.controls ) { osViewer.controls.init( _defaults ); } if ( osViewer.zoomSlider ) { osViewer.zoomSlider.init( _defaults ); } if ( osViewer.overlays ) { osViewer.overlays.init( _defaults ); } if ( osViewer.drawRect ) { osViewer.drawRect.init(); } if ( osViewer.transformRect ) { osViewer.transformRect.init(); } osViewer.observables.redrawRequired.connect(); return result.promise; }, getObservables: function() { console.log(&quot;Observables = &quot;, osViewer.observables); return osViewer.observables; }, hasFooter: function() { return _footerImage != null; }, getConfig: function() { return _defaults; }, loadFooter: function() { if ( _defaults.image.baseFooterUrl &amp;&amp; _defaults.global.footerHeight &gt; 0 ) { _footerImage = new Image(); _footerImage.src = _defaults.image.baseFooterUrl.replace( &quot;{width}&quot;, Math.round( _container.width() ) ).replace( &quot;{height}&quot;, Math.round( _defaults.global.footerHeight ) ); _footerImage.src = _defaults.image.baseFooterUrl.replace( &quot;/full/max/&quot;, &quot;/full/!&quot; + Math.round( _container.width() ) + &quot;,&quot; + Math.round( _defaults.global.footerHeight ) + &quot;/&quot;); _footerImage.onload = function() { if ( _debug ) { console.log( &quot;loading footer image &quot;, _footerImage ); console.log( &quot;Calculating image Footer size&quot; ); } osViewer.drawFooter(); }; } }, drawFooter: function() { if ( osViewer.viewer ) { _overlayFooter(); } osViewer.viewer.removeHandler( 'update-viewport', _overlayFooter ); osViewer.viewer.addHandler( 'update-viewport', _overlayFooter ); }, getOverlayGroup: function( name ) { return _defaults.getOverlayGroup( name ); }, getHighlightCoordinates: function( name ) { return _defaults.getCoordinates( name ); }, createPyramid: function( imageInfo ) { var fileExtension = _defaults.image.mimeType; fileExtension = fileExtension.replace( &quot;image/&quot;, &quot;&quot; ); fileExtension = fileExtension.replace(&quot;jpeg&quot;, &quot;jpg&quot;).replace(&quot;tiff&quot;, &quot;tif&quot;); var imageLevels = []; var tileSource; if(Array.isArray(imageInfo)) { imageInfo.forEach(function(level) { level.mimetype = _defaults.image.mimeType; }); tileSource = new OpenSeadragon.LegacyTileSource(imageInfo); } else if(imageInfo.sizes) { imageInfo.sizes.forEach(function(size) { if(_debug) { console.log(&quot;Image level width = &quot;, size.width) console.log(&quot;Image level height = &quot;, size.height) } var level = { mimetype: _defaults.image.mimeType, url: imageInfo[&quot;@id&quot;].replace( &quot;/info.json&quot;, &quot;&quot; ) + &quot;/full/&quot; + size.width + &quot;,/0/default.&quot; + fileExtension, width: imageInfo.width, height: imageInfo.height }; if(_debug) { console.log(&quot;Created level &quot;, level); } imageLevels.push( level ); }); tileSource = new OpenSeadragon.LegacyTileSource(imageLevels); } else { tileSource = new OpenSeadragon.ImageTileSource({ url: imageInfo[&quot;@id&quot;].replace( &quot;/info.json&quot;, &quot;&quot; ) + &quot;/full/full/0/default.&quot; + fileExtension, crossOriginPolicy: &quot;Anonymous&quot;, buildPyramid: false }); } return tileSource; }, getSizes: function() { return osViewer.sizes; }, addImage: function( url, width, height ) { if ( _debug ) { console.log( 'osViewer.addImage: url - ' + url ); console.log( 'osViewer.addImage: width - ' + width ); console.log( 'osViewer.addImage: height - ' + height ); } if ( osViewer.viewer ) { osViewer.viewer.addTiledImage( { tileSource: { type: &quot;legacy-image-pyramid&quot;, levels: [ { url: url, height: height, width: width } ] }, x: 0, y: 1.6, width: 1 } ); } else { if ( _debug ) { console.log( &quot;Viewer not initialized yet; cannot add image&quot; ); } } }, getImageInfo: function() { if(osViewer.viewer) { return osViewer.viewer.tileSources; } return null; }, getScaleToOriginalSize: function(imageNo) { return 1.0; // if(!imageNo) { // imageNo = 0; // } // var displaySize = osViewer.viewer.viewport._contentSize.x; // return osViewer.getImageInfo()[imageNo].tileSource.width / displaySize; }, scaleToOriginalSize: function( value, imageNo ) { return value; // if ( _debug ) { // console.log( 'Overlays _scaleToOriginalSize: value - ' + value ); // } // // if(!imageNo) { // imageNo = 0; // } // // var displaySize = osViewer.viewer.viewport._contentSize.x; // return value / displaySize * osViewer.getImageInfo()[imageNo].tileSource.width; }, scaleToImageSize: function( value, imageNo ) { return value; // if ( _debug ) { // console.log( 'Overlays _scaleToImageSize: value - ' + value ); // } // // if(!imageNo) { // imageNo = 0; // } // // var displaySize = osViewer.viewer.viewport._contentSize.x; // return value * displaySize / osViewer.getImageInfo()[imageNo].tileSource.width; }, close: function() { if ( _debug ) { console.log( &quot;Closing openSeadragon viewer&quot; ); } if ( osViewer.viewer ) { osViewer.viewer.destroy(); } }, redraw: function() { if(osViewer.controls) { osViewer.controls.setPanning( true ); } _calculateSizes(osViewer); }, setImageSizes: function(imageInfo, sizes) { if(sizes) { var string = sizes.replace(/[\\{\\}]/, &quot;&quot;); var sizes = JSON.parse(sizes); var iiifSizes = []; sizes.forEach(function(size) { iiifSizes.push({&quot;width&quot;: parseInt(size), &quot;height&quot;: parseInt(size)}); }); if(iiifSizes.length &gt; 0) { imageInfo.sizes = iiifSizes; } else { delete imageInfo.sizes; } } }, setTileSizes: function(imageInfo, tiles) { if(tiles) { var tileString = viewImage.getConfig().global.tileSizes.replace(/(\\d+)/, '&quot;$1&quot;').replace(&quot;=&quot;, &quot;:&quot;); var tiles = JSON.parse(tileString); var iiifTiles = []; Object.keys(tiles).forEach(function(size) { var scaleFactors = tiles[size]; iiifTiles.push({&quot;width&quot;: parseInt(size), &quot;height&quot;: parseInt(size), &quot;scaleFactors&quot;: scaleFactors}) }); imageInfo.tiles = iiifTiles; } }, onFirstTileLoaded: function() { var defer = Q.defer(); if(viewImage.observables) { viewImage.observables.firstTileLoaded.subscribe(function(event) { defer.resolve(event); }, function(error) { defer.reject(error) }); } else { defer.reject(&quot;No observables defined&quot;); } return defer.promise; }, createTileSource: function(source) { var result = Q.defer(); viewImage.tileSourceResolver.resolveAsJson(source) .then( function(imageInfo) { if(_debug) { console.log(&quot;IIIF image info &quot;, imageInfo); } viewImage.setImageSizes(imageInfo, _defaults.global.imageSizes); viewImage.setTileSizes(imageInfo, _defaults.global.tileSizes); var tileSource; if(imageInfo.tiles) { tileSource = new OpenSeadragon.IIIFTileSource(imageInfo); } else { tileSource = osViewer.createPyramid(imageInfo); } return tileSource; }, function(error) { if(viewImage.tileSourceResolver.isURI(_defaults.image.tileSource)) { if(_debug) { console.log(&quot;Image URL&quot;, _defaults.image.tileSource); } var tileSource = new OpenSeadragon.ImageTileSource( { url: _defaults.image.tileSource, buildPyramid: true, crossOriginPolicy: false } ); return tileSource; } else { var errorMsg = &quot;Failed to load tilesource from &quot; + tileSource; if(_debug) { console.log(errorMsg); } return Q.reject(errorMsg); } }) .then(function(tileSource) { result.resolve(tileSource); }).catch(function(errorMessage) { result.reject(errorMessage); }); return result.promise; } }; function createObservables(window, viewer) { var observables = {}; observables.viewerOpen = Rx.Observable.create(function(observer) { viewer.addOnceHandler( 'open', function( event ) { event.osState = &quot;open&quot;; if(Number.isNaN(event.eventSource.viewport.getHomeBounds().x)) { return observer.onError(&quot;Unknow error loading image from &quot;, _defaults.image.tileSource); } else { return observer.onNext(event); } } ); viewer.addOnceHandler( 'open-failed', function( event ) { event.osState = &quot;open-failed&quot;; console.log(&quot;Failed to open openseadragon &quot;); return observer.onError(event); } ); }); observables.firstTileLoaded = Rx.Observable.create(function(observer) { viewer.addOnceHandler( 'tile-loaded', function( event ) { event.osState = &quot;tile-loaded&quot;; return observer.onNext(event); } ); viewer.addOnceHandler( 'tile-load-failed', function( event ) { event.osState = &quot;tile-load-failed&quot;; console.log(&quot;Failed to load tile&quot;); return observer.onError(event); } ); }); observables.viewerZoom = Rx.Observable.create(function(observer) { viewer.addHandler( 'zoom', function( event ) { return observer.onNext(event); } ); }); observables.animationComplete = Rx.Observable.create(function(observer) { viewer.addHandler( 'animation-finish', function( event ) { return observer.onNext(event); } ); }); observables.viewportUpdate = Rx.Observable.create(function(observer) { viewer.addHandler( 'update-viewport', function( event ) { return observer.onNext(event); } ); }); observables.animation = Rx.Observable.create(function(observer) { viewer.addHandler( 'animation', function( event ) { return observer.onNext(event); } ); }); observables.viewerRotate = Rx.Observable.create(function(observer) { viewer.addHandler( 'rotate', function( event ) { event.osState = &quot;rotate&quot;; return observer.onNext(event); } ); }); observables.canvasResize = Rx.Observable.create(function(observer) { viewer.addHandler( 'resize', function( event ) { event.osState = &quot;resize&quot;; return observer.onNext(event); } ); }); observables.windowResize = Rx.Observable.fromEvent(window, &quot;resize&quot;).map(function(event) { event.osState = &quot;window resize&quot;; return event; }); observables.overlayRemove = Rx.Observable.create(function(observer) { viewer.addHandler( 'remove-overlay', function( event ) { return observer.onNext(event); } ); }); observables.overlayUpdate = Rx.Observable.create(function(observer) { viewer.addHandler( 'update-overlay', function( event ) { return observer.onNext(event); } ); }); observables.levelUpdate = Rx.Observable.create(function(observer) { viewer.addHandler( 'update-level', function( event ) { return observer.onNext(event); } ); }); observables.redrawRequired = observables.viewerOpen .merge(observables.viewerRotate .merge(observables.canvasResize) .debounce(10)) .map(function(event) { var location = {}; if(osViewer.controls) { location = osViewer.controls.getLocation(); } if(event.osState === &quot;open&quot;) { location.zoom = osViewer.viewer.viewport.getHomeZoom(); if(_defaults.image.location) { location = _defaults.image.location; } } event.targetLocation = location; return event; }).publish(); return observables; } function _calculateSizes(osViewer) { if ( _debug ) { console.log( &quot;viewImage: calcualte sizes&quot; ); console.log(&quot;Home zoom = &quot;, osViewer.viewer.viewport.getHomeZoom()); } osViewer.sizes = new viewImage.Measures( osViewer ); if ( _defaults.global.adaptContainerHeight ) { osViewer.sizes.resizeCanvas(); } if ( osViewer.viewer != null ) { osViewer.viewer.viewport.setMargins( {bottom: osViewer.sizes.footerHeight + osViewer.sizes.calculateExcessHeight()} ); } if ( _debug ) { console.log( &quot;sizes: &quot;, osViewer.sizes ); } }; function _overlayFooter( event ) { if ( _defaults.global.footerHeight &gt; 0 ) { var footerHeight = _defaults.global.footerHeight; var footerPos = new OpenSeadragon.Point( 0, _container.height() - footerHeight ); var footerSize = new OpenSeadragon.Point( _container.width(), footerHeight ); if ( !_canvasScale ) { _canvasScale = osViewer.viewer.drawer.context.canvas.width / osViewer.viewer.drawer.context.canvas.clientWidth; } if ( _canvasScale != 1 ) { footerPos = footerPos.times( _canvasScale ); footerSize = footerSize.times( _canvasScale ); } osViewer.viewer.drawer.context.drawImage( _footerImage, footerPos.x, footerPos.y, footerSize.x, footerSize.y ); } }; function _timeout(promise, time) { var deferred = new jQuery.Deferred(); $.when(promise).done(deferred.resolve).fail(deferred.reject).progress(deferred.notify); setTimeout(function() { deferred.reject(&quot;timeout&quot;); }, time); return deferred.promise(); } return osViewer; } )( jQuery, OpenSeadragon ); // browser backward compability if(!String.prototype.startsWith) { String.prototype.startsWith = function(subString) { var start = this.substring(0,subString.length); return start.localeCompare(subString) === 0; } } if(!String.prototype.endsWith) { String.prototype.endsWith = function(subString) { var start = this.substring(this.length-subString.length,this.length); return start.localeCompare(subString) === 0; } } if(!Array.prototype.find) { Array.prototype.find = function(comparator) { for ( var int = 0; int &lt; this.length; int++ ) { var element = this[int]; if(comparator(element)) { return element; } } } } if(!Number.isNaN) { Number.isNaN = function(number) { return number !== number; } } Ã— Search results Close "},"statistics_statistics.js.html":{"id":"statistics_statistics.js.html","title":"Source: statistics/statistics.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: statistics/statistics.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Methodensammlung fÃ¼r Statistik-Graphen mit jqplot Implementierte Graphen: * * PublicationTypes * MostEditedWorks * NumberOfPages * MostImportedWorksTrend * * CrowdSourcingProgress Jeder Graph muss mit Statistics.&lt;Graphname&gt;.init(config) * initiallisiert werden. Das config-Objekt enthÃ¤lt dabei die zugrundeliegenden Daten. * AnschlieÃŸend kann der Graph mit Statistics.&lt;Graphname&gt;.plot(divId) gemalt werden. Um * Mouseover-Anzeige zu verwenden, muss sie mit Statistics.initMouseover(document, window) * initialisiert werden Um fÃ¼r PublicationTypes aud Mausklick eine Suche nach passenden * Werken zu starten muss dies mit initSearchQuery(plotId, inputId, buttonId) * initialisiert werden * * @version 3.2.0 */ var Statistics = ( function() { 'use strict'; var _debug = false; jQuery.jqplot.config.enablePlugins = true; var Statistics = {}; Statistics.chartLabel = null; Statistics.initMouseover = function( document, window ) { $( document ).mousemove( function( ev ) { if ( Statistics.chartLabel != null ) { var top = window.pageYOffset || document.documentElement.scrollTop; var left = window.pageXOffset || document.documentElement.scrollLeft; var mouseX = ev.pageX + 10 - left; // these are going to be how jquery // knows where to put the div that // will be our tooltip var mouseY = ev.pageY - 20 - top; $( '#chartpseudotooltip' ).html( Statistics.chartLabel ); var cssObj = { 'position': 'fixed', 'left': mouseX + 'px', // usually needs more offset here 'top': mouseY + 'px', 'z-index': 10000, 'max-width': '300px' }; $( '#chartpseudotooltip' ).css( cssObj ); $( '#chartpseudotooltip' ).show(); } else { $( '#chartpseudotooltip' ).hide(); } } ); } Statistics.PublicationTypes = function( config ) { this.config = config; } Statistics.PublicationTypes.prototype.plot = function( divId ) { var typeList = this.config.labelList.substring( 1, this.config.labelList.length - 1 ); typeList = typeList.split( ',' ); var typeNumberList = new Array(); for ( var i = 0; i &lt; typeList.length; i++ ) { var itemList = typeList[ i ].split( &quot;::&quot; ); typeList[ i ] = itemList[ 0 ] + &quot; (&quot; + itemList[ 1 ] + &quot;)&quot;; itemList[ 1 ] = parseInt( itemList[ 1 ] ); typeNumberList.push( itemList ); } // data = itemList; var plot1 = jQuery.jqplot( divId, [ typeNumberList ], { title: ' ', seriesDefaults: { shadow: false, renderer: jQuery.jqplot.PieRenderer, rendererOptions: { startAngle: -90, padding: 2, sliceMargin: 2, dataLabels: typeList, dataLabelThreshold: 5, dataLabelPositionFactor: 0.6, showDataLabels: false, } }, highlighter: { show: false }, cursor: { show: false } } ); var $div = $( &quot;#&quot; + divId ); var labelDesc = this.config.labelDesc; $div.bind( 'jqplotDataHighlight', function( ev, seriesIndex, pointIndex, data ) { Statistics.chartLabel = typeNumberList[ pointIndex ][ 0 ] + &quot; (&quot; + typeNumberList[ pointIndex ][ 1 ] + &quot; &quot; + labelDesc + &quot;)&quot;; } ); $div.bind( 'jqplotDataUnhighlight', function( ev ) { Statistics.chartLabel = null; } ); $div.bind( 'jqplotDataMouseOver', function( ev, seriesIndex, pointIndex, data ) { $( this ).css( { 'cursor': 'pointer' } ); } ); } Statistics.PublicationTypes.prototype.initSearchQuery = function( plotId, inputId, buttonId ) { $( '#' + plotId ).bind( 'jqplotDataClick', function( ev, seriesIndex, pointIndex, data ) { var publicationName = data[ 2 ]; var searchString = '(DOCSTRCT:&quot;' + publicationName + '&quot;) AND (DOCTYPE:&quot;DOCSTRCT&quot;)'; if ( _debug ) { console.log( &quot;search for &quot; + encodeURI( searchString ) ); } $( '#' + inputId ).val( searchString ); $( '#' + buttonId ).click(); } ); } Statistics.MostEditedWorks = function( config ) { this.config = config; } Statistics.MostEditedWorks.prototype.plot = function( divId ) { var labelList = this.config.labelList.substring( 1, this.config.labelList.length - 1 ); labelList = labelList.split( ',' ); var graphList = new Array(); var fullLabelList = new Array(); var maxLabelLength = 40; for ( var i = 0; i &lt; labelList.length; i++ ) { var itemList = labelList[ i ].split( &quot;::&quot; ); fullLabelList[ i ] = itemList[ 0 ]; labelList[ i ] = Statistics.shortString( itemList[ 0 ], maxLabelLength ); itemList[ 1 ] = parseInt( itemList[ 1 ] ); graphList.push( itemList[ 1 ] ); } var plot1 = jQuery.jqplot( divId, [ graphList ], { seriesDefaults: { renderer: jQuery.jqplot.BarRenderer, rendererOptions: { barDirection: 'horizontal', varyBarColor: true } }, series: [ { pointLabels: { show: true, stackedValue: true, labels: labelList, location: 'ne', edgeTolerance: -50 } } ], axes: { yaxis: { ticks: labelList, renderer: jQuery.jqplot.CategoryAxisRenderer, rendererOptions: { tickRenderer: jQuery.jqplot.AxisTickRenderer, tickOptions: { show: false, showLabel: false } } }, xaxis: { padMax: 1.4, rendererOptions: { tickRenderer: jQuery.jqplot.AxisTickRenderer, tickOptions: { show: true, showLabel: true } } } }, cursor: { show: false }, highlighter: { show: false } } ); var $div = $( '#chart-most-edited' ); $div.bind( 'jqplotDataHighlight', function( ev, seriesIndex, pointIndex, data ) { // chartLabel = graphList[pointIndex] + &quot; &quot; + labelDesc; Statistics.chartLabel = fullLabelList[ pointIndex ]; } ); $div.bind( 'jqplotDataUnhighlight', function( ev ) { Statistics.chartLabel = null; } ); } Statistics.NumberOfPages = function( config ) { this.config = config; } Statistics.NumberOfPages.prototype.plot = function( divId ) { var labelList = [ this.config.titlePages + &quot;::&quot; + this.config.numPages, this.config.titleFullTexts + &quot;::&quot; + this.config.numFullTexts ]; var graphList = new Array(); for ( var i = 0; i &lt; labelList.length; i++ ) { var itemList = labelList[ i ].split( &quot;::&quot; ); labelList[ i ] = itemList[ 0 ]; itemList[ 1 ] = parseInt( itemList[ 1 ] ); graphList.push( itemList[ 1 ] ); } var plot1 = jQuery.jqplot( divId, [ graphList ], { seriesDefaults: { renderer: jQuery.jqplot.BarRenderer, rendererOptions: { barDirection: 'vertical', varyBarColor: true } }, series: [ { pointLabels: { show: false, labels: labelList, location: 'n' } } ], axes: { xaxis: { ticks: labelList, renderer: jQuery.jqplot.CategoryAxisRenderer, rendererOptions: { tickRenderer: jQuery.jqplot.AxisTickRenderer, tickOptions: { show: true, showLabel: true } } }, yaxis: { min: 0, rendererOptions: { tickOptions: { show: true, showLabel: true } } } }, cursor: { show: false }, highlighter: { show: false } } ); var $div = $( &quot;#&quot; + divId ); $div.bind( 'jqplotDataHighlight', function( ev, seriesIndex, pointIndex, data ) { // chartLabel = graphList[pointIndex] + &quot; &quot; + labelList[pointIndex].split(' // ')[1]; Statistics.chartLabel = graphList[ pointIndex ] + &quot; &quot; + labelList[ pointIndex ]; } ); $div.bind( 'jqplotDataUnhighlight', function( ev ) { Statistics.chartLabel = null; } ); } Statistics.MostImportedWorksTrend = function( config ) { this.config = config; } Statistics.MostImportedWorksTrend.prototype.plot = function( divId ) { var labelList = this.config.labelList.substring( 1, this.config.labelList.length - 1 ); labelList = labelList.split( ', ' ); var graphList = new Array(); var lastDate, date; for ( var i = 0; i &lt; labelList.length; i++ ) { var itemList = labelList[ i ].split( &quot;::&quot; ); labelList[ i ] = itemList[ 0 ]; var date = new jQuery.jsDate( parseInt( itemList[ 0 ] ) ); itemList[ 0 ] = date; itemList[ 1 ] = parseInt( itemList[ 1 ] ); graphList.push( itemList ); if ( lastDate == null ) { lastDate = date; } } var plot1 = jQuery.jqplot( divId, [ graphList ], { seriesDefaults: { fill: false, lineWidth: 5, fillColor: '#fffdf6' }, series: [ { showMarker: false, pointLabels: { show: false } } ], axes: { xaxis: { // max: lastDate, // min: date, renderer: jQuery.jqplot.DateAxisRenderer, tickOptions: { formatString: &quot;%b %Y&quot;, markSize: 10, } }, yaxis: { padMax: 1.01, padMin: 1.01, tickOptions: { markSize: 10, }, } }, cursor: { show: false }, highlighter: { show: true, showTooltip: true, showMarker: false, formatString: '%s, %s ' + this.config.labelDesc }, seriesColors: [ &quot;#DAA520&quot; ] } ); } Statistics.CrowdSourcingProgress = function( config ) { this.config = config; } Statistics.CrowdSourcingProgress.prototype.plot = function( fulltextId, contentId ) { $( '#' + fulltextId ).css( 'width', Statistics.getBarSize( this.config.fulltextProgressString, 160 ) ); $( '#' + contentId ).css( 'width', Statistics.getBarSize( this.config.contentProgressString, 160 ) ); } Statistics.getBarSize = function( inputString, barWidth ) { var parts = inputString.split( '/' ); var completedPages = parseFloat( parts[ 0 ] ); var totalPages = parseFloat( parts[ 1 ] ); var progress = completedPages / totalPages * barWidth; return progress; } Statistics.shortString = function( string, maxLength ) { if ( string.length &lt;= maxLength ) { return string; } else { var wordArray = string.split( ' ' ); var newString = &quot;&quot;; var nextString = &quot;&quot;; var counter = 0; while ( counter &lt; 1 || nextString.length &lt; maxLength ) { newString = nextString; nextString = nextString + &quot; &quot; + wordArray[ counter ]; counter++; } return newString + &quot; [...]&quot;; } } function _addDays(date, days) { var result = new Date(); result.setDate(date.getDate() + days); return result; } return Statistics; } )( jQuery ); Ã— Search results Close "},"viewer_viewerJS.bookshelvesSession.js.html":{"id":"viewer_viewerJS.bookshelvesSession.js.html","title":"Source: viewer/viewerJS.bookshelvesSession.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.bookshelvesSession.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module to manage bookshelves in the current session. * * @version 3.2.0 * @module viewerJS.bookshelvesSession * @requires jQuery */ var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _confirmCounter = 0; var _defaults = { root: '', msg: { resetBookshelves: '', resetBookshelvesConfirm: '', saveItemToSession: '' } }; viewer.bookshelvesSession = { init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.bookshelvesSession.init' ); console.log( '##############################' ); console.log( 'viewer.bookshelvesSession.init: config - ', config ); } $.extend( true, _defaults, config ); // set confirm counter to local storage if ( localStorage.getItem( 'confirmCounter' ) == undefined ) { localStorage.setItem( 'confirmCounter', 0 ); } // render bookshelf dropdown list _renderDropdownList(); // toggle bookshelf dropdown $( '[data-bookshelf-type=&quot;dropdown&quot;]' ).off().on( 'click', function( event ) { event.stopPropagation(); // hide other dropdowns $( '.login-navigation__login-dropdown, .login-navigation__user-dropdown, .navigation__collection-panel' ).hide(); _getAllSessionElements( _defaults.root ).then( function( elements ) { if ( elements.items.length &gt; 0 ) { $( '.bookshelf-navigation__dropdown' ).slideToggle( 'fast' ); } else { return false; } } ).fail( function( error ) { console.error( 'ERROR - _getAllSessionElements: ', error.responseText ); } ); } ); // set element count of list to counter _setSessionElementCount(); // check add buttons if element is in list _setAddActiveState(); // add element to session $( '[data-bookshelf-type=&quot;add&quot;]' ).off().on( 'click', function() { var currBtn = $( this ); var currPi = currBtn.attr( 'data-pi' ); _isElementSet( _defaults.root, currPi ).then( function( isSet ) { // set confirm counter _confirmCounter = parseInt( localStorage.getItem( 'confirmCounter' ) ); if ( !isSet ) { if ( _confirmCounter == 0 ) { if ( confirm( _defaults.msg.saveItemToSession ) ) { currBtn.addClass( 'added' ); localStorage.setItem( 'confirmCounter', 1 ); _setSessionElement( _defaults.root, currPi ).then( function() { _setSessionElementCount(); _renderDropdownList(); } ); } else { return false; } } else { currBtn.addClass( 'added' ); _setSessionElement( _defaults.root, currPi ).then( function() { _setSessionElementCount(); _renderDropdownList(); } ); } } else { currBtn.removeClass( 'added' ); _deleteSessionElement( _defaults.root, currPi ).then( function() { _setSessionElementCount(); _renderDropdownList(); } ); } } ).fail( function( error ) { console.error( 'ERROR - _isElementSet: ', error.responseText ); } ); } ); // hide menus by clicking on body $( 'body' ).on( 'click', function( event ) { var target = $( event.target ); var dropdown = $( '.bookshelf-navigation__dropdown' ); var dropdownChild = dropdown.find( '*' ); if ( !target.is( dropdown ) &amp;&amp; !target.is( dropdownChild ) ) { $( '.bookshelf-navigation__dropdown' ).hide(); } } ); } }; /* ######## ADD (CREATE) ######## */ /* ######## GET (READ) ######## */ /** * Method to get all elements in watchlist from current session (user not logged in). * * @method _getAllSessionElements * @param {String} root The application root path. * @returns {Object} An JSON-Object which contains all session elements. */ function _getAllSessionElements( root ) { if ( _debug ) { console.log( '---------- _getAllSessionElements() ----------' ); console.log( '_getAllSessionElements: root - ', root ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/session/get/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to check if element is in list (user not logged in). * * @method _isElementSet * @param {String} root The application root path. * @param {String} pi The persistent identifier of the saved element. * @returns {Boolean} True if element is set. */ function _isElementSet( root, pi ) { if ( _debug ) { console.log( '---------- _isElementSet() ----------' ); console.log( '_isElementSet: root - ', root ); console.log( '_isElementSet: pi - ', pi ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/session/contains/' + pi + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise } /* ######## SET (UPDATE) ######## */ /** * Method to add an elements to watchlist in current session (user not logged in). * * @method _setSessionElement * @param {String} root The application root path. * @param {String} pi The persistent identifier of the saved element. */ function _setSessionElement( root, pi ) { if ( _debug ) { console.log( '---------- _setSessionElement() ----------' ); console.log( '_setSessionElement: root - ', root ); console.log( '_setSessionElement: pi - ', pi ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/session/add/' + pi + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise } /* ######## DELETE ######## */ /** * Method to delete an element from watchlist in current session (user not logged in). * * @method _deleteSessionElement * @param {String} root The application root path. * @param {String} pi The persistent identifier of the saved element. */ function _deleteSessionElement( root, pi ) { if ( _debug ) { console.log( '---------- _deleteSessionElement() ----------' ); console.log( '_deleteSessionElement: root - ', root ); console.log( '_deleteSessionElement: pi - ', pi ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/session/delete/' + pi + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise } /** * Method to delete all elements from watchlist in current session (user not logged * in). * * @method _deleteAllSessionElements * @param {String} root The application root path. */ function _deleteAllSessionElements( root ) { if ( _debug ) { console.log( '---------- _deleteAllSessionElements() ----------' ); console.log( '_deleteAllSessionElements: root - ', root ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/session/delete/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise } /* ######## BUILD ######## */ /** * Method to set the count of elements in watchlist from current session (user not * logged in). * * @method _setSessionElementCount * @param {String} root The application root path. */ function _setSessionElementCount() { if ( _debug ) { console.log( '---------- _setSessionElementCount() ----------' ); } _getAllSessionElements( _defaults.root ).then( function( elements ) { $( '[data-bookshelf-type=&quot;counter&quot;]' ).empty().text( elements.items.length ); } ).fail( function( error ) { console.error( 'ERROR - _getAllSessionElements: ', error.responseText ); } ); } /** * Method to render the element list in bookshelf dropdown (user not logged in). * * @method _renderDropdownList */ function _renderDropdownList() { if ( _debug ) { console.log( '---------- _renderDropdownList() ----------' ); } _getAllSessionElements( _defaults.root ).then( function( elements ) { // DOM-Elements var dropdownListReset = $( '&lt;button&gt;' ).addClass( 'btn-clean' ).attr( 'type', 'button' ).attr( 'data-bookshelf-type', 'reset' ).text( _defaults.msg.resetBookshelves ); var dropdownList = $( '&lt;ul /&gt;' ).addClass( 'list' ); var dropdownListItem = null; var dropdownListItemRow = null; var dropdownListItemColLeft = null; var dropdownListItemColCenter = null; var dropdownListItemColRight = null; var dropdownListItemImage = null; var dropdownListItemName = null; var dropdownListItemNameLink = null; var dropdownListItemDelete = null; // set confirm counter if ( elements.items.length &lt; 1 ) { localStorage.setItem( 'confirmCounter', 0 ); } elements.items .forEach( function( item ) { dropdownListItem = $( '&lt;li /&gt;' ); dropdownListItemRow = $( '&lt;div /&gt;' ).addClass( 'row no-margin' ); dropdownListItemColLeft = $( '&lt;div /&gt;' ).addClass( 'col-xs-4 no-padding' ); dropdownListItemColCenter = $( '&lt;div /&gt;' ).addClass( 'col-xs-7 no-padding' ); dropdownListItemColRight = $( '&lt;div /&gt;' ).addClass( 'col-xs-1 no-padding bookshelf-navigation__dropdown-list-remove' ); dropdownListItemImage = $( '&lt;div /&gt;' ).addClass( 'bookshelf-navigation__dropdown-list-image' ).css( 'background-image', 'url(' + item.representativeImageUrl + ')' ); dropdownListItemName = $( '&lt;h4 /&gt;' ); dropdownListItemNameLink = $( '&lt;a /&gt;' ).attr( 'href', _defaults.root + item.url ).text( item.name ); dropdownListItemDelete = $( '&lt;button /&gt;' ).addClass( 'btn-clean' ).attr( 'type', 'button' ).attr( 'data-bookshelf-type', 'delete' ) .attr( 'data-pi', item.pi ); // build bookshelf item dropdownListItemName.append( dropdownListItemNameLink ); dropdownListItemColLeft.append( dropdownListItemImage ); dropdownListItemColCenter.append( dropdownListItemName ); dropdownListItemColRight.append( dropdownListItemDelete ); dropdownListItemRow.append( dropdownListItemColLeft ).append( dropdownListItemColCenter ).append( dropdownListItemColRight ); dropdownListItem.append( dropdownListItemRow ); dropdownList.append( dropdownListItem ); } ); // render complete list $( '.bookshelf-navigation__dropdown-list' ).empty().append( dropdownList ); // render reset if items exist if ( elements.items.length &gt; 0 ) { $( '.bookshelf-navigation__dropdown-list-reset' ).empty().append( dropdownListReset ); } else { $( '.bookshelf-navigation__dropdown' ).hide(); $( '.bookshelf-navigation__dropdown-list-reset' ).empty(); } // delete single item $( '[data-bookshelf-type=&quot;delete&quot;]' ).on( 'click', function() { var currBtn = $( this ); var currPi = currBtn.attr( 'data-pi' ); _deleteSessionElement( _defaults.root, currPi ).then( function() { _setSessionElementCount(); _setAddActiveState(); _renderDropdownList(); } ); } ); // delete all items $( '[data-bookshelf-type=&quot;reset&quot;]' ).on( 'click', function() { if ( confirm( _defaults.msg.resetBookshelvesConfirm ) ) { _deleteAllSessionElements( _defaults.root ).then( function() { localStorage.setItem( 'confirmCounter', 0 ); _setSessionElementCount(); _setAddActiveState(); _renderDropdownList(); } ); } else { return false; } } ); } ).fail( function( error ) { console.error( 'ERROR - _getAllSessionElements: ', error.responseText ); } ); } /** * Method to set the active state of add buttons (user not logged in). * * @method _setAddActiveState */ function _setAddActiveState() { if ( _debug ) { console.log( '---------- _setAddActiveState() ----------' ); } $( '[data-bookshelf-type=&quot;add&quot;]' ).each( function() { var currBtn = $( this ); var currPi = currBtn.attr( 'data-pi' ); _isElementSet( _defaults.root, currPi ).then( function( isSet ) { if ( isSet ) { currBtn.addClass( 'added' ); } else { currBtn.removeClass( 'added' ); } } ).fail( function( error ) { console.error( 'ERROR - _isElementSet: ', error.responseText ); } ); } ); } return viewer; } )( viewerJS || {}, jQuery ); // /rest/bookshelves/session/add/{pi}/{logid}/{page} // FÃ¼gt der Merkliste ein Item mit der angegebenen pi, logId und Seitennummer an. Der Name // des Items wird automatisch aus dem zur pi gehÃ¶renden SOLR-Dokument erstellt // /rest/bookshelves/session/delete/{pi}/{logid}/{page} // LÃ¶scht das Item mit der angegebenen pi, logid und Seitennummer aus der Merkliste, wenn // es enthalten ist // /rest/bookshelves/session/contains/{pi}/{logid}/{page} // gibt &quot;true&quot; zurÃ¼ck, wenn die Merkliste ein Item mit der angegebenen pi, logid und // Seitennummer enthÃ¤lt; sonst &quot;false&quot; // /rest/bookshelves/session/count // Gibt die Zahl der in der Merkliste enthaltenen Items zurÃ¼ck. Ã— Search results Close "},"viewer_viewerJS.bookshelvesUser.js.html":{"id":"viewer_viewerJS.bookshelvesUser.js.html","title":"Source: viewer/viewerJS.bookshelvesUser.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.bookshelvesUser.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module to manage bookshelves if the user is logged in. * * @version 3.2.0 * @module viewerJS.bookshelvesUser * @requires jQuery */ var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _defaults = { root: '', msg: { resetBookshelves: '', resetBookshelvesConfirm: '', noItemsAvailable: '', selectBookshelf: '', addNewBookshelf: '' } }; viewer.bookshelvesUser = { init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.bookshelvesUser.init' ); console.log( '##############################' ); console.log( 'viewer.bookshelvesUser.init: config - ', config ); } $.extend( true, _defaults, config ); // render bookshelf navigation list _renderBookshelfNavigationList(); // toggle bookshelf dropdown $( '[data-bookshelf-type=&quot;dropdown&quot;]' ).off().on( 'click', function( event ) { event.stopPropagation(); // hide other dropdowns $( '.login-navigation__login-dropdown, .login-navigation__user-dropdown, .navigation__collection-panel' ).hide(); $( '.bookshelf-popup' ).remove(); $( '.bookshelf-navigation__dropdown' ).slideToggle( 'fast' ); } ); // check if element is in any bookshelf _setAddedStatus(); // render bookshelf popup $( '[data-bookshelf-type=&quot;add&quot;]' ).off().on( 'click', function( event ) { event.stopPropagation(); // hide other dropdowns $( '.bookshelf-navigation__dropdown, .login-navigation__user-dropdown' ).hide(); var currBtn = $( this ); var currPi = currBtn.attr( 'data-pi' ); var currLogid = currBtn.attr( 'data-logid' ); var currPage = currBtn.attr( 'data-page' ); var currPos = currBtn.offset(); var currSize = { width: currBtn.outerWidth(), height: currBtn.outerHeight() }; // render bookshelf popup _renderBookshelfPopup( currPi, currLogid, currPage, currPos, currSize ); } ); // hide menus/popups by clicking on body $( 'body' ).on( 'click', function( event ) { $( '.bookshelf-navigation__dropdown' ).hide(); if ( $( '.bookshelf-popup' ).length &gt; 0 ) { var target = $( event.target ); var popup = $( '.bookshelf-popup' ); var popupChild = popup.find( '*' ); if ( !target.is( popup ) &amp;&amp; !target.is( popupChild ) ) { $( '.bookshelf-popup' ).remove(); } } } ); // add new bookshelf in overview $( '#addBookshelfBtn' ).off().on( 'click', function() { var bsName = $( '#addBookshelfInput' ).val(); if ( bsName != '' ) { _addNamedBookshelf( _defaults.root, bsName ).then( function() { location.reload(); } ).fail( function( error ) { console.error( 'ERROR - _addNamedBookshelf: ', error.responseText ); } ); } else { _addAutomaticNamedBookshelf( _defaults.root ).then( function() { location.reload(); } ).fail( function( error ) { console.error( 'ERROR - _addAutomaticNamedBookshelf: ', error.responseText ); } ); } } ); // add new bookshelf on enter in overview $( '#addBookshelfInput' ).on( 'keyup', function( event ) { if ( event.which == 13 ) { $( '#addBookshelfBtn' ).click(); } } ); } }; /* ######## ADD (CREATE) ######## */ /** * Method to add an item to the user bookshelf by PI. * * @method _addBookshelfItemByPi * @param {String} root The application root path. * @param {String} id The current bookshelf id. * @param {String} pi The pi of the item to add. * @returns {Promise} A promise that checks the existing items. */ function _addBookshelfItemByPi( root, id, pi ) { if ( _debug ) { console.log( '---------- _addBookshelfItemByPi() ----------' ); console.log( '_addBookshelfItemByPi: root - ', root ); console.log( '_addBookshelfItemByPi: id - ', id ); console.log( '_addBookshelfItemByPi: pi - ', pi ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/get/' + id + '/add/' + pi + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to add an item with PI, LOGID and PAGE to the user bookshelf. * * @method _addBookshelfItemByPiLogidPage * @param {String} root The application root path. * @param {String} id The current bookshelf id. * @param {String} pi The pi of the item to add. * @param {String} logid The logid of the item to add. * @param {String} page The page of the item to add. * @returns {Promise} A promise that checks the existing items. */ function _addBookshelfItemByPiLogidPage( root, id, pi, logid, page ) { if ( _debug ) { console.log( '---------- _addBookshelfItemByPiLogidPage() ----------' ); console.log( '_addBookshelfItemByPiLogidPage: root - ', root ); console.log( '_addBookshelfItemByPiLogidPage: id - ', id ); console.log( '_addBookshelfItemByPiLogidPage: pi - ', pi ); console.log( '_addBookshelfItemByPiLogidPage: logid - ', logid ); console.log( '_addBookshelfItemByPiLogidPage: page - ', page ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/get/' + id + '/add/' + pi + '/' + logid + '/' + page + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to add a named bookshelf to the user account. * * @method _addNamedBookshelf * @param {String} root The application root path. * @param {String} name The name of the bookshelf. * @returns {Promise} A promise that checks the existing items. */ function _addNamedBookshelf( root, name ) { if ( _debug ) { console.log( '---------- _addNamedBookshelf() ----------' ); console.log( '_addNamedBookshelf: root - ', root ); console.log( '_addNamedBookshelf: name - ', name ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/add/' + name + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to add a automatic named bookshelf to the user account. * * @method _addAutomaticNamedBookshelf * @param {String} root The application root path. * @returns {Promise} A promise that checks the existing items. */ function _addAutomaticNamedBookshelf( root ) { if ( _debug ) { console.log( '---------- _addAutomaticNamedBookshelf() ----------' ); console.log( '_addAutomaticNamedBookshelf: root - ', root ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/add/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to add the session bookshelf to the user account with an automatic generated * name. * * @method _addSessionBookshelf * @param {String} root The application root path. * @returns {Promise} A promise that checks the existing items. */ function _addSessionBookshelf( root ) { if ( _debug ) { console.log( '---------- _addSessionBookshelf() ----------' ); console.log( '_addSessionBookshelf: root - ', root ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/addSessionBookshelf/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to add the session bookshelf to the user account with a given name. * * @method _addSessionBookshelfNamed * @param {String} root The application root path. * @returns {Promise} A promise that checks the existing items. */ function _addSessionBookshelfNamed( root, name ) { if ( _debug ) { console.log( '---------- _addSessionBookshelfNamed() ----------' ); console.log( '_addSessionBookshelfNamed: root - ', root ); console.log( '_addSessionBookshelfNamed: name - ', name ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/addSessionBookshelf/' + name + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /* ######## GET (READ) ######## */ /** * Method to get all user bookshelves. * * @method _getAllBookshelves * @param {String} root The application root path. * @returns {Promise} A promise that checks the existing items. */ function _getAllBookshelves( root ) { if ( _debug ) { console.log( '---------- _getAllBookshelves() ----------' ); console.log( '_getAllBookshelves: root - ', root ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/get/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to get a bookshelf by id. * * @method _getBookshelfById * @param {String} root The application root path. * @param {String} id The current bookshelf id. * @returns {Promise} A promise that checks the existing items. */ function _getBookshelfById( root, id ) { if ( _debug ) { console.log( '---------- _getBookshelfById() ----------' ); console.log( '_getBookshelfById: root - ', root ); console.log( '_getBookshelfById: id - ', id ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/get/' + id + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to get the number of items in the selected bookshelf. * * @method _getBookshelfItemCount * @param {String} root The application root path. * @param {String} id The current bookshelf id. * @returns {Promise} A promise that checks the existing items. */ function _getBookshelfItemCount( root, id ) { if ( _debug ) { console.log( '---------- _getBookshelfItemCount() ----------' ); console.log( '_getBookshelfItemCount: root - ', root ); console.log( '_getBookshelfItemCount: id - ', id ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/get/' + id + '/count/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to get all public bookshelves. * * @method _getPublicBookshelves * @param {String} root The application root path. * @returns {Promise} A promise that checks the existing items. */ function _getPublicBookshelves( root ) { if ( _debug ) { console.log( '---------- _getPublicBookshelves() ----------' ); console.log( '_getPublicBookshelves: root - ', root ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/public/get/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to get all shared bookshelves. * * @method _getSharedBookshelves * @param {String} root The application root path. * @returns {Promise} A promise that checks the existing items. */ function _getSharedBookshelves( root ) { if ( _debug ) { console.log( '---------- _getSharedBookshelves() ----------' ); console.log( '_getSharedBookshelves: root - ', root ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/shared/get/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to check if an item by PI if it's in user bookshelf. It returns the * bookshelves or false if no items are in list. * * @method _getContainingBookshelfItemByPi * @param {String} root The application root path. * @param {String} pi The pi of the current item. * @returns {Promise} A promise that checks the existing items. */ function _getContainingBookshelfItemByPi( root, pi ) { if ( _debug ) { console.log( '---------- _getContainingBookshelfItemByPi() ----------' ); console.log( '_getContainingBookshelfItemByPi: root - ', root ); console.log( '_getContainingBookshelfItemByPi: pi - ', pi ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/contains/' + pi + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to check if an item by PI, LOGID and PAGE if it's in user bookshelf. It * returns the bookshelves or false if no items are in list. * * @method _getContainingBookshelfItemByPiLogidPage * @param {String} root The application root path. * @param {String} pi The pi of the current item. * @returns {Promise} A promise that checks the existing items. */ function _getContainingBookshelfItemByPiLogidPage( root, pi, logid, page ) { if ( _debug ) { console.log( '---------- _getContainingBookshelfItemByPiLogidPage() ----------' ); console.log( '_getContainingBookshelfItemByPiLogidPage: root - ', root ); console.log( '_getContainingBookshelfItemByPiLogidPage: pi - ', pi ); console.log( '_getContainingBookshelfItemByPiLogidPage: logid - ', logid ); console.log( '_getContainingBookshelfItemByPiLogidPage: page - ', page ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/contains/' + pi + '/' + logid + '/' + page + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /* ######## SET (UPDATE) ######## */ /** * Method to set the name of a bookshelf. * * @method _setBookshelfName * @param {String} root The application root path. * @param {String} id The current bookshelf id. * @param {String} name The name of the bookshelf. * @returns {Promise} A promise that checks the existing items. */ function _setBookshelfName( root, id, name ) { if ( _debug ) { console.log( '---------- _setBookshelfName() ----------' ); console.log( '_setBookshelfName: root - ', root ); console.log( '_setBookshelfName: id - ', id ); console.log( '_setBookshelfName: name - ', name ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/get/' + id + '/set/name/' + name + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /* ######## DELETE ######## */ /** * Method to delete an item from the user bookshelf by PI. * * @method _deleteBookshelfItemByPi * @param {String} root The application root path. * @param {String} id The current bookshelf id. * @param {String} pi The pi of the item to add. * @returns {Promise} A promise that checks the existing items. */ function _deleteBookshelfItemByPi( root, id, pi ) { if ( _debug ) { console.log( '---------- _deleteBookshelfItemByPi() ----------' ); console.log( '_deleteBookshelfItemByPi: root - ', root ); console.log( '_deleteBookshelfItemByPi: id - ', id ); console.log( '_deleteBookshelfItemByPi: pi - ', pi ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/get/' + id + '/delete/' + pi + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to delete an item with PI, LOGID and PAGE from the user bookshelf. * * @method _deleteBookshelfItemByPiLogidPage * @param {String} root The application root path. * @param {String} id The current bookshelf id. * @param {String} pi The pi of the item to add. * @param {String} logid The logid of the item to add. * @param {String} page The page of the item to add. * @returns {Promise} A promise that checks the existing items. */ function _deleteBookshelfItemByPiLogidPage( root, id, pi, logid, page ) { if ( _debug ) { console.log( '---------- _deleteBookshelfItemByPiLogidPage() ----------' ); console.log( '_deleteBookshelfItemByPiLogidPage: root - ', root ); console.log( '_deleteBookshelfItemByPiLogidPage: id - ', id ); console.log( '_deleteBookshelfItemByPiLogidPage: pi - ', pi ); console.log( '_deleteBookshelfItemByPiLogidPage: logid - ', logid ); console.log( '_deleteBookshelfItemByPiLogidPage: page - ', page ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/get/' + id + '/delete/' + pi + '/' + logid + '/' + page + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /** * Method to delete a bookshelf by ID. * * @method _deleteBookshelfById * @param {String} root The application root path. * @param {String} id The current bookshelf id. * @returns {Promise} A promise that checks the existing items. */ function _deleteBookshelfById( root, id ) { if ( _debug ) { console.log( '---------- _deleteBookshelfById() ----------' ); console.log( '_deleteBookshelfById: root - ', root ); console.log( '_deleteBookshelfById: id - ', id ); } var promise = Q( $.ajax( { url: root + '/rest/bookshelves/user/delete/' + id + '/', type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; } /* ######## BUILD ######## */ /** * Method to render a popup which contains bookshelf actions. * * @method _renderBookshelfPopup * @param {String} pi The pi of the item to add. * @param {String} logid The logid of the item to add. * @param {String} page The page of the item to add. * @param {Object} pos The position of the clicked button. * @param {Object} size The width and height of the clicked button. */ function _renderBookshelfPopup( pi, logid, page, pos, size ) { if ( _debug ) { console.log( '---------- _renderBookshelfPopup() ----------' ); console.log( '_renderBookshelfPopup: pi - ', pi ); console.log( '_renderBookshelfPopup: logid - ', logid ); console.log( '_renderBookshelfPopup: page - ', page ); console.log( '_renderBookshelfPopup: pos - ', pos ); console.log( '_renderBookshelfPopup: size - ', size ); } var pi = pi; var posTop = pos.top; var posLeft = pos.left; // remove all popups $( '.bookshelf-popup' ).remove(); // DOM-Elements var bookshelfPopup = $( '&lt;div /&gt;' ).addClass( 'bookshelf-popup bottom' ).css( { 'top': ( posTop + size.height ) + 10 + 'px', 'left': ( posLeft - 142 ) + ( size.width / 2 ) + 'px' } ); var bookshelfPopupLoader = $( '&lt;div /&gt;' ).addClass( 'bookshelf-popup__body-loader' ); bookshelfPopup.append( bookshelfPopupLoader ); // build popup header var bookshelfPopupHeader = $( '&lt;div /&gt;' ).addClass( 'bookshelf-popup__header' ).text( _defaults.msg.selectBookshelf ); // build popup body var bookshelfPopupBody = $( '&lt;div /&gt;' ).addClass( 'bookshelf-popup__body' ); // build popup footer var bookshelfPopupFooter = $( '&lt;div /&gt;' ).addClass( 'bookshelf-popup__footer' ); var bookshelfPopupFooterRow = $( '&lt;div /&gt;' ).addClass( 'row no-margin' ); var bookshelfPopupFooterColLeft = $( '&lt;div /&gt;' ).addClass( 'col-xs-11 no-padding' ); var bookshelfPopupFooterInput = $( '&lt;input /&gt;' ).attr( 'type', 'text' ).attr( 'placeholder', _defaults.msg.addNewBookshelf ); bookshelfPopupFooterColLeft.append( bookshelfPopupFooterInput ); var bookshelfPopupFooterColright = $( '&lt;div /&gt;' ).addClass( 'col-xs-1 no-padding' ); var bookshelfPopupFooterAddBtn = $( '&lt;button /&gt;' ).addClass( 'btn-clean' ).attr( 'type', 'button' ).attr( 'data-bookshelf-type', 'add' ).attr( 'data-pi', pi ); bookshelfPopupFooterColright.append( bookshelfPopupFooterAddBtn ); bookshelfPopupFooterRow.append( bookshelfPopupFooterColLeft ).append( bookshelfPopupFooterColright ); bookshelfPopupFooter.append( bookshelfPopupFooterRow ); // build popup bookshelfPopup.append( bookshelfPopupHeader ).append( bookshelfPopupBody ).append( bookshelfPopupFooter ); // append popup $( 'body' ).append( bookshelfPopup ); // render bookshelf list _renderBookshelfPopoverList( pi ); // add new bookshelf in popover $( '.bookshelf-popup__footer [data-bookshelf-type=&quot;add&quot;]' ).on( 'click', function() { var bsName = $( '.bookshelf-popup__footer input' ).val(); var currPi = $( this ).attr( 'data-pi' ); if ( bsName != '' ) { _addNamedBookshelf( _defaults.root, bsName ).then( function() { $( '.bookshelf-popup__footer input' ).val( '' ); _renderBookshelfPopoverList( currPi ); _renderBookshelfNavigationList(); } ).fail( function( error ) { console.error( 'ERROR - _addNamedBookshelf: ', error.responseText ); } ); } else { _addAutomaticNamedBookshelf( _defaults.root ).then( function() { $( '.bookshelf-popup__footer input' ).val( '' ); _renderBookshelfPopoverList( currPi ); _renderBookshelfNavigationList(); } ).fail( function( error ) { console.error( 'ERROR - _addAutomaticNamedBookshelf: ', error.responseText ); } ); } } ); // add new bookshelf on enter in popover $( '.bookshelf-popup__footer input' ).on( 'keyup', function( event ) { if ( event.which == 13 ) { $( '.bookshelf-popup__footer [data-bookshelf-type=&quot;add&quot;]' ).click(); } } ); } /** * Method to render the element list in bookshelf popover. * * @method _renderBookshelfPopoverList * @param {String} pi The current PI of the selected item. */ function _renderBookshelfPopoverList( pi ) { if ( _debug ) { console.log( '---------- _renderBookshelfPopoverList() ----------' ); console.log( '_renderBookshelfPopoverList: pi - ', pi ); } _getAllBookshelves( _defaults.root ).then( function( elements ) { // DOM-Elements var dropdownList = $( '&lt;ul /&gt;' ).addClass( 'bookshelf-popup__body-list list' ); var dropdownListItem = null; var dropdownListItemText = null; var dropdownListItemAdd = null; var dropdownListItemIsInBookshelf = null; var dropdownListItemAddCounter = null; if ( elements.length &gt; 0 ) { elements.forEach( function( item ) { dropdownListItem = $( '&lt;li /&gt;' ); dropdownListItemIsInBookshelf = ''; // check if item is in bookshelf item.items.forEach( function( object ) { if ( object.pi == pi ) { dropdownListItemIsInBookshelf = '&lt;i class=&quot;fa fa-check&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt; '; } } ); dropdownListItemAddCounter = $( '&lt;span /&gt;' ).text( item.items.length ); dropdownListItemAdd = $( '&lt;button /&gt;' ).addClass( 'btn-clean' ).attr( 'type', 'button' ).attr( 'data-bookshelf-type', 'add' ).attr( 'data-id', item.id ) .attr( 'data-pi', pi ).text( item.name ).prepend( dropdownListItemIsInBookshelf ).append( dropdownListItemAddCounter ); // build bookshelf item dropdownListItem.append( dropdownListItemAdd ); dropdownList.append( dropdownListItem ); } ); } else { // add empty list item dropdownListItem = $( '&lt;li /&gt;' ); dropdownListItemText = $( '&lt;span /&gt;' ).addClass( 'empty' ).text( _defaults.msg.noItemsAvailable ); dropdownListItem.append( dropdownListItemText ); dropdownList.append( dropdownListItem ); } // render complete list $( '.bookshelf-popup__body' ).empty().append( dropdownList ); // remove loader $( '.bookshelf-popup__body-loader' ).remove(); // add item to bookshelf $( '.bookshelf-popup__body-list [data-bookshelf-type=&quot;add&quot;]' ).on( 'click', function() { var currBtn = $( this ); var currId = currBtn.attr( 'data-id' ); var currPi = currBtn.attr( 'data-pi' ); var isChecked = currBtn.find( '.fa-check' ); if ( isChecked.length &gt; 0 ) { _deleteBookshelfItemByPi( _defaults.root, currId, currPi ).then( function() { _renderBookshelfPopoverList( currPi ); _renderBookshelfNavigationList(); _setAddedStatus(); } ).fail( function( error ) { console.error( 'ERROR - _deleteBookshelfItemByPi: ', error.responseText ); } ); } else { _addBookshelfItemByPi( _defaults.root, currId, currPi ).then( function() { _renderBookshelfPopoverList( currPi ); _renderBookshelfNavigationList(); _setAddedStatus(); } ).fail( function( error ) { console.error( 'ERROR - _addBookshelfItemByPi: ', error.responseText ); } ); } } ); } ).fail( function( error ) { console.error( 'ERROR - _getAllBookshelves: ', error.responseText ); } ); } /** * Method to render the element list in bookshelf navigation. * * @method _renderBookshelfNavigationList */ function _renderBookshelfNavigationList() { if ( _debug ) { console.log( '---------- _renderBookshelfNavigationList() ----------' ); } var allBookshelfItems = 0; _getAllBookshelves( _defaults.root ).then( function( elements ) { // DOM-Elements var dropdownList = $( '&lt;ul /&gt;' ).addClass( 'bookshelf-navigation__dropdown-list list' ); var dropdownListItem = null; var dropdownListItemRow = null; var dropdownListItemLeft = null; var dropdownListItemRight = null; var dropdownListItemText = null; var dropdownListItemLink = null; var dropdownListItemAddCounter = null; if ( elements.length &gt; 0 ) { elements.forEach( function( item ) { dropdownListItem = $( '&lt;li /&gt;' ); dropdownListItemRow = $( '&lt;div /&gt;' ).addClass( 'row no-margin' ); dropdownListItemLeft = $( '&lt;div /&gt;' ).addClass( 'col-xs-10 no-padding' ); dropdownListItemRight = $( '&lt;div /&gt;' ).addClass( 'col-xs-2 no-padding' ); dropdownListItemLink = $( '&lt;a /&gt;' ).attr( 'href', _defaults.root + '/bookshelf/' + item.id + '/' ).text( item.name ); dropdownListItemAddCounter = $( '&lt;span /&gt;' ).addClass( 'bookshelf-navigation__dropdown-list-counter' ).text( item.items.length ); // build bookshelf item dropdownListItemLeft.append( dropdownListItemLink ); dropdownListItemRight.append( dropdownListItemAddCounter ); dropdownListItemRow.append( dropdownListItemLeft ).append( dropdownListItemRight ) dropdownListItem.append( dropdownListItemRow ); dropdownList.append( dropdownListItem ); // raise bookshelf item counter allBookshelfItems += item.items.length; } ); // set bookshelf item counter $( '[data-bookshelf-type=&quot;counter&quot;]' ).empty().text( allBookshelfItems ); } else { // add empty list item dropdownListItem = $( '&lt;li /&gt;' ); dropdownListItemText = $( '&lt;span /&gt;' ).addClass( 'empty' ).text( _defaults.msg.noItemsAvailable ); dropdownListItem.append( dropdownListItemText ); dropdownList.append( dropdownListItem ); // set bookshelf item counter $( '[data-bookshelf-type=&quot;counter&quot;]' ).empty().text( allBookshelfItems ); } // render complete list $( '.bookshelf-navigation__dropdown-list' ).empty().append( dropdownList ); } ).fail( function( error ) { console.error( 'ERROR - _getAllBookshelves: ', error.responseText ); } ); } /** * Method to set an 'added' status to an object. * * @method _setAddedStatus */ function _setAddedStatus() { if ( _debug ) { console.log( '---------- _setAddedStatus() ----------' ); } $( '[data-bookshelf-type=&quot;add&quot;]' ).each( function() { var currTrigger = $( this ); var currTriggerPi = currTrigger.attr( 'data-pi' ); _isItemInBookshelf( currTrigger, currTriggerPi ); } ); } /** * Method to check if item is in any bookshelf. * * @method _isItemInBookshelf * @param {Object} object An jQuery-Object of the current item. * @param {String} pi The current PI of the selected item. */ function _isItemInBookshelf( object, pi ) { if ( _debug ) { console.log( '---------- _isItemInBookshelf() ----------' ); console.log( '_isItemInBookshelf: pi - ', pi ); console.log( '_isItemInBookshelf: object - ', object ); } _getContainingBookshelfItemByPi( _defaults.root, pi ).then( function( items ) { if ( items.length == 0 ) { object.removeClass( 'added' ); return false; } else { object.addClass( 'added' ); } } ).fail( function( error ) { console.error( 'ERROR - _getContainingBookshelfItemByPi: ', error.responseText ); } ); } return viewer; } )( viewerJS || {}, jQuery ); Ã— Search results Close "},"viewer_viewerJS.calendarPopover.js.html":{"id":"viewer_viewerJS.calendarPopover.js.html","title":"Source: viewer/viewerJS.calendarPopover.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.calendarPopover.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * &lt;Short Module Description&gt; * * @version 3.2.0 * @module viewerJS.calendarPopover * @requires jQuery */ var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _this = null; var _currApiCall = ''; var _json = {}; var _popoverConfig = {}; var _popoverContent = null; var _defaults = { appUrl: '', calendarWrapperSelector: '.search-calendar__months', popoverTriggerSelector: '[data-popover-trigger=&quot;calendar-po-trigger&quot;]', popoverTitle: 'Bitte Ã¼bergeben Sie den Titel des Werks', }; viewer.calendarPopover = { init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.calendarPopover.init' ); console.log( '##############################' ); console.log( 'viewer.calendarPopover.init: config - ', config ); } $.extend( true, _defaults, config ); // TODO: Fehlermeldung in der Konsole beseitigen, wenn man auf den Tag ein // zweites Mal klickt. // show popover for current day $( _defaults.popoverTriggerSelector ).on( 'click', function() { _this = $( this ); _currApiCall = encodeURI( _this.attr( 'data-api' ) ); viewerJS.helper.getRemoteData( _currApiCall ).done( function( _json ) { _popoverContent = _getPopoverContent( _json, _defaults ); _popoverConfig = { placement: 'auto bottom', title: _defaults.popoverTitle, content: _popoverContent, viewport: { selector: _defaults.calendarWrapperSelector }, html: true }; $( _defaults.popoverTriggerSelector ).popover( 'destroy' ); _this.popover( _popoverConfig ); _this.popover( 'show' ); } ); } ); // remove all popovers by clicking on body $( 'body' ).on( 'click', function( event ) { if ( $( event.target ).closest( _defaults.popoverTriggerSelector ).length ) { return; } else { $( _defaults.popoverTriggerSelector ).popover( 'destroy' ); } } ); } }; /** * Method to render the popover content. * * @method _getPopoverContent * @param {Object} data A JSON-Object which contains the necessary data. * @param {Object} config The config object of the module. * @returns {String} The HTML-String of the popover content. */ function _getPopoverContent( data, config ) { if ( _debug ) { console.log( '---------- _getPopoverContent() ----------' ); console.log( '_getPopoverContent: data = ', data ); console.log( '_getPopoverContent: config = ', config ); } var workList = ''; var workListLink = ''; workList += '&lt;ul class=&quot;list&quot;&gt;'; $.each( data, function( works, values ) { workListLink = config.appUrl + 'image/' + values.PI_TOPSTRUCT + '/' + values.THUMBPAGENO + '/' + values.LOGID + '/'; workList += '&lt;li&gt;'; workList += '&lt;a href=&quot;' + workListLink + '&quot;&gt;'; workList += values.LABEL; workList += '&lt;/a&gt;'; workList += '&lt;/li&gt;'; } ); workList += '&lt;/ul&gt;'; return workList; } return viewer; } )( viewerJS || {}, jQuery ); Ã— Search results Close "},"viewer_viewerJS.changeFontSize.js.html":{"id":"viewer_viewerJS.changeFontSize.js.html","title":"Source: viewer/viewerJS.changeFontSize.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.changeFontSize.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module to raise and degrade the page font size. * * @version 3.2.0 * @module viewerJS.changeFontSize * @requires jQuery */ var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _parsedFontSize = 0; var _currFontSize = ''; var _defaults = { fontDownBtn: '', fontUpBtn: '', maxFontSize: 18, minFontSize: 12, baseFontSize: '14px' }; viewer.changeFontSize = { /** * Method which initializes the font size switcher. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {String} config.fontDownBtn The ID/Class of the font degrade button. * @param {String} config.fontUpBtn The ID/Class of the font upgrade button. * @param {String} config.maxFontSize The maximum font size the document should * scale up. * @param {String} config.minFontSize The minimum font size the document should * scale down. * @param {String} config.baseFontSize The base font size of the HTML-Element. * @example * * &lt;pre&gt; * var changeFontSizeConfig = { * fontDownBtn: '#fontSizeDown', * fontUpBtn: '#fontSizeUp', * maxFontSize: 18, * minFontSize: 14 * }; * * viewerJS.changeFontSize.init( changeFontSizeConfig ); * &lt;/pre&gt; */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.changeFontSize.init' ); console.log( '##############################' ); console.log( 'viewer.changeFontSize.init: config - ' ); console.log( config ); } $.extend( true, _defaults, config ); if ( viewer.localStoragePossible ) { // set current font-size _setFontSize(); // set button state _setButtonState(); $( _defaults.fontDownBtn ).on( 'click', function() { // set current font-size _currFontSize = $( 'html' ).css( 'font-size' ); // save font-size _saveFontSize( _currFontSize ); // parse number of font-size _parsedFontSize = _parseFontSize( _currFontSize ); // degrade font-size _degradeFontSize( _parsedFontSize ); } ); $( _defaults.fontUpBtn ).on( 'click', function() { // set current font-size _currFontSize = $( 'html' ).css( 'font-size' ); // save font-size _saveFontSize( _currFontSize ); // parse number of font-size _parsedFontSize = _parseFontSize( _currFontSize ); // raise font-size _raiseFontSize( _parsedFontSize ); } ); } } }; /** * Method to degrade the page font-size. * * @method _degradeFontSize * @param {Number} current The current font-size of the HTML-Element. */ function _degradeFontSize( current ) { if ( _debug ) { console.log( '---------- _degradeFontSize() ----------' ); console.log( '_degradeFontSize: current = ', current ); } var size = current; size--; if ( size &gt;= _defaults.minFontSize ) { $( _defaults.fontDownBtn ).prop( 'disabled', false ); $( _defaults.fontUpBtn ).prop( 'disabled', false ); $( 'html' ).css( 'font-size', size + 'px' ); // save font-size _saveFontSize( size + 'px' ); } else { $( _defaults.fontDownBtn ).prop( 'disabled', true ); $( _defaults.fontUpBtn ).prop( 'disabled', false ); } } /** * Method to raise the page font-size. * * @method _raiseFontSize * @param {Number} current The current font-size of the HTML-Element. */ function _raiseFontSize( current ) { if ( _debug ) { console.log( '---------- _raiseFontSize() ----------' ); console.log( '_raiseFontSize: current = ', current ); } var size = current; size++; if ( size &lt;= _defaults.maxFontSize ) { $( _defaults.fontDownBtn ).prop( 'disabled', false ); $( _defaults.fontUpBtn ).prop( 'disabled', false ); $( 'html' ).css( 'font-size', size + 'px' ); // save font-size _saveFontSize( size + 'px' ); } else { $( _defaults.fontDownBtn ).prop( 'disabled', false ); $( _defaults.fontUpBtn ).prop( 'disabled', true ); } } /** * Method which parses a given pixel value to a number and returns it. * * @method _parseFontSize * @param {String} string The string to parse. */ function _parseFontSize( string ) { if ( _debug ) { console.log( '---------- _parseFontSize() ----------' ); console.log( '_parseFontSize: string = ', string ); } return parseInt( string.replace( 'px' ) ); } /** * Method to save the current font-size to local storage as a string. * * @method _saveFontSize * @param {String} size The String to save in local storage. */ function _saveFontSize( size ) { if ( _debug ) { console.log( '---------- _saveFontSize() ----------' ); console.log( '_parseFontSize: size = ', size ); } localStorage.setItem( 'currentFontSize', size ); } /** * Method to set the current font-size from local storage to the HTML-Element. * * @method _setFontSize */ function _setFontSize() { if ( _debug ) { console.log( '---------- _setFontSize() ----------' ); } var fontSize = localStorage.getItem( 'currentFontSize' ); if ( fontSize === null || fontSize === '' ) { localStorage.setItem( 'currentFontSize', _defaults.baseFontSize ); } else { $( 'html' ).css( 'font-size', fontSize ); } } /** * Method to set the state of the font-size change buttons. * * @method _setButtonState */ function _setButtonState() { if ( _debug ) { console.log( '---------- _setButtonState() ----------' ); } var fontSize = localStorage.getItem( 'currentFontSize' ); var newFontSize = _parseFontSize( fontSize ); if ( newFontSize === _defaults.minFontSize ) { $( _defaults.fontDownBtn ).prop( 'disabled', true ); } if ( newFontSize === _defaults.maxFontSize ) { $( _defaults.fontUpBtn ).prop( 'disabled', true ); } } return viewer; } )( viewerJS || {}, jQuery ); Ã— Search results Close "},"viewer_viewerJS.dataTable.js.html":{"id":"viewer_viewerJS.dataTable.js.html","title":"Source: viewer/viewerJS.dataTable.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.dataTable.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module to manage the data table features. * * @version 3.2.0 * @module viewerJS.dataTable * @requires jQuery */ var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _dataTablePaginator = null; var _txtField1 = null; var _txtField2 = null; var _totalCount = null; var _reloadBtn = null; var _defaults = { dataTablePaginator: '', txtField1: '', txtField2: '', totalCount: '', reloadBtn: '', }; viewer.dataTable = { init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.dataTable.init' ); console.log( '##############################' ); console.log( 'viewer.dataTable.init: config = ', config ); } $.extend( true, _defaults, config ); viewer.dataTable.paginator.init(); if ( $( '.column-filter-wrapper' ).length &gt; 0 ) { viewer.dataTable.filter.init(); } }, /** * Pagination */ paginator: { setupAjax: false, init: function() { if ( _debug ) { console.log( '---------- dataTable.paginator.init() ----------' ); } _dataTablePaginator = $( _defaults.dataTablePaginator ); _txtField1 = $( _defaults.txtField1 ); _txtField2 = $( _defaults.txtField2 ); _totalCount = $( _defaults.totalCount ); _reloadBtn = $( _defaults.reloadBtn ); _txtField1.on( 'click', function() { $( this ).hide(); viewer.dataTable.paginator.inputFieldHandler(); } ); _totalCount.on( 'click', function() { _txtField1.hide(); viewer.dataTable.paginator.inputFieldHandler(); } ); /* * AJAX Eventlistener */ if ( !this.setupAjax ) { jsf.ajax.addOnEvent( function( data ) { var ajaxstatus = data.status; if ( _defaults.dataTablePaginator.length &gt; 0 ) { switch ( ajaxstatus ) { case &quot;begin&quot;: if ( _txtField1 !== null &amp;&amp; _txtField2 !== null ) { _txtField1.off(); _txtField2.off(); } break; case &quot;complete&quot;: break; case &quot;success&quot;: viewer.dataTable.paginator.init(); break; } } } ); this.setupAjax = true; } }, inputFieldHandler: function() { if ( _debug ) { console.log( '---------- dataTable.paginator.inputFieldHandler() ----------' ); } _txtField2.show().find( 'input' ).focus().select(); _txtField2.find( 'input' ).on( 'blur', function() { $( this ).hide(); _txtField1.show(); _reloadBtn.click(); } ); _txtField2.find( 'input' ).on( 'keypress', function( event ) { if ( event.keyCode == 13 ) { _reloadBtn.click(); } else { return; } } ); }, }, /** * Filter */ filter: { setupAjax: false, init: function() { if ( _debug ) { console.log( '---------- dataTable.filter.init() ----------' ); } $( '#adminAllUserForm' ).on( 'submit', function( event ) { event.preventDefault(); $( '.column-filter-wrapper' ).find( '.btn-filter' ).click(); } ); /* * AJAX Eventlistener */ if ( !this.setupAjax ) { jsf.ajax.addOnEvent( function( data ) { var ajaxstatus = data.status; if ( _defaults.dataTablePaginator.length &gt; 0 ) { switch ( ajaxstatus ) { case &quot;begin&quot;: break; case &quot;complete&quot;: break; case &quot;success&quot;: viewer.dataTable.filter.init(); break; } } } ); this.setupAjax = true; } }, }, }; return viewer; } )( viewerJS || {}, jQuery ); Ã— Search results Close "},"viewer_viewerJS.dateSortedFeed.js.html":{"id":"viewer_viewerJS.dateSortedFeed.js.html","title":"Source: viewer/viewerJS.dateSortedFeed.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.dateSortedFeed.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module to render a RSS-Feed sorted by date. * * @version 3.2.0 * @module viewerJS.dateSortedFeed * @requires jQuery * */ var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _promise = null; var _defaults = { path: null, dataSortOrder: null, dataCount: null, dataEncoding: null, feedBox: null, monthNames: [ '', 'Januar', 'Februar', 'MÃ¤rz', 'April', 'Mai', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember' ] }; viewer.dateSortedFeed = { /** * Method which initializes the date sorted RSS-Feed. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {String} config.path The rootpath of the application. * @param {Object} config.feedBox An jQuery object of the wrapper DIV. * @example * * &lt;pre&gt; * var dateSortedFeedConfig = { * path: '#{request.contextPath}', * feedBox: $( '#dateSortedFeed' ) * }; * * viewerJS.dateSortedFeed.setDataSortOrder( '#{cc.attrs.sorting}' ); * viewerJS.dateSortedFeed.setDataCount( '#{cc.attrs.count}' ); * viewerJS.dateSortedFeed.setDataEncoding( '#{cc.attrs.encoding}' ); * viewerJS.dateSortedFeed.init( dateSortedFeedConfig ); * &lt;/pre&gt; */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.dateSortedFeed.init' ); console.log( '##############################' ); console.log( 'viewer.dateSortedFeed.init: feedBoxObj - ' + feedBoxObj ); console.log( 'viewer.dateSortedFeed.init: path - ' + path ); } $.extend( true, _defaults, config ); var dataURL = _defaults.path; dataURL += '/api?action=query&amp;q=PI:*&amp;jsonFormat=datecentric&amp;sortField=DATECREATED'; dataURL += '&amp;sortOrder='; dataURL += _defaults.dataSortOrder; dataURL += '&amp;count='; dataURL += _defaults.dataCount; dataURL += '&amp;encoding='; dataURL += _defaults.dataEncoding; if ( _debug ) { console.log( 'viewer.dateSortedFeed.init: dataURL - ' + dataURL ); } // checking for feedbox element and render feed if ( _defaults.feedBox ) { _promise = viewer.helper.getRemoteData( dataURL ); _promise.then( function( data ) { _renderFeed( data ); } ).then( null, function() { console.error( 'ERROR: viewer.dateSortedFeed.init - ', error ); } ); } else { return; } }, /** * Returns the sorting order of the feed. * * @method getDataSortOrder * @returns {String} The sorting order. * */ getDataSortOrder: function() { return _defaults.dataSortOrder; }, /** * Sets the sorting order of the feed. * * @method getDataSortOrder * @param {String} str The sorting order (asc/desc) * */ setDataSortOrder: function( str ) { _defaults.dataSortOrder = str; }, /** * Returns the number of entries from the feed. * * @method getDataSortOrder * @returns {String} The number of entries. * */ getDataCount: function() { return _defaults.dataCount; }, /** * Sets the number of entries from the feed. * * @method setDataCount * @param {String} The number of entries. * */ setDataCount: function( num ) { _defaults.dataCount = num; }, /** * Returns the type of encoding. * * @method getDataEncoding * @returns {String} The type of encoding. * */ getDataEncoding: function() { return _defaults.dataEncoding; }, /** * Sets the type of encoding. * * @method setDataEncoding * @param {String} The type of encoding. * */ setDataEncoding: function( str ) { _defaults.dataEncoding = str; } }; /** * Renders the feed and appends it to the wrapper. * * @method _renderFeed * @param {Object} data An JSON object of the feed data. * */ function _renderFeed( data ) { var feed = ''; $.each( data, function( i, j ) { feed += '&lt;h4&gt;' + _dateConverter( j.date ) + '&lt;/h4&gt;'; $.each( j, function( m, n ) { if ( n.title ) { for ( var x = 0; x &lt;= n.title.length; x++ ) { if ( n.title[ x ] !== undefined ) { feed += '&lt;div class=&quot;sorted-feed-title&quot;&gt;&lt;a href=&quot;'; feed += n.url; feed += '&quot; title=&quot;'; feed += n.title[ x ]; feed += '&quot;&gt;'; feed += n.title[ x ]; feed += '&lt;/a&gt;&lt;/div&gt;'; } } } } ); } ); _defaults.feedBox.append( feed ); } /** * Converts a date to this form: 16. November 2015 * * @method _dateConverter * @param {String} str The date to convert. * @returns {String} The new formated date. * */ function _dateConverter( str ) { var strArr = str.split( '-' ); var monthIdx = parseInt( strArr[ 1 ] ); var newDate = strArr[ 2 ] + '. ' + _defaults.monthNames[ monthIdx ] + ' ' + strArr[ 0 ]; return newDate; } return viewer; } )( viewerJS || {}, jQuery ); Ã— Search results Close "},"viewer_viewerJS.download.js.html":{"id":"viewer_viewerJS.download.js.html","title":"Source: viewer/viewerJS.download.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.download.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which manages the download view. * * @version 3.2.0 * @module viewerJS.download * @requires jQuery * */ var viewerJS = ( function( viewer ) { 'use strict'; // default variables var _debug = false; var _checkbox = null; var _downloadBtn = null; viewer.download = { /** * Method to initialize the download view. * * @method init */ init: function() { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.download.init' ); console.log( '##############################' ); } _checkbox = $( '#agreeLicense' ); _downloadBtn = $( '#downloadBtn' ); _downloadBtn.prop( 'disabled', true ); _checkbox.on( 'click', function() { var currState = $( this ).prop( 'checked' ); viewer.download.checkboxValidation( currState ); } ); }, /** * Method which validates the checkstate of a checkbox and enables the download * button. * * @method checkboxValidation * @param {String} state The current checkstate of the checkbox. */ checkboxValidation: function( state ) { if ( _debug ) { console.log( '---------- viewer.download.checkboxValidation() ----------' ); console.log( 'viewer.download.checkboxValidation: state = ', state ); } if ( state ) { _downloadBtn.prop( 'disabled', false ); } else { _downloadBtn.prop( 'disabled', true ); return false; } }, }; return viewer; } )( viewerJS || {}, jQuery ); Ã— Search results Close "},"viewer_viewerJS.downloadModal.js.html":{"id":"viewer_viewerJS.downloadModal.js.html","title":"Source: viewer/viewerJS.downloadModal.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.downloadModal.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which generates a download modal which dynamic content. * * @version 3.2.0 * @module viewerJS.downloadModal * @requires jQuery * */ var viewerJS = ( function( viewer ) { 'use strict'; // default variables var _debug = false; var _defaults = { dataType: null, dataTitle: null, dataId: null, dataPi: null, downloadBtn: null, reCaptchaSiteKey: '', useReCaptcha: true, path: '', iiifPath: '', apiUrl: '', userEmail: null, workInfo: {}, modal: { id: '', label: '', string: { title: '', body: '', closeBtn: '', saveBtn: '', } }, messages: { downloadInfo: { text: 'Informationen zum angeforderten Download', title: 'Werk', part: 'Teil', fileSize: 'GrÃ¶ÃŸe' }, reCaptchaText: 'Um die Generierung von Dokumenten durch Suchmaschinen zu verhindern bestÃ¤tigen Sie bitte das reCAPTCHA.', rcInvalid: 'Die ÃœberprÃ¼fung war nicht erfolgreich. Bitte bestÃ¤tigen Sie die reCAPTCHA Anfrage.', rcValid: 'Vielen Dank. Sie kÃ¶nnen nun ihre ausgewÃ¤hlte Datei generieren lassen.', eMailText: 'Um per E-Mail informiert zu werden sobald der Download zur VerfÃ¼gung steht, kÃ¶nnen Sie hier optional Ihre E-Mail Adresse hinterlassen', eMailTextLoggedIn: 'Sie werden Ã¼ber Ihre registrierte E-Mail Adresse von uns Ã¼ber den Fortschritt des Downloads informiert.', eMail: '' } }; var _loadingOverlay = null; viewer.downloadModal = { /** * Method to initialize the download modal mechanic. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {String} config.dataType The data type of the current file to download. * @param {String} config.dataTitle The title of the current file to download. * @param {String} config.dataId The LOG_ID of the current file to download. * @param {String} config.dataPi The PI of the current file to download. * @param {Object} config.downloadBtn A collection of all buttons with the class * attribute 'download-modal'. * @param {String} config.reCaptchaSiteKey The site key for the google reCAPTCHA, * fetched from the viewer config. * @param {String} config.path The current application path. * @param {String} config.apiUrl The URL to trigger the ITM download task. * @param {String} config.userEmail The current user email if the user is logged * in. Otherwise the one which the user enters or leaves blank. * @param {Object} config.modal A configuration object for the download modal. * @param {String} config.modal.id The ID of the modal. * @param {String} config.modal.label The label of the modal. * @param {Object} config.modal.string An object of strings for the modal content. * @param {String} config.modal.string.title The title of the modal. * @param {String} config.modal.string.body The content of the modal as HTML. * @param {String} config.modal.string.closeBtn Buttontext * @param {String} config.modal.string.saveBtn Buttontext * @param {Object} config.messages An object of strings for the used text * snippets. * @example * * &lt;pre&gt; * var downloadModalConfig = { * downloadBtn: $( '.download-modal' ), * path: '#{navigationHelper.applicationUrl}', * userEmail: $( '#userEmail' ).val(), * messages: { * reCaptchaText: '#{msg.downloadReCaptchaText}', * rcInvalid: '#{msg.downloadRcInvalid}', * rcValid: '#{msg.downloadRcValid}', * eMailText: '#{msg.downloadEMailText}', * eMailTextLoggedIn: '#{msg.downloadEMailTextLoggedIn}', * eMail: '#{msg.downloadEmail}', * closeBtn: '#{msg.downloadCloseModal}', * saveBtn: '#{msg.downloadGenerateFile}', * } * }; * * viewerJS.downloadModal.init( downloadModalConfig ); * &lt;/pre&gt; */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.downloadModal.init' ); console.log( '##############################' ); console.log( 'viewer.downloadModal.init: config = ', config ); } $.extend( true, _defaults, config ); // build loading overlay _loadingOverlay = $( '&lt;div /&gt;' ); _loadingOverlay.addClass( 'dl-modal__overlay' ); $( 'body' ).append( _loadingOverlay ); _defaults.downloadBtn.on( 'click', function() { // show loading overlay $( '.dl-modal__overlay' ).fadeIn( 'fast' ); _defaults.dataType = $( this ).attr( 'data-type' ); _defaults.dataTitle = $( this ).attr( 'data-title' ); if ( $( this ).attr( 'data-id' ) !== '' ) { _defaults.dataId = $( this ).attr( 'data-id' ); } else { _defaults.dataId = '-'; } _defaults.dataPi = $( this ).attr( 'data-pi' ); _getWorkInfo( _defaults.dataPi, _defaults.dataId, _defaults.dataType ).done( function( info ) { _defaults.workInfo = info; _defaults.modal = { id: _defaults.dataPi + '-Modal', label: _defaults.dataPi + '-Label', string: { title: _defaults.dataTitle, body: viewer.downloadModal.renderModalBody( _defaults.dataType, _defaults.workInfo ), closeBtn: _defaults.messages.closeBtn, saveBtn: _defaults.messages.saveBtn, } }; // hide loading overlay $( '.dl-modal__overlay' ).fadeOut( 'fast' ); // init modal viewer.downloadModal.initModal( _defaults ); } ); } ); }, /** * Method which initializes the download modal and its content. * * @method initModal * @param {Object} params An config object which overwrites the defaults. */ initModal: function( params ) { if ( _debug ) { console.log( '---------- viewer.downloadModal.initModal() ----------' ); console.log( 'viewer.downloadModal.initModal: params = ', params ); } $( 'body' ).append( viewer.helper.renderModal( params.modal ) ); // disable submit button $( '#submitModal' ).attr( 'disabled', 'disabled' ); // show modal $( '#' + params.modal.id ).modal( 'show' ); // render reCAPTCHA to modal $( '#' + params.modal.id ).on( 'shown.bs.modal', function( e ) { if ( _defaults.useReCaptcha ) { var rcWidget = grecaptcha.render( 'reCaptchaWrapper', { sitekey: _defaults.reCaptchaSiteKey, callback: function() { var rcWidgetResponse = viewer.downloadModal.validateReCaptcha( grecaptcha.getResponse( rcWidget ) ); if ( rcWidgetResponse ) { $( '#modalAlerts' ).append( viewer.helper.renderAlert( 'alert-success', _defaults.messages.rcValid, true ) ); // enable submit button $( '#submitModal' ).removeAttr( 'disabled' ).on( 'click', function() { _defaults.userEmail = $( '#recallEMail' ).val(); _defaults.apiUrl = viewer.downloadModal .buildAPICall( _defaults.path, _defaults.dataType, _defaults.dataPi, _defaults.dataId, _defaults.userEmail ); window.location.href = _defaults.apiUrl; } ); } else { $( '#modalAlerts' ).append( viewer.helper.renderAlert( 'alert-danger', _defaults.messages.rcInvalid, true ) ); } } } ); } else { // hide paragraph $( this ).find( '.modal-body h4' ).next( 'p' ).hide(); // enable submit button $( '#submitModal' ).removeAttr( 'disabled' ).on( 'click', function() { _defaults.userEmail = $( '#recallEMail' ).val(); _defaults.apiUrl = viewer.downloadModal.buildAPICall( _defaults.path, _defaults.dataType, _defaults.dataPi, _defaults.dataId, _defaults.userEmail ); window.location.href = _defaults.apiUrl; } ); } } ); // remove modal from DOM after closing $( '#' + params.modal.id ).on( 'hidden.bs.modal', function( e ) { $( this ).remove(); } ); }, /** * Method which returns a HTML-String to render the download modal body. * * @method renderModalBody * @param {String} type The current file type to download. * @param {String} title The title of the current download file. * @returns {String} The HTML-String to render the download modal body. */ renderModalBody: function( type, infos ) { if ( _debug ) { console.log( '---------- viewer.downloadModal.renderModalBody() ----------' ); console.log( 'viewer.downloadModal.renderModalBody: type = ', type ); console.log( 'viewer.downloadModal.renderModalBody: infos = ', infos ); } var rcResponse = null; var modalBody = ''; modalBody += ''; // alerts modalBody += '&lt;div id=&quot;modalAlerts&quot;&gt;&lt;/div&gt;'; // Title if ( type === 'pdf' ) { modalBody += '&lt;h4&gt;'; modalBody += '&lt;i class=&quot;fa fa-file-pdf-o&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt; PDF-Download: '; modalBody += '&lt;/h4&gt;'; } else { modalBody += '&lt;h4&gt;'; modalBody += '&lt;i class=&quot;fa fa-file-text-o&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt; ePub-Download: '; modalBody += '&lt;/h4&gt;'; } // Info modalBody += '&lt;p&gt;' + _defaults.messages.downloadInfo.text + ':&lt;/p&gt;'; modalBody += '&lt;dl class=&quot;dl-horizontal&quot;&gt;'; modalBody += '&lt;dt&gt;' + _defaults.messages.downloadInfo.title + ':&lt;/dt&gt;'; modalBody += '&lt;dd&gt;' + infos.title + '&lt;/dd&gt;'; if ( infos.div !== null ) { modalBody += '&lt;dt&gt;' + _defaults.messages.downloadInfo.part + ':&lt;/dt&gt;'; modalBody += '&lt;dd&gt;' + infos.div + '&lt;/dd&gt;'; } if ( infos.size ) { modalBody += '&lt;dt&gt;' + _defaults.messages.downloadInfo.fileSize + ':&lt;/dt&gt;'; modalBody += '&lt;dd&gt;~' + infos.size + '&lt;/dd&gt;'; modalBody += '&lt;/dl&gt;'; } // reCAPTCHA if ( _defaults.useReCaptcha ) { modalBody += '&lt;hr /&gt;'; modalBody += '&lt;p&gt;&lt;strong&gt;reCAPTCHA&lt;/strong&gt;&lt;/p&gt;'; modalBody += '&lt;p&gt;' + _defaults.messages.reCaptchaText + ':&lt;/p&gt;'; modalBody += '&lt;div id=&quot;reCaptchaWrapper&quot;&gt;&lt;/div&gt;'; } // E-Mail modalBody += '&lt;hr /&gt;'; modalBody += '&lt;form class=&quot;email-form&quot;&gt;'; modalBody += '&lt;div class=&quot;form-group&quot;&gt;'; modalBody += '&lt;label for=&quot;recallEMail&quot;&gt;' + _defaults.messages.eMail + '&lt;/label&gt;'; if ( _defaults.userEmail != undefined ) { modalBody += '&lt;p class=&quot;help-block&quot;&gt;' + _defaults.messages.eMailTextLoggedIn + '&lt;/p&gt;'; modalBody += '&lt;input type=&quot;email&quot; class=&quot;form-control&quot; id=&quot;recallEMail&quot; value=&quot;' + _defaults.userEmail + '&quot; disabled=&quot;disabled&quot; /&gt;'; } else { modalBody += '&lt;p class=&quot;help-block&quot;&gt;' + _defaults.messages.eMailText + ':&lt;/p&gt;'; modalBody += '&lt;input type=&quot;email&quot; class=&quot;form-control&quot; id=&quot;recallEMail&quot; /&gt;'; } modalBody += '&lt;/div&gt;'; modalBody += '&lt;/form&gt;'; return modalBody; }, /** * Method which checks the reCAPTCHA response. * * @method validateReCaptcha * @param {String} response The reCAPTCHA response. * @returns {Boolean} Returns true if the reCAPTCHA sent a response. */ validateReCaptcha: function( response ) { if ( _debug ) { console.log( '---------- viewer.downloadModal.validateReCaptcha() ----------' ); console.log( 'viewer.downloadModal.validateReCaptcha: response = ', response ); } if ( response == 0 ) { return false; } else { return true; } }, /** * Method which returns an URL to trigger the ITM download task. * * @method buildAPICall * @param {String} path The current application path. * @param {String} type The current file type to download. * @param {String} pi The PI of the current work. * @param {String} logid The LOG_ID of the current work. * @param {String} email The current user email. * @returns {String} The URL to trigger the ITM download task. */ buildAPICall: function( path, type, pi, logid, email ) { if ( _debug ) { console.log( '---------- viewer.downloadModal.buildAPICall() ----------' ); console.log( 'viewer.downloadModal.buildAPICall: path = ', path ); console.log( 'viewer.downloadModal.buildAPICall: type = ', type ); console.log( 'viewer.downloadModal.buildAPICall: pi = ', pi ); console.log( 'viewer.downloadModal.buildAPICall: logid = ', logid ); console.log( 'viewer.downloadModal.buildAPICall: email = ', email ); } var url = ''; url += path + 'rest/download'; if ( type == '' ) { url += '/-'; } else { url += '/' + type; } if ( pi == '' ) { url += '/-'; } else { url += '/' + pi; } if ( logid == '' ) { url += '/-'; } else { url += '/' + logid; } if ( email == '' || email == undefined ) { url += '/-/'; } else { url += '/' + email + '/'; } return encodeURI( url ); } }; /** * Method which returns a promise if the work info has been reached. * * @method getWorkInfo * @param {String} pi The PI of the work. * @param {String} logid The LOG_ID of the work. * @returns {Promise} A promise object if the info has been reached. */ function _getWorkInfo( pi, logid, type ) { if ( _debug ) { console.log( '---------- _getWorkInfo() ----------' ); console.log( '_getWorkInfo: pi = ', pi ); console.log( '_getWorkInfo: logid = ', logid ); console.log( '_getWorkInfo: type = ', type ); } var restCall = ''; var workInfo = {}; if ( logid !== '' || logid !== undefined ) { restCall = _defaults.iiifPath + type + '/mets/' + pi + '/' + logid + '/'; if ( _debug ) { console.log( 'if' ); console.log( '_getWorkInfo: restCall = ', restCall ); } } else { restCall = _defaults.iiifPath + type + '/mets/' + pi + '/-/'; if ( _debug ) { console.log( 'else' ); console.log( '_getWorkInfo: restCall = ', restCall ); } } return viewerJS.helper.getRemoteData( restCall ); } return viewer; } )( viewerJS || {}, jQuery ); Ã— Search results Close "},"viewer_viewerJS.editComment.js.html":{"id":"viewer_viewerJS.editComment.js.html","title":"Source: viewer/viewerJS.editComment.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.editComment.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module to edit comments in user generated content. * * @version 3.2.0 * @module viewerJS.editComment * @requires jQuery */ var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _defaults = { commentCount: 0, editBtnCount: 0, deleteBtnCount: 0, deleteModalCount: 0, btnId: null, commentText: null }; viewer.editComment = { /** * Method which initializes all required events to edit comments. * * @method init * @example * * &lt;pre&gt; * $( document ).ready( function() { * viewerJS.editComment.init(); * } ); * &lt;/pre&gt; */ init: function() { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.editComment.init' ); console.log( '##############################' ); } // clear texarea for new comments if ( $( 'textarea[id*=&quot;newCommentInput&quot;]' ).val() !== '' ) { $( 'textarea[id*=&quot;newCommentInput&quot;]' ).focus().val( '' ); } // eventlisteners $( '.comment-edit' ).on( 'click', function() { // hide add new comment field $( '#newCommentField' ).fadeOut(); // get button id _defaults.btnId = $( this ).attr( 'id' ).replace( 'commentEditBtn-', '' ); // show textfield to edit comment and hide comment $( '#addComment' ).hide(); $( '#commentEditComment-' + _defaults.btnId ).prev().hide(); $( '#commentEditComment-' + _defaults.btnId ).show(); // hide edit button $( '.comment-edit' ).hide(); } ); $( '.comment-abort' ).on( 'click', function() { // show add new comment field $( '#newCommentField' ).fadeIn(); // show edit button and comment $( '.comments-comment-text' ).show(); $( '.comment-edit' ).show(); $( '#addComment' ).show(); // hide textfield to edit comment $( this ).parent().hide(); } ); // add counting ids to elements $( '.comment-edit' ).each( function() { $( this ).attr( 'id', 'commentEditBtn-' + _defaults.editBtnCount ); _defaults.editBtnCount++; } ); $( '.comments-comment-edit' ).each( function() { $( this ).attr( 'id', 'commentEditComment-' + _defaults.commentCount ); _defaults.commentCount++; } ); $.each( $( '.comments-delete-btn' ), function() { $( this ).attr( 'data-toggle', 'modal' ).attr( 'data-target', '#deleteCommentModal-' + _defaults.deleteBtnCount ); _defaults.deleteBtnCount++; } ); $.each( $( '.deleteCommentModal' ), function() { $( this ).attr( 'id', 'deleteCommentModal-' + _defaults.deleteModalCount ); _defaults.deleteModalCount++; } ); } }; return viewer; } )( viewerJS || {}, jQuery ); Ã— Search results Close "},"viewer_viewerJS.helper.js.html":{"id":"viewer_viewerJS.helper.js.html","title":"Source: viewer/viewerJS.helper.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.helper.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which includes mostly used helper functions. * * @version 3.2.0 * @module viewerJS.helper * @requires jQuery */ var viewerJS = ( function( viewer ) { 'use strict'; // default variables var _debug = false; viewer.helper = { /** * Method to truncate a string to a given length. * * @method truncateString * @param {String} str The string to truncate. * @param {Number} size The number of characters after the string should be * croped. * @returns {String} The truncated string. * @example * * &lt;pre&gt; * viewerJS.helper.truncateString( $( '.something' ).text(), 75 ); * &lt;/pre&gt; */ truncateString: function( str, size ) { if ( _debug ) { console.log( '---------- viewer.helper.truncateString() ----------' ); console.log( 'viewer.helper.truncateString: str = ', str ); console.log( 'viewer.helper.truncateString: size = ', size ); } var strSize = parseInt( str.length ); if ( strSize &gt; size ) { return str.substring( 0, size ) + '...'; } else { return str; } }, /** * Method which calculates the current position of the active element in sidebar * toc and the image container position and saves it to lacal storage. * * @method saveSidebarTocPosition * @example * * &lt;pre&gt; * viewerJS.helper.saveSidebarTocPosition(); * &lt;/pre&gt; */ saveSidebarTocPosition: function() { if ( _debug ) { console.log( '---------- viewer.helper.saveSidebarTocPosition() ----------' ); } var scrollSidebarTocPosition = null; var savedIdDoc = localStorage.getItem( 'currIdDoc' ); var sidebarTocWrapper = '.widget-toc-elem-wrapp'; var currElement = null; var currUrl = ''; var parentLogId = ''; if ( viewer.localStoragePossible ) { if ( savedIdDoc !== 'false' ) { currElement = $( 'li[data-iddoc=&quot;' + savedIdDoc + '&quot;]' ); if ( currElement.length &gt; 0 ) { $( sidebarTocWrapper ).scrollTop( currElement.offset().top - $( sidebarTocWrapper ).offset().top + $( sidebarTocWrapper ).scrollTop() ); localStorage.setItem( 'currIdDoc', 'false' ); } else { localStorage.setItem( 'currIdDoc', 'false' ); } $( '.widget-toc-elem-link a' ).on( 'click', function() { parentLogId = $( this ).parents( 'li' ).attr( 'data-iddoc' ); localStorage.setItem( 'currIdDoc', parentLogId ); } ); } else { localStorage.setItem( 'currIdDoc', 'false' ); // expand click $( '.widget-toc-elem-expand a' ).on( 'click', function() { scrollSidebarTocPosition = $( sidebarTocWrapper ).scrollTop(); localStorage.setItem( 'sidebarTocScrollPosition', scrollSidebarTocPosition ); } ); // link click $( '.widget-toc-elem-link a' ).on( 'click', function( event ) { event.preventDefault(); currUrl = $( this ).attr( 'href' ); scrollSidebarTocPosition = $( sidebarTocWrapper ).scrollTop(); localStorage.setItem( 'sidebarTocScrollPosition', scrollSidebarTocPosition ); location.href = currUrl; } ); // scroll to saved position $( sidebarTocWrapper ).scrollTop( localStorage.getItem( 'sidebarTocScrollPosition' ) ); } } else { return false; } }, /** * Returns an JSON object from a API call. * * @method getRemoteData * @param {String} url The API call URL. * @returns {Object} A promise object, which tells about the success of receiving * data. * @example * * &lt;pre&gt; * viewerJS.helper.getRemoteData( dataURL ); * &lt;/pre&gt; */ getRemoteData: function( url ) { if ( _debug ) { console.log( '---------- viewer.helper.getRemoteData() ----------' ); console.log( 'viewer.helper.getRemoteData: url = ', url ); } var promise = Q( $.ajax( { url: decodeURI( url ), type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true } ) ); return promise; }, /** * Returns a BS Modal with dynamic content. * * @method renderModal * @param {Object} config An config object which includes the content of the * modal. * @param {String} config.id The ID of the modal. * @param {String} config.label The label of the modal. * @param {Object} config.string An object of strings for the modal content. * @param {String} config.string.title The title of the modal. * @param {String} config.string.body The content of the modal as HTML. * @param {String} config.string.closeBtn Buttontext * @param {String} config.string.saveBtn Buttontext * @returns {String} A HTML-String which renders the modal. */ renderModal: function( config ) { if ( _debug ) { console.log( '---------- viewer.helper.renderModal() ----------' ); console.log( 'viewer.helper.renderModal: config = ', config ); } var _defaults = { id: 'myModal', label: 'myModalLabel', closeId: 'closeModal', submitId: 'submitModal', string: { title: 'Modal title', body: '', closeBtn: 'Close', saveBtn: 'Save changes', } }; $.extend( true, _defaults, config ); var modal = ''; modal += '&lt;div class=&quot;modal fade&quot; id=&quot;' + _defaults.id + '&quot; tabindex=&quot;-1&quot; role=&quot;dialog&quot; aria-labelledby=&quot;' + _defaults.label + '&quot;&gt;'; modal += '&lt;div class=&quot;modal-dialog&quot; role=&quot;document&quot;&gt;'; modal += '&lt;div class=&quot;modal-content&quot;&gt;'; modal += '&lt;div class=&quot;modal-header&quot;&gt;'; modal += '&lt;button type=&quot;button&quot; class=&quot;close&quot; data-dismiss=&quot;modal&quot; aria-label=&quot;' + _defaults.string.closeBtn + '&quot;&gt;'; modal += '&lt;span aria-hidden=&quot;true&quot;&gt;&amp;times;&lt;/span&gt;'; modal += '&lt;/button&gt;'; modal += '&lt;h4 class=&quot;modal-title&quot; id=&quot;' + _defaults.label + '&quot;&gt;' + _defaults.string.title + '&lt;/h4&gt;'; modal += '&lt;/div&gt;'; modal += '&lt;div class=&quot;modal-body&quot;&gt;' + _defaults.string.body + '&lt;/div&gt;'; modal += '&lt;div class=&quot;modal-footer&quot;&gt;'; modal += '&lt;button type=&quot;button&quot; id=&quot;' + _defaults.closeId + '&quot; class=&quot;btn&quot; data-dismiss=&quot;modal&quot;&gt;' + _defaults.string.closeBtn + '&lt;/button&gt;'; modal += '&lt;button type=&quot;button&quot; id=&quot;' + _defaults.submitId + '&quot; class=&quot;btn&quot;&gt;' + _defaults.string.saveBtn + '&lt;/button&gt;'; modal += '&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;'; return modal; }, /** * Returns a BS Alert with dynamic content. * * @method renderAlert * @param {String} type The type of the alert. * @param {String} content The content of the alert. * @param {Boolean} dismissable Sets the option to make the alert dismissable, * true = dismissable. * @returns {String} A HTML-String which renders the alert. */ renderAlert: function( type, content, dismissable ) { if ( _debug ) { console.log( '---------- viewer.helper.renderAlert() ----------' ); console.log( 'viewer.helper.renderAlert: type = ', type ); console.log( 'viewer.helper.renderAlert: content = ', content ); console.log( 'viewer.helper.renderAlert: dismissable = ', dismissable ); } var bsAlert = ''; bsAlert += '&lt;div role=&quot;alert&quot; class=&quot;alert ' + type + ' alert-dismissible fade in&quot;&gt;'; if ( dismissable ) { bsAlert += '&lt;button aria-label=&quot;Close&quot; data-dismiss=&quot;alert&quot; class=&quot;close&quot; type=&quot;button&quot;&gt;&lt;span aria-hidden=&quot;true&quot;&gt;Ã—&lt;/span&gt;&lt;/button&gt;'; } bsAlert += content; bsAlert += '&lt;/div&gt;'; return bsAlert; }, /** * Method to get the version number of the used MS Internet Explorer. * * @method detectIEVersion * @returns {Number} The browser version. */ detectIEVersion: function() { var ua = window.navigator.userAgent; // IE 10 and older var msie = ua.indexOf( 'MSIE ' ); if ( msie &gt; 0 ) { // IE 10 or older =&gt; return version number return parseInt( ua.substring( msie + 5, ua.indexOf( '.', msie ) ), 10 ); } // IE 11 var trident = ua.indexOf( 'Trident/' ); if ( trident &gt; 0 ) { // IE 11 =&gt; return version number var rv = ua.indexOf( 'rv:' ); return parseInt( ua.substring( rv + 3, ua.indexOf( '.', rv ) ), 10 ); } // IE 12+ var edge = ua.indexOf( 'Edge/' ); if ( edge &gt; 0 ) { // Edge (IE 12+) =&gt; return version number return parseInt( ua.substring( edge + 5, ua.indexOf( '.', edge ) ), 10 ); } // other browser return false; }, /** * Method to check if itÂ´s possible to write to local Storage * * @method checkLocalStorage * @returns {Boolean} true or false */ checkLocalStorage: function() { if ( typeof localStorage === 'object' ) { try { localStorage.setItem( 'testLocalStorage', 1 ); localStorage.removeItem( 'testLocalStorage' ); return true; } catch ( error ) { console.error( 'Not possible to write in local Storage: ', error ); return false; } } }, /** * Method to render a warning popover. * * @method renderWarningPopover * @param {String} msg The message to show in the popover. * @returns {Object} An jQuery Object to append to DOM. */ renderWarningPopover: function( msg ) { var popover = $( '&lt;div /&gt;' ); var popoverText = $( '&lt;p /&gt;' ); var popoverButton = $( '&lt;button /&gt;' ); var popoverButtonIcon = $( '&lt;i aria-hidden=&quot;true&quot; /&gt;' ); popover.addClass( 'warning-popover' ); // build button popoverButton.addClass( 'btn-clean' ); popoverButton.attr( 'data-toggle', 'warning-popover' ); popoverButtonIcon.addClass( 'fa fa-times' ); popoverButton.append( popoverButtonIcon ); popover.append( popoverButton ); // build text popoverText.html( msg ); popover.append( popoverText ); return popover; }, /** * Method to equal height of sidebar and content. * * @method equalHeight * @param {String} sidebar The selector of the sidebar. * @param {String} content The selector of the content. */ equalHeight: function( sidebar, content ) { if ( _debug ) { console.log( '---------- viewer.helper.equalHeight() ----------' ); console.log( 'viewer.helper.equalHeight: sidebar = ', sidebar ); console.log( 'viewer.helper.equalHeight: content = ', content ); } var $sidebar = $( sidebar ); var $content = $( content ); var sidebarHeight = $sidebar.outerHeight(); var contentHeight = $content.outerHeight(); if ( sidebarHeight &gt; contentHeight ) { $content.css( { 'min-height': ( sidebarHeight ) + 'px' } ); } }, /** * Method to validate the reCAPTCHA response. * * @method validateReCaptcha * @param {String} wrapper The reCAPTCHA widget wrapper. * @param {String} key The reCAPTCHA site key. * @returns {Boolean} Returns true if the response is valid. */ validateReCaptcha: function( wrapper, key ) { var widget = grecaptcha.render( wrapper, { sitekey: key, callback: function() { var response = grecaptcha.getResponse( widget ); console.log( response ); if ( response == 0 ) { return false; } else { return true; } } } ); }, /** * Method to get the current used browser. * * @method getCurrentBrowser * @returns {String} The name of the current Browser. */ getCurrentBrowser: function() { // Opera 8.0+ var isOpera = ( !!window.opr &amp;&amp; !!opr.addons ) || !!window.opera || navigator.userAgent.indexOf( ' OPR/' ) &gt;= 0; // Firefox 1.0+ var isFirefox = typeof InstallTrigger !== 'undefined'; // Safari 3.0+ &quot;[object HTMLElementConstructor]&quot; var isSafari = /constructor/i.test( window.HTMLElement ) || ( function( p ) { return p.toString() === &quot;[object SafariRemoteNotification]&quot;; } )( !window[ 'safari' ] || ( typeof safari !== 'undefined' &amp;&amp; safari.pushNotification ) ); // Internet Explorer 6-11 var isIE = /* @cc_on!@ */false || !!document.documentMode; // Edge 20+ var isEdge = !isIE &amp;&amp; !!window.StyleMedia; // Chrome 1+ var isChrome = !!window.chrome &amp;&amp; !!window.chrome.webstore; // Blink engine detection // var isBlink = ( isChrome || isOpera ) &amp;&amp; !!window.CSS; if ( isOpera ) { return 'Opera'; } else if ( isFirefox ) { return 'Firefox'; } else if ( isSafari ) { return 'Safari'; } else if ( isIE ) { return 'IE'; } else if ( isEdge ) { return 'Edge'; } else if ( isChrome ) { return 'Chrome'; } }, }; viewer.localStoragePossible = viewer.helper.checkLocalStorage(); return viewer; } )( viewerJS || {}, jQuery ); Ã— Search results Close "},"viewer_viewerJS.navigation.js.html":{"id":"viewer_viewerJS.navigation.js.html","title":"Source: viewer/viewerJS.navigation.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.navigation.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * This module drives the functionality of the main navigation from the Goobi viewer. * * @version 3.2.0 * @module viewerJS.navigation * @requires jQuery */ var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _defaults = { navigationSelector: '#navigation', subMenuSelector: '[data-toggle=&quot;submenu&quot;]', megaMenuSelector: '[data-toggle=&quot;megamenu&quot;]', closeMegaMenuSelector: '[data-toggle=&quot;close&quot;]', }; viewer.navigation = { /** * Method to initialize the viewer main navigation. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {String} config.navigationSelector The selector for the navigation * element. * @param {String} config.subMenuSelector The selector for the submenu element. * @param {String} config.megaMenuSelector The selector for the mega menu element. * @param {String} config.closeMegaMenuSelector The selector for the close mega * menu element. */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.navigation.init' ); console.log( '##############################' ); console.log( 'viewer.navigation.init: config - ', config ); } $.extend( true, _defaults, config ); // TRIGGER STANDARD MENU $( _defaults.subMenuSelector ).on( 'click', function() { var currTrigger = $( this ); if ( $( this ).parents( '.navigation__submenu' ).hasClass( 'in' ) ) { _resetSubMenus(); currTrigger.parent().addClass( 'active' ); currTrigger.next( '.navigation__submenu' ).addClass( 'in' ); _calcSubMenuPosition( currTrigger.next( '.navigation__submenu' ) ); } else { _resetMenus(); currTrigger.parent().addClass( 'active' ); currTrigger.next( '.navigation__submenu' ).addClass( 'in' ); } } ); // TRIGGER MEGA MENU $( _defaults.megaMenuSelector ).on( 'click', function() { _resetMenus(); if ( $( this ).next( '.navigation__megamenu-wrapper' ).hasClass( 'in' ) ) { $( this ).parent().removeClass( 'active' ); $( this ).next( '.navigation__megamenu-wrapper' ).removeClass( 'in' ); } else { $( '.navigation__megamenu-trigger' ).removeClass( 'active' ); $( '.navigation__megamenu-wrapper' ).removeClass( 'in' ); $( this ).parent().addClass( 'active' ); $( this ).next( '.navigation__megamenu-wrapper' ).addClass( 'in' ); } } ); $( _defaults.closeMegaMenuSelector ).on( 'click', function() { _resetMenus(); } ); if ( $( '.navigation__megamenu-wrapper' ).length &gt; 0 ) { _resetMenus(); } // reset all menus by clicking on body $( 'body' ).on( 'click', function( event ) { if ( event.target.id == 'navigation' || $( event.target ).closest( _defaults.navigationSelector ).length ) { return; } else { _resetMenus(); } } ); }, }; /** * Method to reset all shown menus. * * @method _resetMenus */ function _resetMenus() { if ( _debug ) { console.log( '---------- _resetMenus() ----------' ); } $( '.navigation__submenu-trigger' ).removeClass( 'active' ); $( '.navigation__submenu' ).removeClass( 'in' ); $( '.navigation__megamenu-trigger' ).removeClass( 'active' ); $( '.navigation__megamenu-wrapper' ).removeClass( 'in' ); } /** * Method to reset all shown submenus. * * @method _resetSubMenus */ function _resetSubMenus() { $( '.level-2, .level-3, .level-4, .level-5' ).parent().removeClass( 'active' ); $( '.level-2, .level-3, .level-4, .level-5' ).removeClass( 'in' ).removeClass( 'left' ); } /** * Method to calculate the position of the shown submenu. * * @method _calcSubMenuPosition * @param {Object} menu An jQuery object of the current submenu. */ function _calcSubMenuPosition( menu ) { if ( _debug ) { console.log( '---------- _clacSubMenuPosition() ----------' ); console.log( '_clacSubMenuPosition: menu - ', menu ); } var currentOffsetLeft = menu.offset().left; var menuWidth = menu.outerWidth(); var windowWidth = $( window ).outerWidth(); var offsetWidth = currentOffsetLeft + menuWidth; if ( _debug ) { console.log( '_clacSubMenuPosition: currentOffsetLeft - ', currentOffsetLeft ); console.log( '_clacSubMenuPosition: menuWidth - ', menuWidth ); console.log( '_clacSubMenuPosition: windowWidth - ', windowWidth ); console.log( '_clacSubMenuPosition: offsetWidth - ', offsetWidth ); } if ( offsetWidth &gt;= windowWidth ) { menu.addClass( 'left' ).css( 'width', menuWidth ); } else { return false; } } return viewer; } )( viewerJS || {}, jQuery ); Ã— Search results Close "},"viewer_viewerJS.nerFacetting.js.html":{"id":"viewer_viewerJS.nerFacetting.js.html","title":"Source: viewer/viewerJS.nerFacetting.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.nerFacetting.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which facetts the NER-Tags in a sidebar widget and Pageview. * * @version 3.2.0 * @module viewerJS.nerFacetting * @requires jQuery * @requires Bootstrap */ var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _json = null; var _apiCall = ''; var _html = ''; var _pageCount = 0; var _scaleCount = 0; var _scaleHeight = 0; var _sliderHandlePosition = {}; var _movedSliderHandlePosition = 0; var _recurrenceCount = 0; var _scaleValue = 0; var _sliderScaleHeight = 0; var _start = 0; var _end = 0; var _currentNerPageRangeSelected = ''; var _currentNerPageRange = ''; var _currentNerType = ''; var _promise = null; var _defaults = { currentPage: '', baseUrl: '', apiUrl: '/rest/ner/tags/', workId: '', overviewTrigger: '', overviewContent: '', sectionTrigger: '', sectionContent: '', facettingTrigger: '', setTagRange: '', slider: '', sliderScale: '', sectionTags: '', currentTags: '', sliderHandle: '', sliderSectionStripe: '', recurrenceNumber: 0, recurrenceSectionNumber: 0, sidebarRight: false, loader: '', msg: { noJSON: 'Es konnten keine Daten abgerufen werden.', emptyTag: 'Keine Tags vorhanden', page: 'Seite', tags: 'Tags', } }; viewer.nerFacetting = { /** * Method to initialize the NER-Widget or NER-View. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {String} config.currentPage The name of the current page. * @param {String} config.baseUrl The root URL. * @param {String} config.apiUrl The base URL for the API-Calls. * @param {String} config.workId The ID of the current work. * @param {String} config.overviewTrigger The ID/Class of the overview trigger. * @param {String} config.overviewContent The ID/Class of the content section from * overview. * @param {String} config.sectionTrigger The ID/Class of the section trigger. * @param {String} config.sectionContent The ID/Class of the content section from * section. * @param {String} config.facettingTrigger The ID/Class of the facetting trigger. * @param {String} config.setTagRange The ID/Class of the select menu for the * range. * @param {String} config.slider The ID/Class of the tag range slider. * @param {String} config.sliderScale The ID/Class of the slider scale. * @param {String} config.sectionTags The ID/Class of the tag section. * @param {String} config.currentTags The ID/Class of the tag container. * @param {String} config.sliderHandle The ID/Class of the slider handle. * @param {String} config.sliderSectionStripe The ID/Class of the range stripe on * the slider. * @param {Number} config.recurrenceNumber The number of displayed tags in a row. * @param {Number} config.recurrenceSectionNumber The number of displayed tags in * a section. * @param {Boolean} config.sidebarRight If true, the current tag row will show up * to the left of the sidebar widget. * @param {String} config.loader The ID/Class of the AJAX-Loader. * @param {Object} config.msg An object of strings for multi language use. */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.nerFacetting.init' ); console.log( '##############################' ); console.log( 'viewer.nerFacetting.init: config - ', config ); } $.extend( true, _defaults, config ); if ( viewer.localStoragePossible ) { // show loader $( _defaults.loader ).show(); // clean local storage _cleanUpLocalStorage(); // reset select menu $( _defaults.setTagRange ).find( 'option' ).attr( 'selected', false ); if ( _defaults.currentPage === 'nerfacetting' ) { $( _defaults.setTagRangeOverview ).find( 'option[value=&quot;1&quot;]' ).prop( 'selected', true ); } else { $( _defaults.setTagRangeOverview ).find( 'option[value=&quot;10&quot;]' ).prop( 'selected', true ); } // reset facetting icons _resetFacettingIcons(); // get data for current work if ( _defaults.currentPage === 'nerfacetting' ) { _apiCall = _getAllTagsOfARange( 1, '-' ); } else { _apiCall = _getAllTagsOfARange( 10, '-' ); } _promise = viewer.helper.getRemoteData( _apiCall ); _promise.then( function( json ) { _json = json; // check if data is not empty if ( _json !== null || _json !== 'undefinded' ) { // check if overview is already loaded if ( $( _defaults.overviewContent ).html() === '' ) { _renderOverview( _json ); } } else { _html = viewer.helper.renderAlert( 'alert-danger', _defaults.msg.noJSON + '&lt;br /&gt;&lt;br /&gt;URL: ' + _apiCall, true ); $( _defaults.overviewContent ).html( _html ); } } ).then( null, function( error ) { $( '.facetting-content' ).empty().append( viewer.helper .renderAlert( 'alert-danger', '&lt;strong&gt;Status: &lt;/strong&gt;' + error.status + ' ' + error.statusText, false ) ); console.error( 'ERROR: viewer.nerFacetting.init - ', error ); } ); /** * Event if overview tab is clicked. */ $( _defaults.overviewTrigger ).on( 'click', function() { // show loader $( _defaults.loader ).show(); // resets $( _defaults.setTagRange ).find( 'option' ).attr( 'selected', false ); if ( _defaults.currentPage === 'nerfacetting' ) { $( _defaults.setTagRangeOverview ).find( 'option[value=&quot;1&quot;]' ).prop( 'selected', true ); localStorage.setItem( 'currentNerPageRange', '1' ); } else { $( _defaults.setTagRangeOverview ).find( 'option[value=&quot;10&quot;]' ).prop( 'selected', true ); localStorage.setItem( 'currentNerPageRange', '10' ); } _currentNerPageRange = localStorage.getItem( 'currentNerPageRange' ); localStorage.setItem( 'currentNerType', '-' ); _currentNerType = localStorage.getItem( 'currentNerType' ); _resetFacettingIcons(); // check if tab is active if ( $( this ).parent().hasClass( 'active' ) ) { console.info( 'Overview is already active.' ); } else { if ( _defaults.currentPage === 'nerfacetting' ) { _apiCall = _getAllTagsOfARange( 1, '-' ); } else { _apiCall = _getAllTagsOfARange( 10, '-' ); } _promise = viewer.helper.getRemoteData( _apiCall ); _promise.then( function( json ) { _json = json; _renderOverview( _json ); } ).then( null, function( error ) { $( '.facetting-content' ).empty().append( viewer.helper.renderAlert( 'alert-danger', '&lt;strong&gt;Status: &lt;/strong&gt;' + error.status + ' ' + error.statusText, false ) ); console.error( 'ERROR: viewer.nerFacetting.init - ', error ); } ); } } ); /** * Event if section tab is clicked. */ $( _defaults.sectionTrigger ).on( 'click', function() { // show loader $( _defaults.loader ).show(); // reset select menu $( _defaults.setTagRange ).find( 'option' ).attr( 'selected', false ); if ( _defaults.currentPage === 'nerfacetting' ) { $( _defaults.setTagRangeSection ).find( 'option[value=&quot;5&quot;]' ).prop( 'selected', true ); } else { $( _defaults.setTagRangeSection ).find( 'option[value=&quot;10&quot;]' ).prop( 'selected', true ); } // reset facetting _resetFacettingIcons() // set local storage value if ( _defaults.currentPage === 'nerfacetting' ) { localStorage.setItem( 'currentNerPageRange', 5 ); } else { localStorage.setItem( 'currentNerPageRange', 10 ); } _currentNerPageRange = localStorage.getItem( 'currentNerPageRange' ); localStorage.setItem( 'currentNerType', '-' ); _currentNerType = localStorage.getItem( 'currentNerType' ); // check if tab is active if ( $( this ).parent().hasClass( 'active' ) ) { console.info( 'Section is already active.' ); } else { _renderSection(); // reset section stripe $( _defaults.sliderSectionStripe ).css( 'top', '0px' ); } } ); /** * Event if select menu changes. */ $( _defaults.setTagRange ).on( 'change', function() { var currVal = $( this ).val(); _currentNerType = localStorage.getItem( 'currentNerType' ); // show loader $( _defaults.loader ).show(); // save current value in local storage localStorage.setItem( 'currentNerPageRange', currVal ); _currentNerPageRange = localStorage.getItem( 'currentNerPageRange' ); // render overview if ( $( this ).hasClass( 'overview' ) ) { if ( _currentNerType === null || _currentNerType === '' ) { _currentNerType = '-'; } _apiCall = _getAllTagsOfARange( currVal, _currentNerType ); _promise = viewer.helper.getRemoteData( _apiCall ); _promise.then( function( json ) { _json = json; // check if data is not empty if ( _json !== null || _json !== 'undefinded' ) { _renderOverview( _json ); } else { _html = viewer.helper.renderAlert( 'alert-danger', _defaults.msg.noJSON + '&lt;br /&gt;&lt;br /&gt;URL: ' + _apiCall, true ); $( _defaults.overviewContent ).html( _html ); } } ).then( null, function( error ) { $( '.facetting-content' ).empty().append( viewer.helper.renderAlert( 'alert-danger', '&lt;strong&gt;Status: &lt;/strong&gt;' + error.status + ' ' + error.statusText, false ) ); console.error( 'ERROR: viewer.nerFacetting.init - ', error ); } ); } // render section else { // setup values localStorage.setItem( 'currentNerPageRange', currVal ); _currentNerPageRange = localStorage.getItem( 'currentNerPageRange' ); _renderSection(); // reset section stripe if ( _currentNerPageRange &gt; _pageCount ) { $( _defaults.sliderSectionStripe ).css( { 'top': '0px', 'height': '600px' } ); } else { $( _defaults.sliderSectionStripe ).css( { 'top': '0px', 'height': '100px' } ); } } } ); /** * Event if facetting icons are clicked. */ $( _defaults.facettingTrigger ).on( 'click', function() { var currType = $( this ).attr( 'data-type' ); // show loader $( _defaults.loader ).show(); // set values localStorage.setItem( 'currentNerType', currType ); _currentNerType = localStorage.getItem( 'currentNerType' ); if ( _defaults.currentPage === 'nerfacetting' ) { if ( _currentNerPageRange == null || _currentNerPageRange === '' ) { _currentNerPageRange = localStorage.setItem( 'currentNerPageRange', 1 ); } } else { if ( _currentNerPageRange == null || _currentNerPageRange === '' ) { _currentNerPageRange = localStorage.setItem( 'currentNerPageRange', 10 ); } } _currentNerPageRange = localStorage.getItem( 'currentNerPageRange' ); // activate icons $( '.facetting-trigger' ).removeClass( 'active' ); $( this ).addClass( 'active' ); $( '.reset-filter' ).show(); // filter overview if ( $( this ).parent().parent().parent().attr( 'id' ) === 'overview' ) { // setup data _apiCall = _getAllTagsOfARange( _currentNerPageRange, _currentNerType ); _promise = viewer.helper.getRemoteData( _apiCall ); _promise.then( function( json ) { _json = json; _renderOverview( _json ); // hide select all if ( $( this ).parent().hasClass( 'reset-filter' ) ) { $( this ).parent().hide(); } // set icons to active if &quot;all&quot; is selected if ( _currentNerType === '-' ) { $( '.facetting-trigger' ).addClass( 'active' ); } } ).then( null, function( error ) { $( '.facetting-content' ).empty().append( viewer.helper.renderAlert( 'alert-danger', '&lt;strong&gt;Status: &lt;/strong&gt;' + error.status + ' ' + error.statusText, false ) ); console.error( 'ERROR: viewer.nerFacetting.init - ', error ); } ); } // filter section else { _renderSection(); // hide select all if ( $( this ).parent().hasClass( 'reset-filter' ) ) { $( this ).parent().hide(); } // set icons to active if &quot;all&quot; is selected if ( _currentNerType === '-' ) { $( '.facetting-trigger' ).addClass( 'active' ); } // reset section stripe $( _defaults.sliderSectionStripe ).css( 'top', '0px' ); } } ); } else { $( '.facetting-content' ).empty().append( viewer.helper .renderAlert( 'alert-danger', '&lt;strong&gt;Deactivated: &lt;/strong&gt;Not possible to write in local Storage!', false ) ); } } }; /** * Method to render the NER overview. * * @method _renderOverview * @param {Object} data A JSON-Object. * @returns {Sting} A HTML-String which renders the overview. */ function _renderOverview( data ) { if ( _debug ) { console.log( '---------- _renderOverview() ----------' ); console.log( '_renderOverview: data = ', data ); } _html = ''; _html += '&lt;ul class=&quot;overview-scale&quot;&gt;'; // render page number $.each( data.pages, function( p, page ) { _html += '&lt;li&gt;'; _html += '&lt;div class=&quot;page-number&quot;&gt;'; if ( data.rangeSize == 1 ) { if ( _defaults.currentPage === 'nerfacetting' ) { _html += '&lt;a href=&quot;' + _defaults.baseUrl + '/image/' + _defaults.workId + '/' + page.pageOrder + '/&quot;&gt;'; } else { _html += '&lt;a href=&quot;' + _defaults.baseUrl + '/' + _defaults.currentPage + '/' + _defaults.workId + '/' + page.pageOrder + '/&quot;&gt;'; } _html += page.pageOrder; _html += '&lt;/a&gt;'; } else { if ( _defaults.currentPage === 'nerfacetting' ) { if ( page.firstPage !== undefined || page.lastPage !== undefined ) { _html += '&lt;a href=&quot;' + _defaults.baseUrl + '/image/' + _defaults.workId + '/' + page.firstPage + '/&quot;&gt;'; _html += page.firstPage + '-' + page.lastPage; _html += '&lt;/a&gt;'; } else { _html += '&lt;a href=&quot;' + _defaults.baseUrl + '/image/' + _defaults.workId + '/' + page.pageOrder + '/&quot;&gt;'; _html += page.pageOrder; _html += '&lt;/a&gt;'; } } else { if ( page.firstPage !== undefined || page.lastPage !== undefined ) { _html += '&lt;a href=&quot;' + _defaults.baseUrl + '/' + _defaults.currentPage + '/' + _defaults.workId + '/' + page.firstPage + '/&quot;&gt;'; _html += page.firstPage + '-' + page.lastPage; _html += '&lt;/a&gt;'; } else { _html += '&lt;a href=&quot;' + _defaults.baseUrl + '/' + _defaults.currentPage + '/' + _defaults.workId + '/' + page.pageOrder + '/&quot;&gt;'; _html += page.pageOrder; _html += '&lt;/a&gt;'; } } } _html += '&lt;/div&gt;'; _html += '&lt;div class=&quot;tag-container&quot;&gt;'; // render tags if ( page.tags.length === 0 || page.tags.length === 'undefined' ) { _html += '&lt;span class=&quot;page-tag empty&quot;&gt;' + _defaults.msg.emptyTag + '&lt;/span&gt;'; } else { $.each( page.tags, function( t, tag ) { _html += '&lt;span class=&quot;page-tag ' + tag.type + '&quot;&gt;' + tag.value + '&lt;/span&gt;'; } ); } _html += '&lt;/div&gt;'; _html += '&lt;/li&gt;'; } ); _html += '&lt;/ul&gt;'; $( _defaults.overviewContent ).hide().html( _html ).find( '.tag-container' ).each( function() { $( this ).children( '.page-tag' ).slice( _defaults.recurrenceNumber ).remove(); } ); $( _defaults.overviewContent ).show(); // hide loader $( _defaults.loader ).hide(); $( '.tag-container' ).on( { 'mouseover': function() { var $this = $( this ); _showCurrentTags( $this ); }, 'mouseout': function() { _hideCurrentTags(); } } ); } /** * Method which shows the current tag row in a tooltip. * * @method _showCurrentTags * @param {Object} $obj An jQuery object of the current tag row. */ function _showCurrentTags( $obj ) { var content = $obj.html(); var pos = $obj.position(); if ( _defaults.sidebarRight ) { if ( _defaults.currentPage === 'nerfacetting' ) { $( _defaults.currentTags ).html( content ).css( { 'display': 'block', 'top': pos.top + 25 + 'px', } ); } else { $( _defaults.currentTags ).addClass( 'right' ).html( content ).css( { 'display': 'block', 'top': pos.top - 2 + 'px', 'left': 'auto', 'right': '100%' } ); } } else { if ( _defaults.currentPage === 'nerfacetting' ) { $( _defaults.currentTags ).html( content ).css( { 'display': 'block', 'top': pos.top + 25 + 'px' } ); } else { $( _defaults.currentTags ).html( content ).css( { 'display': 'block', 'top': pos.top - 2 + 'px' } ); } } } /** * Method which hides the current tag row tooltip. * * @method _hideCurrentTags */ function _hideCurrentTags() { $( _defaults.currentTags ).hide(); } /** * Method to render the NER section. * * @method _renderSection * @param {Object} data A JSON-Object. */ function _renderSection() { if ( _debug ) { console.log( '---------- _renderSection() ----------' ); console.log( '_renderSection: _currentNerPageRange = ', _currentNerPageRange ); console.log( '_renderSection: _currentNerType = ', _currentNerType ); } // set values _apiCall = _getAllTags(); _promise = viewer.helper.getRemoteData( _apiCall ); _promise.then( function( workCall ) { _pageCount = _getPageCount( workCall ); if ( _currentNerPageRange === null || _currentNerPageRange === '' ) { _currentNerPageRange = localStorage.getItem( 'currentNerPageRange' ); } if ( _currentNerType === null || _currentNerType === '' ) { _currentNerType = localStorage.getItem( 'currentNerType' ) } // render page count to scale if ( _defaults.currentPage === 'nerfacetting' ) { $( '#sliderScale .scale-page.end' ).html( _pageCount ); } else { if ( _pageCount &gt; 1000 ) { $( '#sliderScale .scale-page.end' ).html( '999+' ); } else { $( '#sliderScale .scale-page.end' ).html( _pageCount ); } } // init slider $( _defaults.slider ).slider( { orientation: &quot;vertical&quot;, range: false, min: 1, max: _pageCount, value: _pageCount, slide: function( event, ui ) { _sliderHandlePosition = $( _defaults.sliderHandle ).position(); _scaleValue = ( _pageCount + 1 ) - ui.value; // show bubble $( '.page-bubble' ).show(); _renderPageBubble( _scaleValue ); }, start: function() { _sliderHandlePosition = $( _defaults.sliderHandle ).position(); _movedSliderHandlePosition = _sliderHandlePosition.top; }, stop: function( event, ui ) { _currentNerType = localStorage.getItem( 'currentNerType' ); _sliderScaleHeight = $( _defaults.sliderScale ).height(); // set position of section stripe if ( _currentNerPageRange &gt; _pageCount ) { $( _defaults.sliderSectionStripe ).css( { 'top': '0px', 'height': '600px' } ); } else { if ( _sliderHandlePosition.top &lt; 100 ) { $( _defaults.sliderSectionStripe ).animate( { 'top': '0px', 'height': '100px' } ); } else if ( _sliderHandlePosition.top &gt; 100 ) { if ( _sliderHandlePosition.top &gt; 500 ) { $( _defaults.sliderSectionStripe ).animate( { 'top': ( _sliderScaleHeight - 100 ) + 'px', 'height': '100px' } ); } else { if ( _movedSliderHandlePosition &lt; _sliderHandlePosition.top ) { $( _defaults.sliderSectionStripe ).animate( { 'top': _sliderHandlePosition.top - 25 + 'px', 'height': '100px' } ); } else { $( _defaults.sliderSectionStripe ).animate( { 'top': _sliderHandlePosition.top - 50 + 'px', 'height': '100px' } ); } } } } // render tags switch ( _currentNerPageRange ) { case '5': _start = _scaleValue - 2; _end = _scaleValue + 3; while ( _start &lt; 1 ) { _start++; _end++; } while ( _end &gt; _pageCount ) { _start--; _end--; } _apiCall = _getAllTagsOfPageSection( _start, _end, _currentNerType ); break; case '10': _start = _scaleValue - 5; _end = _scaleValue + 5; while ( _start &lt; 1 ) { _start++; _end++; } while ( _end &gt; _pageCount ) { _start--; _end--; } _apiCall = _getAllTagsOfPageSection( _start, _end, _currentNerType ); break; case '50': _start = _scaleValue - 25; _end = _scaleValue + 25; while ( _start &lt; 1 ) { _start++; _end++; } while ( _end &gt; _pageCount ) { _start--; _end--; } _apiCall = _getAllTagsOfPageSection( _start, _end, _currentNerType ); break; case '100': _start = _scaleValue - 50; _end = _scaleValue + 50; while ( _start &lt; 1 ) { _start++; _end++; } while ( _end &gt; _pageCount ) { _start--; _end--; } _apiCall = _getAllTagsOfPageSection( _start, _end, _currentNerType ); break; } _promise = viewer.helper.getRemoteData( _apiCall ); _promise.then( function( json ) { _json = json; _html = _renderSectionTags( _json ); if ( _html === '' ) { $( _defaults.sectionTags ).hide().html( viewer.helper.renderAlert( 'alert-warning', _defaults.msg.emptyTag, false ) ).show(); } else { $( _defaults.sectionTags ).hide().html( _html ).each( function() { $( this ).children( '.page-tag' ).slice( _defaults.recurrenceSectionNumber ).remove(); } ); $( _defaults.sectionTags ).show(); } // hide bubble $( '.page-bubble' ).fadeOut(); } ).then( null, function( error ) { $( '.facetting-content' ).empty().append( viewer.helper .renderAlert( 'alert-danger', '&lt;strong&gt;Status: &lt;/strong&gt;' + error.status + ' ' + error.statusText, false ) ); console.error( 'ERROR: viewer.nerFacetting.init - ', error ); } ); } } ); // render section tags _apiCall = _getAllTagsOfPageSection( 0, _currentNerPageRange, _currentNerType ); _promise = viewer.helper.getRemoteData( _apiCall ); _promise.then( function( json ) { _json = json; _html = _renderSectionTags( _json ); if ( _html === '' ) { $( _defaults.sectionTags ).hide().html( viewer.helper.renderAlert( 'alert-warning', _defaults.msg.emptyTag, false ) ).show(); } else { $( _defaults.sectionTags ).hide().html( _html ).each( function() { $( this ).children( '.page-tag' ).slice( _defaults.recurrenceSectionNumber ).remove(); } ); $( _defaults.sectionTags ).show(); } // hide loader $( _defaults.loader ).hide(); } ) .then( null, function( error ) { $( '.facetting-content' ).empty().append( viewer.helper .renderAlert( 'alert-danger', '&lt;strong&gt;Status: &lt;/strong&gt;' + error.status + ' ' + error.statusText, false ) ); console.error( 'ERROR: viewer.nerFacetting.init - ', error ); } ); } ).then( null, function( error ) { $( '.facetting-content' ).empty().append( viewer.helper.renderAlert( 'alert-danger', '&lt;strong&gt;Status: &lt;/strong&gt;' + error.status + ' ' + error.statusText, false ) ); console.error( 'ERROR: viewer.nerFacetting.init - ', error ); } ); } /** * Method which renders the tags in the section area. * * @method _renderSectionTags * @param {Object} data A JSON-Object. * @returns {Sting} A HTML-String which renders the tag section. */ function _renderSectionTags( data ) { if ( _debug ) { console.log( '---------- _renderSectionTags() ----------' ); console.log( '_renderSectionTags: data - ', data ); } _html = ''; // render tags $.each( data.pages, function( p, page ) { if ( page.tags.length === 0 || page.tags.length === 'undefined' ) { _html += ''; } else { $.each( page.tags, function( t, tag ) { if ( _defaults.currentPage === 'nerfacetting' ) { if ( tag.counter &lt; 10 ) { _html += '&lt;span class=&quot;page-tag ' + tag.type + '&quot; style=&quot;font-size: 1.' + tag.counter + 'rem;&quot;&gt;' + tag.value + '&lt;/span&gt;'; } else { _html += '&lt;span class=&quot;page-tag ' + tag.type + '&quot; style=&quot;font-size: 2rem;&quot;&gt;' + tag.value + '&lt;/span&gt;'; } } else { if ( tag.counter &lt; 10 ) { _html += '&lt;span class=&quot;page-tag ' + tag.type + '&quot; style=&quot;font-size: 1' + tag.counter + 'px;&quot;&gt;' + tag.value + '&lt;/span&gt;'; } else { _html += '&lt;span class=&quot;page-tag ' + tag.type + '&quot; style=&quot;font-size: 19px;&quot;&gt;' + tag.value + '&lt;/span&gt;'; } } } ); } } ); return _html; } /** * Method which renders a span showing the current page section. * * @method _renderPageBubble * @param {Number} page The current pagenumber. */ function _renderPageBubble( page ) { if ( _debug ) { console.log( '---------- _renderPageBubble() ----------' ); console.log( '_renderPageBubble: page - ', page ); } var pageBubble = ''; switch ( _currentNerPageRange ) { case '5': _start = page - 2; _end = page + 3; while ( _start &lt; 1 ) { _start++; _end++; } while ( _end &gt; _pageCount ) { _start--; _end--; } pageBubble += '&lt;span class=&quot;page-bubble&quot;&gt;' + _start + '-' + _end + '&lt;/span&gt;'; break; case '10': _start = page - 5; _end = page + 5; while ( _start &lt; 1 ) { _start++; _end++; } while ( _end &gt; _pageCount ) { _start--; _end--; } pageBubble += '&lt;span class=&quot;page-bubble&quot;&gt;' + _start + '-' + _end + '&lt;/span&gt;'; break; case '50': _start = page - 25; _end = page + 25; while ( _start &lt; 1 ) { _start++; _end++; } while ( _end &gt; _pageCount ) { _start--; _end--; } pageBubble += '&lt;span class=&quot;page-bubble&quot;&gt;' + _start + '-' + _end + '&lt;/span&gt;'; break; case '100': _start = page - 50; _end = page + 50; while ( _start &lt; 1 ) { _start++; _end++; } while ( _end &gt; _pageCount ) { _start--; _end--; } pageBubble += '&lt;span class=&quot;page-bubble&quot;&gt;' + _start + '-' + _end + '&lt;/span&gt;'; break; } $( '#sliderVertical .ui-slider-handle' ).html( pageBubble ); } /** * Method which returns the page count of the current work. * * @method _getPageCount * @param {Object} work The current wor object. * @returns {Number} The page count of the current work. */ function _getPageCount( work ) { if ( _debug ) { console.log( '---------- _getPageCount() ----------' ); console.log( '_getPageCount: work - ', work ); } return work.pages.length; } /** * Method which resets all facetting icons to default * * @method _resetFacettingIcons */ function _resetFacettingIcons() { if ( _debug ) { console.log( '---------- _resetFacettingIcons() ----------' ); } $( '.facetting-trigger' ).addClass( 'active' ); $( '.reset-filter' ).hide(); } /** * Method which removes all set local storage values. * * @method _cleanUpLocalStorage */ function _cleanUpLocalStorage() { if ( _debug ) { console.log( '---------- _cleanUpLocalStorage() ----------' ); } localStorage.removeItem( 'currentNerPageRange' ); localStorage.removeItem( 'currentNerType' ); } /** * API-Calls */ // get all tags from all pages: /rest/ner/tags/{pi}/ function _getAllTags() { return _defaults.baseUrl + _defaults.apiUrl + _defaults.workId; } // get all tags of a range: /viewer/rest/ner/tags/ranges/{range}/{type}/{pi}/ function _getAllTagsOfARange( range, type ) { return _defaults.baseUrl + _defaults.apiUrl + 'ranges/' + range + '/' + type + '/' + _defaults.workId + '/'; } // get all tags sorted of type: /rest/ner/tags/{type}/{pi}/ function _getAllTagsOfAType( type ) { return _defaults.baseUrl + _defaults.apiUrl + type + '/' + _defaults.workId + '/'; } // get all tags sorted of recurrence (asc/desc): // /rest/ner/tags/recurrence/{type}/{order}/{pi}/ function _getAllTagsOfRecurrence( type, order ) { if ( type === '-' ) { return _defaults.baseUrl + _defaults.apiUrl + 'recurrence/-/' + order + '/' + _defaults.workId + '/'; } else { return _defaults.baseUrl + _defaults.apiUrl + 'recurrence/' + type + '/' + order + '/' + _defaults.workId + '/'; } } // get all tags sorted of page section: /rest/ner/tags/{start}/{end}/{pi}/ function _getAllTagsOfPageSection( start, end, type ) { return _defaults.baseUrl + _defaults.apiUrl + start + '/' + end + '/' + type + '/' + _defaults.workId + '/'; } return viewer; } )( viewerJS || {}, jQuery ); Ã— Search results Close "},"viewer_viewerJS.nerFulltext.js.html":{"id":"viewer_viewerJS.nerFulltext.js.html","title":"Source: viewer/viewerJS.nerFulltext.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.nerFulltext.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module to render NER-Popovers in fulltext pages. * * @version 3.2.0 * @module viewerJS.nerFulltext * @requires jQuery * */ var viewerJS = ( function( viewer ) { 'use strict'; // define variables var _debug = false; var _defaults = { path: null, lang: {} }; var _contextPath = null; var _lang = null; viewer.nerFulltext = { /** * Method which initializes the NER Popover methods. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {String} config.path The rootpath of the application. * @example * * &lt;pre&gt; * var nerConfig = { * path: '#{request.contextPath}' * }; * * viewerJS.nerFulltext.init( nerConfig ); * &lt;/pre&gt; */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.nerFulltext.init' ); console.log( '##############################' ); console.log( 'viewer.nerFulltext.init: config - ' ); console.log( config ); } $.extend( true, _defaults, config ); _initNerPopover( _defaults.path ); } }; /** * Method which fetches data from the API and returns an JSON object. * * @method _getRemoteData * @param {String} target The API call URL. * @returns {Object} The JSON object with the API data. * */ function _getRemoteData( target ) { if ( _debug ) { console.log( 'viewer.nerFulltext _getRemoteData: target - ' ); console.log( target ); } // show preloader for current element $( '.ner-detail-loader', target ).css( { display: 'inline-block' } ); // AJAX call var data = $.ajax( { url: decodeURI( $( target ).attr( 'data-remotecontent' ) ), type: 'POST', dataType: 'JSON', async: false, complete: function() { $( '.ner-detail-loader' ).hide(); } } ).responseText; return data; } /** * Method which initializes the events for the NER-Popovers. * * @method _initNerPopover * @param {String} path The root path of the application. * */ function _initNerPopover( path ) { if ( _debug ) { console.log( 'viewer.nerFulltext _initNerPopover: path - ' + path ); } var data, position, title, triggerCoords, textBox, textBoxPosition, textBoxCoords; $( '.ner-trigger' ).on( 'click', function() { $( 'body' ).find( '.ner-popover-pointer' ).hide(); $( 'body' ).find( '.ner-popover' ).remove(); data = _getRemoteData( $( this ) ); position = $( this ).position(); triggerCoords = { top: position.top, left: position.left, width: $( this ).outerWidth() }; textBox = $( '#view_fulltext_wrapp' ); textBoxPosition = textBox.position(); textBoxCoords = { top: textBoxPosition.top, left: 0, right: textBoxPosition.left + textBox.outerWidth() }; title = $( this ).attr( 'title' ); textBox.append( _renderNerPopover( data, _calculateNerPopoverPosition( triggerCoords, textBoxCoords ), title, path ) ); if ( $( '.ner-popover' ) ) { $( this ).find( '.ner-popover-pointer' ).show(); _removeNerPopover(); $( '.ner-detail-trigger' ).on( 'click', function() { data = _getRemoteData( $( this ) ); title = $( this ).attr( 'title' ); $( this ).parent().next( '.ner-popover-detail' ).html( _renderNerPopoverDetail( data, title ) ); } ); } } ); } /** * Method which renders a popover to the DOM. * * @method _renderNerPopover * @param {Object} data The JSON object from the API. * @param {Object} position A jQuery object including the position of the clicked * trigger. * @param {String} title The value of the title attribute from the clicked trigger. * @param {String} path The root path of the application. * @returns {String} The HTML string which renders the popover. * */ function _renderNerPopover( data, position, title, path ) { if ( _debug ) { console.log( 'viewer.nerFulltext _renderNerPopover: data - ' ); console.log( data ); console.log( 'viewer.nerFulltext _renderNerPopover: position - ' ); console.log( position ); console.log( 'viewer.nerFulltext _renderNerPopover: title - ' + title ); console.log( 'viewer.nerFulltext _renderNerPopover: path - ' + path ); } var positionTop = position.top; var positionLeft = position.left; var popover = ''; popover += '&lt;div class=&quot;ner-popover&quot; style=&quot;top:' + positionTop + 'px; left:' + positionLeft + 'px&quot;&gt;'; popover += '&lt;div class=&quot;ner-popover-close&quot; title=&quot;Fenster schlie&amp;szlig;en&quot;&gt;&amp;times;&lt;/div&gt;'; popover += '&lt;div class=&quot;ner-popover-header&quot;&gt;&lt;h4&gt;' + title + '&lt;/h4&gt;&lt;/div&gt;'; popover += '&lt;div class=&quot;ner-popover-body&quot;&gt;'; popover += '&lt;dl class=&quot;dl-horizontal&quot;&gt;'; $.each( $.parseJSON( data ), function( i, object ) { $.each( object, function( property, value ) { popover += '&lt;dt title=&quot;' + property + '&quot;&gt;' + property + ':&lt;/dt&gt;'; var objValue = ''; $.each( value, function( p, v ) { var icon = ''; switch ( property ) { case 'Beruf': icon = 'glyphicon-briefcase'; break; case 'Verwandte Begriffe': icon = 'glyphicon-briefcase'; break; case 'Sohn': icon = 'glyphicon-user'; break; case 'Vater': icon = 'glyphicon-user'; break; case 'Geburtsort': icon = 'glyphicon-map-marker'; break; case 'Sterbeort': icon = 'glyphicon-map-marker'; break; } if ( v.url ) { objValue += '&lt;span '; objValue += 'class=&quot;ner-detail-trigger&quot; '; objValue += 'title=&quot;' + v.text + '&quot; '; objValue += 'tabindex=&quot;-1&quot;'; objValue += 'data-remotecontent=&quot;' + path + '/api?action=normdata&amp;url=' + v.url + '&quot;&gt;'; objValue += '&lt;span class=&quot;glyphicon ' + icon + '&quot;&gt;&lt;/span&gt;&amp;nbsp;'; objValue += v.text; objValue += '&lt;span class=&quot;ner-detail-loader&quot;&gt;&lt;/span&gt;'; objValue += '&lt;/span&gt;'; } else { if ( property === 'URI' ) { objValue += '&lt;a href=&quot;' + v.text + '&quot; target=&quot;_blank&quot;&gt;' + v.text + '&lt;/a&gt;'; } else { objValue += v.text; } } objValue += '&lt;br /&gt;'; } ); popover += '&lt;dd&gt;' + objValue + '&lt;/dd&gt;'; popover += '&lt;div class=&quot;ner-popover-detail&quot;&gt;&lt;/div&gt;'; } ); } ); popover += '&lt;/dl&gt;'; popover += '&lt;/div&gt;'; popover += '&lt;/div&gt;'; return popover; } /** * Method which renders detail information into the popover. * * @method _renderNerPopoverDetail * @param {Object} data The JSON object from the API. * @param {String} title The value of the title attribute from the clicked trigger. * @returns {String} The HTML string which renders the details. * */ function _renderNerPopoverDetail( data, title ) { if ( _debug ) { console.log( 'viewer.nerFulltext _renderNerPopoverDetail: data - ' ); console.log( data ); console.log( 'viewer.nerFulltext _renderNerPopoverDetail: title - ' + title ); } var popoverDetail = ''; popoverDetail += '&lt;div class=&quot;ner-popover-detail&quot;&gt;'; popoverDetail += '&lt;div class=&quot;ner-popover-detail-header&quot;&gt;&lt;h4&gt;' + title + '&lt;/h4&gt;&lt;/div&gt;'; popoverDetail += '&lt;div class=&quot;ner-popover-detail-body&quot;&gt;'; popoverDetail += '&lt;dl class=&quot;dl-horizontal&quot;&gt;'; $.each( $.parseJSON( data ), function( i, object ) { $.each( object, function( property, value ) { popoverDetail += '&lt;dt title=&quot;' + property + '&quot;&gt;' + property + ':&lt;/dt&gt;'; var objValue = ''; $.each( value, function( p, v ) { if ( property === 'URI' ) { objValue += '&lt;a href=&quot;' + v.text + '&quot; target=&quot;_blank&quot;&gt;' + v.text + '&lt;/a&gt;'; } else { objValue += v.text; } objValue += '&lt;br /&gt;'; } ); popoverDetail += '&lt;dd&gt;' + objValue + '&lt;/dd&gt;'; popoverDetail += '&lt;div class=&quot;ner-popover-detail&quot;&gt;&lt;/div&gt;'; } ); } ); popoverDetail += '&lt;/dl&gt;'; popoverDetail += '&lt;/div&gt;'; popoverDetail += '&lt;/div&gt;'; return popoverDetail; } /** * Method which calculates the position of the popover in the DOM. * * @method _calculateNerPopoverPosition * @param {Object} triggerCoords A jQuery object including the position of the clicked * trigger. * @param {Object} textBoxCoords A jQuery object including the position of the parent * DIV. * @returns {Object} An object which includes the position of the popover. * */ function _calculateNerPopoverPosition( triggerCoords, textBoxCoords ) { if ( _debug ) { console.log( 'viewer.nerFulltext _calculateNerPopoverPosition: triggerCoords - ' ); console.log( triggerCoords ); console.log( 'viewer.nerFulltext _calculateNerPopoverPosition: textBoxCoords - ' ); console.log( textBoxCoords ); } var poLeftBorder = triggerCoords.left - ( 150 - ( triggerCoords.width / 2 ) ), poRightBorder = poLeftBorder + 300, tbLeftBorder = textBoxCoords.left, tbRightBorder = textBoxCoords.right, poTop, poLeft = poLeftBorder; poTop = triggerCoords.top + 27; if ( poLeftBorder &lt;= tbLeftBorder ) { poLeft = tbLeftBorder; } if ( poRightBorder &gt;= tbRightBorder ) { poLeft = textBoxCoords.right - 300; } return { top: poTop, left: poLeft }; } /** * Method to remove a popover from the DOM. * * @method _removeNerPopover * */ function _removeNerPopover() { if ( _debug ) { console.log( 'viewer.nerFulltext _removeNerPopover' ); } $( '.ner-popover-close' ).on( 'click', function() { $( 'body' ).find( '.ner-popover-pointer' ).hide(); $( this ).parent().remove(); } ); } return viewer; } )( viewerJS || {}, jQuery ); Ã— Search results Close "},"viewer_viewerJS.normdata.js.html":{"id":"viewer_viewerJS.normdata.js.html","title":"Source: viewer/viewerJS.normdata.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.normdata.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module to render popovers including normdata. * * @version 3.2.0 * @module viewerJS.normdata * @requires jQuery * @requires Bootstrap * */ var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _data = null; var _dataURL = ''; var _data = ''; var _linkPos = null; var _popover = ''; var _id = ''; var _$this = null; var _normdataIcon = null; var _preloader = null; var _defaults = { id: 0, path: null, lang: {}, elemWrapper: null }; viewer.normdata = { /** * Method to initialize the timematrix slider and the events which builds the * matrix and popovers. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {String} config.id The starting ID of the popover. * @param {String} config.path The rootpath of the application. * @param {Object} config.lang An object of localized strings. * @param {Object} config.elemWrapper An jQuery object of the wrapper DIV. * @example * * &lt;pre&gt; * var normdataConfig = { * path: '#{request.contextPath}', * lang: { * popoverTitle: '#{msg.normdataPopverTitle}', * popoverClose: '#{msg.normdataPopoverClose}' * }, * elemWrapper: $( '#metadataElementWrapper' ) * }; * * viewerJS.normdata.init( normdataConfig ); * &lt;/pre&gt; */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.normdata.init' ); console.log( '##############################' ); console.log( 'viewer.normdata.init: config = ', config ); } $.extend( true, _defaults, config ); // hide close icons $( '.closeAllPopovers' ).hide(); // first level click // console.log(&quot;Init Click on normdata&quot;); // console.log(&quot;normdatalink = &quot;, $( '.normdataLink') ) $( '.normdataLink' ).on( 'click', function() { console.log( &quot;Click on normdata&quot; ); _$this = $( this ); _$this.off( 'focus' ); _renderPopoverAction( _$this, _defaults.id ); } ); }, }; /** * Method which executes the click event action of the popover. * * @method _renderPopoverAction * @param {Object} $Obj The jQuery object of the current clicked link. * @param {String} id The current id of the popover. */ function _renderPopoverAction( $Obj, id ) { if ( _debug ) { console.log( '---------- _renderPopoverAction() ----------' ); console.log( '_renderPopoverAction: $Obj = ', $Obj ); console.log( '_renderPopoverAction: id = ', id ); } _normdataIcon = $Obj.find( '.fa-list-ul' ); _preloader = $Obj.find( '.normdata-preloader' ); // set variables _dataURL = $Obj.attr( 'data-remotecontent' ); _data = _getRemoteData( _dataURL, _preloader, _normdataIcon ); _linkPos = $Obj.offset(); _popover = _buildPopover( _data, id ); if ( _debug ) { console.log( '_renderPopoverAction: _dataURL = ', _dataURL ); console.log( '_renderPopoverAction: _data = ', _data ); console.log( '_renderPopoverAction: _linkPos = ', _linkPos ); } // append popover to body $( 'body' ).append( _popover ); // set popover position _calculatePopoverPosition( id, _linkPos, $Obj ); // show popover $( document ).find( '#normdataPopover-' + id ).hide().fadeIn( 'fast', function() { // disable source button $Obj.attr( 'disabled', 'disabled' ).addClass( 'disabled' ); // hide tooltip $Obj.tooltip( 'hide' ); // set event for nth level popovers $( '.normdataDetailLink' ).off( 'click' ).on( 'click', function() { _$this = $( this ); _renderPopoverAction( _$this, _defaults.id ); } ); } ).draggable(); // init close method _closeNormdataPopover( $Obj ); // increment id _defaults.id++; // init close all method _closeAllNormdataPopovers( $Obj ); } /** * Returns an HTML-String which renders the fetched data into a popover. * * @method _buildPopover * @param {Object} data The JSON-Object which includes the data. * @param {String} id The incremented id of the popover. * @returns {String} The HTML-String with the fetched data. */ function _buildPopover( data, id ) { if ( _debug ) { console.log( '---------- _buildPopover() ----------' ); console.log( '_buildPopover: data = ', data ); console.log( '_buildPopover: id = ', id ); } var html = ''; html += '&lt;div id=&quot;normdataPopover-' + id + '&quot; class=&quot;normdata-popover&quot;&gt;'; html += '&lt;div class=&quot;normdata-popover-title&quot;&gt;'; html += '&lt;h4&gt;' + _defaults.lang.popoverTitle + '&lt;/h4&gt;'; html += '&lt;span class=&quot;normdata-popover-close glyphicon glyphicon-remove&quot; title=&quot;' + _defaults.lang.popoverClose + '&quot;&gt;&lt;/span&gt;'; html += '&lt;/div&gt;'; html += '&lt;div class=&quot;normdata-popover-content&quot;&gt;'; html += '&lt;dl class=&quot;dl-horizontal&quot;&gt;'; $.each( data, function( i, object ) { $.each( object, function( property, value ) { html += '&lt;dt title=&quot;' + property + '&quot;&gt;' + property + '&lt;/dt&gt;'; html += '&lt;dd&gt;'; $.each( value, function( p, v ) { if ( v.text ) { if ( property === &quot;URI&quot; ) { html += '&lt;a href=&quot;' + v.text + '&quot; target=&quot;_blank&quot;&gt;'; html += v.text; html += '&lt;/a&gt;'; } else { html += v.text; } } if ( v.identifier ) { html += '&lt;a href=&quot;' + _defaults.path + '/search/-/' + v.identifier + '/1/&quot;&gt;'; html += '&lt;span class=&quot;glyphicon glyphicon-search&quot;&gt;&lt;/span&gt;'; html += '&lt;/a&gt;'; } if ( v.url ) { html += '&lt;button type=&quot;button&quot; class=&quot;normdataDetailLink&quot; data-remotecontent=&quot;'; html += _defaults.path; html += '/api?action=normdata&amp;amp;url='; html += v.url; html += '&quot; title=&quot;' + _defaults.lang.showNormdata + '&quot;&gt;'; html += '&lt;i class=&quot;fa fa-list-ul&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;'; html += '&lt;div class=&quot;normdata-preloader&quot;&gt;&lt;/div&gt;'; html += '&lt;/button&gt;'; } html += '&lt;br /&gt;'; } ); html += '&lt;/dd&gt;' } ); } ); html += &quot;&lt;/dl&gt;&quot;; html += &quot;&lt;/div&gt;&quot;; html += &quot;&lt;/div&gt;&quot;; return html; } /** * Sets the position to the first level popovers. * * @method _calculateFirstLevelPopoverPosition * @param {String} id The incremented id of the popover. * @param {Object} pos An Object with the current position oft the clicked link. * @param {Object} $Obj An jQuery-Object of the clicked link. * */ function _calculatePopoverPosition( id, pos, $Obj ) { if ( _debug ) { console.log( '---------- _calculatePopoverPosition() ----------' ); console.log( '_calculatePopoverPosition: id = ', id ); console.log( '_calculatePopoverPosition: pos = ', pos ); console.log( '_calculatePopoverPosition: $Obj = ', $Obj ); } var _bodyWidth = $( 'body' ).outerWidth(); var _popoverWidth = $( '#normdataPopover-' + id ).outerWidth(); var _popoverRight = pos.left + _popoverWidth; if ( _debug ) { console.log( '_calculatePopoverPosition: _bodyWidth = ', _bodyWidth ); console.log( '_calculatePopoverPosition: _popoverWidth = ', _popoverWidth ); console.log( '_calculatePopoverPosition: _popoverLeft = ', pos.left ); console.log( '_calculatePopoverPosition: _popoverRight = ', _popoverRight ); } if ( _popoverRight &gt; _bodyWidth ) { var _diff = _popoverRight - _bodyWidth; if ( _debug ) { console.log( '_calculatePopoverPosition: _diff = ', _diff ); } $( document ).find( '#normdataPopover-' + id ).css( { top: pos.top + $Obj.outerHeight() + 5, left: pos.left - _diff } ); } else { $( document ).find( '#normdataPopover-' + id ).css( { top: pos.top + $Obj.outerHeight() + 5, left: pos.left } ); } } /** * Removes current popover from the DOM on click. * * @method _closeNormdataPopover * */ function _closeNormdataPopover( $Obj ) { if ( _debug ) { console.log( '---------- _closeNormdataPopover() ----------' ); console.log( '_closeNormdataPopover: $Obj = ', $Obj ); } $( document ).find( '.normdata-popover-close' ).on( 'click', function() { $( this ).parent().parent().remove(); $Obj.removeAttr( 'disabled' ).removeClass( 'disabled' ); if ( $( '.normdata-popover' ).length &lt; 1 ) { $( '.closeAllPopovers' ).hide(); } } ); } /** * Removes all popovers from the DOM on click. * * @method _closeAllNormdataPopovers * */ function _closeAllNormdataPopovers( $Obj ) { if ( _debug ) { console.log( '---------- _closeAllNormdataPopovers() ----------' ); console.log( '_closeAllNormdataPopovers: $Obj = ', $Obj ); } var _close = $Obj.parent().find( 'i.closeAllPopovers' ); if ( $( '.normdata-popover' ).length &gt; 0 ) { _close.show(); _close.on( 'click', function() { // close all popovers $( '.normdata-popover' ).each( function() { $( this ).remove(); } ); // hide all close icons $( '.closeAllPopovers' ).each( function() { $( this ).hide(); } ); // set trigger to enable $( '.normdataLink' ).removeAttr( 'disabled' ).removeClass( 'disabled' ); } ); } else { _close.hide(); } } /** * Returns an JSON object from a API call. * * @method _getRemoteData * @returns {Object} The JSON object with the API data. */ function _getRemoteData( url, loader, icon ) { if ( _debug ) { console.log( '---------- _getRemoteData() ----------' ); console.log( '_getRemoteData: url = ', url ); console.log( '_getRemoteData: loader = ', loader ); console.log( '_getRemoteData: icon = ', icon ); } loader.show(); icon.hide(); var data = $.ajax( { url: decodeURI( url ), type: &quot;POST&quot;, dataType: &quot;JSON&quot;, async: false, success: function() { loader.hide(); icon.show(); } } ).responseText; return jQuery.parseJSON( data ); } return viewer; } )( viewerJS || {}, jQuery ); Ã— Search results Close "},"viewer_viewerJS.pageScroll.js.html":{"id":"viewer_viewerJS.pageScroll.js.html","title":"Source: viewer/viewerJS.pageScroll.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.pageScroll.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module to scroll a page back to top animated. * * @version 3.2.0 * @module viewerJS.pageScroll * @requires jQuery */ var viewerJS = ( function( viewer ) { 'use strict'; var _elem = null; var _text = null; viewer.pageScroll = { /** * Initializes the animated pagescroll. * * @method init * @param {String} obj The selector of the jQuery object. * @param {String} anchor The name of the anchor to scroll to. */ init: function( obj, anchor ) { _elem = $( obj ); _text = anchor; // eventlistener $( window ).on( 'scroll', function() { if ( window.pageYOffset &gt; 200 ) { _elem.fadeIn(); } else { _elem.hide(); } } ); _elem.on( 'click', function() { _scrollPage( _text ); } ); } }; /** * Method which scrolls the page animated. * * @method _scrollPage * @param {String} anchor The name of the anchor to scroll to. */ function _scrollPage( anchor ) { $( 'html,body' ).animate( { scrollTop: $( anchor ).offset().top }, 1000 ); return false; } return viewer; } )( viewerJS || {}, jQuery ); Ã— Search results Close "},"viewer_viewerJS.responsiveColumnGallery.js.html":{"id":"viewer_viewerJS.responsiveColumnGallery.js.html","title":"Source: viewer/viewerJS.responsiveColumnGallery.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.responsiveColumnGallery.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which generates a responsive image gallery in columns. * * @version 3.2.0 * @module viewerJS.responsiveColumnGallery * @requires jQuery * */ var viewerJS = ( function( viewer ) { 'use strict'; // default variables var _debug = false; var _defaults = { themePath: '', imagePath: '', imageDataFile: '', galleryObject: null, maxColumnCount: null, maxImagesPerColumn: null, fixedHeight: false, maxHeight: '', caption: true, overlayColor: '', lang: {}, lightbox: { active: true, caption: true }, }; var _promise = null; var _imageData = null; var _parentImage = null; var _lightboxImage = null; var _imageLightbox = null; var _smallViewport = null; var _dataUrl = null; viewer.responsiveColumnGallery = { /** * Method which initializes the column gallery. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {String} config.themePath The path to the current activated viewer * theme. * @param {String} config.imagePath The path to the used images. * @param {String} config.imageDataFile The path to the JSON-File, which contains * the images data. * @param {Object} config.galleryObject The DIV where the gallery should be * rendered. * @param {Number} config.maxColumnCount Count count of the gallery, 4 column are * maximum. * @param {Number} config.maxImagesPerColumn Count of the images per column. * @param {Boolean} config.fixedHeight If true the images have a fixed height, * default is false. * @param {String} config.maxHeight Sets the given max height value for the * images. * @param {Boolean} config.caption If true the gallery images have a caption with * the title text, default is true. * @param {String} config.overlayColor Takes a HEX-value to set the color of the * image overlay. * @param {Object} config.lang An object of strings for multilanguage * functionality. * @param {Object} config.lightbox An Object to configure the image lightbox. * @param {Boolean} config.lightbox.active If true the lightbox functionality is * enabled, default is true. * @param {Boolean} config.lightbox.caption If true the lightbox has a caption * text, default is true. */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.responsiveColumnGallery.init' ); console.log( '##############################' ); console.log( 'viewer.responsiveColumnGallery.init: config = ', config ); } $.extend( true, _defaults, config ); // fetch image data and check the viewport _dataUrl = _defaults.themePath + _defaults.imageDataFile; _promise = viewer.helper.getRemoteData( _dataUrl ); _promise.then( function( imageData ) { _imageData = imageData; _smallViewport = viewer.responsiveColumnGallery.checkForSmallViewport(); // render columns if ( _defaults.maxColumnCount &gt; 4 ) { _defaults.galleryObject.append( viewer.helper.renderAlert( 'alert-danger', 'Die maximale Spaltenanzahl fÃ¼r die Galerie betrÃ¤gt 4!', true ) ); return false; } else { for ( var i = 0; i &lt; _defaults.maxColumnCount; i++ ) { _defaults.galleryObject.append( viewer.responsiveColumnGallery.renderColumns( _defaults.maxColumnCount ) ); } } // render images while ( _imageData.length ) { $.each( $( '.rcg-col' ), function() { $( this ).append( viewer.responsiveColumnGallery.renderImages( _imageData.splice( 0, _defaults.maxImagesPerColumn ) ) ); } ); } // set fixed height if activated and viewport is &gt; 375px if ( _defaults.fixedHeight &amp;&amp; !_smallViewport ) { $.each( $( '.rcg-image-body' ), function() { viewer.responsiveColumnGallery.fixedHeight( $( this ) ); } ); } // prepare lightbox if ( _defaults.lightbox.active ) { $( '.lightbox-toggle' ).on( 'click', function( event ) { event.preventDefault(); _parentImage = $( this ).parent().children( 'img' ); _lightboxImage = viewer.responsiveColumnGallery.prepareLightbox( _parentImage ); _imageLightbox = viewer.responsiveColumnGallery.renderLightbox( _lightboxImage ); $( 'body' ).append( _imageLightbox ); $( '.rcg-lightbox-body' ).hide(); $( '.rcg-lightbox-overlay' ).fadeIn( 'slow' ); // first load image, then center it and show it up $( '.rcg-lightbox-image img' ).load( function() { viewer.responsiveColumnGallery.centerLightbox( $( '.rcg-lightbox-body' ) ); $( '.rcg-lightbox-body' ).show(); } ); // close lightbox via button $( '.rcg-lightbox-close' ).on( 'click', function() { $( '.rcg-lightbox-overlay' ).remove(); } ); // close lightbox via esc $( document ).keypress( function( event ) { if ( event.keyCode === 27 ) { $( '.rcg-lightbox-overlay' ).remove(); } } ); // close lightbox via click on picture $( '.rcg-lightbox-image img' ).on( 'click', function() { $( '.rcg-lightbox-overlay' ).remove(); } ); } ); } } ).then( null, function( error ) { _defaults.galleryObject.append( viewer.helper.renderAlert( 'alert-danger', '&lt;strong&gt;Status: &lt;/strong&gt;' + error.status + ' ' + error.statusText, false ) ); console.error( 'ERROR: viewer.responsiveColumnGallery.init - ', error ); } ); }, /** * Method which renders the gallery columns. * * @method renderColumns * @param {String} count The column count of the gallery. * @returns {String} A HTML-String which renders a column. */ renderColumns: function( count ) { if ( _debug ) { console.log( '---------- viewer.responsiveColumnGallery.renderColumns() ----------' ); console.log( 'viewer.responsiveColumnGallery.renderColumns: count = ', count ); } var column = ''; column += '&lt;div class=&quot;rcg-col col-' + count + '&quot;&gt;&lt;/div&gt;'; return column; }, /** * Method which renders the gallery images. * * @method renderImages * @param {Object} data An object of image data to render the images. * @returns {String} A HTML-String which renders the gallery images. */ renderImages: function( data ) { if ( _debug ) { console.log( '---------- viewer.responsiveColumnGallery.renderImages() ----------' ); console.log( 'viewer.responsiveColumnGallery.renderImages: data = ', data ); } var image = ''; $.each( data, function( i, j ) { $.each( j, function( m, n ) { image += '&lt;div class=&quot;rcg-image-container&quot;&gt;'; image += '&lt;div class=&quot;rcg-image-body&quot;&gt;'; image += '&lt;a href=&quot;' + n.url + '&quot;&gt;'; image += '&lt;div class=&quot;rcg-image-overlay&quot; style=&quot;background-color:' + _defaults.overlayColor + '&quot;&gt;&lt;/div&gt;'; image += '&lt;/a&gt;'; image += '&lt;div class=&quot;rcg-image-title&quot;&gt;'; image += '&lt;h4&gt;' + n.title + '&lt;/h4&gt;'; image += '&lt;/div&gt;'; image += '&lt;img src=&quot;' + _defaults.themePath + _defaults.imagePath + n.name + '&quot; alt=&quot;' + n.alt + '&quot; /&gt;'; if ( _defaults.lightbox.active ) { image += '&lt;div class=&quot;lightbox-toggle&quot; title=&quot;' + _defaults.lang.showLightbox + '&quot;&gt;'; image += '&lt;span class=&quot;glyphicon glyphicon-fullscreen&quot;&gt;&lt;/span&gt;'; image += '&lt;/div&gt;'; } image += '&lt;/div&gt;'; if ( _defaults.caption ) { image += '&lt;div class=&quot;rcg-image-footer&quot;&gt;'; image += '&lt;p&gt;' + n.caption + '&lt;a href=&quot;' + n.url + '&quot; title=&quot;' + n.title + '&quot;&gt;'; image += _defaults.lang.goToWork + ' &lt;span class=&quot;glyphicon glyphicon glyphicon-picture&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;'; image += '&lt;/div&gt;'; } image += '&lt;/div&gt;'; } ); } ); return image; }, /** * Method which sets a fixed height to the gallery images. * * @method fixedHeight * @param {Object} $obj An jQuery object of the element which height should be * fixed. */ fixedHeight: function( $obj ) { if ( _debug ) { console.log( '---------- viewer.responsiveColumnGallery.fixedHeight() ----------' ); console.log( 'viewer.responsiveColumnGallery.fixedHeight: $obj = ', $obj ); } $obj.children( 'img' ).css( { 'height': _defaults.maxHeight } ); }, /** * Method which checks the viewport width and returns true if itÂ´s smaller then * 375px. * * @method checkForSmallViewport * @returns {Boolean} Returns true if itÂ´s smaller then 375px. */ checkForSmallViewport: function() { if ( _debug ) { console.log( '---------- viewer.responsiveColumnGallery.checkForSmallViewport() ----------' ); } var windowWidth = $( window ).outerWidth(); if ( windowWidth &lt;= 375 ) { return true; } else { return false; } }, /** * Method which prepares the lightbox object with the required data. * * @method prepareLightbox * @param {Object} $obj An jQuery object which includes the required data * attributes. * @returns {Object} An Object which includes the required data. */ prepareLightbox: function( $obj ) { if ( _debug ) { console.log( '---------- viewer.responsiveColumnGallery.prepareLightbox() ----------' ); console.log( 'viewer.responsiveColumnGallery.prepareLightbox: $obj = ', $obj ); } var lightboxData = {}; lightboxData.src = $obj.attr( 'src' ); lightboxData.caption = $obj.attr( 'alt' ); return lightboxData; }, /** * Method which renders a lightbox for the selected image. * * @method renderLightbox * @param {Object} data An object which includes the required data. * @returns {String} A HTML-String which renders the lightbox. */ renderLightbox: function( data ) { if ( _debug ) { console.log( '---------- viewer.responsiveColumnGallery.renderLightbox() ----------' ); console.log( 'viewer.responsiveColumnGallery.renderLightbox: data = ', data ); } var lightbox = ''; lightbox += '&lt;div class=&quot;rcg-lightbox-overlay&quot;&gt;'; lightbox += '&lt;div class=&quot;rcg-lightbox-body&quot;&gt;'; lightbox += '&lt;div class=&quot;rcg-lightbox-close&quot; title=&quot;' + _defaults.lang.close + '&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-remove&quot;&gt;&lt;/span&gt;&lt;/div&gt;'; lightbox += '&lt;div class=&quot;rcg-lightbox-image&quot;&gt;'; lightbox += '&lt;img src=&quot;' + data.src + '&quot; alt=&quot;' + data.alt + '&quot; /&gt;'; lightbox += '&lt;/div&gt;'; // .rcg-lightbox-image if ( _defaults.lightbox.caption ) { lightbox += '&lt;div class=&quot;rcg-lightbox-caption&quot;&gt;'; lightbox += '&lt;p&gt;' + data.caption + '&lt;/p&gt;'; lightbox += '&lt;/div&gt;'; // .rcg-lightbox-caption } lightbox += '&lt;/div&gt;'; // .rcg-lightbox-body lightbox += '&lt;/div&gt;'; // .rcg-lightbox-overlay return lightbox; }, /** * Method which centers the given object to the viewport. * * @method centerLightbox * @param {Object} $obj An jQuery object of the element to center. */ centerLightbox: function( $obj ) { if ( _debug ) { console.log( '---------- viewer.responsiveColumnGallery.centerLightbox() ----------' ); console.log( 'viewer.responsiveColumnGallery.centerLightbox: $obj = ', $obj ); } var boxWidth = $obj.outerWidth(); var boxHeight = $obj.outerHeight(); $obj.css( { 'margin-top': '-' + boxHeight / 2 + 'px', 'margin-left': '-' + boxWidth / 2 + 'px' } ); }, }; return viewer; } )( viewerJS || {}, jQuery ); Ã— Search results Close "},"viewer_viewerJS.searchAdvanced.js.html":{"id":"viewer_viewerJS.searchAdvanced.js.html","title":"Source: viewer/viewerJS.searchAdvanced.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.searchAdvanced.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which sets up the functionality for search advanced. * * @version 3.2.0 * @module viewerJS.searchAdvanced * @requires jQuery */ var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _advSearchValues = {}; var _defaults = { loaderSelector: '.search-advanced__loader', inputSelector: '.value-text', resetSelector: '.reset', }; viewer.searchAdvanced = { /** * Method to initialize the search advanced features. * * @method init * @param {Object} config An config object which overwrites the defaults. */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.searchAdvanced.init' ); console.log( '##############################' ); console.log( 'viewer.searchAdvanced.init: config = ', config ); } $.extend( true, _defaults, config ); // init bs tooltips $( '[data-toggle=&quot;tooltip&quot;]' ).tooltip(); if ( viewer.localStoragePossible ) { localStorage.setItem( 'advSearchValues', JSON.stringify( _advSearchValues ) ); // set search values _setAdvSearchValues(); _resetValue(); // ajax eventlistener jsf.ajax.addOnEvent( function( data ) { var ajaxstatus = data.status; switch ( ajaxstatus ) { case &quot;begin&quot;: // show loader $( _defaults.loaderSelector ).show(); break; case &quot;success&quot;: // init bs tooltips $( '[data-toggle=&quot;tooltip&quot;]' ).tooltip(); // set search values _setAdvSearchValues(); _getAdvSearchValues(); _resetValue(); // set disabled state to select wrapper $( 'select' ).each( function() { if ( $( this ).attr( 'disabled' ) === 'disabled' ) { $( this ).parent().addClass( 'disabled' ); } else { $( this ).parent().removeClass( 'disabled' ); } } ); // hide loader $( _defaults.loaderSelector ).hide(); break; } } ); } else { return false; } }, }; function _setAdvSearchValues() { if ( _debug ) { console.log( '---------- _setAdvSearchValues() ----------' ); } $( _defaults.inputSelector ).off().on( 'keyup', function() { var currId = $( this ).attr( 'id' ); var currVal = $( this ).val(); var currValues = JSON.parse( localStorage.getItem( 'advSearchValues' ) ); // check if values are in local storage if ( !currValues.hasOwnProperty( currVal ) ) { currValues[ currId ] = currVal; } else { return false; } // write values to local storage localStorage.setItem( 'advSearchValues', JSON.stringify( currValues ) ); } ); } function _getAdvSearchValues() { if ( _debug ) { console.log( '---------- _getAdvSearchValues() ----------' ); } var values = JSON.parse( localStorage.getItem( 'advSearchValues' ) ); $.each( values, function( id, value ) { $( '#' + id ).val( value ); } ); } function _resetValue() { if ( _debug ) { console.log( '---------- _resetValue() ----------' ); } $( _defaults.resetSelector ).off().on( 'click', function() { var inputId = $( this ).parents( '.input-group' ).find( 'input' ).attr( 'id' ); var currValues = JSON.parse( localStorage.getItem( 'advSearchValues' ) ); // delete value from local storage object if ( currValues.hasOwnProperty( inputId ) ) { delete currValues[ inputId ]; } // write new values to local storage localStorage.setItem( 'advSearchValues', JSON.stringify( currValues ) ); $( this ).parents( '.input-group' ).find( 'input' ).val( '' ); } ); } return viewer; } )( viewerJS || {}, jQuery ); Ã— Search results Close "},"viewer_viewerJS.searchList.js.html":{"id":"viewer_viewerJS.searchList.js.html","title":"Source: viewer/viewerJS.searchList.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.searchList.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which sets up the functionality for search list. * * @version 3.2.0 * @module viewerJS.searchList * @requires jQuery */ var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _promise = null; var _childHits = null; var _defaults = { contextPath: '', restApiPath: '/rest/search/hit/', hitsPerCall: 20, resetSearchSelector: '#resetCurrentSearch', searchInputSelector: '#currentSearchInput', searchTriggerSelector: '#slCurrentSearchTrigger', saveSearchModalSelector: '#saveSearchModal', saveSearchInputSelector: '#saveSearchInput', excelExportSelector: '.excel-export-trigger', excelExportLoaderSelector: '.excel-export-loader', hitContentLoaderSelector: '.search-list__loader', hitContentSelector: '.search-list__hit-content', msg: { getMoreChildren: 'Mehr Treffer laden', } }; viewer.searchList = { /** * Method to initialize the search list features. * * @method init * @param {Object} config An config object which overwrites the defaults. */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.searchList.init' ); console.log( '##############################' ); console.log( 'viewer.searchList.init: config = ', config ); } $.extend( true, _defaults, config ); // init bs tooltips $( '[data-toggle=&quot;tooltip&quot;]' ).tooltip(); // focus save search modal input on show $( _defaults.saveSearchModalSelector ).on( 'shown.bs.modal', function() { $( _defaults.saveSearchInputSelector ).focus(); } ); // reset current search and redirect to standard search $( _defaults.resetSearchSelector ).on( 'click', function() { $( _defaults.searchInputSelector ).val( '' ); location.href = _defaults.contextPath + '/search/'; } ); // show/hide loader for excel export $( _defaults.excelExportSelector ).on( 'click', function() { var trigger = $( this ); var excelLoader = $( _defaults.excelExportLoaderSelector ); trigger.hide(); excelLoader.show(); var url = _defaults.contextPath + '/rest/download/search/waitFor/'; var promise = Q( $.ajax( { url: decodeURI( url ), type: &quot;GET&quot;, dataType: &quot;text&quot;, async: true } ) ); promise.then( function( data ) { if ( _debug ) { console.log(&quot;Download started&quot;); } excelLoader.hide(); trigger.show(); } ).catch( function( error ) { if ( _debug ) { console.log(&quot;Error downloading excel sheet: &quot;, error.responseText); } excelLoader.hide(); trigger.show(); }); } ); // get child hits $( '[data-toggle=&quot;hit-content&quot;]' ).each( function() { var currBtn = $( this ); var currIdDoc = $( this ).attr( 'data-iddoc' ); var currUrl = _getApiUrl( currIdDoc, _defaults.hitsPerCall ); if ( _debug ) { console.log( 'Current API Call URL: ', currUrl ); } _promise = viewer.helper.getRemoteData( currUrl ); currBtn.find( _defaults.hitContentLoaderSelector ).css( 'display', 'inline-block' ); // get data and render hits if data is valid _promise.then( function( data ) { if ( data.hitsDisplayed &lt; _defaults.hitsPerCall ) { // render child hits into the DOM _renderChildHits( data, currBtn ); // set current button active, remove loader and show content currBtn.toggleClass( 'in' ).find( _defaults.hitContentLoaderSelector ).hide(); currBtn.next().show(); // set event to toggle current hits currBtn.off().on( 'click', function() { $( this ).toggleClass( 'in' ).next().slideToggle(); } ); } else { // remove loader currBtn.find( _defaults.hitContentLoaderSelector ).hide(); // set event to toggle current hits currBtn.off().on( 'click', function() { // render child hits into the DOM _renderChildHits( data, currBtn ); // check if more children exist and render link _renderGetMoreChildren( data, currIdDoc, currBtn ); $( this ).toggleClass( 'in' ).next().slideToggle(); } ); } } ).then( null, function() { currBtn.next().append( viewer.helper.renderAlert( 'alert-danger', '&lt;strong&gt;Status: &lt;/strong&gt;' + error.status + ' ' + error.statusText, false ) ); console.error( 'ERROR: viewer.searchList.init - ', error ); } ); } ); }, }; /** * Method to get the full REST-API URL. * * @method _getApiUrl * @param {String} id The current IDDoc of the hit set. * @returns {String} The full REST-API URL. */ function _getApiUrl( id, hits ) { if ( _debug ) { console.log( '---------- _getApiUrl() ----------' ); console.log( '_getApiUrl: id = ', id ); } return _defaults.contextPath + _defaults.restApiPath + id + '/' + hits + '/'; } /** * Method which renders the child hits into the DOM. * * @method _renderChildHits * @param {Object} data The data object which contains the child hits. * @param {Object} $this The current child hits trigger. * @returns {Object} An jquery object which contains the child hits. */ function _renderChildHits( data, $this ) { if ( _debug ) { console.log( '---------- _renderChildHits() ----------' ); console.log( '_renderChildHits: data = ', data ); console.log( '_renderChildHits: $this = ', $this ); } var hitSet = null; // clean hit sets $this.next().empty(); // build hits $.each( data.children, function( children, child ) { hitSet = $( '&lt;div class=&quot;search-list__hit-content-set&quot; /&gt;' ); // build title hitSet.append( _renderHitSetTitle( child.browseElement ) ); // append metadata if exist hitSet.append( _renderMetdataInfo( child.foundMetadata, child.url ) ); // build child hits if ( child.hasChildren ) { $.each( child.children, function( subChildren, subChild ) { hitSet.append( _renderSubChildHits( subChild.browseElement, subChild.type ) ); } ); } // append complete set $this.next().append( hitSet ); } ); } /** * Method which renders the hit set title. * * @method _renderHitSetTitle * @param {Object} data The data object which contains the hit set title values. * @returns {Object} A jquery object which contains the hit set title. */ function _renderHitSetTitle( data ) { if ( _debug ) { console.log( '---------- _renderHitSetTitle() ----------' ); console.log( '_renderHitSetTitle: data = ', data ); } var hitSetTitle = null; var hitSetTitleH5 = null; var hitSetTitleDl = null; var hitSetTitleDt = null; var hitSetTitleDd = null; var hitSetTitleLink = null; hitSetTitle = $( '&lt;div class=&quot;search-list__struct-title&quot; /&gt;' ); hitSetTitleH5 = $( '&lt;h5 /&gt;' ); hitSetTitleLink = $( '&lt;a /&gt;' ); hitSetTitleLink.attr( 'href', _defaults.contextPath + '/' + data.url ); hitSetTitleLink.append( data.labelShort ); hitSetTitleH5.append( hitSetTitleLink ); hitSetTitle.append( hitSetTitleH5 ); return hitSetTitle; } /** * Method which renders metadata info. * * @method _renderMetdataInfo * @param {Object} data The data object which contains the sub hit values. * @param {String} url The URL for the current work. * @returns {Object} A jquery object which contains the metadata info. */ function _renderMetdataInfo( data, url ) { if ( _debug ) { console.log( '---------- _renderMetdataInfo() ----------' ); console.log( '_renderMetdataInfo: data = ', data ); console.log( '_renderMetdataInfo: url = ', url ); } var metadataWrapper = null; var metadataTable = null; var metadataTableBody = null; var metadataTableRow = null; var metadataTableCellLeft = null; var metadataTableCellRight = null; var metadataKeyIcon = null; var metadataKeyLink = null; var metadataValueLink = null; if ( !$.isEmptyObject( data ) ) { metadataWrapper = $( '&lt;div class=&quot;search-list__metadata-info&quot; /&gt;' ); metadataTable = $( '&lt;table /&gt;' ); metadataTableBody = $( '&lt;tbody /&gt;' ); data.forEach( function( metadata ) { // left cell metadataTableCellLeft = $( '&lt;td /&gt;' ); metadataKeyIcon = $( '&lt;i /&gt;' ).attr( 'aria-hidden', 'true' ).addClass( 'fa fa-bookmark-o' ); metadataKeyLink = $( '&lt;a /&gt;' ).attr( 'href', _defaults.contextPath + '/' + url ).html( metadata.one + ':' ); metadataTableCellLeft.append( metadataKeyIcon ).append( metadataKeyLink ); // right cell metadataTableCellRight = $( '&lt;td /&gt;' ); metadataValueLink = $( '&lt;a /&gt;' ).attr( 'href', _defaults.contextPath + '/' + url ).html( metadata.two ); metadataTableCellRight.append( metadataValueLink ); // row metadataTableRow = $( '&lt;tr /&gt;' ); metadataTableRow.append( metadataTableCellLeft ).append( metadataTableCellRight ); // body metadataTableBody.append( metadataTableRow ); } ); metadataTable.append( metadataTableBody ); metadataWrapper.append( metadataTable ); return metadataWrapper; } } /** * Method which renders sub child hits. * * @method _renderSubChildHits * @param {Object} data The data object which contains the sub hit values. * @param {String} type The type of hit to render. * @returns {Object} A jquery object which contains the sub child hits. */ function _renderSubChildHits( data, type ) { if ( _debug ) { console.log( '---------- _renderSubChildHits() ----------' ); console.log( '_renderSubChildHits: data = ', data ); console.log( '_renderSubChildHits: type = ', type ); } var hitSetChildren = null; var hitSetChildrenDl = null; var hitSetChildrenDt = null; var hitSetChildrenDd = null; var hitSetChildrenLink = null; hitSetChildren = $( '&lt;div class=&quot;search-list__struct-child-hits&quot; /&gt;' ); hitSetChildrenDl = $( '&lt;dl class=&quot;dl-horizontal&quot; /&gt;' ); hitSetChildrenDt = $( '&lt;dt /&gt;' ); // check hit type switch ( type ) { case 'PAGE': hitSetChildrenDt.append( '&lt;i class=&quot;fa fa-file-text&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;' ); break; case 'PERSON': hitSetChildrenDt.append( '&lt;i class=&quot;fa fa-user&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;' ); break; case 'CORPORATION': hitSetChildrenDt.append( '&lt;i class=&quot;fa fa-university&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;' ); break; case 'LOCATION': hitSetChildrenDt.append( '&lt;i class=&quot;fa fa-location-arrow&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;' ); break; case 'SUBJECT': hitSetChildrenDt.append( '&lt;i class=&quot;fa fa-question-circle-o&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;' ); break; case 'PUBLISHER': hitSetChildrenDt.append( '&lt;i class=&quot;fa fa-copyright&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;' ); break; case 'EVENT': hitSetChildrenDt.append( '&lt;i class=&quot;fa fa-calendar&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;' ); break; case 'ACCESSDENIED': hitSetChildrenDt.append( '&lt;i class=&quot;fa fa-lock&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;' ); break; } hitSetChildrenDd = $( '&lt;dd /&gt;' ); hitSetChildrenLink = $( '&lt;a /&gt;' ).attr( 'href', _defaults.contextPath + '/' + data.url ); switch ( type ) { case 'PAGE': case 'ACCESSDENIED': hitSetChildrenLink.append( data.fulltextForHtml ); break; default: hitSetChildrenLink.append( data.labelShort ); break; } hitSetChildrenDd.append( hitSetChildrenLink ); hitSetChildrenDl.append( hitSetChildrenDt ).append( hitSetChildrenDd ); hitSetChildren.append( hitSetChildrenDl ); return hitSetChildren; } /** * Method to render a get more children link. * * @method _renderGetMoreChildren */ function _renderGetMoreChildren( data, iddoc, $this ) { if ( _debug ) { console.log( '---------- _renderGetMoreChildren() ----------' ); console.log( '_renderGetMoreChildren: data = ', data ); console.log( '_renderGetMoreChildren: iddoc = ', iddoc ); console.log( '_renderGetMoreChildren: $this = ', $this ); } var apiUrl = _getApiUrl( iddoc, _defaults.hitsPerCall + data.hitsDisplayed ); var hitContentMore = $( '&lt;div /&gt;' ); var getMoreChildrenLink = $( '&lt;button type=&quot;button&quot; /&gt;' ); if ( data.hasMoreChildren ) { // build get more link hitContentMore.addClass( 'search-list__hit-content-more' ); getMoreChildrenLink.addClass( 'btn-clean' ); getMoreChildrenLink.attr( 'data-api', apiUrl ); getMoreChildrenLink.attr( 'data-iddoc', iddoc ); getMoreChildrenLink.append( _defaults.msg.getMoreChildren ); hitContentMore.append( getMoreChildrenLink ); // append links $this.next().append( hitContentMore ); // render new hit set getMoreChildrenLink.off().on( 'click', function( event ) { var currApiUrl = $( this ).attr( 'data-api' ); var parentOffset = $this.parent().offset().top; // get data and render hits if data is valid _promise = viewer.helper.getRemoteData( currApiUrl ); _promise.then( function( data ) { // render child hits into the DOM _renderChildHits( data, $this ); // check if more children exist and render link _renderGetMoreChildren( data, iddoc, $this ); } ).then( null, function() { $this.next().append( viewer.helper.renderAlert( 'alert-danger', '&lt;strong&gt;Status: &lt;/strong&gt;' + error.status + ' ' + error.statusText, false ) ); console.error( 'ERROR: _renderGetMoreChildren - ', error ); } ); } ); } else { // clear and hide current get more link $this.next().find( _defaults.hitContentMoreSelector ).empty().hide(); console.info( '_renderGetMoreChildren: No more child hits available' ); return false; } } return viewer; } )( viewerJS || {}, jQuery ); Ã— Search results Close "},"viewer_viewerJS.searchSortingDropdown.js.html":{"id":"viewer_viewerJS.searchSortingDropdown.js.html","title":"Source: viewer/viewerJS.searchSortingDropdown.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.searchSortingDropdown.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which sets up the sorting functionality for search list. * * @version 3.2.0 * @module viewerJS.searchSortingDropdown * @requires jQuery */ var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _selectedSorting = ''; var _dataSortFieldState = ''; var _currUrl = ''; var _valueUrl = ''; var _checkValUrl = ''; var _dataSortField = ''; var _defaults = { select: '#sortSelect', }; viewer.searchSortingDropdown = { /** * Method to initialize the search sorting widget. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {Object} config.select An jQuery object which holds the sorting menu. */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.searchSortingDropdown.init' ); console.log( '##############################' ); console.log( 'viewer.searchSortingDropdown.init: config = ', config ); } $.extend( true, _defaults, config ); if ( viewer.localStoragePossible ) { _selectedSorting = localStorage.dataSortField; _currUrl = location.href; // get selected sorting type from local storage an set the menu option to // selected if ( _selectedSorting !== '' || _selectedSorting !== 'undefinded' ) { $( _defaults.select ).children( 'option' ).each( function() { _dataSortFieldState = $( this ).attr( 'data-sortField' ); _checkValUrl = $( this ).val(); if ( _dataSortFieldState === _selectedSorting &amp;&amp; _checkValUrl === _currUrl ) { $( this ).attr( 'selected', 'selected' ); } } ); } // get the sorting URL from the option value and reload the page on change $( _defaults.select ).on( 'change', function() { _valueUrl = $( this ).val(); _dataSortField = $( this ).children( 'option:selected' ).attr( 'data-sortField' ); if ( _valueUrl !== '' ) { // save current sorting state to local storage if ( typeof ( Storage ) !== &quot;undefined&quot; ) { localStorage.dataSortField = _dataSortField; } else { console.info( 'Local Storage is not defined. Current sorting state could not be saved.' ); return false; } window.location.href = _valueUrl; } } ); } else { return false; } }, }; return viewer; } )( viewerJS || {}, jQuery ); Ã— Search results Close "},"viewer_viewerJS.simpleLightBox.js.html":{"id":"viewer_viewerJS.simpleLightBox.js.html","title":"Source: viewer/viewerJS.simpleLightBox.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.simpleLightBox.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module to render a simple lightbox for images. * * @version 3.2.0 * @module viewerJS.simpleLightbox * @requires jQuery * @example &lt;img src=&quot;/your/path/to/the/image.jpg&quot; class=&quot;lightbox-image&quot; * data-imgpath=&quot;/your/path/to/the/&quot; data-imgname=&quot;image.jpg&quot; alt=&quot;&quot; /&gt; * */ var viewerJS = ( function( viewer ) { 'use strict'; var _box = null; var _imgpath = null; var _imgname = null; viewer.simpleLightBox = { /** * Initializes an event (click) which renders a lightbox with an bigger image. * * @method init * @example * * &lt;pre&gt; * viewerJS.simpleLightBox.init(); * &lt;/pre&gt; * */ init: function() { // eventlisteners $( '.lightbox-image' ).on( 'click', function( event ) { event.preventDefault(); var $this = $( this ); _imgpath = _getImagePath( $this ); _imgname = _getImageName( $this ); _box = _setupLightBox( _imgpath, _imgname ); $( 'body' ).append( _box ); _centerModalBox( $( '.lightbox-modal-box' ) ); $( '.lightbox-overlay' ).fadeIn(); $( '.lightbox-close-btn' ).on( 'click', function() { $( '.lightbox-overlay' ).remove(); } ); } ); } }; /** * Returns the image path from the 'data-imgpath' attribute. * * @method _getImagePath * @param {Object} $Obj Must be a jQuery-Object like $('.something') * @returns {String} The image path from the 'data-imgpath' attribute. * */ function _getImagePath( $Obj ) { _imgpath = $Obj.attr( 'data-imgpath' ); return _imgpath; } /** * Returns the image name from the 'data-imgname' attribute. * * @method _getImageName * @param {Object} $Obj Must be a jQuery-Object like $('.something') * @returns {String} The image name from the 'data-imgname' attribute. * */ function _getImageName( $Obj ) { _imgname = $Obj.attr( 'data-imgname' ); return _imgname; } /** * Returns a HTML-String which renders the lightbox. * * @method _setupLightBox * @param {String} path The path to the big image. * @param {String} name The name of the big image. * @returns {String} The HTML-Code to render the lightbox. * */ function _setupLightBox( path, name ) { var lightbox = ''; lightbox = '&lt;div class=&quot;lightbox-overlay&quot;&gt;'; lightbox += '&lt;div class=&quot;lightbox-modal-box&quot;&gt;'; lightbox += '&lt;div class=&quot;lightbox-close&quot;&gt;'; lightbox += '&lt;span class=&quot;lightbox-close-btn&quot; title=&quot;Fenster schlie&amp;szlig;en&quot;&gt;&amp;times;&lt;/span&gt;'; lightbox += '&lt;/div&gt;'; lightbox += '&lt;img src=&quot;' + path + name + '&quot; alt=&quot;' + name + '&quot; /&gt;&lt;/div&gt;&lt;/div&gt;'; return lightbox; } /** * Puts the lightbox to the center of the screen. * * @method _centerModalBox * @param {Object} $Obj Must be a jQuery-Object like $('.something') */ function _centerModalBox( $Obj ) { var boxWidth = $Obj.outerWidth(); var boxHeight = $Obj.outerHeight(); $Obj.css( { 'margin-top': '-' + boxHeight / 2 + 'px', 'margin-left': '-' + boxWidth / 2 + 'px' } ); } return viewer; } )( viewerJS || {}, jQuery ); Ã— Search results Close "},"viewer_viewerJS.stackedThumbnails.js.html":{"id":"viewer_viewerJS.stackedThumbnails.js.html","title":"Source: viewer/viewerJS.stackedThumbnails.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.stackedThumbnails.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which renders CSS featured stacked thumbnails in search list for multivolume * works. * * @version 3.2.0 * @module viewerJS.stackedThumbnails * @requires jQuery */ var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _imgWidth = null; var _imgHeight = null; var _defaults = { thumbs: '.stacked-thumbnail', thumbsBefore: '.stacked-thumbnail-before', thumbsAfter: '.stacked-thumbnail-after', }; viewer.stackedThumbnails = { /** * Method to initialize the timematrix slider and the events which builds the * matrix and popovers. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {Object} config.thumbs All jQuery objects of the stacked thumbnails. * @param {String} config.thumbsBefore The classname of the stacked thumbnail * before element. * @param {String} config.thumbsAfter The classname of the stacked thumbnail after * element. */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.stackedThumbnails.init' ); console.log( '##############################' ); console.log( 'viewer.stackedThumbnails.init: config - ' ); console.log( config ); } $.extend( true, _defaults, config ); // hide stacked thumbs $( _defaults.thumbs ).hide(); $( _defaults.thumbs ).siblings().hide(); // iterate through thumbnails and set width and height for image stack $( _defaults.thumbs ).each( function() { _imgWidth = $( this ).outerWidth(); _imgHeight = $( this ).outerHeight(); $( this ).css( { 'margin-left': '-' + ( _imgWidth / 2 ) + 'px' } ); $( this ).siblings().css( { 'width': _imgWidth, 'height': _imgHeight, 'margin-left': '-' + ( _imgWidth / 2 ) + 'px' } ); // show stacked thumbs after building them $( this ).show(); $( this ).siblings( _defaults.thumbsBefore ).fadeIn( 'slow', function() { $( this ).siblings( _defaults.thumbsAfter ).fadeIn(); } ); } ); }, }; return viewer; } )( viewerJS || {}, jQuery ); Ã— Search results Close "},"viewer_viewerJS.timematrix.js.html":{"id":"viewer_viewerJS.timematrix.js.html","title":"Source: viewer/viewerJS.timematrix.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.timematrix.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module to create an imagemap sorted by the year of creation. * * @version 3.2.0 * @module viewerJS.timematrix * @requires jQuery */ var viewerJS = ( function( viewer ) { 'use strict'; // default variables var _debug = false; var _promise = null; var _apiData = null; var _defaults = { contextPath: null, apiQuery: 'api?action=timeline', startDateQuery: '&amp;startDate=', rangeInput1: null, startDate: null, endDateQuery: '&amp;endDate=', rangeInput2: null, endDate: null, countQuery: '&amp;count=', count: null, $tmCanvas: null, $tmCanvasPos: null, $tmCanvasCoords: {}, lang: {} }; viewer.timematrix = { /** * Method to initialize the timematrix slider and the events which builds the * matrix and popovers. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {String} config.contextPath The rootpath of the application. * @param {String} config.apiQuery The API action to call. * @param {String} config.startDateQuery The GET-Parameter for the start date. * @param {Object} config.rangeInput1 An jQuery object of the first range input. * @param {String} config.startDate The value of the first range input. * @param {String} config.endDateQuery The GET-Parameter for the end date. * @param {Object} config.rangeInput2 An jQuery object of the second range input. * @param {String} config.endDate The value of the second range input. * @param {String} config.countQuery The GET-Parameter for the count query. * @param {String} config.count The number of results from the query. * @param {Object} config.$tmCanvas An jQuery object of the timematrix canvas. * @param {Object} config.$tmCanvasPos An jQuery object of the timematrix canvas * position. * @param {Object} config.lang An object of localized strings. * @example * * &lt;pre&gt; * $( document ).ready( function() { * var timematrixConfig = { * path: '#{request.contextPath}/', * lang: { * closeWindow: '#{msg.timematrixCloseWindow}', * goToWork: '#{msg.timematrixGoToWork}' * } * }; * viewerJS.timematrix.init( timematrixConfig ); * } ); * &lt;/pre&gt; */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.timematrix.init' ); console.log( '##############################' ); console.log( 'viewer.timematrix.init: config - ' ); console.log( config ); } $.extend( true, _defaults, config ); _defaults.$tmCanvasCoords = { top: _defaults.$tmCanvasPos.top, left: 0, right: _defaults.$tmCanvasPos.left + _defaults.$tmCanvas.outerWidth() }; // range slider settings $( '#slider-range' ).slider( { range: true, min: parseInt( _defaults.startDate ), max: parseInt( _defaults.endDate ), values: [ parseInt( _defaults.startDate ), parseInt( _defaults.endDate ) ], slide: function( event, ui ) { _defaults.rangeInput1.val( ui.values[ 0 ] ); $( '.timematrix-slider-bubble-startDate' ).html( ui.values[ 0 ] ); _defaults.startDate = ui.values[ 0 ]; _defaults.rangeInput1.val( ui.values[ 1 ] ); $( '.timematrix-slider-bubble-endDate' ).html( ui.values[ 1 ] ); _defaults.endDate = ui.values[ 1 ]; } } ); // append slider bubble to slider handle $( '#slider-range .ui-slider-range' ).next().append( _renderSliderBubble( 'startDate', _defaults.startDate ) ); $( '#slider-range .ui-slider-range' ).next().next().append( _renderSliderBubble( 'endDate', _defaults.endDate ) ); // set active slider handle to top $( '.ui-slider-handle' ).on( 'mousedown', function() { $( '.ui-slider-handle' ).removeClass( 'top' ); $( this ).addClass( 'top' ); } ); // listen to submit event of locate timematrix form $( '#locateTimematrix' ).on( 'submit', function( e ) { e.preventDefault(); // check for popovers and remove them if ( $( '.timematrix-popover' ).length ) { $( '.timematrix-popover' ).remove(); } // build api target var apiTarget = _defaults.contextPath; apiTarget += _defaults.apiQuery; apiTarget += _defaults.startDateQuery; apiTarget += _defaults.startDate; apiTarget += _defaults.endDateQuery; apiTarget += _defaults.endDate; apiTarget += _defaults.countQuery; apiTarget += _defaults.count; // get data from api _promise = viewer.helper.getRemoteData( apiTarget ); // render thumbnails _promise.then( function( data ) { _apiData = data; _defaults.$tmCanvas.html( _renderThumbs( _apiData ) ); $( '.timematrix-thumb' ).css( { height: $( '.timematrix-thumb' ).outerWidth() } ); // show thumbs after theyÂ´ve been loaded $( '.timematrix-thumb img' ).load( function() { $( this ).css( { visibility: 'visible' } ); } ); // listen to click event on thumbnails $( '.timematrix-thumb' ).on( 'click', function() { if ( !$( '.timematrix-popover' ) ) { $( '.timematrix-thumb' ).removeClass( 'marker' ); $( this ).addClass( 'marker' ); _renderPopover( $( this ), _defaults.lang ); } else { $( '.timematrix-popover' ).remove(); $( '.timematrix-thumb' ).removeClass( 'marker' ); $( this ).addClass( 'marker' ); _renderPopover( $( this ), _defaults.lang ); } // close popover $( '.timematrix-popover-close' ).on( 'click', function() { $( this ).parent().remove(); $( '.timematrix-thumb' ).removeClass( 'marker' ); } ); // check if image is loaded and reset loader $( '.timematrix-popover-body img' ).load( function() { $( '.timematrix-popover-imageloader' ).hide(); } ); } ); } ).then( null, function() { _defaults.$tmCanvas.append( viewer.helper.renderAlert( 'alert-danger', '&lt;strong&gt;Status: &lt;/strong&gt;' + error.status + ' ' + error.statusText, false ) ); console.error( 'ERROR: viewer.timematrix.init - ', error ); } ) } ); // remove all popovers by clicking on body $( 'body' ).on( 'click', function( event ) { if ( $( event.target ).closest( '.timematrix-thumb' ).length ) { return; } else { _removePopovers(); } } ); } }; /** * Method to render image thumbnails to the timematrix canvas. * * @method _renderThumbs * @param {Object} json An JSON-Object which contains the image data. * @returns {String} HTML-String which displays the image thumbnails. */ function _renderThumbs( json ) { if ( _debug ) { console.log( 'viewer.timematrix _renderThumbs: json - ' ); console.log( json ); } var tlbox = ''; tlbox += '&lt;div class=&quot;timematrix-box&quot;&gt;'; tlbox += '&lt;header class=&quot;timematrix-header&quot;&gt;'; if ( _defaults.startDate !== '' &amp;&amp; _defaults.endDate !== '' ) { tlbox += '&lt;h3&gt;' + _defaults.startDate + ' - ' + _defaults.endDate + '&lt;/h3&gt;'; } tlbox += '&lt;/header&gt;'; tlbox += '&lt;section class=&quot;timematrix-body&quot;&gt;'; $.each( json, function( i, j ) { tlbox += '&lt;div class=&quot;timematrix-thumb&quot; data-title=&quot;' + j.title + '&quot; data-mediumimage=&quot;' + j.mediumimage + '&quot; data-url=&quot;' + j.url + '&quot;&gt;'; if ( j.thumbnailUrl ) { tlbox += '&lt;img src=&quot;' + j.thumbnailUrl + '&quot; style=&quot;visibility: hidden;&quot; /&gt;'; } else { tlbox += ''; } tlbox += '&lt;/div&gt;'; } ); tlbox += '&lt;/section&gt;'; tlbox += '&lt;footer class=&quot;timematrix-footer&quot;&gt;&lt;/footer&gt;'; tlbox += '&lt;/div&gt;'; return tlbox; } /** * Method to render a popover with a thumbnail image. * * @method _renderPopover * @param {Object} $Obj Must be an jQuery-Object like $(this). * @param {Object} lang An Object with localized strings in the selected language. */ function _renderPopover( $Obj, lang ) { if ( _debug ) { console.log( 'viewer.timematrix _renderPopover: obj - ' ); console.log( $Obj ); console.log( 'viewer.timematrix _renderPopover: lang - ' + lang ); } var title = $Obj.attr( 'data-title' ); var mediumimage = $Obj.attr( 'data-mediumimage' ); var url = $Obj.attr( 'data-url' ); var $objPos = $Obj.position(); var $objCoords = { top: $objPos.top, left: $objPos.left, width: $Obj.outerWidth() }; var popoverPos = _calculatePopoverPosition( $objCoords, _defaults.$tmCanvasCoords ); var popover = ''; popover += '&lt;div class=&quot;timematrix-popover&quot; style=&quot;top: ' + popoverPos.top + 'px; left: ' + popoverPos.left + 'px;&quot;&gt;'; popover += '&lt;span class=&quot;timematrix-popover-close&quot; title=&quot;' + lang.closeWindow + '&quot;&gt;&amp;times;&lt;/span&gt;'; popover += '&lt;header class=&quot;timematrix-popover-header&quot;&gt;'; popover += '&lt;h4 title=&quot;' + title + '&quot;&gt;' + viewer.helper.truncateString( title, 75 ) + '&lt;/h4&gt;'; popover += '&lt;/header&gt;'; popover += '&lt;section class=&quot;timematrix-popover-body&quot;&gt;'; popover += '&lt;div class=&quot;timematrix-popover-imageloader&quot;&gt;&lt;/div&gt;'; popover += '&lt;a href=&quot;' + url + '&quot;&gt;&lt;img src=&quot;' + mediumimage + '&quot; /&gt;&lt;/a&gt;'; popover += '&lt;/section&gt;'; popover += '&lt;footer class=&quot;timematrix-popover-footer&quot;&gt;'; popover += '&lt;a href=&quot;' + url + '&quot; title=&quot;' + title + '&quot;&gt;' + lang.goToWork + '&lt;/a&gt;'; popover += '&lt;/footer&gt;'; popover += '&lt;/div&gt;'; _defaults.$tmCanvas.append( popover ); } /** * Method which calculates the position of the popover. * * @method _calculatePopoverPosition * @param {Object} triggerCoords An object which contains the coordinates of the * element has been clicked. * @param {Object} tmCanvasCoords An object which contains the coordinates of the * wrapper element from the timematrix. * @returns {Object} An object which contains the top and the left position of the * popover. */ function _calculatePopoverPosition( triggerCoords, tmCanvasCoords ) { if ( _debug ) { console.log( 'viewer.timematrix _calculatePopoverPosition: triggerCoords - ' ); console.log( triggerCoords ); console.log( 'viewer.timematrix _calculatePopoverPosition: tmCanvasCoords - ' ); console.log( tmCanvasCoords ); } var poLeftBorder = triggerCoords.left - ( 150 - ( triggerCoords.width / 2 ) ); var poRightBorder = poLeftBorder + 300; var tbLeftBorder = tmCanvasCoords.left; var tbRightBorder = tmCanvasCoords.right; var poTop; var poLeft = poLeftBorder; poTop = ( triggerCoords.top + $( '.timematrix-thumb' ).outerHeight() ) - 1; if ( poLeftBorder &lt;= tbLeftBorder ) { poLeft = tbLeftBorder; } if ( poRightBorder &gt;= tbRightBorder ) { poLeft = tmCanvasCoords.right - 300; } return { top: poTop, left: poLeft }; } /** * Method which renders the bubbles for the slider. * * @method _renderSliderBubble * @param {String} time The string for the time value. * @param {String} val The string for the value. * @returns {String} HTML-String which renders the slider-bubble. */ function _renderSliderBubble( time, val ) { if ( _debug ) { console.log( 'viewer.timematrix _renderSliderBubble: time - ' + time ); console.log( 'viewer.timematrix _renderSliderBubble: val - ' + val ); } return '&lt;div class=&quot;timematrix-slider-bubble-' + time + '&quot;&gt;' + val + '&lt;/div&gt;'; } /** * Method which removes all popovers. * * @method _removePopovers */ function _removePopovers() { if ( _debug ) { console.log( '---------- _removePopovers() ----------' ); } $( '.timematrix-popover' ).remove(); $( '.timematrix-thumb' ).removeClass( 'marker' ); } return viewer; } )( viewerJS || {}, jQuery ); Ã— Search results Close "},"viewer_viewerJS.tinyMce.js.html":{"id":"viewer_viewerJS.tinyMce.js.html","title":"Source: viewer/viewerJS.tinyMce.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.tinyMce.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * &lt;Short Module Description&gt; * * @version 3.2.0 * @module viewerJS.tinyMce * @requires jQuery */ var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _defaults = { currLang: 'de', selector: 'textarea.tinyMCE', width: '100%', height: 400, theme: 'modern', plugins: 'print preview paste searchreplace autolink directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists textcolor wordcount spellchecker imagetools media contextmenu colorpicker textpattern help', toolbar: 'formatselect | undo redo | bold italic underline strikethrough forecolor backcolor | link | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | fullscreen code', menubar: false, statusbar: false, pagebreak_separator: '&lt;span class=&quot;pagebreak&quot;&gt;&lt;/span&gt;', relative_urls: false, force_br_newlines: false, force_p_newlines: false, forced_root_block: '', language: 'de' }; viewer.tinyMce = { init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.tinyMce.init' ); console.log( '##############################' ); console.log( 'viewer.tinyMce.init: config - ', config ); } $.extend( true, _defaults, config ); // check current language switch ( _defaults.currLang ) { case 'de': _defaults.language = 'de'; break; case 'es': _defaults.language = 'es'; break; case 'pt': _defaults.language = 'pt_PT'; break; case 'ru': _defaults.language = 'ru'; break; } // init editor tinymce.init( _defaults ); }, overview: function() { // check if description or publication editing is enabled and // set fullscreen options if ( $( '.overview__description-editor' ).length &gt; 0 ) { viewerJS.tinyConfig.setup = function( editor ) { editor.on( 'init', function( e ) { $( '.overview__publication-action .btn' ).hide(); } ); editor.on( 'FullscreenStateChanged', function( e ) { if ( e.state ) { $( '.overview__description-action-fullscreen' ).addClass( 'in' ); } else { $( '.overview__description-action-fullscreen' ).removeClass( 'in' ); } } ); }; } else { viewerJS.tinyConfig.setup = function( editor ) { editor.on( 'init', function( e ) { $( '.overview__description-action .btn' ).hide(); } ); editor.on( 'FullscreenStateChanged', function( e ) { if ( e.state ) { $( '.overview__publication-action-fullscreen' ).addClass( 'in' ); } else { $( '.overview__publication-action-fullscreen' ).removeClass( 'in' ); } } ); }; } }, }; return viewer; } )( viewerJS || {}, jQuery ); Ã— Search results Close "},"viewer_viewerJS.userDropdown.js.html":{"id":"viewer_viewerJS.userDropdown.js.html","title":"Source: viewer/viewerJS.userDropdown.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.userDropdown.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module to manage the user dropdown. * * @version 3.2.0 * @module viewerJS.userDropdown * @requires jQuery */ var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _bookselfDropdown = false; var _defaults = {}; viewer.userDropdown = { init: function() { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.userDropdown.init' ); console.log( '##############################' ); } // check if bookshelfdropdown exist if ( $( '.bookshelf-navigation__dropdown' ).length &gt; 0 ) { _bookselfDropdown = true; } // login dropdown $( '[data-toggle=&quot;login-dropdown&quot;]' ).on( 'click', function( event ) { event.stopPropagation(); // hide bookshelfdropdow if exist if ( _bookselfDropdown ) { $( '.bookshelf-navigation__dropdown' ).hide(); $( '.bookshelf-popup' ).remove(); } // hide collection panel if exist if ( $( '.navigation__collection-panel' ).length &gt; 0 ) { $( '.navigation__collection-panel' ).hide(); } $( '.login-navigation__login-dropdown' ).slideToggle( 'fast' ); } ); // user dropdown $( '[data-toggle=&quot;user-dropdown&quot;]' ).on( 'click', function( event ) { event.stopPropagation(); // hide bookshelfdropdow if exist if ( _bookselfDropdown ) { $( '.bookshelf-navigation__dropdown' ).hide(); $( '.bookshelf-popup' ).remove(); } // hide collection panel if exist if ( $( '.navigation__collection-panel' ).length &gt; 0 ) { $( '.navigation__collection-panel' ).hide(); } $( '.login-navigation__user-dropdown' ).slideToggle( 'fast' ); } ); // retrieve account $( '[data-toggle=&quot;retrieve-account&quot;]' ).on( 'click', function() { $( '.login-navigation__retrieve-account' ).addClass( 'in' ); } ); $( '[data-dismiss=&quot;retrieve-account&quot;]' ).on( 'click', function() { $( '.login-navigation__retrieve-account' ).removeClass( 'in' ); } ); // remove dropdown by clicking on body $( 'body' ).on( 'click', function( event ) { var target = $( event.target ); var dropdown = $( '.login-navigation__user-dropdown, .login-navigation__login-dropdown' ); var dropdownChild = dropdown.find( '*' ); if ( !target.is( dropdown ) &amp;&amp; !target.is( dropdownChild ) ) { dropdown.hide(); } } ); } }; return viewer; } )( viewerJS || {}, jQuery ); Ã— Search results Close "},"viewer_viewerJS.versionHistory.js.html":{"id":"viewer_viewerJS.versionHistory.js.html","title":"Source: viewer/viewerJS.versionHistory.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewer/viewerJS.versionHistory.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which renders current and other versions of a work into a widget. * * @version 3.2.0 * @module viewerJS.versionHistory * @requires jQuery */ var viewerJS = ( function( viewer ) { 'use strict'; var _debug = false; var _defaults = { versions: [], json: null, imgUrl: '', imgPi: '', versionLink: '', widgetInputs: '', widgetList: '', }; viewer.versionHistory = { /** * Method to initialize the version history widget. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {Array} config.versions An array which holds all versions. * @param {Object} config.json An JSON-Object which takes all versions. * @param {String} config.imgUrl The image URL for the current work. * @param {String} config.imgPi The PI for the image of the current work. * @param {String} config.versionLink A string placeholder for the final HTML. * @param {String} config.widgetInputs A string placeholder for the final HTML. * @param {String} config.widgetList A string placeholder for the final HTML. */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'viewer.versionHistory.init' ); console.log( '##############################' ); console.log( 'viewer.versionHistory.init: config = ', config ); } $.extend( true, _defaults, config ); // push versions into an array $( _defaults.widgetInputs ).each( function() { _defaults.versions.push( $( this ).val() ); } ); if ( _debug ) { console.log( 'viewer.versionHistory: versions = ', _defaults.versions ); } // append list elements to widget for ( var i = 0; i &lt; _defaults.versions.length; i++ ) { _defaults.json = JSON.parse( _defaults.versions[ i ] ); if ( _defaults.json.id === _defaults.imgPi ) { // Aktuell geÃ¶ffnete Version - kein Link _defaults.versionLink = '&lt;li&gt;&lt;span&gt;'; if ( _defaults.json.label != undefined &amp;&amp; _defaults.json.label != '' ) { _defaults.versionLink += _defaults.json.label; } else { _defaults.versionLink += _defaults.json.id; if ( _defaults.json.year != undefined &amp;&amp; _defaults.json.year != '' ) { _defaults.versionLink += ' (' + _defaults.json.year + ')'; } } _defaults.versionLink += '&lt;/span&gt;&lt;/li&gt;'; $( _defaults.widgetList ).append( _defaults.versionLink ); } else { // VorgÃ¤nger und Nachfolger jeweils mit Link _defaults.versionLink = '&lt;li&gt;&lt;a href=&quot;' + _defaults.imgUrl + '/' + _defaults.json.id + '/1/&quot;&gt;'; if ( _defaults.json.label != undefined &amp;&amp; _defaults.json.label != '' ) { _defaults.versionLink += _defaults.json.label; } else { _defaults.versionLink += _defaults.json.id; if ( _defaults.json.year != undefined &amp;&amp; _defaults.json.year != '' ) { _defaults.versionLink += ' (' + _defaults.json.year + ')'; } } _defaults.versionLink += '&lt;/a&gt;&lt;/li&gt;'; $( _defaults.widgetList ).append( _defaults.versionLink ); } } } }; return viewer; } )( viewerJS || {}, jQuery ); Ã— Search results Close "},"viewImage_viewImage.controls.persistence.js.html":{"id":"viewImage_viewImage.controls.persistence.js.html","title":"Source: viewImage/viewImage.controls.persistence.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewImage/viewImage.controls.persistence.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which handles the persistence of zoom and rotation levels. * * @version 3.2.0 * @module viewImage.controls.persistence * @requires jQuery */ var viewImage = ( function( osViewer ) { 'use strict'; var _debug = false; osViewer.controls.persistence = { init: function( config ) { if ( typeof ( Storage ) !== 'undefined' ) { /** * Set Location from local storage */ var location = null; var currentPersistenceId = osViewer.getConfig().global.persistenceId; if ( config.global.persistZoom || config.global.persistRotation ) { try { var location = JSON.parse( localStorage.imageLocation ); } catch ( err ) { if ( _debug ) { console.error( &quot;No readable image location in local storage&quot; ); } } if ( location &amp;&amp; _isValid( location ) &amp;&amp; location.persistenceId === currentPersistenceId ) { if ( _debug ) { console.log( &quot;Reading location from local storage&quot;, location ); } config.image.location = {}; if ( config.global.persistZoom ) { if ( _debug ) { console.log( &quot;setting zoom from local storage&quot; ); } config.image.location.zoom = location.zoom; config.image.location.x = location.x; config.image.location.y = location.y; } if ( config.global.persistRotation ) { if ( _debug ) { console.log( &quot;setting rotation from local storage&quot; ); } config.image.location.rotation = location.rotation; } else { config.image.location.rotation = 0; } } /** * save current location to local storage before navigating away */ window.onbeforeunload = function() { var loc = osViewer.controls.getLocation(); loc.persistenceId = osViewer.getConfig().global.persistenceId; localStorage.imageLocation = JSON.stringify( loc ); if ( _debug ) { console.log( &quot;storing zoom &quot; + localStorage.imageLocation ); } } } } } } function _isValid( location ) { return _isNumber( location.x ) &amp;&amp; _isNumber( location.y ) &amp;&amp; _isNumber( location.zoom ) &amp;&amp; _isNumber( location.rotation ); } function _isNumber( x ) { return typeof x === &quot;number&quot; &amp;&amp; !Number.isNaN( x ); } return osViewer; } )( viewImage || {}, jQuery ); Ã— Search results Close "},"viewImage_viewImage.controls.js.html":{"id":"viewImage_viewImage.controls.js.html","title":"Source: viewImage/viewImage.controls.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewImage/viewImage.controls.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which handles the image controls of the image view. * * @version 3.2.0 * @module viewImage.controls * @requires jQuery */ var viewImage = ( function( osViewer ) { 'use strict'; var _debug = false; var _currentZoom; var _zoomedOut = true; var _panning = false; var _fadeout = null; osViewer.controls = { init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'osViewer.controls.init' ); console.log( '##############################' ); } if(osViewer.controls.persistence) { osViewer.controls.persistence.init(config); } if(_debug) { console.log(&quot;Setting viewer location to&quot;, config.image.location); } if( osViewer.observables ) { // set location after viewport update osViewer.observables.redrawRequired .sample(osViewer.observables.viewportUpdate) .filter(function(event) {return osViewer.controls ? true : false}) .subscribe(function(event) { setLocation(event, osViewer) osViewer.controls.setPanning( false ); }); // zoom home if min zoom reached osViewer.observables.viewerZoom.subscribe( function( event ) { if ( _debug ) { console.log( &quot;zoom to &quot; + osViewer.viewer.viewport.getZoom( true ) ); } if ( !osViewer.controls.isPanning() ) { var currentZoom = osViewer.viewer.viewport.getZoom(); if ( currentZoom &lt;= osViewer.viewer.viewport.minZoomLevel ) { if ( _debug ) { console.log( &quot;Zoomed out: Panning home&quot; ); } osViewer.controls.setPanning(true); osViewer.controls.goHome( true ); osViewer.controls.setPanning(false); } } } ); } // fade out fullscreen controls if ( $( '#fullscreenTemplate' ).length &gt; 0 ) { $( '#fullscreenTemplate' ).on( 'mousemove', function() { osViewer.controls.fullscreenControlsFadeout(); } ); } }, getLocation: function() { return { x: osViewer.controls.getCenter().x, y: osViewer.controls.getCenter().y, zoom: osViewer.controls.getZoom()/osViewer.controls.getCurrentRotationZooming(), rotation: osViewer.controls.getRotation(), } }, getCenter: function() { if ( _debug ) { console.log( &quot;image center is &quot; + osViewer.viewer.viewport.getCenter( true ) ); } return osViewer.viewer.viewport.getCenter( true ); }, setCenter: function( center ) { if ( _debug ) { console.log( &quot;Setting image center to &quot; ); console.log( center ); } osViewer.viewer.viewport.panTo( center, true ); }, getZoom: function() { if ( _debug ) { console.log( 'osViewer.controls.getZoom' ); } return osViewer.viewer.viewport.getZoom( true ); }, zoomTo: function( zoomTo ) { if ( _debug ) { console.log( 'osViewer.controls.myZoomTo: zoomTo - ' + zoomTo ); } var zoomBy = parseFloat( zoomTo ) / osViewer.viewer.viewport.getZoom(); if ( _debug ) { console.log( 'osViewer.controls.myZoomTo: zoomBy - ' + zoomBy ); } osViewer.viewer.viewport.zoomBy( zoomBy, osViewer.viewer.viewport.getCenter( false ), true ); }, setFullScreen: function( enable ) { if ( _debug ) { console.log( 'osViewer.controls.setFullScreen: enable - ' + enable ); } osViewer.viewer.setFullScreen( enable ); }, goHome: function( immediate ) { if ( _debug ) { console.log( 'osViewer.controls.panHome - zoom : ' + osViewer.viewer.viewport.getHomeZoom() ); } osViewer.viewer.viewport.goHome( immediate ); _zoomedOut = true; }, reset: function( resetRotation ) { if ( _debug ) { console.log( 'osViewer.controls.goHome: bool - ' + resetRotation ); } // osViewer.viewer.viewport.goHome( true ); osViewer.controls.goHome( true ); osViewer.viewer.viewport.zoomTo( osViewer.viewer.viewport.getHomeZoom(), null, true ); if ( resetRotation ) { osViewer.controls.rotateTo( 0 ); } }, zoomIn: function() { if ( _debug ) { console.log( 'osViewer.controls.zoomIn: zoomSpeed - ' + osViewer.getConfig().global.zoomSpeed ); } osViewer.viewer.viewport.zoomBy( osViewer.getConfig().global.zoomSpeed, osViewer.viewer.viewport.getCenter( false ), false ); }, zoomOut: function() { if ( _debug ) { console.log( 'osViewer.controls.zoomOut: zoomSpeed - ' + osViewer.getConfig().global.zoomSpeed ); } osViewer.viewer.viewport.zoomBy( 1 / osViewer.getConfig().global.zoomSpeed, osViewer.viewer.viewport.getCenter( false ), false ); }, getHomeZoom: function( rotated ) { if ( rotated &amp;&amp; osViewer.getCanvasSize().x / osViewer.getCanvasSize().y &lt;= osViewer.getImageSize().x / osViewer.getImageSize().y ) { osViewer.viewer.viewport.homeFillsViewer = true; } var zoom = osViewer.viewer.viewport.getHomeZoom(); osViewer.viewer.viewport.homeFillsViewer = false; return zoom; }, rotateRight: function() { if ( _debug ) { console.log( 'osViewer.controls.rotateRight' ); } var newRotation = osViewer.viewer.viewport.getRotation() + 90; osViewer.controls.rotateTo( newRotation ); }, rotateLeft: function() { if ( _debug ) { console.log( 'osViewer.controls.rotateLeft' ); } var newRotation = osViewer.viewer.viewport.getRotation() - 90; osViewer.controls.rotateTo( newRotation ); }, getRotation: function() { if ( _debug ) { console.log( 'osViewer.controls.getRotation' ); } return osViewer.viewer.viewport.getRotation(); }, setRotation: function( rotation ) { if ( _debug ) { console.log( 'osViewer.controls.setRotation: rotation - ' + rotation ); } return osViewer.controls.rotateTo( rotation ); }, rotateTo: function( newRotation ) { if ( newRotation &lt; 0 ) { newRotation = newRotation + 360; } newRotation = newRotation % 360; if ( _debug ) { console.log( 'osViewer.controls.rotateTo: newRotation - ' + newRotation ); } _panning = true; _currentZoom = null; osViewer.viewer.viewport.setRotation( newRotation ); _panning = false; }, getCurrentRotationZooming: function() { var sizes = osViewer.getSizes(); if(sizes &amp;&amp; sizes.rotated()) { return 1/sizes.ratio(sizes.originalImageSize); } else { return 1; } }, setPanning: function(panning) { _panning = panning; }, isPanning: function() { return _panning; }, fullscreenControlsFadeout: function() { if ( _debug ) { console.log( '---------- osViewer.controls.fullscreenControlsFadeout() ----------' ); } if ( _fadeout ) { clearTimeout( _fadeout ); this.showFullscreenControls(); } _fadeout = setTimeout( this.hideFullscreenControls, 3000 ); }, hideFullscreenControls: function() { if ( _debug ) { console.log( '---------- osViewer.controls.hideFullscreenControls() ----------' ); } $( '#fullscreenRotateControlsWrapper, #fullscreenZoomSliderWrapper, #fullscreenExitWrapper, #fullscreenPrevWrapper, #fullscreenNextWrapper' ).stop().fadeOut( 'slow' ); }, showFullscreenControls: function() { if ( _debug ) { console.log( '---------- osViewer.controls.showFullscreenControls() ----------' ); } $( '#fullscreenRotateControlsWrapper, #fullscreenZoomSliderWrapper, #fullscreenExitWrapper, #fullscreenPrevWrapper, #fullscreenNextWrapper' ).show(); } }; // set correct location, zooming and rotation once viewport has been updated after // redraw function setLocation(event, osViewer) { if(_debug) { console.log(&quot;Viewer changed from &quot; + event.osState + &quot; event&quot;); console.log(&quot;target location: &quot;, event.targetLocation); console.log(&quot;Home zoom = &quot;, osViewer.viewer.viewport.getHomeZoom()); } osViewer.viewer.viewport.minZoomLevel = osViewer.viewer.viewport.getHomeZoom() * osViewer.getConfig().global.minZoomLevel; var targetZoom = event.targetLocation.zoom; var targetLocation = new OpenSeadragon.Point(event.targetLocation.x, event.targetLocation.y); var zoomDiff = targetZoom * osViewer.viewer.viewport.getHomeZoom() - (osViewer.viewer.viewport.minZoomLevel); // console.log(&quot;zoomDiff: &quot; + targetZoom + &quot; * &quot; + osViewer.viewer.viewport.getHomeZoom() // + &quot; - &quot; + osViewer.viewer.viewport.minZoomLevel + &quot; = &quot;, zoomDiff); // console.log(&quot;zoomDiff: &quot; + targetZoom + &quot; - &quot; + osViewer.viewer.viewport.minZoomLevel + // &quot;/&quot; + osViewer.controls.getCurrentRotationZooming() + &quot; = &quot;, zoomDiff); var zoomedOut = zoomDiff &lt; 0.001 || !targetZoom; if(zoomedOut) { if(_debug) { console.log(&quot;Zooming home&quot;) } osViewer.controls.goHome( true ); } else { if(_debug) { console.log( &quot;Zooming to &quot; + targetZoom + &quot; * &quot; + osViewer.controls.getCurrentRotationZooming() ); console.log(&quot;panning to &quot;, targetLocation); } osViewer.viewer.viewport.zoomTo( targetZoom * osViewer.controls.getCurrentRotationZooming(), null, true); osViewer.controls.setCenter( targetLocation); } if(event.osState === &quot;open&quot; &amp;&amp; event.targetLocation.rotation !== 0) { osViewer.controls.rotateTo(event.targetLocation.rotation); } } return osViewer; } )( viewImage || {}, jQuery ); Ã— Search results Close "},"viewImage_viewImage.drawLine.js.html":{"id":"viewImage_viewImage.drawLine.js.html","title":"Source: viewImage/viewImage.drawLine.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewImage/viewImage.drawLine.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which drwas a line to the image. * * @version 3.2.0 * @module viewImage.drawLine * @requires jQuery */ var viewImage = ( function( osViewer ) { 'use strict'; var _debug = false; var _drawing = true; var _viewerInputHook = null; var _hbAdd = 5; var _deleteOldDrawElement = true; var _drawElement = null; var _startPoint = null; var _drawPoint = null; osViewer.drawLine = { init: function() { _viewerInputHook = osViewer.viewer.addViewerInputHook( { hooks: [ { tracker: &quot;viewer&quot;, handler: &quot;clickHandler&quot;, hookHandler: _disableViewerEvent }, { tracker: &quot;viewer&quot;, handler: &quot;scrollHandler&quot;, hookHandler: _disableViewerEvent }, { tracker: &quot;viewer&quot;, handler: &quot;dragHandler&quot;, hookHandler: _onViewerDrag }, { tracker: &quot;viewer&quot;, handler: &quot;pressHandler&quot;, hookHandler: _onViewerPress }, { tracker: &quot;viewer&quot;, handler: &quot;dragEndHandler&quot;, hookHandler: _onViewerDragEnd } ] } ); }, toggleDrawing: function() { _drawing = !_drawing; } } function _onViewerPress( event ) { if ( _drawing ) { if ( _drawElement &amp;&amp; _deleteOldDrawElement ) { osViewer.viewer.removeOverlay( _drawElement ); } _drawElement = document.createElement( &quot;div&quot; ); _drawElement.style.border = &quot;2px solid green&quot;; _drawPoint = osViewer.viewer.viewport.viewerElementToViewportCoordinates( event.position ); _drawPoint = osViewer.overlays.getRotated( _drawPoint ); var rect = new OpenSeadragon.Rect( _drawPoint.x, _drawPoint.y, 0, 0 ); osViewer.viewer.addOverlay( _drawElement, rect, 1 ); // console.log(osViewer.viewer.viewport // .viewerElementToImageCoordinates(event.position)); event.preventDefaultAction = true; return true; } } function _onViewerDrag( event ) { if ( _drawing ) { var newPoint = osViewer.viewer.viewport.viewerElementToViewportCoordinates( event.position ); newPoint = osViewer.overlays.getRotated( newPoint ); var rect = new OpenSeadragon.Rect( _drawPoint.x, _drawPoint.y, newPoint.x - _drawPoint.x, newPoint.y - _drawPoint.y ); if ( newPoint.x &lt; _drawPoint.x ) { rect.x = newPoint.x; rect.width = _drawPoint.x - newPoint.x; } if ( newPoint.y &lt; _drawPoint.y ) { rect.y = newPoint.y; rect.height = _drawPoint.y - newPoint.y; } osViewer.viewer.updateOverlay( _drawElement, rect, 0 ); event.preventDefaultAction = true; return true; } } function _onViewerDragEnd( event ) { if ( _drawing ) { var newPoint = osViewer.viewer.viewport.viewerElementToViewportCoordinates( event.position ); newPoint = osViewer.overlays.getRotated( newPoint ); var rect = new OpenSeadragon.Rect( _drawPoint.x, _drawPoint.y, newPoint.x - _drawPoint.x, newPoint.y - _drawPoint.y ); if ( newPoint.x &lt; _drawPoint.x ) { rect.x = newPoint.x; rect.width = _drawPoint.x - newPoint.x; } if ( newPoint.y &lt; _drawPoint.y ) { rect.y = newPoint.y; rect.height = _drawPoint.y - newPoint.y; } rect.hitBox = { l: rect.x - _hbAdd, t: rect.y - _hbAdd, r: rect.x + rect.width + _hbAdd, b: rect.y + rect.height + _hbAdd }; // osViewer.overlays.addRect({ // drawElement : _drawElement, // rect : rect // }); // console.log(osViewer.viewer.viewport // .viewerElementToImageCoordinates(event.position)); event.preventDefaultAction = true; return true; } } function _disableViewerEvent( event ) { if ( _drawing ) { event.preventDefaultAction = true; return true; } } function checkForRectHit( point ) { var i; for ( i = 0; i &lt; _rects.length; i++ ) { var x = _rects[ i ]; if ( point.x &gt; x.hitBox.l &amp;&amp; point.x &lt; x.hitBox.r &amp;&amp; point.y &gt; x.hitBox.t &amp;&amp; point.y &lt; x.hitBox.b ) { var topLeftHb = { l: x.x - _hbAdd, t: x.y - _hbAdd, r: x.x + _hbAdd, b: x.y + _hbAdd }; var topRightHb = { l: x.x + x.width - _hbAdd, t: x.y - _hbAdd, r: x.x + x.width + _hbAdd, b: x.y + _hbAdd }; var bottomRightHb = { l: x.x + x.width - _hbAdd, t: x.y + x.height - _hbAdd, r: x.x + x.width + _hbAdd, b: x.y + x.height + _hbAdd }; var bottomLeftHb = { l: x.x - _hbAdd, t: x.y + x.height - _hbAdd, r: x.x + _hbAdd, b: x.y + x.height + _hbAdd }; var topHb = { l: x.x + _hbAdd, t: x.y - _hbAdd, r: x.x + x.width - _hbAdd, b: x.y + _hbAdd }; var rightHb = { l: x.x + x.width - _hbAdd, t: x.y + _hbAdd, r: x.x + x.width + _hbAdd, b: x.y + x.height - _hbAdd }; var bottomHb = { l: x.x + _hbAdd, t: x.y + x.height - _hbAdd, r: x.x + x.width - _hbAdd, b: x.y + x.height + _hbAdd }; var leftHb = { l: x.x - _hbAdd, t: x.y + _hbAdd, r: x.x + _hbAdd, b: x.y + x.height - _hbAdd }; } } } return osViewer; } )( viewImage || {}, jQuery ); Ã— Search results Close "},"viewImage_viewImage.drawRect.js.html":{"id":"viewImage_viewImage.drawRect.js.html","title":"Source: viewImage/viewImage.drawRect.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewImage/viewImage.drawRect.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which draws rectangles to the image to highlight areas. * * @version 3.2.0 * @module viewImage.drawRect * @requires jQuery */ var viewImage = ( function( osViewer ) { 'use strict'; var _debug = false; var drawingStyleClass = &quot;drawing&quot;; var _active = false; var _drawing = false; var _overlayGroup = null; var _finishHook = null; var _viewerInputHook = null; var _hbAdd = 5; var _minDistanceToExistingRect = 0.01; var _deleteOldDrawElement = true; var _drawElement = null; var _drawPoint = null; osViewer.drawRect = { init: function() { if ( _debug ) { console.log( '##############################' ); console.log( 'osViewer.drawRect.init' ); console.log( '##############################' ); } _viewerInputHook = osViewer.viewer.addViewerInputHook( { hooks: [ { tracker: &quot;viewer&quot;, handler: &quot;clickHandler&quot;, hookHandler: _disableViewerEvent // }, { // tracker: &quot;viewer&quot;, // handler: &quot;scrollHandler&quot;, // hookHandler: _disableViewerEvent }, { tracker: &quot;viewer&quot;, handler: &quot;dragHandler&quot;, hookHandler: _onViewerDrag }, { tracker: &quot;viewer&quot;, handler: &quot;pressHandler&quot;, hookHandler: _onViewerPress }, { tracker: &quot;viewer&quot;, handler: &quot;dragEndHandler&quot;, hookHandler: _onViewerDragEnd } ] } ); }, startDrawing: function( overlayGroup, finishHook ) { _active = true; _overlayGroup = overlayGroup; _finishHook = finishHook; }, endDrawing: function( removeLastElement ) { _active = false; _overlayGroup = null; _finishHook = null; if ( _drawElement &amp;&amp; removeLastElement ) { osViewer.viewer.removeOverlay( _drawElement ); } else { $( _drawElement ).removeClass( drawingStyleClass ); } }, isActive: function() { return _active; }, isDrawing: function() { return _drawing; }, removeLastDrawnElement: function() { if ( _drawElement ) { osViewer.viewer.removeOverlay( _drawElement ); } }, } function _onViewerPress( event ) { if ( _active ) { _drawPoint = osViewer.viewer.viewport.viewerElementToViewportCoordinates( event.position ); event.preventDefaultAction = false; return true; } } function _onViewerDrag( event ) { // if(_debug) { // console.log(&quot;Dragging: &quot;); // console.log(&quot;_active = &quot; + _active); // console.log(&quot;_drawing = &quot; + _drawing); // console.log(&quot;_drawPoint = &quot; + _drawPoint); // } if ( _drawing ) { var newPoint = osViewer.viewer.viewport.viewerElementToViewportCoordinates( event.position ); var rect = new OpenSeadragon.Rect( _drawPoint.x, _drawPoint.y, newPoint.x - _drawPoint.x, newPoint.y - _drawPoint.y ); if ( newPoint.x &lt; _drawPoint.x ) { rect.x = newPoint.x; rect.width = _drawPoint.x - newPoint.x; } if ( newPoint.y &lt; _drawPoint.y ) { rect.y = newPoint.y; rect.height = _drawPoint.y - newPoint.y; } osViewer.viewer.updateOverlay( _drawElement, rect, 0 ); event.preventDefaultAction = true; return true; } else if ( _active &amp;&amp; _drawPoint ) { var activeOverlay = osViewer.overlays.getDrawingOverlay(); if ( activeOverlay &amp;&amp; osViewer.transformRect &amp;&amp; osViewer.transformRect.isActive() &amp;&amp; osViewer.overlays.contains( activeOverlay.rect, _drawPoint, _minDistanceToExistingRect ) ) { _drawPoint = null; if ( _debug ) console.log( &quot;Action overlaps active overlay&quot; ); } else { _drawing = true; if ( activeOverlay &amp;&amp; _deleteOldDrawElement ) { osViewer.overlays.removeOverlay( activeOverlay ); } _drawElement = document.createElement( &quot;div&quot; ); if ( _overlayGroup ) { $( _drawElement ).addClass( _overlayGroup.styleClass ); } $( _drawElement ).addClass( drawingStyleClass ); var rect = new OpenSeadragon.Rect( _drawPoint.x, _drawPoint.y, 0, 0 ); osViewer.viewer.addOverlay( _drawElement, rect, 1 ); } event.preventDefaultAction = true; return true; } } function _onViewerDragEnd( event ) { if ( _drawing ) { _drawing = false; var newPoint = osViewer.viewer.viewport.viewerElementToViewportCoordinates( event.position ); var rect = new OpenSeadragon.Rect( _drawPoint.x, _drawPoint.y, newPoint.x - _drawPoint.x, newPoint.y - _drawPoint.y ); if ( newPoint.x &lt; _drawPoint.x ) { rect.x = newPoint.x; rect.width = _drawPoint.x - newPoint.x; } if ( newPoint.y &lt; _drawPoint.y ) { rect.y = newPoint.y; rect.height = _drawPoint.y - newPoint.y; } rect.hitBox = { l: rect.x - _hbAdd, t: rect.y - _hbAdd, r: rect.x + rect.width + _hbAdd, b: rect.y + rect.height + _hbAdd }; var overlay = { type: osViewer.overlays.overlayTypes.RECTANGLE, element: _drawElement, rect: rect, group: _overlayGroup.name, }; osViewer.overlays.setDrawingOverlay( overlay ); if ( _finishHook ) { _finishHook( overlay ); } event.preventDefaultAction = true; return true; } } function _disableViewerEvent( event ) { if ( _active ) { event.preventDefaultAction = true; return true; } } function checkForRectHit( point ) { var i; for ( i = 0; i &lt; _rects.length; i++ ) { var x = _rects[ i ]; if ( point.x &gt; x.hitBox.l &amp;&amp; point.x &lt; x.hitBox.r &amp;&amp; point.y &gt; x.hitBox.t &amp;&amp; point.y &lt; x.hitBox.b ) { var topLeftHb = { l: x.x - _hbAdd, t: x.y - _hbAdd, r: x.x + _hbAdd, b: x.y + _hbAdd }; var topRightHb = { l: x.x + x.width - _hbAdd, t: x.y - _hbAdd, r: x.x + x.width + _hbAdd, b: x.y + _hbAdd }; var bottomRightHb = { l: x.x + x.width - _hbAdd, t: x.y + x.height - _hbAdd, r: x.x + x.width + _hbAdd, b: x.y + x.height + _hbAdd }; var bottomLeftHb = { l: x.x - _hbAdd, t: x.y + x.height - _hbAdd, r: x.x + _hbAdd, b: x.y + x.height + _hbAdd }; var topHb = { l: x.x + _hbAdd, t: x.y - _hbAdd, r: x.x + x.width - _hbAdd, b: x.y + _hbAdd }; var rightHb = { l: x.x + x.width - _hbAdd, t: x.y + _hbAdd, r: x.x + x.width + _hbAdd, b: x.y + x.height - _hbAdd }; var bottomHb = { l: x.x + _hbAdd, t: x.y + x.height - _hbAdd, r: x.x + x.width - _hbAdd, b: x.y + x.height + _hbAdd }; var leftHb = { l: x.x - _hbAdd, t: x.y + _hbAdd, r: x.x + _hbAdd, b: x.y + x.height - _hbAdd }; } } } return osViewer; } )( viewImage || {}, jQuery ); Ã— Search results Close "},"viewImage_viewImage.measures.js.html":{"id":"viewImage_viewImage.measures.js.html","title":"Source: viewImage/viewImage.measures.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewImage/viewImage.measures.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which contains all image informations like size, scale etc. * * @version 3.2.0 * @module viewImage.Measures * @requires jQuery */ var viewImage = ( function( osViewer ) { 'use strict'; var _debug = false; osViewer.Measures = function( osViewer ) { this.config = osViewer.getConfig(); this.$container = $( &quot;#&quot; + this.config.global.divId ); this.outerCanvasSize = new OpenSeadragon.Point( this.$container.outerWidth(), this.$container.outerHeight() ); this.innerCanvasSize = new OpenSeadragon.Point( this.$container.width(), this.$container.height() ); this.originalImageSize = new OpenSeadragon.Point( this.getTotalImageWidth( osViewer.getImageInfo() ), this.getMaxImageHeight( osViewer.getImageInfo() ) ); // console.log(&quot;Original image size = &quot;, this.originalImageSize); this.footerHeight = this.config.global.footerHeight; this.rotation = osViewer.viewer != null ? osViewer.viewer.viewport.getRotation() : 0; this.xPadding = this.outerCanvasSize.x - this.innerCanvasSize.x; this.yPadding = this.outerCanvasSize.y - this.innerCanvasSize.y; this.innerCanvasSize.y -= this.footerHeight; // calculate image size as it should be displayed in relation to canvas size if ( this.fitToHeight() ) { this.imageDisplaySize = new OpenSeadragon.Point( this.innerCanvasSize.y / this.ratio( this.getRotatedSize( this.originalImageSize ) ), this.innerCanvasSize.y ) } else { this.imageDisplaySize = new OpenSeadragon.Point( this.innerCanvasSize.x, this.innerCanvasSize.x * this.ratio( this.getRotatedSize( this.originalImageSize ) ) ) } if ( this.rotated() ) { this.imageDisplaySize = this.getRotatedSize( this.imageDisplaySize ); } }; osViewer.Measures.prototype.getMaxImageWidth = function( imageInfo ) { var width = 0; if ( imageInfo &amp;&amp; imageInfo.length &gt; 0 ) { for ( var i = 0; i &lt; imageInfo.length; i++ ) { var tileSource = imageInfo[ i ]; if ( tileSource.tileSource ) { correction = tileSource.width; tileSource = tileSource.tileSource; } width = Math.max( width, tileSource.width * correction ); } } return width; }; osViewer.Measures.prototype.getMaxImageHeight = function( imageInfo ) { var height = 0; if ( imageInfo &amp;&amp; imageInfo.length &gt; 0 ) { for ( var i = 0; i &lt; imageInfo.length; i++ ) { var tileSource = imageInfo[ i ]; var correction = 1; if ( tileSource.tileSource ) { correction = tileSource.width; tileSource = tileSource.tileSource; } height = Math.max( height, tileSource.height * correction ); } } return height; }; osViewer.Measures.prototype.getTotalImageWidth = function( imageInfo ) { var width = 0; if ( imageInfo &amp;&amp; imageInfo.length &gt; 0 ) { for ( var i = 0; i &lt; imageInfo.length; i++ ) { var tileSource = imageInfo[ i ]; var correction = 1; if ( tileSource.tileSource ) { correction = tileSource.width; tileSource = tileSource.tileSource; } width += ( tileSource.width * correction ); } } return width; }; osViewer.Measures.prototype.getTotalImageHeight = function( imageInfo ) { var height = 0; if ( imageInfo &amp;&amp; imageInfo.length &gt; 0 ) { for ( var i = 0; i &lt; imageInfo.length; i++ ) { var tileSource = imageInfo[ i ]; var aspectRatio if ( tileSource.tileSource ) { correction = tileSource.width; tileSource = tileSource.tileSource; } height += tileSource.height * correction; } } return height; }; osViewer.Measures.prototype.getImageHomeSize = function() { var ratio = this.rotated() ? 1 / this.ratio( this.originalImageSize ) : this.ratio( this.originalImageSize ); if ( this.fitToHeight() ) { var height = this.innerCanvasSize.y; var width = height / ratio; } else { var width = this.innerCanvasSize.x; var height = width * ratio; } return this.getRotatedSize( new OpenSeadragon.Point( width, height ) ); }; osViewer.Measures.prototype.rotated = function() { return this.rotation % 180 !== 0; }; osViewer.Measures.prototype.landscape = function() { return this.ratio( this.originalImageSize ) &lt; 1; }; osViewer.Measures.prototype.ratio = function( size ) { return size.y / size.x; }; osViewer.Measures.prototype.getRotatedSize = function( size ) { return new OpenSeadragon.Point( this.rotated() ? size.y : size.x, this.rotated() ? size.x : size.y ); }; osViewer.Measures.prototype.fitToHeight = function() { return !this.config.global.adaptContainerHeight &amp;&amp; this.ratio( this.getRotatedSize( this.originalImageSize ) ) &gt; this.ratio( this.innerCanvasSize ); }; osViewer.Measures.prototype.resizeCanvas = function() { // Set height of container if required if ( this.config.global.adaptContainerHeight ) { if ( _debug ) { console.log( &quot;adapt container height&quot; ); } this.$container.height( this.getRotatedSize( this.imageDisplaySize ).y + this.footerHeight ); } this.outerCanvasSize = new OpenSeadragon.Point( this.$container.outerWidth(), this.$container.outerHeight() ); this.innerCanvasSize = new OpenSeadragon.Point( this.$container.width(), this.$container.height() - this.footerHeight ); }; osViewer.Measures.prototype.calculateExcessHeight = function() { var imageSize = this.getRotatedSize( this.getImageHomeSize() ); var excessHeight = this.config.global.adaptContainerHeight || this.fitToHeight() ? 0 : 0.5 * ( this.innerCanvasSize.y - imageSize.y ); return excessHeight; }; return osViewer; } )( viewImage || {}, jQuery ); Ã— Search results Close "},"viewImage_viewImage.overlays.js.html":{"id":"viewImage_viewImage.overlays.js.html","title":"Source: viewImage/viewImage.overlays.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewImage/viewImage.overlays.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which shows existing overlays on images. * * @version 3.2.0 * @module viewImage.overlays * @requires jQuery */ var viewImage = ( function( osViewer ) { 'use strict'; var _debug = false; var _focusStyleClass = 'focus'; var _highlightStyleClass = 'highlight'; var _overlayFocusHook = null; var _overlayClickHook = null; var _drawingOverlay = null; var _overlays = []; var _defaults = {}; var _initializedCallback = null; osViewer.overlays = { init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'osViewer.overlays.init' ); console.log( '##############################' ); } $.extend( true, _defaults, config ); osViewer.observables.overlayRemove.subscribe(function( event ) { if ( event.element ) { $( event.element ).remove(); } }); if(_defaults.image.highlightCoords) { osViewer.observables.viewerOpen.subscribe( function( data ) { for ( var index=0; index&lt;_defaults.image.highlightCoords.length; index++) { var highlightCoords = _defaults.image.highlightCoords[ index ]; var imageIndex = highlightCoords.pageIndex; osViewer.overlays.draw( highlightCoords.name, highlightCoords.displayTooltip, imageIndex); } if ( _initializedCallback ) { _initializedCallback(); } } ); } }, onInitialized: function( callback ) { var oldCallback = _initializedCallback; _initializedCallback = function() { if ( oldCallback ) { oldCallback(); } callback(); } }, onFocus: function( hook ) { var tempHook = _overlayFocusHook; _overlayFocusHook = function( overlay, focus ) { if ( tempHook ) tempHook( overlay, focus ); hook( overlay, focus ); } }, onClick: function( hook ) { var tempHook = _overlayClickHook; _overlayClickHook = function( overlay ) { if ( tempHook ) tempHook( overlay ); hook( overlay ); } }, getOverlays: function() { return _overlays.slice(); }, getRects: function() { return _overlays.filter( function( overlay ) { return overlay.type === osViewer.overlays.overlayTypes.RECTANGLE } ).slice(); }, getLines: function() { return _overlays.filter( function( overlay ) { return overlay.type === osViewer.overlays.overlayTypes.LINE } ).slice(); }, draw: function( group, displayTitle, imageIndex ) { if ( _debug ) { console.log( 'osViewer.overlays.draw: group - ' + group ); console.log( 'osViewer.overlays.draw: displayTitle - ' + displayTitle ); console.log( 'osViewer.overlays.draw: imageIndex - ' + imageIndex ); } var coordList = _defaults.getCoordinates( group ); if ( coordList ) { for ( var index=0; index&lt;coordList.coordinates.length; index++ ) { var coords = coordList.coordinates[ index ]; var title = displayTitle &amp;&amp; coords.length &gt; 4 ? coords[ 4 ] : ''; var id = coords.length &gt; 5 ? coords[ 5 ] : index; _createRectangle( coords[ 0 ], coords[ 1 ], coords[ 2 ] - coords[ 0 ], coords[ 3 ] - coords[ 1 ], title, id, group, imageIndex ); } } }, unDraw: function( group ) { if ( _debug ) { console.log( 'osViewer.overlays.unDraw: group - ' + group ); } var newRects = []; _overlays = _overlays.filter( function( overlay ) { if ( overlay.group === group ) { osViewer.viewer.removeOverlay( overlay.element ); return false; } else { return true; } } ); }, highlight: function( group ) { if ( _debug ) { console.log( 'osViewer.overlays.highlight: group - ' + group ); } _overlays.filter( function( overlay ) { return overlay.group === group; } ).forEach( function( overlay ) { if ( overlay.element ) { overlay.element.highlight( true ); } } ); }, unHighlight: function( group ) { if ( _debug ) { console.log( 'osViewer.overlays.unHighlight: group - ' + group ); } _overlays.filter( function( overlay ) { return overlay.group === group; } ).forEach( function( overlay ) { if ( overlay.element ) { overlay.element.highlight( false ); } } ); }, focusBox: function( group, id ) { if ( _debug ) { console.log( 'osViewer.overlays.highlightBox: group - ' + group ); console.log( 'osViewer.overlays.highlightBox: id - ' + id ); } _overlays.filter( function( overlay ) { return overlay.group === group; } ).forEach( function( overlay ) { if ( overlay.element ) { overlay.element.focus( overlay.id === id ); } } ); }, addOverlay: function( overlay ) { if ( _debug ) { console.log( 'osViewer.overlays.addOverlay: overlay - ' + overlay ); } _overlays.push( overlay ); if ( overlay.element ) { osViewer.viewer.updateOverlay( overlay.element, overlay.rect, 0 ); } }, removeOverlay: function( overlay ) { if ( overlay ) { if ( _debug ) console.log( &quot;Removing overlay &quot; + overlay.id ); var index = _overlays.indexOf( overlay ); _overlays.splice( index, 1 ); if ( overlay.element ) { osViewer.viewer.removeOverlay( overlay.element ); } } }, drawRect: function( rectangle, group, title, id ) { if ( _debug ) { console.log( 'osViewer.overlays.drawRect: rectangle - ' + rectangle ); console.log( 'osViewer.overlays.drawRect: group - ' + group ); } _createRectangle( rectangle.x, rectangle.y, rectangle.width, rectangle.height, title ? title : &quot;&quot;, id ? id : &quot;&quot;, group ); }, drawLine: function( point1, point2, group ) { if ( _debug ) { console.log( 'osViewer.overlays.drawLine: point1 - ' + point1 ); console.log( 'osViewer.overlays.drawLine: point2 - ' + point2 ); console.log( 'osViewer.overlays.drawLine: group - ' + group ); } _createLine( point1.x, point1.y, point2.x, point2.y, &quot;&quot;, &quot;&quot;, group ); }, showOverlay: function( overlay ) { if ( overlay &amp;&amp; !overlay.element ) { _drawOverlay( overlay ); if ( _overlayFocusHook ) { _overlayFocusHook( overlay, true ); } } }, hideOverlay: function( overlay ) { if ( overlay &amp;&amp; overlay.element &amp;&amp; _drawingOverlay != overlay ) { _undrawOverlay( overlay ); if ( _overlayFocusHook ) { _overlayFocusHook( overlay, false ); } } }, getOverlay: function( id, group ) { var overlay = _overlays.find( function( overlay ) { if ( group ) { return overlay.id === id &amp;&amp; overlay.group === group; } else { return overlay.id === id } } ); // console.log(&quot;search for overlay with id = &quot; + id); // console.log(&quot;Found overlay &quot;, overlay); return overlay; }, getCoordinates: function( overlay ) { if(_debug){ console.log(&quot;getCoordinates - overlay&quot;, overlay); } if ( overlay.type === osViewer.overlays.overlayTypes.RECTANGLE ) { var transformedRect = osViewer.viewer.viewport.viewportToImageRectangle( overlay.rect ); transformedRect = transformedRect.times( osViewer.getScaleToOriginalSize() ); return transformedRect; } else if ( overlay.type === osViewer.overlays.overlayTypes.LINE ) { var p1 = osViewer.viewer.viewport.viewportToImageCoordinates( overlay.poin1 ); var p2 = osViewer.viewer.viewport.viewportToImageCoordinates( overlay.poin2 ); return { point1: p1, point2: p2 }; } }, getDrawingOverlay: function() { return _drawingOverlay; }, setDrawingOverlay: function( overlay ) { _drawingOverlay = overlay; }, showHiddenOverlays: function() { osViewer.viewer.addViewerInputHook( { hooks: [ { tracker: &quot;viewer&quot;, handler: &quot;moveHandler&quot;, hookHandler: _onViewerMove } ] } ); }, contains: function( rect, point, precision ) { if ( precision == null ) { precision = 0; } return _isInside( rect, point, precision ); }, overlayTypes: { RECTANGLE: &quot;rectangle&quot;, LINE: &quot;line&quot; }, getRotated: function(point) { // var rotation = osViewer.viewer.viewport.getRotation(); // var center = osViewer.viewer.viewport.getCenter( true ); // point = point.rotate(-rotation, center); return point; } }; function _createLine( x1, y1, x2, y2, title, id, group ) { if ( _debug ) { console.log( '------------------------------' ); console.log( 'Overlays _createLine: x1 - ' + x1 ); console.log( 'Overlays _createLine: y1 - ' + y1 ); console.log( 'Overlays _createLine: x2 - ' + x2 ); console.log( 'Overlays _createLine: y2 - ' + y2 ); console.log( 'Overlays _createLine: title - ' + title ); console.log( 'Overlays _createLine: id - ' + id ); console.log( 'Overlays _createLine: group - ' + group ); console.log( '------------------------------' ); } x1 = osViewer.scaleToImageSize( x1 ); y1 = osViewer.scaleToImageSize( y1 ); x2 = osViewer.scaleToImageSize( x2 ); y2 = osViewer.scaleToImageSize( y2 ); var p1 = new OpenSeadragon.Point( x1, y1 ); var p2 = new OpenSeadragon.Point( x2, y2 ); var length = p1.distanceTo( p2 ); var angle = _calculateAngle( p1, p2 ); var beta = ( 180 - angle ) / 2; // console.log( &quot;drawing line with length = &quot; + length + &quot; and angle = &quot; + angle ); y1 += length / 2 * Math.sin( angle * Math.PI / 180 ); x1 -= length / 2 * Math.sin( angle * Math.PI / 180 ) / Math.tan( beta * Math.PI / 180 ); var rectangle = osViewer.viewer.viewport.imageToViewportRectangle( x1, y1, length, 1 ); var p1Viewer = osViewer.viewer.viewport.imageToViewportCoordinates( p1 ); var p2Viewer = osViewer.viewer.viewport.imageToViewportCoordinates( p2 ); var overlay = { type: osViewer.overlays.overlayTypes.LINE, rect: rectangle, angle: angle, point1: p1Viewer, point2: p2Viewer, group: group, id: id, title: title }; var overlayStyle = _defaults.getOverlayGroup( overlay.group ); if ( !overlayStyle.hidden ) { _drawOverlay( overlay ); } _overlays.push( overlay ); } /** * coordinates are in original image space */ function _createRectangle( x, y, width, height, title, id, group, imageIndex ) { if ( _debug ) { console.log( '------------------------------' ); console.log( 'Overlays _createRectangle: x - ' + x ); console.log( 'Overlays _createRectangle: y - ' + y ); console.log( 'Overlays _createRectangle: width - ' + width ); console.log( 'Overlays _createRectangle: height - ' + height ); console.log( 'Overlays _createRectangle: title - ' + title ); console.log( 'Overlays _createRectangle: id - ' + id ); console.log( 'Overlays _createRectangle: group - ' + group ); console.log( 'Overlays _createRectangle: imageIndex - ' + imageIndex ); console.log( '------------------------------' ); } x = osViewer.scaleToImageSize( x ); y = osViewer.scaleToImageSize( y ); width = osViewer.scaleToImageSize( width ); height = osViewer.scaleToImageSize( height ); if(!imageIndex) { imageIndex = 0; } var tiledImage = osViewer.viewer.world.getItemAt(imageIndex); var rectangle = tiledImage.imageToViewportRectangle( x, y, width, height ); // console.log(&quot;Found rect &quot;, rectangle); // var rectangle = osViewer.viewer.viewport.imageToViewportRectangle( x, y, width, height // ); var overlay = { type: osViewer.overlays.overlayTypes.RECTANGLE, rect: rectangle, group: group, id: id, title: title }; var overlayStyle = _defaults.getOverlayGroup( overlay.group ); if ( !overlayStyle.hidden ) { _drawOverlay( overlay ); } _overlays.push( overlay ); } function _undrawOverlay( overlay ) { osViewer.viewer.removeOverlay( overlay.element ); overlay.element = null; } function _drawOverlay( overlay ) { if(_debug) { console.log(&quot;viewImage.overlays._drawOverlay&quot;); console.log(&quot;overlay: &quot;, overlay); } var element = document.createElement( &quot;div&quot; ); $(element).attr(&quot;id&quot;, &quot;overlay_&quot; + overlay.id) var overlayStyle = _defaults.getOverlayGroup( overlay.group ); if ( overlayStyle ) { if(_debug)console.log(&quot;overlay style&quot;, overlayStyle); // element.title = overlay.title; // $( element ).attr( &quot;data-toggle&quot;, &quot;tooltip&quot; ); // $( element ).attr( &quot;data-placement&quot;, &quot;auto top&quot; ); $( element ).addClass( overlayStyle.styleClass ); if ( overlay.type === osViewer.overlays.overlayTypes.LINE ) { _rotate( overlay.angle, element ); } if ( overlayStyle.interactive ) { element.focus = function( focus ) { if ( focus ) { $( element ).addClass( _focusStyleClass ); _createTooltip(element, overlay); // tooltip.height(100); // $( element ).tooltip( &quot;show&quot; ); } else { $( element ).removeClass( _focusStyleClass ); $(&quot;.tooltipp#tooltip_&quot; + overlay.id).remove(); } if ( _overlayFocusHook ) { _overlayFocusHook( overlay, focus ); } }; element.highlight = function( focus ) { if ( focus ) { $( element ).addClass( _highlightStyleClass ); } else { $( element ).removeClass( _highlightStyleClass ); } }; $( element ).on( &quot;mouseover&quot;, function() { if ( _debug ) { console.log( 'Overlays _drawOverlay: mouse over - ' + overlayStyle.name ); } osViewer.overlays.focusBox( overlay.group, overlay.id ); } ); $( element ).on( &quot;mouseout&quot;, function() { if ( _debug ) { console.log( 'Overlays _drawOverlay: mouse out - ' + overlayStyle.name ); } element.focus( false ); } ); $( element ).on( &quot;click&quot;, function() { if ( _overlayClickHook ) { _overlayClickHook( overlay ); } } ); } overlay.element = element; osViewer.viewer.addOverlay( element, overlay.rect, 0 ); } } function _createTooltip(element, overlay) { if(overlay.title) { var canvasCorner = osViewer.sizes.$container.offset(); var top = $( element ).offset().top; var left = $( element ).offset().left; var bottom = top + $( element ).outerHeight(); var right = left + $( element ).outerWidth(); // console.log(&quot;Tooltip at &quot;, left, top, right, bottom); var $tooltip = $(&quot;&lt;div class='tooltipp'&gt;&quot; + overlay.title + &quot;&lt;/div&gt;&quot;); $(&quot;body&quot;).append($tooltip); var tooltipPadding = parseFloat($tooltip.css(&quot;padding-top&quot;)); $tooltip.css(&quot;max-width&quot;,right-left); $tooltip.css(&quot;top&quot;, Math.max(canvasCorner.top + tooltipPadding, top-$tooltip.outerHeight()-tooltipPadding)); $tooltip.css(&quot;left&quot;, Math.max(canvasCorner.left + tooltipPadding, left)); $tooltip.attr(&quot;id&quot;, &quot;tooltip_&quot; + overlay.id); // console.log(&quot;tooltip width = &quot;, $tooltip.width()); // listener for zoom osViewer.observables.animation .do(function() { // console.log(&quot;element at: &quot;, $(element).offset()); var top = Math.max($( element ).offset().top, canvasCorner.top); var left = Math.max($( element ).offset().left, canvasCorner.left); $tooltip.css(&quot;top&quot;, Math.max(canvasCorner.top + tooltipPadding, top-$tooltip.outerHeight()-tooltipPadding)); $tooltip.css(&quot;left&quot;, Math.max(canvasCorner.left + tooltipPadding, left)); }) .takeWhile(function() { return $(&quot;.tooltipp&quot;).length &gt; 0; }) .subscribe(); } } function _rotate( angle, mapElement ) { if ( _debug ) { console.log( 'Overlays _rotate: angle - ' + angle ); console.log( 'Overlays _rotate: mapElement - ' + mapElement ); } if ( angle !== 0 ) { $( mapElement ).css( &quot;-moz-transform&quot;, &quot;rotate(&quot; + angle + &quot;deg)&quot; ); $( mapElement ).css( &quot;-webkit-transform&quot;, &quot;rotate(&quot; + angle + &quot;deg)&quot; ); $( mapElement ).css( &quot;-ms-transform&quot;, &quot;rotate(&quot; + angle + &quot;deg)&quot; ); $( mapElement ).css( &quot;-o-transform&quot;, &quot;rotate(&quot; + angle + &quot;deg)&quot; ); $( mapElement ).css( &quot;transform&quot;, &quot;rotate(&quot; + angle + &quot;deg)&quot; ); var sin = Math.sin( angle ); var cos = Math.cos( angle ); $( mapElement ).css( &quot;filter&quot;, &quot;progid:DXImageTransform.Microsoft.Matrix(M11=&quot; + cos + &quot;, M12=&quot; + sin + &quot;, M21=-&quot; + sin + &quot;, M22=&quot; + cos + &quot;, sizingMethod='auto expand'&quot; ); } } function _calculateAngle( p1, p2 ) { if ( _debug ) { console.log( 'Overlays _calculateAngle: p1 - ' + p1 ); console.log( 'Overlays _calculateAngle: p2 - ' + p2 ); } var dx = p2.x - p1.x; var dy = p2.y - p1.y; var radians = null; if ( dx &gt; 0 ) { radians = Math.atan( dy / dx ); return radians * 180 / Math.PI; } else if ( dx &lt; 0 ) { radians = Math.atan( dy / dx ); return radians * 180 / Math.PI + 180; } else if ( dy &lt; 0 ) { return 270; } else { return 90; } } // function _getScaleToOriginalSize() { // var displaySize = osViewer.viewer.world.getItemAt(0).source.dimensions.x;// // osViewer.viewer.viewport.contentSize.x; // return osViewer.getImageInfo().width / displaySize; // } // // function _scaleToOriginalSize( value ) { // if ( _debug ) { // console.log( 'Overlays _scaleToOriginalSize: value - ' + value ); // } // // var displaySize = osViewer.viewer.world.getItemAt(0).source.dimensions.x;// // osViewer.viewer.viewport.contentSize.x; // return value / displaySize * osViewer.getImageInfo().width; // } // // function _scaleToImageSize( value ) { // if ( _debug ) { // console.log( 'Overlays _scaleToImageSize: value - ' + value ); // } // // var displaySize = osViewer.viewer.world.getItemAt(0).source.dimensions.x;// // osViewer.viewer.viewport.contentSize.x; // return value * displaySize / osViewer.getImageInfo().width; // } function _isInside( rect, point, extra ) { return point.x &gt; rect.x - extra &amp;&amp; point.x &lt; ( rect.x + rect.width + extra ) &amp;&amp; point.y &gt; rect.y - extra &amp;&amp; point.y &lt; ( rect.y + rect.height + extra ); } function _onViewerMove( event ) { var position = event.position; var ieVersion = viewerJS.helper.detectIEVersion(); if(ieVersion &amp;&amp; ieVersion === 10) { // console.log(&quot;Correct position for ie &quot;, ieVersion); position.x += $(window).scrollLeft(); position.y += $(window).scrollTop(); } // console.log( &quot;viewer move &quot;, position); var point = osViewer.viewer.viewport.viewerElementToViewportCoordinates( position ); _overlays.forEach( function( o ) { if ( _isInside( o.rect, point, 0 ) ) { osViewer.overlays.showOverlay( o ); } else { osViewer.overlays.hideOverlay( o ); } } ); } return osViewer; } )( viewImage || {}, jQuery ); Ã— Search results Close "},"viewImage_viewImage.readingMode.js.html":{"id":"viewImage_viewImage.readingMode.js.html","title":"Source: viewImage/viewImage.readingMode.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewImage/viewImage.readingMode.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which handles the viewer reading mode. * * @version 3.2.0 * @module viewImage.readingMode * @requires jQuery */ var viewImage = ( function( osViewer ) { 'use strict'; var _debug = false; var _localStoragePossible = true; var _activePanel = null; var _defaults = { navSelector: '.reading-mode__navigation', viewSelector: '#contentView', imageContainerSelector: '.reading-mode__content-view-image', imageSelector: '#readingModeImage', sidebarSelector: '#contentSidebar', sidebarToggleButton: '.reading-mode__content-sidebar-toggle', sidebarInnerSelector: '.reading-mode__content-sidebar-inner', sidebarTabsSelector: '.reading-mode__content-sidebar-tabs', sidebarTabContentSelector: '.tab-content', sidebarTocWrapperSelector: '.widget-toc-elem-wrapp', sidebarStatus: '', useTabs: true, useAccordeon: false, msg: {}, }; osViewer.readingMode = { /** * Method to initialize the viewer reading mode. * * @method init * @param {Object} config An config object which overwrites the defaults. * @param {String} config.navSelector A string which contains the selector for the * navigation. * @param {String} config.viewSelector A string which contains the selector for * the content view. * @param {String} config.imageContainerSelector A string which contains the * selector for the image container. * @param {String} config.imageSelector A string which contains the selector for * the image. * @param {String} config.sidebarSelector A string which contains the selector for * the sidebar. * @param {String} config.sidebarToggleButton A string which contains the selector * for the sidebar toggle button. * @param {String} config.sidebarInnerSelector A string which contains the * selector for the inner sidebar container. * @param {String} config.sidebarStatus A string which contains the current * sidebar status. */ init: function( config ) { if ( _debug ) { console.log( '##############################' ); console.log( 'osViewer.readingMode.init' ); console.log( '##############################' ); console.log( 'osViewer.readingMode.init: config - ', config ); } $.extend( true, _defaults, config ); // check local storage _localStoragePossible = viewerJS.helper.checkLocalStorage(); if ( _localStoragePossible ) { _defaults.sidebarStatus = localStorage.getItem( 'sidebarStatus' ); if ( _defaults.sidebarStatus === '' || _defaults.sidebarStatus === undefined ) { localStorage.setItem( 'sidebarStatus', 'true' ); } // set viewport _setViewportHeight(); if ( _defaults.useTabs ) { _setSidebarTabHeight(); } _setSidebarButtonPosition(); _checkSidebarStatus(); setTimeout( function() { _showContent(); }, 500 ); // save panel status if ( _defaults.useAccordeon ) { _activePanel = localStorage.getItem( 'activePanel' ); $( '.panel-collapse' ).each( function() { $( this ).removeClass( 'in' ); } ); if ( _activePanel === null ) { localStorage.setItem( 'activePanel', '#collapseOne' ); _activePanel = localStorage.getItem( 'activePanel' ); $( _activePanel ).addClass( 'in' ); } else { $( _activePanel ).addClass( 'in' ); } // click panel event $( 'a[data-toggle=&quot;collapse&quot;]' ).on( 'click', function() { var currPanel = $( this ).attr( 'href' ); localStorage.setItem( 'activePanel', currPanel ); } ); } // events $( '[data-toggle=&quot;sidebar&quot;]' ).on( 'click', function() { $( this ).toggleClass( 'in' ); $( this ).parents( '.reading-mode__content-sidebar' ).toggleClass( 'in' ); $( this ).parents( '.reading-mode__content-sidebar' ).prev().toggleClass( 'in' ); // set sidebar status to local storage _defaults.sidebarStatus = localStorage.getItem( 'sidebarStatus' ); if ( _defaults.sidebarStatus === 'false' ) { localStorage.setItem( 'sidebarStatus', 'true' ); } else { localStorage.setItem( 'sidebarStatus', 'false' ); } } ); $( window ).on( 'resize', function() { _setViewportHeight(); if ( _defaults.useTabs ) { _setSidebarTabHeight(); } _setSidebarButtonPosition(); } ); $( window ).on( &quot;orientationchange&quot;, function() { _setViewportHeight(); if ( _defaults.useTabs ) { _setSidebarTabHeight(); } _setSidebarButtonPosition(); } ); // AJAX Loader Eventlistener if ( typeof jsf !== 'undefined' ) { jsf.ajax.addOnEvent( function( data ) { var ajaxstatus = data.status; switch ( ajaxstatus ) { case &quot;success&quot;: _setViewportHeight(); if ( _defaults.useTabs ) { _setSidebarTabHeight(); } _setSidebarButtonPosition(); break; } } ); } } else { return false; } }, }; /** * Method which sets the height of the viewport elements. * * @method _setViewportHeight */ function _setViewportHeight() { if ( _debug ) { console.log( '---------- _setViewportHeight() ----------' ); console.log( '_setViewportHeight: view = ', _defaults.viewSelector ); console.log( '_setViewportHeight: image = ', _defaults.imageSelector ); console.log( '_setViewportHeight: sidebar = ', _defaults.sidebarSelector ); console.log( '_setViewportHeight: sidebarInner = ', _defaults.sidebarInnerSelector ); console.log( '_setViewportHeight: sidebarTabs = ', _defaults.sidebarTabsSelector ); } var viewportHeight = $( window ).outerHeight(); var navHeight = $( _defaults.navSelector ).outerHeight(); var newHeight = viewportHeight - navHeight; if ( _debug ) { console.log( '_setViewportHeight: viewportHeight = ', viewportHeight ); console.log( '_setViewportHeight: navHeight = ', navHeight ); console.log( '_setViewportHeight: newHeight = ', newHeight ); } $( _defaults.viewSelector ).css( 'height', newHeight ); $( _defaults.imageSelector ).css( 'height', newHeight ); $( _defaults.sidebarSelector ).css( 'height', newHeight ); $( _defaults.sidebarInnerSelector ).css( 'height', newHeight ); } /** * Method which sets the height of the sidebar Tabs. * * @method _setSidebarTabHeight */ function _setSidebarTabHeight() { if ( _debug ) { console.log( '---------- _setSidebarTabHeight() ----------' ); console.log( '_setSidebarTabHeight: sidebarTabs = ', _defaults.sidebarTabsSelector ); } var viewportHeight = $( window ).outerHeight(); var navHeight = $( _defaults.navSelector ).outerHeight(); var newHeight = viewportHeight - navHeight; var tabPos = $( _defaults.sidebarTabsSelector ).position(); var tabHeight = newHeight - tabPos.top - 15; var navTabsHeight = $( '.nav-tabs' ).outerHeight(); if ( _debug ) { console.log( '_setSidebarTabHeight: tabPos = ', tabPos ); console.log( '_setSidebarTabHeight: tabHeight = ', tabHeight ); } if ( viewportHeight &gt; 768 ) { $( _defaults.sidebarTabsSelector ).css( 'height', tabHeight ); $( _defaults.sidebarTabContentSelector ).css( 'height', tabHeight - navTabsHeight ); $( _defaults.sidebarTocWrapperSelector ).css( 'min-height', tabHeight - navTabsHeight ); } } /** * Method which sets the position of the sidebar toggle button. * * @method _setSidebarButtonPosition */ function _setSidebarButtonPosition() { if ( _debug ) { console.log( '---------- _setSidebarButtonPosition() ----------' ); console.log( '_setSidebarButtonPosition: view = ', _defaults.viewSelector ); } var viewHalfHeight = $( _defaults.viewSelector ).outerHeight() / 2; if ( _debug ) { console.log( '_setSidebarButtonPosition: viewHalfHeight = ', viewHalfHeight ); } $( _defaults.sidebarToggleButton ).css( 'top', viewHalfHeight ); } /** * Method which checks the current sidebar status, based on a local storage value. * * @method _checkSidebarStatus * @returns {Boolean} Returns false if the sidebar is inactive, returns true if the * sidebar is active. */ function _checkSidebarStatus() { if ( _debug ) { console.log( '---------- _checkSidebarStatus() ----------' ); console.log( '_checkSidebarStatus: sidebarStatus = ', _defaults.sidebarStatus ); } if ( _defaults.sidebarStatus === 'false' ) { $( '[data-toggle=&quot;sidebar&quot;]' ).removeClass( 'in' ); $( '.reading-mode__content-sidebar' ).removeClass( 'in' ).prev().removeClass( 'in' ); return false; } else { return true; } } /** * Method which shows the content by removing CSS-Classes after loading every page * element. * * @method _showContent */ function _showContent() { if ( _debug ) { console.log( '---------- _showContent() ----------' ); } $( _defaults.viewSelector ).removeClass( 'invisible' ); $( _defaults.sidebarSelector ).removeClass( 'invisible' ); } return osViewer; } )( viewImage || {}, jQuery ); Ã— Search results Close "},"viewImage_viewImage.tileSourceResolver.js.html":{"id":"viewImage_viewImage.tileSourceResolver.js.html","title":"Source: viewImage/viewImage.tileSourceResolver.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewImage/viewImage.tileSourceResolver.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which interprets the image information. * * @version 3.2.0 * @module viewImage.tileSourceResolver * @requires jQuery */ var viewImage = ( function( osViewer ) { 'use strict'; var _debug = false; osViewer.tileSourceResolver = { resolveAsJsonOrURI: function( imageInfo ) { var deferred = Q.defer(); if ( this.isJson( imageInfo ) ) { deferred.resolve( imageInfo ); } else if ( this.isStringifiedJson( imageInfo ) ) { deferred.resolve( JSON.parse( imageInfo ) ); } else { deferred.resolve( imageInfo ); } return deferred.promise; }, resolveAsJson: function( imageInfo ) { var deferred = Q.defer(); if ( this.isURI( imageInfo ) ) { if ( this.isJsonURI( imageInfo ) ) { return this.loadJsonFromURL( imageInfo ); } else { deferred.reject( &quot;Url does not lead to a json object&quot; ); } } else if ( typeof imageInfo === &quot;string&quot; ) { try { var json = JSON.parse( imageInfo ); deferred.resolve( json ); } catch ( error ) { deferred.reject( &quot;String does not contain valid json: &quot; + error ); } } else if ( typeof imageInfo === &quot;object&quot; ) { deferred.resolve( imageInfo ); } else { deferred.reject( &quot;Neither a url nor a json object&quot; ); } return deferred.promise; }, loadJsonFromURL: function( imageInfo ) { var deferred = Q.defer(); if ( this.isJsonURI( imageInfo ) ) { OpenSeadragon.makeAjaxRequest( imageInfo, // success function( request ) { try { deferred.resolve( JSON.parse( request.responseText ) ); } catch ( error ) { deferred.reject( error ) } }, // error function( error ) { deferred.reject( error ); } ) } else { deferred.reject( &quot;Not a json uri: &quot; + imageInfo ); } return deferred.promise; }, loadIfJsonURL: function( imageInfo ) { return Q.promise( function( resolve, reject ) { if ( osViewer.tileSourceResolver.isURI( imageInfo ) ) { var ajaxParams = { url: decodeURI( imageInfo ), type: &quot;GET&quot;, dataType: &quot;JSON&quot;, async: true, crossDomain: true, accepts: { application_json: &quot;application/json&quot;, application_jsonLd: &quot;application/ld+json&quot;, text_json: &quot;text/json&quot;, text_jsonLd: &quot;text/ld+json&quot;, } } Q( $.ajax( ajaxParams ) ).then( function( data ) { resolve( data ); } ).fail( function( error ) { reject( &quot;Failed to retrieve json from &quot; + imageInfo ); } ); setTimeout( function() { reject( &quot;Timeout after 10s&quot; ); }, 10000 ) } else { reject( &quot;Not a uri: &quot; + imageInfo ); } } ); }, isJsonURI: function( imageInfo ) { if ( this.isURI( imageInfo ) ) { var shortened = imageInfo.replace( /\\?.*/, &quot;&quot; ); if ( shortened.endsWith( &quot;/&quot; ) ) { shortened = shortened.substring( 0, shortened.length - 1 ); } return shortened.toLowerCase().endsWith( &quot;.json&quot; ); } return false; }, isURI: function( imageInfo ) { if ( imageInfo &amp;&amp; typeof imageInfo === &quot;string&quot; ) { if ( imageInfo.startsWith( &quot;http://&quot; ) || imageInfo.startsWith( &quot;https://&quot; ) || imageInfo.startsWith( &quot;file:/&quot; ) ) { return true; } } return false; }, isStringifiedJson: function( imageInfo ) { if ( imageInfo &amp;&amp; typeof imageInfo === &quot;string&quot; ) { try { var json = JSON.parse( imageInfo ); return this.isJson( json ); } catch ( error ) { // no json return false; } } return false; }, isJson: function( imageInfo ) { return imageInfo &amp;&amp; typeof imageInfo === &quot;object&quot;; }, } return osViewer; } )( viewImage || {}, jQuery ); Ã— Search results Close "},"viewImage_viewImage.transformRect.js.html":{"id":"viewImage_viewImage.transformRect.js.html","title":"Source: viewImage/viewImage.transformRect.js","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Source: viewImage/viewImage.transformRect.js /** * This file is part of the Goobi viewer - a content presentation and management * application for digitized objects. * * Visit these websites for more information. - http://www.intranda.com - * http://digiverso.com * * This program is free software; you can redistribute it and/or modify it under the terms * of the GNU General Public License as published by the Free Software Foundation; either * version 2 of the License, or (at your option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A * PARTICULAR PURPOSE. See the GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along with this * program. If not, see &lt;http://www.gnu.org/licenses/&gt;. * * Module which resizes existing rectangles on an image. * * @version 3.2.0 * @module viewImage.transformRect * @requires jQuery */ var viewImage = ( function( osViewer ) { 'use strict'; var DEFAULT_CURSOR = &quot;default&quot;; var _debug = false; var _drawingStyleClass = &quot;transforming&quot;; var _active = false; var _drawing = false; var _group = null; var _finishHook = null; var _viewerInputHook = null; var _hbAdd = 5; var _sideClickPrecision = 0.004; var _drawArea = &quot;&quot;; var _enterPoint = null; osViewer.transformRect = { init: function() { if ( _debug ) { console.log( '##############################' ); console.log( 'osViewer.transformRect.init' ); console.log( '##############################' ); } _viewerInputHook = osViewer.viewer.addViewerInputHook( { hooks: [ { tracker: &quot;viewer&quot;, handler: &quot;clickHandler&quot;, hookHandler: _disableViewerEvent // }, { // tracker : &quot;viewer&quot;, // handler : &quot;scrollHandler&quot;, // hookHandler : _disableViewerEvent }, { tracker: &quot;viewer&quot;, handler: &quot;dragHandler&quot;, hookHandler: _onViewerDrag }, { tracker: &quot;viewer&quot;, handler: &quot;pressHandler&quot;, hookHandler: _onViewerPress }, { tracker: &quot;viewer&quot;, handler: &quot;dragEndHandler&quot;, hookHandler: _onViewerDragEnd }, { tracker: &quot;viewer&quot;, handler: &quot;releaseHandler&quot;, hookHandler: _onViewerRelease }, { tracker: &quot;viewer&quot;, handler: &quot;moveHandler&quot;, hookHandler: _onViewerMove } ] } ); }, startDrawing: function( overlay, finishHook ) { if ( _debug ) console.log( &quot;Start drawing&quot; ); osViewer.overlays.setDrawingOverlay( overlay ); _active = true; _group = overlay.group; _finishHook = finishHook; $( overlay.element ).addClass( _drawingStyleClass ); }, endDrawing: function() { _drawing = false; _group = null; _finishHook = null; _active = false; var drawOverlay = osViewer.overlays.getDrawingOverlay(); if ( drawOverlay != null ) { $( drawOverlay.element ).removeClass( _drawingStyleClass ); $( drawOverlay.element ).css( { cursor: DEFAULT_CURSOR } ); } }, isActive: function() { return _active; }, hitAreas: { TOP: &quot;t&quot;, BOTTOM: &quot;b&quot;, RIGHT: &quot;r&quot;, LEFT: &quot;l&quot;, TOPLEFT: &quot;tl&quot;, TOPRIGHT: &quot;tr&quot;, BOTTOMLEFT: &quot;bl&quot;, BOTTOMRIGHT: &quot;br&quot;, CENTER: &quot;c&quot;, isCorner: function( area ) { return area === this.TOPRIGHT || area === this.TOPLEFT || area === this.BOTTOMLEFT || area === this.BOTTOMRIGHT; }, isEdge: function( area ) { return area === this.TOP || area === this.BOTTOM || area === this.LEFT || area === this.RIGHT; }, getCursor: function( area ) { var rotated = osViewer.viewer.viewport.getRotation() % 180 === 90; if ( area === this.TOPLEFT || area === this.BOTTOMRIGHT ) { return rotated ? &quot;nesw-resize&quot; : &quot;nwse-resize&quot;; } else if ( area === this.TOPRIGHT || area === this.BOTTOMLEFT ) { return rotated ? &quot;nwse-resize&quot; : &quot;nesw-resize&quot;; } else if ( area === this.TOP || area === this.BOTTOM ) { return rotated ? &quot;ew-resize&quot; : &quot;ns-resize&quot;; } else if ( area === this.RIGHT || area === this.LEFT ) { return rotated ? &quot;ns-resize&quot; : &quot;ew-resize&quot;; } else if ( area === this.CENTER ) { return &quot;move&quot;; } else { return DEFAULT_CURSOR; } } } } function _onViewerMove( event ) { if ( !_drawing &amp;&amp; _active ) { var drawPoint = osViewer.viewer.viewport.viewerElementToViewportCoordinates( event.position ); drawPoint = osViewer.overlays.getRotated( drawPoint ); var overlayRect = osViewer.overlays.getDrawingOverlay().rect; var overlayElement = osViewer.overlays.getDrawingOverlay().element; var viewerElement = osViewer.viewer.element; var area = _findCorner( overlayRect, drawPoint, _sideClickPrecision ); if ( !area ) { area = _findEdge( overlayRect, drawPoint, _sideClickPrecision ); } if ( !area &amp;&amp; osViewer.overlays.contains( overlayRect, drawPoint, 0 ) ) { area = osViewer.transformRect.hitAreas.CENTER; } if ( area ) { $( viewerElement ).css( { cursor: osViewer.transformRect.hitAreas.getCursor( area ) } ); } else { $( viewerElement ).css( { cursor: DEFAULT_CURSOR } ); } event.preventDefaultAction = true; return true; } } function _onViewerPress( event ) { if ( _active ) { if ( !osViewer.overlays.getDrawingOverlay() ) { return false; } var overlayRect = osViewer.overlays.getDrawingOverlay().rect; var overlayElement = osViewer.overlays.getDrawingOverlay().element; var drawPoint = osViewer.viewer.viewport.viewerElementToViewportCoordinates( event.position ); drawPoint = osViewer.overlays.getRotated( drawPoint ); var drawArea = _findCorner( overlayRect, drawPoint, _sideClickPrecision ); if ( !drawArea ) { drawArea = _findEdge( overlayRect, drawPoint, _sideClickPrecision ); } if ( !drawArea &amp;&amp; osViewer.overlays.contains( overlayRect, drawPoint, 0 ) ) { drawArea = osViewer.transformRect.hitAreas.CENTER; } if ( _debug ) console.log( &quot;draw area = &quot; + drawArea ); if ( drawArea ) { $( overlayElement ).tooltip( 'destroy' ); _enterPoint = drawPoint; } _drawArea = drawArea; event.preventDefaultAction = true; return true; } } function _onViewerDrag( event ) { if ( _drawing ) { var newPoint = osViewer.viewer.viewport.viewerElementToViewportCoordinates( event.position ); newPoint = osViewer.overlays.getRotated( newPoint ); var rect = osViewer.overlays.getDrawingOverlay().rect; var topLeft; var bottomRight; // if(_debug)console.log(&quot;Draw location = &quot; + newPoint); if ( _drawArea === osViewer.transformRect.hitAreas.TOPLEFT ) { topLeft = new OpenSeadragon.Point( Math.min( newPoint.x, rect.getBottomRight().x ), Math.min( newPoint.y, rect.getBottomRight().y ) ); bottomRight = rect.getBottomRight(); } else if ( _drawArea === osViewer.transformRect.hitAreas.TOPRIGHT ) { topLeft = new OpenSeadragon.Point( rect.getTopLeft().x, Math.min( newPoint.y, rect.getBottomRight().y ) ); bottomRight = new OpenSeadragon.Point( Math.max( newPoint.x, rect.getTopLeft().x ), rect.getBottomRight().y ); } else if ( _drawArea === osViewer.transformRect.hitAreas.BOTTOMLEFT ) { topLeft = new OpenSeadragon.Point( Math.min( newPoint.x, rect.getBottomRight().x ), rect.getTopLeft().y ); bottomRight = new OpenSeadragon.Point( rect.getBottomRight().x, Math.max( newPoint.y, rect.getTopLeft().y ) ); } else if ( _drawArea === osViewer.transformRect.hitAreas.BOTTOMRIGHT ) { topLeft = rect.getTopLeft(); bottomRight = new OpenSeadragon.Point( Math.max( newPoint.x, rect.getTopLeft().x ), Math.max( newPoint.y, rect.getTopLeft().y ) ); } else if ( _drawArea === osViewer.transformRect.hitAreas.LEFT ) { topLeft = new OpenSeadragon.Point( Math.min( newPoint.x, rect.getBottomRight().x ), rect.getTopLeft().y ); bottomRight = rect.getBottomRight(); } else if ( _drawArea === osViewer.transformRect.hitAreas.RIGHT ) { topLeft = rect.getTopLeft(); bottomRight = new OpenSeadragon.Point( Math.max( newPoint.x, rect.getTopLeft().x ), rect.getBottomRight().y ); } else if ( _drawArea === osViewer.transformRect.hitAreas.TOP ) { topLeft = new OpenSeadragon.Point( rect.getTopLeft().x, Math.min( newPoint.y, rect.getBottomRight().y ) ); bottomRight = rect.getBottomRight(); } else if ( _drawArea === osViewer.transformRect.hitAreas.BOTTOM ) { topLeft = rect.getTopLeft(); bottomRight = new OpenSeadragon.Point( rect.getBottomRight().x, Math.max( newPoint.y, rect.getTopLeft().y ) ); } else if ( _drawArea === osViewer.transformRect.hitAreas.CENTER &amp;&amp; _enterPoint ) { var dx = _enterPoint.x - newPoint.x; var dy = _enterPoint.y - newPoint.y; rect.x -= dx; rect.y -= dy; _enterPoint = newPoint; } if ( topLeft &amp;&amp; bottomRight ) { // if(_debug)console.log(&quot;Upper left point is &quot; + rect.getTopLeft()); // if(_debug)console.log(&quot;Lower right point is &quot; + rect.getBottomRight()); // if(_debug)console.log(&quot;Setting upper left point to &quot; + topLeft); // if(_debug)console.log(&quot;Setting lower right point to &quot; + bottomRight); rect.x = topLeft.x; rect.y = topLeft.y; rect.width = bottomRight.x - topLeft.x; rect.height = bottomRight.y - topLeft.y; } osViewer.viewer.updateOverlay( osViewer.overlays.getDrawingOverlay().element, rect, 0 ); event.preventDefaultAction = true; return true; } else if ( _drawArea ) { _drawing = true; event.preventDefaultAction = true; return true; } } function _onViewerRelease( event ) { if ( _active ) { if ( _drawing &amp;&amp; _finishHook ) { _finishHook( osViewer.overlays.getDrawingOverlay() ); } _drawing = false; if ( osViewer.overlays.getDrawingOverlay() ) { $( osViewer.overlays.getDrawingOverlay().element ).tooltip(); } _drawArea = &quot;&quot;; _enterPoint = null; event.preventDefaultAction = true; return true; } } function _onViewerDragEnd( event ) { if ( _drawing ) { _drawing = false; event.preventDefaultAction = true; return true; } } function _disableViewerEvent( event ) { if ( _drawing ) { event.preventDefaultAction = true; return true; } } function checkForRectHit( point ) { var i; for ( i = 0; i &lt; _rects.length; i++ ) { var x = _rects[ i ]; if ( point.x &gt; x.hitBox.l &amp;&amp; point.x &lt; x.hitBox.r &amp;&amp; point.y &gt; x.hitBox.t &amp;&amp; point.y &lt; x.hitBox.b ) { var topLeftHb = { l: x.x - _hbAdd, t: x.y - _hbAdd, r: x.x + _hbAdd, b: x.y + _hbAdd }; var topRightHb = { l: x.x + x.width - _hbAdd, t: x.y - _hbAdd, r: x.x + x.width + _hbAdd, b: x.y + _hbAdd }; var bottomRightHb = { l: x.x + x.width - _hbAdd, t: x.y + x.height - _hbAdd, r: x.x + x.width + _hbAdd, b: x.y + x.height + _hbAdd }; var bottomLeftHb = { l: x.x - _hbAdd, t: x.y + x.height - _hbAdd, r: x.x + _hbAdd, b: x.y + x.height + _hbAdd }; var topHb = { l: x.x + _hbAdd, t: x.y - _hbAdd, r: x.x + x.width - _hbAdd, b: x.y + _hbAdd }; var rightHb = { l: x.x + x.width - _hbAdd, t: x.y + _hbAdd, r: x.x + x.width + _hbAdd, b: x.y + x.height - _hbAdd }; var bottomHb = { l: x.x + _hbAdd, t: x.y + x.height - _hbAdd, r: x.x + x.width - _hbAdd, b: x.y + x.height + _hbAdd }; var leftHb = { l: x.x - _hbAdd, t: x.y + _hbAdd, r: x.x + _hbAdd, b: x.y + x.height - _hbAdd }; } } } /* * Determine the side of the rectangle rect the point lies on or closest at &lt;=maxDist * distance */ function _findEdge( rect, point, maxDist ) { var distanceToLeft = _distToSegment( point, rect.getTopLeft(), rect.getBottomLeft() ); var distanceToBottom = _distToSegment( point, rect.getBottomLeft(), rect.getBottomRight() ); var distanceToRight = _distToSegment( point, rect.getTopRight(), rect.getBottomRight() ); var distanceToTop = _distToSegment( point, rect.getTopLeft(), rect.getTopRight() ); var minDistance = Math.min( distanceToLeft, Math.min( distanceToRight, Math.min( distanceToTop, distanceToBottom ) ) ); if ( minDistance &lt;= maxDist ) { if ( distanceToLeft === minDistance ) { return osViewer.transformRect.hitAreas.LEFT; } if ( distanceToRight === minDistance ) { return osViewer.transformRect.hitAreas.RIGHT; } if ( distanceToTop === minDistance ) { return osViewer.transformRect.hitAreas.TOP; } if ( distanceToBottom === minDistance ) { return osViewer.transformRect.hitAreas.BOTTOM; } } return &quot;&quot;; } /* * Determine the cornder of the rectangle rect the point lies on or closest at * &lt;=maxDist distance */ function _findCorner( rect, point, maxDist ) { var distanceToTopLeft = _dist( point, rect.getTopLeft() ); var distanceToBottomLeft = _dist( point, rect.getBottomLeft() ); var distanceToTopRight = _dist( point, rect.getTopRight() ); var distanceToBottomRight = _dist( point, rect.getBottomRight() ); var minDistance = Math.min( distanceToTopLeft, Math.min( distanceToTopRight, Math.min( distanceToBottomLeft, distanceToBottomRight ) ) ); if ( minDistance &lt;= maxDist ) { if ( distanceToTopLeft === minDistance ) { return osViewer.transformRect.hitAreas.TOPLEFT; } if ( distanceToTopRight === minDistance ) { return osViewer.transformRect.hitAreas.TOPRIGHT; } if ( distanceToBottomLeft === minDistance ) { return osViewer.transformRect.hitAreas.BOTTOMLEFT; } if ( distanceToBottomRight === minDistance ) { return osViewer.transformRect.hitAreas.BOTTOMRIGHT; } } return &quot;&quot;; } function _sqr( x ) { return x * x } function _dist2( v, w ) { return _sqr( v.x - w.x ) + _sqr( v.y - w.y ) } function _dist( v, w ) { return Math.sqrt( _dist2( v, w ) ) } function _distToSegmentSquared( p, v, w ) { var l2 = _dist2( v, w ); if ( l2 == 0 ) return _dist2( p, v ); var t = ( ( p.x - v.x ) * ( w.x - v.x ) + ( p.y - v.y ) * ( w.y - v.y ) ) / l2; if ( t &lt; 0 ) return _dist2( p, v ); if ( t &gt; 1 ) return _dist2( p, w ); return _dist2( p, { x: v.x + t * ( w.x - v.x ), y: v.y + t * ( w.y - v.y ) } ); } function _distToSegment( point, lineP1, lineP2 ) { return Math.sqrt( _distToSegmentSquared( point, lineP1, lineP2 ) ); } return osViewer; } )( viewImage || {}, jQuery ); Ã— Search results Close "},"global.html":{"id":"global.html","title":"Global","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Global Members Statistics This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Methodensammlung fÃ¼r Statistik-Graphen mit jqplot Implementierte Graphen: PublicationTypes MostEditedWorks NumberOfPages MostImportedWorksTrend *CrowdSourcingProgress Jeder Graph muss mit Statistics..init(config)initiallisiert werden. Das config-Objekt enthÃ¤lt dabei die zugrundeliegenden Daten.AnschlieÃŸend kann der Graph mit Statistics..plot(divId) gemalt werden. UmMouseover-Anzeige zu verwenden, muss sie mit Statistics.initMouseover(document, window)initialisiert werden Um fÃ¼r PublicationTypes aud Mausklick eine Suche nach passendenWerken zu starten muss dies mit initSearchQuery(plotId, inputId, buttonId)initialisiert werden Version: 3.2.0 Source: statistics/statistics.js, line 32 Methods _addAutomaticNamedBookshelf(root) Method to add a automatic named bookshelf to the user account. Parameters: Name Type Description root String The application root path. Source: viewer.js, line 1010 Returns: A promise that checks the existing items. Type Promise _addBookshelfItemByPi(root, id, pi) Method to add an item to the user bookshelf by PI. Parameters: Name Type Description root String The application root path. id String The current bookshelf id. pi String The pi of the item to add. Source: viewer.js, line 930 Returns: A promise that checks the existing items. Type Promise _addBookshelfItemByPiLogidPage(root, id, pi, logid, page) Method to add an item with PI, LOGID and PAGE to the user bookshelf. Parameters: Name Type Description root String The application root path. id String The current bookshelf id. pi String The pi of the item to add. logid String The logid of the item to add. page String The page of the item to add. Source: viewer.js, line 956 Returns: A promise that checks the existing items. Type Promise _addNamedBookshelf(root, name) Method to add a named bookshelf to the user account. Parameters: Name Type Description root String The application root path. name String The name of the bookshelf. Source: viewer.js, line 986 Returns: A promise that checks the existing items. Type Promise _addSessionBookshelf(root) Method to add the session bookshelf to the user account with an automatic generatedname. Parameters: Name Type Description root String The application root path. Source: viewer.js, line 1032 Returns: A promise that checks the existing items. Type Promise _addSessionBookshelfNamed(root) Method to add the session bookshelf to the user account with a given name. Parameters: Name Type Description root String The application root path. Source: viewer.js, line 1055 Returns: A promise that checks the existing items. Type Promise _buildGrid(data) Method to build the elements of the static grid. Parameters: Name Type Description data Object A JSON data object which contains the image informations. Source: viewer.js, line 8167 Returns: An jQuery object which contains all grid elements. Type Object _buildPopover(data, id) Returns an HTML-String which renders the fetched data into a popover. Parameters: Name Type Description data Object The JSON-Object which includes the data. id String The incremented id of the popover. Source: viewer.js, line 4841 Returns: The HTML-String with the fetched data. Type String _calcSubMenuPosition(menu) Method to calculate the position of the shown submenu. Parameters: Name Type Description menu Object An jQuery object of the current submenu. Source: viewer.js, line 3384 _calculateFirstLevelPopoverPosition(id, pos, $Obj) Sets the position to the first level popovers. Parameters: Name Type Description id String The incremented id of the popover. pos Object An Object with the current position oft the clicked link. $Obj Object An jQuery-Object of the clicked link. Source: viewer.js, line 4907 _calculateNerPopoverPosition(triggerCoords, textBoxCoords) Method which calculates the position of the popover in the DOM. Parameters: Name Type Description triggerCoords Object A jQuery object including the position of the clickedtrigger. textBoxCoords Object A jQuery object including the position of the parentDIV. Source: viewer.js, line 4649 Returns: An object which includes the position of the popover. Type Object _calculatePopoverPosition(triggerCoords, tmCanvasCoords) Method which calculates the position of the popover. Parameters: Name Type Description triggerCoords Object An object which contains the coordinates of theelement has been clicked. tmCanvasCoords Object An object which contains the coordinates of thewrapper element from the timematrix. Source: viewer.js, line 6498 Returns: An object which contains the top and the left position of thepopover. Type Object _centerModalBox($Obj) Puts the lightbox to the center of the screen. Parameters: Name Type Description $Obj Object Must be a jQuery-Object like $('.something') Source: viewer.js, line 6145 _changePos(item, diff) (Privat) Method which Parameters: Name Type Description item Object diff String Source: viewer.js, line 7868 _checkSidebarStatus() Method which checks the current sidebar status, based on a local storage value. Source: viewImage.js, line 2419 Returns: Returns false if the sidebar is inactive, returns true if thesidebar is active. Type Boolean _cleanUpLocalStorage() Method which removes all set local storage values. Source: viewer.js, line 4332 _closeAllNormdataPopovers() Removes all popovers from the DOM on click. Source: viewer.js, line 4977 _closeNormdataPopover() Removes current popover from the DOM on click. Source: viewer.js, line 4955 _createListElement(value, $parent, count) Method to ... Parameters: Name Type Description value String ... $parent Object ... count Number Source: viewer.js, line 8530 _createTagInputElement($parent) Method to ... Parameters: Name Type Description $parent Object ... Source: viewer.js, line 8570 _dateConverter(str) Converts a date to this form: 16. November 2015 Parameters: Name Type Description str String The date to convert. Source: viewer.js, line 2298 Returns: The new formated date. Type String _degradeFontSize(current) Method to degrade the page font-size. Parameters: Name Type Description current Number The current font-size of the HTML-Element. Source: viewer.js, line 1843 _deleteAllSessionElements(root) Method to delete all elements from watchlist in current session (user not loggedin). Parameters: Name Type Description root String The application root path. Source: viewer.js, line 641 _deleteBookshelfById(root, id) Method to delete a bookshelf by ID. Parameters: Name Type Description root String The application root path. id String The current bookshelf id. Source: viewer.js, line 1329 Returns: A promise that checks the existing items. Type Promise _deleteBookshelfItemByPi(root, id, pi) Method to delete an item from the user bookshelf by PI. Parameters: Name Type Description root String The application root path. id String The current bookshelf id. pi String The pi of the item to add. Source: viewer.js, line 1273 Returns: A promise that checks the existing items. Type Promise _deleteBookshelfItemByPiLogidPage(root, id, pi, logid, page) Method to delete an item with PI, LOGID and PAGE from the user bookshelf. Parameters: Name Type Description root String The application root path. id String The current bookshelf id. pi String The pi of the item to add. logid String The logid of the item to add. page String The page of the item to add. Source: viewer.js, line 1299 Returns: A promise that checks the existing items. Type Promise _deleteSessionElement(root, pi) Method to delete an element from watchlist in current session (user not logged in). Parameters: Name Type Description root String The application root path. pi String The persistent identifier of the saved element. Source: viewer.js, line 618 _getAllBookshelves(root) Method to get all user bookshelves. Parameters: Name Type Description root String The application root path. Source: viewer.js, line 1079 Returns: A promise that checks the existing items. Type Promise _getAllSessionElements(root) Method to get all elements in watchlist from current session (user not logged in). Parameters: Name Type Description root String The application root path. Source: viewer.js, line 545 Returns: An JSON-Object which contains all session elements. Type Object _getApiUrl(id) Method to get the full REST-API URL. Parameters: Name Type Description id String The current IDDoc of the hit set. Source: viewer.js, line 5700 Returns: The full REST-API URL. Type String _getBookshelfById(root, id) Method to get a bookshelf by id. Parameters: Name Type Description root String The application root path. id String The current bookshelf id. Source: viewer.js, line 1101 Returns: A promise that checks the existing items. Type Promise _getBookshelfItemCount(root, id) Method to get the number of items in the selected bookshelf. Parameters: Name Type Description root String The application root path. id String The current bookshelf id. Source: viewer.js, line 1125 Returns: A promise that checks the existing items. Type Promise _getCenterCoords(infos) Method which returns an array of coordinates for centering the map. Parameters: Name Type Description infos String A JSON-String which contains the feature infos. Source: viewer.js, line 7237 Returns: An array of coords. Type Array _getContainingBookshelfItemByPi(root, pi) Method to check if an item by PI if it's in user bookshelf. It returns thebookshelves or false if no items are in list. Parameters: Name Type Description root String The application root path. pi String The pi of the current item. Source: viewer.js, line 1193 Returns: A promise that checks the existing items. Type Promise _getContainingBookshelfItemByPiLogidPage(root, pi) Method to check if an item by PI, LOGID and PAGE if it's in user bookshelf. Itreturns the bookshelves or false if no items are in list. Parameters: Name Type Description root String The application root path. pi String The pi of the current item. Source: viewer.js, line 1218 Returns: A promise that checks the existing items. Type Promise _getImageName($Obj) Returns the image name from the 'data-imgname' attribute. Parameters: Name Type Description $Obj Object Must be a jQuery-Object like $('.something') Source: viewer.js, line 6109 Returns: The image name from the 'data-imgname' attribute. Type String _getImagePath($Obj) Returns the image path from the 'data-imgpath' attribute. Parameters: Name Type Description $Obj Object Must be a jQuery-Object like $('.something') Source: viewer.js, line 6095 Returns: The image path from the 'data-imgpath' attribute. Type String _getJQueryItem(element) (Privat) Method which Parameters: Name Type Description element Object Source: viewer.js, line 7825 _getLevel(item) (Privat) Method which Parameters: Name Type Description item Object Source: viewer.js, line 7845 _getMapFeatures(infos) Method which returns an object of map features. Parameters: Name Type Description infos String A JSON-String which contains the feature infos. Source: viewer.js, line 7192 Returns: An array of features. Type Array _getPageCount(work) Method which returns the page count of the current work. Parameters: Name Type Description work Object The current wor object. Source: viewer.js, line 4302 Returns: The page count of the current work. Type Number _getPopoverContent(data, config) Method to render the popover content. Parameters: Name Type Description data Object A JSON-Object which contains the necessary data. config Object The config object of the module. Source: viewer.js, line 1715 Returns: The HTML-String of the popover content. Type String _getPublicBookshelves(root) Method to get all public bookshelves. Parameters: Name Type Description root String The application root path. Source: viewer.js, line 1149 Returns: A promise that checks the existing items. Type Promise _getRemoteData(target) Method which fetches data from the API and returns an JSON object. Parameters: Name Type Description target String The API call URL. Source: viewer.js, line 4428 Returns: The JSON object with the API data. Type Object _getRemoteData() Returns an JSON object from a API call. Source: viewer.js, line 5013 Returns: The JSON object with the API data. Type Object _getSharedBookshelves(root) Method to get all shared bookshelves. Parameters: Name Type Description root String The application root path. Source: viewer.js, line 1171 Returns: A promise that checks the existing items. Type Promise _handleBeforeDropFromAvailable(event, ui) (Privat) Method which Parameters: Name Type Description event String ui String Source: viewer.js, line 7686 _handleBeforeDropFromAvailable(event, ui) (Privat) Method which Parameters: Name Type Description event String ui String Source: viewer.js, line 7723 _handleClickTerminator(event) Method to ... Parameters: Name Type Description event Object ... Source: viewer.js, line 8657 _handleDrop() (Privat) Method which Source: viewer.js, line 7742 _handleInputChange(event, text) Method to ... Parameters: Name Type Description event Object ... text String ... Source: viewer.js, line 8630 _hideCurrentTags() Method which hides the current tag row tooltip. Source: viewer.js, line 3939 _initNerPopover(path) Method which initializes the events for the NER-Popovers. Parameters: Name Type Description path String The root path of the application. Source: viewer.js, line 4461 _isElementSet(root, pi) Method to check if element is in list (user not logged in). Parameters: Name Type Description root String The application root path. pi String The persistent identifier of the saved element. Source: viewer.js, line 567 Returns: True if element is set. Type Boolean _isItemInBookshelf(object, pi) Method to check if item is in any bookshelf. Parameters: Name Type Description object Object An jQuery-Object of the current item. pi String The current PI of the selected item. Source: viewer.js, line 1618 _parseFontSize(string) Method which parses a given pixel value to a number and returns it. Parameters: Name Type Description string String The string to parse. Source: viewer.js, line 1901 _raiseFontSize(current) Method to raise the page font-size. Parameters: Name Type Description current Number The current font-size of the HTML-Element. Source: viewer.js, line 1872 _readTags($input) Method to ... Parameters: Name Type Description $input Object ... Source: viewer.js, line 8439 _removeNerPopover() Method to remove a popover from the DOM. Source: viewer.js, line 4686 _removePopovers() Method which removes all popovers. Source: viewer.js, line 6557 _renderBookshelfNavigationList() Method to render the element list in bookshelf navigation. Source: viewer.js, line 1535 _renderBookshelfPopoverList(pi) Method to render the element list in bookshelf popover. Parameters: Name Type Description pi String The current PI of the selected item. Source: viewer.js, line 1448 _renderBookshelfPopup(pi, logid, page, pos, size) Method to render a popup which contains bookshelf actions. Parameters: Name Type Description pi String The pi of the item to add. logid String The logid of the item to add. page String The page of the item to add. pos Object The position of the clicked button. size Object The width and height of the clicked button. Source: viewer.js, line 1354 _renderChildHits(data, $this) Method which renders the child hits into the DOM. Parameters: Name Type Description data Object The data object which contains the child hits. $this Object The current child hits trigger. Source: viewer.js, line 5716 Returns: An jquery object which contains the child hits. Type Object _renderCollections(data) Method which renders the collection accordion. Parameters: Name Type Description data Object The RSS information data object. Source: viewer.js, line 7960 _renderDropdownList() Method to render the element list in bookshelf dropdown (user not logged in). Source: viewer.js, line 683 _renderFeed(data) Renders the feed and appends it to the wrapper. Parameters: Name Type Description data Object An JSON object of the feed data. Source: viewer.js, line 2267 _renderGetMoreChildren() Method to render a get more children link. Source: viewer.js, line 5916 _renderHitSetTitle(data) Method which renders the hit set title. Parameters: Name Type Description data Object The data object which contains the hit set title values. Source: viewer.js, line 5759 Returns: A jquery object which contains the hit set title. Type Object _renderList(tags, $ul) Method to ... Parameters: Name Type Description tags Array ... $ul Object ... Source: viewer.js, line 8505 _renderMasonryGrid(data) Method which renders the masonry grid. Parameters: Name Type Description data Object An data object which contains the images sources for the grid. Source: viewer.js, line 7340 _renderMetdataInfo(data, url) Method which renders metadata info. Parameters: Name Type Description data Object The data object which contains the sub hit values. url String The URL for the current work. Source: viewer.js, line 5790 Returns: A jquery object which contains the metadata info. Type Object _renderNerPopover(data, position, title, path) Method which renders a popover to the DOM. Parameters: Name Type Description data Object The JSON object from the API. position Object A jQuery object including the position of the clickedtrigger. title String The value of the title attribute from the clicked trigger. path String The root path of the application. Source: viewer.js, line 4510 Returns: The HTML string which renders the popover. Type String _renderNerPopoverDetail(data, title) Method which renders detail information into the popover. Parameters: Name Type Description data Object The JSON object from the API. title String The value of the title attribute from the clicked trigger. Source: viewer.js, line 4602 Returns: The HTML string which renders the details. Type String _renderOverview(data) Method to render the NER overview. Parameters: Name Type Description data Object A JSON-Object. Source: viewer.js, line 3804 Returns: A HTML-String which renders the overview. Type Sting _renderPageBubble(page) Method which renders a span showing the current page section. Parameters: Name Type Description page Number The current pagenumber. Source: viewer.js, line 4222 _renderPopover($Obj, lang) Method to render a popover with a thumbnail image. Parameters: Name Type Description $Obj Object Must be an jQuery-Object like $(this). lang Object An Object with localized strings in the selected language. Source: viewer.js, line 6456 _renderPopoverAction($Obj, id) Method which executes the click event action of the popover. Parameters: Name Type Description $Obj Object The jQuery object of the current clicked link. id String The current id of the popover. Source: viewer.js, line 4781 _renderRssFeed(data) Method which renders the RSS feed into the DOM. Parameters: Name Type Description data Object The RSS information data object. Source: viewer.js, line 7466 _renderSection(data) Method to render the NER section. Parameters: Name Type Description data Object A JSON-Object. Source: viewer.js, line 3948 _renderSectionTags(data) Method which renders the tags in the section area. Parameters: Name Type Description data Object A JSON-Object. Source: viewer.js, line 4178 Returns: A HTML-String which renders the tag section. Type Sting _renderSliderBubble(time, val) Method which renders the bubbles for the slider. Parameters: Name Type Description time String The string for the time value. val String The string for the value. Source: viewer.js, line 6540 Returns: HTML-String which renders the slider-bubble. Type String _renderSubChildHits(data, type) Method which renders sub child hits. Parameters: Name Type Description data Object The data object which contains the sub hit values. type String The type of hit to render. Source: viewer.js, line 5847 Returns: A jquery object which contains the sub child hits. Type Object _renderSubCollections(url) Method which renders the subcollections. Parameters: Name Type Description url String The URL to the API which fetches the subcollection data. Source: viewer.js, line 8064 Returns: The HTML string of the subcollections. Type String _renderThumbs(json) Method to render image thumbnails to the timematrix canvas. Parameters: Name Type Description json Object An JSON-Object which contains the image data. Source: viewer.js, line 6418 Returns: HTML-String which displays the image thumbnails. Type String _resetFacettingIcons() Method which resets all facetting icons to default Source: viewer.js, line 4318 _resetMenus() Method to reset all shown menus. Source: viewer.js, line 3358 _resetSubMenus() Method to reset all shown submenus. Source: viewer.js, line 3374 _saveFontSize(size) Method to save the current font-size to local storage as a string. Parameters: Name Type Description size String The String to save in local storage. Source: viewer.js, line 1916 _scrollPage(anchor) Method which scrolls the page animated. Parameters: Name Type Description anchor String The name of the anchor to scroll to. Source: viewer.js, line 5082 _serializeVisibleItems() (Privat) Method which Source: viewer.js, line 7896 _setAddActiveState() Method to set the active state of add buttons (user not logged in). Source: viewer.js, line 779 _setAddedStatus() Method to set an 'added' status to an object. Source: viewer.js, line 1601 _setBookshelfName(root, id, name) Method to set the name of a bookshelf. Parameters: Name Type Description root String The application root path. id String The current bookshelf id. name String The name of the bookshelf. Source: viewer.js, line 1246 Returns: A promise that checks the existing items. Type Promise _setButtonState() Method to set the state of the font-size change buttons. Source: viewer.js, line 1951 _setFontSize() Method to set the current font-size from local storage to the HTML-Element. Source: viewer.js, line 1931 _setSessionElement(root, pi) Method to add an elements to watchlist in current session (user not logged in). Parameters: Name Type Description root String The application root path. pi String The persistent identifier of the saved element. Source: viewer.js, line 593 _setSessionElementCount(root) Method to set the count of elements in watchlist from current session (user notlogged in). Parameters: Name Type Description root String The application root path. Source: viewer.js, line 665 _setSidebarButtonPosition() Method which sets the position of the sidebar toggle button. Source: viewImage.js, line 2398 _setSidebarTabHeight() Method which sets the height of the sidebar Tabs. Source: viewImage.js, line 2368 _setupLightBox(path, name) Returns a HTML-String which renders the lightbox. Parameters: Name Type Description path String The path to the big image. name String The name of the big image. Source: viewer.js, line 6123 Returns: The HTML-Code to render the lightbox. Type String _setViewportHeight() Method which sets the height of the viewport elements. Source: viewImage.js, line 2336 _showContent() Method which shows the content by removing CSS-Classes after loading every pageelement. Source: viewImage.js, line 2444 _showCurrentTags($obj) Method which shows the current tag row in a tooltip. Parameters: Name Type Description $obj Object An jQuery object of the current tag row. Source: viewer.js, line 3897 _updateAllSortIcons() (Privat) Method which Source: viewer.js, line 7754 _updateSortIcons(item) (Privat) Method which Parameters: Name Type Description item Object Source: viewer.js, line 7779 _writeTags($tags, $input) Method to ... Parameters: Name Type Description $tags Object ... $input Object ... Source: viewer.js, line 8478 addTag(tagName) Method which adds a tag to the list. Parameters: Name Type Description tagName String The current tag name. Source: viewer.js, line 8280 buildAPICall(path, type, pi, logid, email) Method which returns an URL to trigger the ITM download task. Parameters: Name Type Description path String The current application path. type String The current file type to download. pi String The PI of the current work. logid String The LOG_ID of the current work. email String The current user email. Source: viewer.js, line 2676 Returns: The URL to trigger the ITM download task. Type String centerLightbox($obj) Method which centers the given object to the viewport. Parameters: Name Type Description $obj Object An jQuery object of the element to center. Source: viewer.js, line 5400 checkboxValidation(state) Method which validates the checkstate of a checkbox and enables the downloadbutton. Parameters: Name Type Description state String The current checkstate of the checkbox. Source: viewer.js, line 2349 checkForSmallViewport() Method which checks the viewport width and returns true if itÂ´s smaller then375px. Source: viewer.js, line 5330 Returns: Returns true if itÂ´s smaller then 375px. Type Boolean checkLocalStorage() Method to check if itÂ´s possible to write to local Storage Source: viewer.js, line 3117 Returns: true or false Type Boolean close() Method to ... Source: viewer.js, line 8358 contains() Method to ... Source: viewer.js, line 8333 decreaseLevel(element, applyToNext) Method which Parameters: Name Type Description element String applyToNext String Source: viewer.js, line 7618 deleteTag(tag) Method which deletes a tag from the list. Parameters: Name Type Description tag Object The current tag to delete. Source: viewer.js, line 8306 detectIEVersion() Method to get the version number of the used MS Internet Explorer. Source: viewer.js, line 3082 Returns: The browser version. Type Number disablePreview() Method which disables the preview button by setting a local storage value. Source: viewer.js, line 7065 enablePreview() Method which enables the preview button by setting a local storage value. Source: viewer.js, line 7078 equalHeight(sidebar, content) Method to equal height of sidebar and content. Parameters: Name Type Description sidebar String The selector of the sidebar. content String The selector of the content. Source: viewer.js, line 3168 fixedHeight($obj) Method which sets a fixed height to the gallery images. Parameters: Name Type Description $obj Object An jQuery object of the element which height should befixed. Source: viewer.js, line 5313 getCurrentBrowser() Method to get the current used browser. Source: viewer.js, line 3220 Returns: The name of the current Browser. Type String getDataEncoding() Returns the type of encoding. Source: viewer.js, line 2245 Returns: The type of encoding. Type String getDataSortOrder() Returns the number of entries from the feed. Source: viewer.js, line 2225 Returns: The number of entries. Type String getDataSortOrder() Returns the sorting order of the feed. Source: viewer.js, line 2205 Returns: The sorting order. Type String getDataSortOrder(str) Sets the sorting order of the feed. Parameters: Name Type Description str String The sorting order (asc/desc) Source: viewer.js, line 2215 getRemoteData(url) Returns an JSON object from a API call. Parameters: Name Type Description url String The API call URL. Source: viewer.js, line 2972 Returns: A promise object, which tells about the success of receivingdata. Type Object Example &lt;pre&gt; viewerJS.helper.getRemoteData( dataURL ); &lt;/pre&gt; getTag() Method to get a single tag. Source: viewer.js, line 8401 getTags() Method to get all tags. Source: viewer.js, line 8373 getTagValues() Method to get all tag values. Source: viewer.js, line 8385 getValue() Method to get a single Value. Source: viewer.js, line 8424 getWorkInfo(pi, logid) Method which returns a promise if the work info has been reached. Parameters: Name Type Description pi String The PI of the work. logid String The LOG_ID of the work. Source: viewer.js, line 2729 Returns: A promise object if the info has been reached. Type Promise increaseLevel(element, applyToNext) Method which Parameters: Name Type Description element String applyToNext String Source: viewer.js, line 7649 init(config) Method to initialize the viewer reading mode. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description navSelector String A string which contains the selector for thenavigation. viewSelector String A string which contains the selector forthe content view. imageContainerSelector String A string which contains theselector for the image container. imageSelector String A string which contains the selector forthe image. sidebarSelector String A string which contains the selector forthe sidebar. sidebarToggleButton String A string which contains the selectorfor the sidebar toggle button. sidebarInnerSelector String A string which contains theselector for the inner sidebar container. sidebarStatus String A string which contains the currentsidebar status. Source: viewImage.js, line 2201 init(config) Method which initializes the font size switcher. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description fontDownBtn String The ID/Class of the font degrade button. fontUpBtn String The ID/Class of the font upgrade button. maxFontSize String The maximum font size the document shouldscale up. minFontSize String The minimum font size the document shouldscale down. baseFontSize String The base font size of the HTML-Element. Source: viewer.js, line 1769 Example &lt;pre&gt; var changeFontSizeConfig = { fontDownBtn: '#fontSizeDown', fontUpBtn: '#fontSizeUp', maxFontSize: 18, minFontSize: 14 }; viewerJS.changeFontSize.init( changeFontSizeConfig ); &lt;/pre&gt; init(config, data) Method which initializes the Masonry Grid. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description $grid Object An jQuery object which represents the gridcontainer. data Object An data object which contains the images sources for thegrid. Source: viewer.js, line 7291 init(config) Method to initialize the timematrix slider and the events which builds thematrix and popovers. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description id String The starting ID of the popover. path String The rootpath of the application. lang Object An object of localized strings. elemWrapper Object An jQuery object of the wrapper DIV. Source: viewer.js, line 4728 Example &lt;pre&gt; var normdataConfig = { path: '#{request.contextPath}', lang: { popoverTitle: '#{msg.normdataPopverTitle}', popoverClose: '#{msg.normdataPopoverClose}' }, elemWrapper: $( '#metadataElementWrapper' ) }; viewerJS.normdata.init( normdataConfig ); &lt;/pre&gt; init(config, data) Method which initializes the RSS Feed. Parameters: Name Type Description config Object An config object which overwrites the defaults. data Object An data object which contains the images sources for thegrid. Source: viewer.js, line 7442 init(config) Method to initialize the search sorting widget. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description select Object An jQuery object which holds the sorting menu. Source: viewer.js, line 5988 init(indent, allowMultiple, config) Method which initializes the CMS sortable list items and sets events. Parameters: Name Type Description indent String allowMultiple Boolean config Object Source: viewer.js, line 7561 init(config) Method to initialize the viewer main navigation. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description navigationSelector String The selector for the navigationelement. subMenuSelector String The selector for the submenu element. megaMenuSelector String The selector for the mega menu element. closeMegaMenuSelector String The selector for the close megamenu element. Source: viewer.js, line 3283 init(config) Method which initializes the column gallery. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description themePath String The path to the current activated viewertheme. imagePath String The path to the used images. imageDataFile String The path to the JSON-File, which containsthe images data. galleryObject Object The DIV where the gallery should berendered. maxColumnCount Number Count count of the gallery, 4 column aremaximum. maxImagesPerColumn Number Count of the images per column. fixedHeight Boolean If true the images have a fixed height,default is false. maxHeight String Sets the given max height value for theimages. caption Boolean If true the gallery images have a caption withthe title text, default is true. overlayColor String Takes a HEX-value to set the color of theimage overlay. lang Object An object of strings for multilanguagefunctionality. lightbox Object An Object to configure the image lightbox. Properties Name Type Description active Boolean If true the lightbox functionality isenabled, default is true. caption Boolean If true the lightbox has a captiontext, default is true. Source: viewer.js, line 5131 init(config) Method to initialize the search advanced features. Parameters: Name Type Description config Object An config object which overwrites the defaults. Source: viewer.js, line 5438 init(config) Method which initializes the date sorted RSS-Feed. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description path String The rootpath of the application. feedBox Object An jQuery object of the wrapper DIV. Source: viewer.js, line 2146 Example &lt;pre&gt; var dateSortedFeedConfig = { path: '#{request.contextPath}', feedBox: $( '#dateSortedFeed' ) }; viewerJS.dateSortedFeed.setDataSortOrder( '#{cc.attrs.sorting}' ); viewerJS.dateSortedFeed.setDataCount( '#{cc.attrs.count}' ); viewerJS.dateSortedFeed.setDataEncoding( '#{cc.attrs.encoding}' ); viewerJS.dateSortedFeed.init( dateSortedFeedConfig ); &lt;/pre&gt; init(obj, anchor) Initializes the animated pagescroll. Parameters: Name Type Description obj String The selector of the jQuery object. anchor String The name of the anchor to scroll to. Source: viewer.js, line 5055 init() Initializes an event (click) which renders a lightbox with an bigger image. Source: viewer.js, line 6060 Example &lt;pre&gt; viewerJS.simpleLightBox.init(); &lt;/pre&gt; init(config) Method to initialize the version history widget. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description versions Array An array which holds all versions. json Object An JSON-Object which takes all versions. imgUrl String The image URL for the current work. imgPi String The PI for the image of the current work. versionLink String A string placeholder for the final HTML. widgetInputs String A string placeholder for the final HTML. widgetList String A string placeholder for the final HTML. Source: viewer.js, line 6760 init(config) Method which initializes the NER Popover methods. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description path String The rootpath of the application. Source: viewer.js, line 4397 Example &lt;pre&gt; var nerConfig = { path: '#{request.contextPath}' }; viewerJS.nerFulltext.init( nerConfig ); &lt;/pre&gt; init() Method which initializes the CMS. Source: viewer.js, line 6841 Example &lt;pre&gt; cmsJS.init(); &lt;/pre&gt; init() Method to initialize the download view. Source: viewer.js, line 2327 init(config) Method to initialize the download modal mechanic. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description dataType String The data type of the current file to download. dataTitle String The title of the current file to download. dataId String The LOG_ID of the current file to download. dataPi String The PI of the current file to download. downloadBtn Object A collection of all buttons with the classattribute 'download-modal'. reCaptchaSiteKey String The site key for the google reCAPTCHA,fetched from the viewer config. path String The current application path. apiUrl String The URL to trigger the ITM download task. userEmail String The current user email if the user is loggedin. Otherwise the one which the user enters or leaves blank. modal Object A configuration object for the download modal. Properties Name Type Description id String The ID of the modal. label String The label of the modal. string Object An object of strings for the modal content. Properties Name Type Description title String The title of the modal. body String The content of the modal as HTML. closeBtn String Buttontext saveBtn String Buttontext messages Object An object of strings for the used textsnippets. Source: viewer.js, line 2422 Example &lt;pre&gt; var downloadModalConfig = { downloadBtn: $( '.download-modal' ), path: '#{navigationHelper.applicationUrl}', userEmail: $( '#userEmail' ).val(), messages: { reCaptchaText: '#{msg.downloadReCaptchaText}', rcInvalid: '#{msg.downloadRcInvalid}', rcValid: '#{msg.downloadRcValid}', eMailText: '#{msg.downloadEMailText}', eMailTextLoggedIn: '#{msg.downloadEMailTextLoggedIn}', eMail: '#{msg.downloadEmail}', closeBtn: '#{msg.downloadCloseModal}', saveBtn: '#{msg.downloadGenerateFile}', } }; viewerJS.downloadModal.init( downloadModalConfig ); &lt;/pre&gt; init(config, data) Method which initializes the RSS Feed. Parameters: Name Type Description config Object An config object which overwrites the defaults. data Object An data object which contains the images sources for thegrid. Source: viewer.js, line 7936 init(settings) Method which initializes the CMS create page module. Parameters: Name Type Description settings Object Source: viewer.js, line 6976 init() Method which initializes all required events to edit comments. Source: viewer.js, line 2786 Example &lt;pre&gt; $( document ).ready( function() { viewerJS.editComment.init(); } ); &lt;/pre&gt; init(config, data) Method which initializes the Masonry Grid. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description gridSelector String The selector for the grid container. data Object An data object which contains the images sources for thegrid. Source: viewer.js, line 8141 init(config) Method to initialize the NER-Widget or NER-View. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description currentPage String The name of the current page. baseUrl String The root URL. apiUrl String The base URL for the API-Calls. workId String The ID of the current work. overviewTrigger String The ID/Class of the overview trigger. overviewContent String The ID/Class of the content section fromoverview. sectionTrigger String The ID/Class of the section trigger. sectionContent String The ID/Class of the content section fromsection. facettingTrigger String The ID/Class of the facetting trigger. setTagRange String The ID/Class of the select menu for therange. slider String The ID/Class of the tag range slider. sliderScale String The ID/Class of the slider scale. sectionTags String The ID/Class of the tag section. currentTags String The ID/Class of the tag container. sliderHandle String The ID/Class of the slider handle. sliderSectionStripe String The ID/Class of the range stripe onthe slider. recurrenceNumber Number The number of displayed tags in a row. recurrenceSectionNumber Number The number of displayed tags ina section. sidebarRight Boolean If true, the current tag row will show upto the left of the sidebar widget. loader String The ID/Class of the AJAX-Loader. msg Object An object of strings for multi language use. Source: viewer.js, line 3471 init(config) Method which initializes the tag list. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description inputFieldId String The Selector for the tag input field. tagList String The Selector for the tag list. autoSuggestUrl String The URL for the tag auto suggest. msg Object An object with message keys. Source: viewer.js, line 8243 init(config) Method to initialize the search list features. Parameters: Name Type Description config Object An config object which overwrites the defaults. Source: viewer.js, line 5589 init(config) Method to initialize the timematrix slider and the events which builds thematrix and popovers. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description thumbs Object All jQuery objects of the stacked thumbnails. thumbsBefore String The classname of the stacked thumbnailbefore element. thumbsAfter String The classname of the stacked thumbnail afterelement. Source: viewer.js, line 6178 init(config) Method to initialize the timematrix slider and the events which builds thematrix and popovers. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description contextPath String The rootpath of the application. apiQuery String The API action to call. startDateQuery String The GET-Parameter for the start date. rangeInput1 Object An jQuery object of the first range input. startDate String The value of the first range input. endDateQuery String The GET-Parameter for the end date. rangeInput2 Object An jQuery object of the second range input. endDate String The value of the second range input. countQuery String The GET-Parameter for the count query. count String The number of results from the query. $tmCanvas Object An jQuery object of the timematrix canvas. $tmCanvasPos Object An jQuery object of the timematrix canvasposition. lang Object An object of localized strings. Source: viewer.js, line 6259 Example &lt;pre&gt; $( document ).ready( function() { var timematrixConfig = { path: '#{request.contextPath}/', lang: { closeWindow: '#{msg.timematrixCloseWindow}', goToWork: '#{msg.timematrixGoToWork}' } }; viewerJS.timematrix.init( timematrixConfig ); } ); &lt;/pre&gt; initModal(params) Method which initializes the download modal and its content. Parameters: Name Type Description params Object An config object which overwrites the defaults. Source: viewer.js, line 2521 initSortables(config) Method which Parameters: Name Type Description config Object Source: viewer.js, line 7023 prepareLightbox($obj) Method which prepares the lightbox object with the required data. Parameters: Name Type Description $obj Object An jQuery object which includes the required dataattributes. Source: viewer.js, line 5350 Returns: An Object which includes the required data. Type Object renderAlert(type, content, dismissable) Returns a BS Alert with dynamic content. Parameters: Name Type Description type String The type of the alert. content String The content of the alert. dismissable Boolean Sets the option to make the alert dismissable,true = dismissable. Source: viewer.js, line 3054 Returns: A HTML-String which renders the alert. Type String renderColumns(count) Method which renders the gallery columns. Parameters: Name Type Description count String The column count of the gallery. Source: viewer.js, line 5252 Returns: A HTML-String which renders a column. Type String renderImages(data) Method which renders the gallery images. Parameters: Name Type Description data Object An object of image data to render the images. Source: viewer.js, line 5270 Returns: A HTML-String which renders the gallery images. Type String renderLightbox(data) Method which renders a lightbox for the selected image. Parameters: Name Type Description data Object An object which includes the required data. Source: viewer.js, line 5370 Returns: A HTML-String which renders the lightbox. Type String renderModal(config) Returns a BS Modal with dynamic content. Parameters: Name Type Description config Object An config object which includes the content of themodal. Properties Name Type Description id String The ID of the modal. label String The label of the modal. string Object An object of strings for the modal content. Properties Name Type Description title String The title of the modal. body String The content of the modal as HTML. closeBtn String Buttontext saveBtn String Buttontext Source: viewer.js, line 3000 Returns: A HTML-String which renders the modal. Type String renderModalBody(type, title) Method which returns a HTML-String to render the download modal body. Parameters: Name Type Description type String The current file type to download. title String The title of the current download file. Source: viewer.js, line 2587 Returns: The HTML-String to render the download modal body. Type String renderWarningPopover(msg) Method to render a warning popover. Parameters: Name Type Description msg String The message to show in the popover. Source: viewer.js, line 3139 Returns: An jQuery Object to append to DOM. Type Object saveSidebarTocPosition() Method which calculates the current position of the active element in sidebartoc and the image container position and saves it to lacal storage. Source: viewer.js, line 2904 Example &lt;pre&gt; viewerJS.helper.saveSidebarTocPosition(); &lt;/pre&gt; saveTags() Method to save the tag list. Source: viewer.js, line 8321 setDataCount(The) Sets the number of entries from the feed. Parameters: Name Type Description The String number of entries. Source: viewer.js, line 2235 setDataEncoding(The) Sets the type of encoding. Parameters: Name Type Description The String type of encoding. Source: viewer.js, line 2255 truncateString(str, size) Method to truncate a string to a given length. Parameters: Name Type Description str String The string to truncate. size Number The number of characters after the string should becroped. Source: viewer.js, line 2874 Returns: The truncated string. Type String Example &lt;pre&gt; viewerJS.helper.truncateString( $( '.something' ).text(), 75 ); &lt;/pre&gt; validateReCaptcha(wrapper, key) Method to validate the reCAPTCHA response. Parameters: Name Type Description wrapper String The reCAPTCHA widget wrapper. key String The reCAPTCHA site key. Source: viewer.js, line 3194 Returns: Returns true if the response is valid. Type Boolean validateReCaptcha(response) Method which checks the reCAPTCHA response. Parameters: Name Type Description response String The reCAPTCHA response. Source: viewer.js, line 2657 Returns: Returns true if the reCAPTCHA sent a response. Type Boolean Ã— Search results Close "},"modules.list.html":{"id":"modules.list.html","title":"Modules","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Modules Ã— Search results Close "},"index.html":{"id":"index.html","title":"Index","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Ã— Search results Close "},"cmsJS.module_createPage.html":{"id":"cmsJS.module_createPage.html","title":"Module: createPage","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: createPage This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which creates new CMS pages and sets their status. Version: 3.2.0 Source: cms/cmsJS.createPage.js, line 1 Requires module:jQuery Methods &lt;inner&gt; disablePreview() Method which disables the preview button by setting a local storage value. Source: cms/cmsJS.createPage.js, line 130 &lt;inner&gt; enablePreview() Method which enables the preview button by setting a local storage value. Source: cms/cmsJS.createPage.js, line 143 &lt;inner&gt; init(settings) Method which initializes the CMS create page module. Parameters: Name Type Description settings Object Source: cms/cmsJS.createPage.js, line 41 &lt;inner&gt; initSortables(config) Method which Parameters: Name Type Description config Object Source: cms/cmsJS.createPage.js, line 88 Ã— Search results Close "},"cmsJS.module_geoLocations.html":{"id":"cmsJS.module_geoLocations.html","title":"Module: geoLocations","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: geoLocations This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module to initialize the mapbox view. Version: 3.2.0 Source: cms/cmsJS.mapBox.js, line 1 Requires module:jQuery Methods &lt;inner&gt; _getCenterCoords(infos) Method which returns an array of coordinates for centering the map. Parameters: Name Type Description infos String A JSON-String which contains the feature infos. Source: cms/cmsJS.mapBox.js, line 166 Returns: An array of coords. Type Array &lt;inner&gt; _getMapFeatures(infos) Method which returns an object of map features. Parameters: Name Type Description infos String A JSON-String which contains the feature infos. Source: cms/cmsJS.mapBox.js, line 121 Returns: An array of features. Type Array Ã— Search results Close "},"cmsJS.module_masonry.html":{"id":"cmsJS.module_masonry.html","title":"Module: masonry","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: masonry This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which initializes a masonry grid. Version: 3.2.0 Source: cms/cmsJS.masonry.js, line 1 Requires module:jQuery Methods &lt;inner&gt; _renderMasonryGrid(data) Method which renders the masonry grid. Parameters: Name Type Description data Object An data object which contains the images sources for the grid. Source: cms/cmsJS.masonry.js, line 97 &lt;inner&gt; init(config, data) Method which initializes the Masonry Grid. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description $grid Object An jQuery object which represents the gridcontainer. data Object An data object which contains the images sources for thegrid. Source: cms/cmsJS.masonry.js, line 48 Ã— Search results Close "},"cmsJS.module_rssFeed.html":{"id":"cmsJS.module_rssFeed.html","title":"Module: rssFeed","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: rssFeed This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which renders the RSS Feed. Version: 3.2.0 Source: cms/cmsJS.rssFeed.js, line 1 Requires module:jQuery Methods &lt;inner&gt; _renderRssFeed(data) Method which renders the RSS feed into the DOM. Parameters: Name Type Description data Object The RSS information data object. Source: cms/cmsJS.rssFeed.js, line 59 &lt;inner&gt; init(config, data) Method which initializes the RSS Feed. Parameters: Name Type Description config Object An config object which overwrites the defaults. data Object An data object which contains the images sources for thegrid. Source: cms/cmsJS.rssFeed.js, line 35 Ã— Search results Close "},"cmsJS.module_sortableList.html":{"id":"cmsJS.module_sortableList.html","title":"Module: sortableList","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: sortableList This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which enables a sortable List based on jQuery UI. This list is used for themainmenu items and dynamic sidebar elements. Version: 3.2.0 Source: cms/cmsJS.sortableList.js, line 1 Requires module:jQuery, Methods &lt;inner&gt; _changePos(item, diff) (Privat) Method which Parameters: Name Type Description item Object diff String Source: cms/cmsJS.sortableList.js, line 343 &lt;inner&gt; _getJQueryItem(element) (Privat) Method which Parameters: Name Type Description element Object Source: cms/cmsJS.sortableList.js, line 300 &lt;inner&gt; _getLevel(item) (Privat) Method which Parameters: Name Type Description item Object Source: cms/cmsJS.sortableList.js, line 320 &lt;inner&gt; _handleBeforeDropFromAvailable(event, ui) (Privat) Method which Parameters: Name Type Description event String ui String Source: cms/cmsJS.sortableList.js, line 161 &lt;inner&gt; _handleBeforeDropFromAvailable(event, ui) (Privat) Method which Parameters: Name Type Description event String ui String Source: cms/cmsJS.sortableList.js, line 198 &lt;inner&gt; _handleDrop() (Privat) Method which Source: cms/cmsJS.sortableList.js, line 217 &lt;inner&gt; _serializeVisibleItems() (Privat) Method which Source: cms/cmsJS.sortableList.js, line 371 &lt;inner&gt; _updateAllSortIcons() (Privat) Method which Source: cms/cmsJS.sortableList.js, line 229 &lt;inner&gt; _updateSortIcons(item) (Privat) Method which Parameters: Name Type Description item Object Source: cms/cmsJS.sortableList.js, line 254 &lt;inner&gt; decreaseLevel(element, applyToNext) Method which Parameters: Name Type Description element String applyToNext String Source: cms/cmsJS.sortableList.js, line 93 &lt;inner&gt; increaseLevel(element, applyToNext) Method which Parameters: Name Type Description element String applyToNext String Source: cms/cmsJS.sortableList.js, line 124 &lt;inner&gt; init(indent, allowMultiple, config) Method which initializes the CMS sortable list items and sets events. Parameters: Name Type Description indent String allowMultiple Boolean config Object Source: cms/cmsJS.sortableList.js, line 36 Ã— Search results Close "},"cmsJS.module_stackedCollection.html":{"id":"cmsJS.module_stackedCollection.html","title":"Module: stackedCollection","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: stackedCollection This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which renders collections as an accordion view. Version: 3.2.0 Source: cms/cmsJS.stackedCollection.js, line 1 Requires module:jQuery Methods &lt;inner&gt; _renderCollections(data) Method which renders the collection accordion. Parameters: Name Type Description data Object The RSS information data object. Source: cms/cmsJS.stackedCollection.js, line 64 &lt;inner&gt; _renderSubCollections(url) Method which renders the subcollections. Parameters: Name Type Description url String The URL to the API which fetches the subcollection data. Source: cms/cmsJS.stackedCollection.js, line 168 Returns: The HTML string of the subcollections. Type String &lt;inner&gt; init(config, data) Method which initializes the RSS Feed. Parameters: Name Type Description config Object An config object which overwrites the defaults. data Object An data object which contains the images sources for thegrid. Source: cms/cmsJS.stackedCollection.js, line 40 Ã— Search results Close "},"cmsJS.module_staticGrid.html":{"id":"cmsJS.module_staticGrid.html","title":"Module: staticGrid","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: staticGrid This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which initializes a static grid. Version: 3.2.0 Source: cms/cmsJS.staticGrid.js, line 1 Requires module:jQuery Methods &lt;inner&gt; _buildGrid(data) Method to build the elements of the static grid. Parameters: Name Type Description data Object A JSON data object which contains the image informations. Source: cms/cmsJS.staticGrid.js, line 73 Returns: An jQuery object which contains all grid elements. Type Object &lt;inner&gt; init(config, data) Method which initializes the Masonry Grid. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description gridSelector String The selector for the grid container. data Object An data object which contains the images sources for thegrid. Source: cms/cmsJS.staticGrid.js, line 47 Ã— Search results Close "},"cmsJS.module_tagList.html":{"id":"cmsJS.module_tagList.html","title":"Module: tagList","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: tagList This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which initializes the tags for the CMS media files. Version: 3.2.0 Source: cms/cmsJS.tagList.js, line 1 Requires module:jQuery Methods &lt;inner&gt; _createListElement(value, $parent, count) Method to ... Parameters: Name Type Description value String ... $parent Object ... count Number Source: cms/cmsJS.tagList.js, line 329 &lt;inner&gt; _createTagInputElement($parent) Method to ... Parameters: Name Type Description $parent Object ... Source: cms/cmsJS.tagList.js, line 369 &lt;inner&gt; _handleClickTerminator(event) Method to ... Parameters: Name Type Description event Object ... Source: cms/cmsJS.tagList.js, line 456 &lt;inner&gt; _handleInputChange(event, text) Method to ... Parameters: Name Type Description event Object ... text String ... Source: cms/cmsJS.tagList.js, line 429 &lt;inner&gt; _readTags($input) Method to ... Parameters: Name Type Description $input Object ... Source: cms/cmsJS.tagList.js, line 238 &lt;inner&gt; _renderList(tags, $ul) Method to ... Parameters: Name Type Description tags Array ... $ul Object ... Source: cms/cmsJS.tagList.js, line 304 &lt;inner&gt; _writeTags($tags, $input) Method to ... Parameters: Name Type Description $tags Object ... $input Object ... Source: cms/cmsJS.tagList.js, line 277 &lt;inner&gt; addTag(tagName) Method which adds a tag to the list. Parameters: Name Type Description tagName String The current tag name. Source: cms/cmsJS.tagList.js, line 79 &lt;inner&gt; close() Method to ... Source: cms/cmsJS.tagList.js, line 157 &lt;inner&gt; contains() Method to ... Source: cms/cmsJS.tagList.js, line 132 &lt;inner&gt; deleteTag(tag) Method which deletes a tag from the list. Parameters: Name Type Description tag Object The current tag to delete. Source: cms/cmsJS.tagList.js, line 105 &lt;inner&gt; getTag() Method to get a single tag. Source: cms/cmsJS.tagList.js, line 200 &lt;inner&gt; getTags() Method to get all tags. Source: cms/cmsJS.tagList.js, line 172 &lt;inner&gt; getTagValues() Method to get all tag values. Source: cms/cmsJS.tagList.js, line 184 &lt;inner&gt; getValue() Method to get a single Value. Source: cms/cmsJS.tagList.js, line 223 &lt;inner&gt; init(config) Method which initializes the tag list. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description inputFieldId String The Selector for the tag input field. tagList String The Selector for the tag list. autoSuggestUrl String The URL for the tag auto suggest. msg Object An object with message keys. Source: cms/cmsJS.tagList.js, line 42 &lt;inner&gt; saveTags() Method to save the tag list. Source: cms/cmsJS.tagList.js, line 120 Ã— Search results Close "},"cmsJS.module_tileGrid.html":{"id":"cmsJS.module_tileGrid.html","title":"Module: tileGrid","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: tileGrid This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which initializes a tile grid. Version: 3.2.0 Source: cms/cmsJS.tileGrid.js, line 1 Requires module:jQuery Ã— Search results Close "},"module-cmsJS.html":{"id":"module-cmsJS.html","title":"Module: cmsJS","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: cmsJS This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Base-Module which initialize the global Content Management System (CMS) object. Version: 3.2.0 Source: cms/cmsJS.js, line 1 Requires module:jQuery Methods &lt;inner&gt; init() Method which initializes the CMS. Source: cms/cmsJS.js, line 31 Example &lt;pre&gt; cmsJS.init(); &lt;/pre&gt; Ã— Search results Close "},"module-viewerJS.html":{"id":"module-viewerJS.html","title":"Module: viewerJS","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: viewerJS This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Base-Module which initialize the global viewer object. Version: 3.2.0 Source: viewer/viewerJS.js, line 1 Ã— Search results Close "},"module-viewImage.html":{"id":"module-viewImage.html","title":"Module: viewImage","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: viewImage This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which initializes the viewerJS module. Version: 3.2.0 Source: viewImage/viewImage.js, line 1 Requires module:jQuery Ã— Search results Close "},"viewerJS.module_bookshelvesSession.html":{"id":"viewerJS.module_bookshelvesSession.html","title":"Module: bookshelvesSession","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: bookshelvesSession This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module to manage bookshelves in the current session. Version: 3.2.0 Source: viewer/viewerJS.bookshelvesSession.js, line 1 Requires module:jQuery Methods &lt;inner&gt; _deleteAllSessionElements(root) Method to delete all elements from watchlist in current session (user not loggedin). Parameters: Name Type Description root String The application root path. Source: viewer/viewerJS.bookshelvesSession.js, line 238 &lt;inner&gt; _deleteSessionElement(root, pi) Method to delete an element from watchlist in current session (user not logged in). Parameters: Name Type Description root String The application root path. pi String The persistent identifier of the saved element. Source: viewer/viewerJS.bookshelvesSession.js, line 215 &lt;inner&gt; _getAllSessionElements(root) Method to get all elements in watchlist from current session (user not logged in). Parameters: Name Type Description root String The application root path. Source: viewer/viewerJS.bookshelvesSession.js, line 142 Returns: An JSON-Object which contains all session elements. Type Object &lt;inner&gt; _isElementSet(root, pi) Method to check if element is in list (user not logged in). Parameters: Name Type Description root String The application root path. pi String The persistent identifier of the saved element. Source: viewer/viewerJS.bookshelvesSession.js, line 164 Returns: True if element is set. Type Boolean &lt;inner&gt; _renderDropdownList() Method to render the element list in bookshelf dropdown (user not logged in). Source: viewer/viewerJS.bookshelvesSession.js, line 280 &lt;inner&gt; _setAddActiveState() Method to set the active state of add buttons (user not logged in). Source: viewer/viewerJS.bookshelvesSession.js, line 376 &lt;inner&gt; _setSessionElement(root, pi) Method to add an elements to watchlist in current session (user not logged in). Parameters: Name Type Description root String The application root path. pi String The persistent identifier of the saved element. Source: viewer/viewerJS.bookshelvesSession.js, line 190 &lt;inner&gt; _setSessionElementCount(root) Method to set the count of elements in watchlist from current session (user notlogged in). Parameters: Name Type Description root String The application root path. Source: viewer/viewerJS.bookshelvesSession.js, line 262 Ã— Search results Close "},"viewerJS.module_bookshelvesUser.html":{"id":"viewerJS.module_bookshelvesUser.html","title":"Module: bookshelvesUser","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: bookshelvesUser This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module to manage bookshelves if the user is logged in. Version: 3.2.0 Source: viewer/viewerJS.bookshelvesUser.js, line 1 Requires module:jQuery Methods &lt;inner&gt; _addAutomaticNamedBookshelf(root) Method to add a automatic named bookshelf to the user account. Parameters: Name Type Description root String The application root path. Source: viewer/viewerJS.bookshelvesUser.js, line 213 Returns: A promise that checks the existing items. Type Promise &lt;inner&gt; _addBookshelfItemByPi(root, id, pi) Method to add an item to the user bookshelf by PI. Parameters: Name Type Description root String The application root path. id String The current bookshelf id. pi String The pi of the item to add. Source: viewer/viewerJS.bookshelvesUser.js, line 133 Returns: A promise that checks the existing items. Type Promise &lt;inner&gt; _addBookshelfItemByPiLogidPage(root, id, pi, logid, page) Method to add an item with PI, LOGID and PAGE to the user bookshelf. Parameters: Name Type Description root String The application root path. id String The current bookshelf id. pi String The pi of the item to add. logid String The logid of the item to add. page String The page of the item to add. Source: viewer/viewerJS.bookshelvesUser.js, line 159 Returns: A promise that checks the existing items. Type Promise &lt;inner&gt; _addNamedBookshelf(root, name) Method to add a named bookshelf to the user account. Parameters: Name Type Description root String The application root path. name String The name of the bookshelf. Source: viewer/viewerJS.bookshelvesUser.js, line 189 Returns: A promise that checks the existing items. Type Promise &lt;inner&gt; _addSessionBookshelf(root) Method to add the session bookshelf to the user account with an automatic generatedname. Parameters: Name Type Description root String The application root path. Source: viewer/viewerJS.bookshelvesUser.js, line 235 Returns: A promise that checks the existing items. Type Promise &lt;inner&gt; _addSessionBookshelfNamed(root) Method to add the session bookshelf to the user account with a given name. Parameters: Name Type Description root String The application root path. Source: viewer/viewerJS.bookshelvesUser.js, line 258 Returns: A promise that checks the existing items. Type Promise &lt;inner&gt; _deleteBookshelfById(root, id) Method to delete a bookshelf by ID. Parameters: Name Type Description root String The application root path. id String The current bookshelf id. Source: viewer/viewerJS.bookshelvesUser.js, line 532 Returns: A promise that checks the existing items. Type Promise &lt;inner&gt; _deleteBookshelfItemByPi(root, id, pi) Method to delete an item from the user bookshelf by PI. Parameters: Name Type Description root String The application root path. id String The current bookshelf id. pi String The pi of the item to add. Source: viewer/viewerJS.bookshelvesUser.js, line 476 Returns: A promise that checks the existing items. Type Promise &lt;inner&gt; _deleteBookshelfItemByPiLogidPage(root, id, pi, logid, page) Method to delete an item with PI, LOGID and PAGE from the user bookshelf. Parameters: Name Type Description root String The application root path. id String The current bookshelf id. pi String The pi of the item to add. logid String The logid of the item to add. page String The page of the item to add. Source: viewer/viewerJS.bookshelvesUser.js, line 502 Returns: A promise that checks the existing items. Type Promise &lt;inner&gt; _getAllBookshelves(root) Method to get all user bookshelves. Parameters: Name Type Description root String The application root path. Source: viewer/viewerJS.bookshelvesUser.js, line 282 Returns: A promise that checks the existing items. Type Promise &lt;inner&gt; _getBookshelfById(root, id) Method to get a bookshelf by id. Parameters: Name Type Description root String The application root path. id String The current bookshelf id. Source: viewer/viewerJS.bookshelvesUser.js, line 304 Returns: A promise that checks the existing items. Type Promise &lt;inner&gt; _getBookshelfItemCount(root, id) Method to get the number of items in the selected bookshelf. Parameters: Name Type Description root String The application root path. id String The current bookshelf id. Source: viewer/viewerJS.bookshelvesUser.js, line 328 Returns: A promise that checks the existing items. Type Promise &lt;inner&gt; _getContainingBookshelfItemByPi(root, pi) Method to check if an item by PI if it's in user bookshelf. It returns thebookshelves or false if no items are in list. Parameters: Name Type Description root String The application root path. pi String The pi of the current item. Source: viewer/viewerJS.bookshelvesUser.js, line 396 Returns: A promise that checks the existing items. Type Promise &lt;inner&gt; _getContainingBookshelfItemByPiLogidPage(root, pi) Method to check if an item by PI, LOGID and PAGE if it's in user bookshelf. Itreturns the bookshelves or false if no items are in list. Parameters: Name Type Description root String The application root path. pi String The pi of the current item. Source: viewer/viewerJS.bookshelvesUser.js, line 421 Returns: A promise that checks the existing items. Type Promise &lt;inner&gt; _getPublicBookshelves(root) Method to get all public bookshelves. Parameters: Name Type Description root String The application root path. Source: viewer/viewerJS.bookshelvesUser.js, line 352 Returns: A promise that checks the existing items. Type Promise &lt;inner&gt; _getSharedBookshelves(root) Method to get all shared bookshelves. Parameters: Name Type Description root String The application root path. Source: viewer/viewerJS.bookshelvesUser.js, line 374 Returns: A promise that checks the existing items. Type Promise &lt;inner&gt; _isItemInBookshelf(object, pi) Method to check if item is in any bookshelf. Parameters: Name Type Description object Object An jQuery-Object of the current item. pi String The current PI of the selected item. Source: viewer/viewerJS.bookshelvesUser.js, line 821 &lt;inner&gt; _renderBookshelfNavigationList() Method to render the element list in bookshelf navigation. Source: viewer/viewerJS.bookshelvesUser.js, line 738 &lt;inner&gt; _renderBookshelfPopoverList(pi) Method to render the element list in bookshelf popover. Parameters: Name Type Description pi String The current PI of the selected item. Source: viewer/viewerJS.bookshelvesUser.js, line 651 &lt;inner&gt; _renderBookshelfPopup(pi, logid, page, pos, size) Method to render a popup which contains bookshelf actions. Parameters: Name Type Description pi String The pi of the item to add. logid String The logid of the item to add. page String The page of the item to add. pos Object The position of the clicked button. size Object The width and height of the clicked button. Source: viewer/viewerJS.bookshelvesUser.js, line 557 &lt;inner&gt; _setAddedStatus() Method to set an 'added' status to an object. Source: viewer/viewerJS.bookshelvesUser.js, line 804 &lt;inner&gt; _setBookshelfName(root, id, name) Method to set the name of a bookshelf. Parameters: Name Type Description root String The application root path. id String The current bookshelf id. name String The name of the bookshelf. Source: viewer/viewerJS.bookshelvesUser.js, line 449 Returns: A promise that checks the existing items. Type Promise Ã— Search results Close "},"viewerJS.module_calendarPopover.html":{"id":"viewerJS.module_calendarPopover.html","title":"Module: calendarPopover","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: calendarPopover This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Version: 3.2.0 Source: viewer/viewerJS.calendarPopover.js, line 1 Requires module:jQuery Methods &lt;inner&gt; _getPopoverContent(data, config) Method to render the popover content. Parameters: Name Type Description data Object A JSON-Object which contains the necessary data. config Object The config object of the module. Source: viewer/viewerJS.calendarPopover.js, line 90 Returns: The HTML-String of the popover content. Type String Ã— Search results Close "},"viewerJS.module_changeFontSize.html":{"id":"viewerJS.module_changeFontSize.html","title":"Module: changeFontSize","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: changeFontSize This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module to raise and degrade the page font size. Version: 3.2.0 Source: viewer/viewerJS.changeFontSize.js, line 1 Requires module:jQuery Methods &lt;inner&gt; _degradeFontSize(current) Method to degrade the page font-size. Parameters: Name Type Description current Number The current font-size of the HTML-Element. Source: viewer/viewerJS.changeFontSize.js, line 114 &lt;inner&gt; _parseFontSize(string) Method which parses a given pixel value to a number and returns it. Parameters: Name Type Description string String The string to parse. Source: viewer/viewerJS.changeFontSize.js, line 172 &lt;inner&gt; _raiseFontSize(current) Method to raise the page font-size. Parameters: Name Type Description current Number The current font-size of the HTML-Element. Source: viewer/viewerJS.changeFontSize.js, line 143 &lt;inner&gt; _saveFontSize(size) Method to save the current font-size to local storage as a string. Parameters: Name Type Description size String The String to save in local storage. Source: viewer/viewerJS.changeFontSize.js, line 187 &lt;inner&gt; _setButtonState() Method to set the state of the font-size change buttons. Source: viewer/viewerJS.changeFontSize.js, line 222 &lt;inner&gt; _setFontSize() Method to set the current font-size from local storage to the HTML-Element. Source: viewer/viewerJS.changeFontSize.js, line 202 &lt;inner&gt; init(config) Method which initializes the font size switcher. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description fontDownBtn String The ID/Class of the font degrade button. fontUpBtn String The ID/Class of the font upgrade button. maxFontSize String The maximum font size the document shouldscale up. minFontSize String The minimum font size the document shouldscale down. baseFontSize String The base font size of the HTML-Element. Source: viewer/viewerJS.changeFontSize.js, line 40 Example &lt;pre&gt; var changeFontSizeConfig = { fontDownBtn: '#fontSizeDown', fontUpBtn: '#fontSizeUp', maxFontSize: 18, minFontSize: 14 }; viewerJS.changeFontSize.init( changeFontSizeConfig ); &lt;/pre&gt; Ã— Search results Close "},"viewerJS.module_dataTable.html":{"id":"viewerJS.module_dataTable.html","title":"Module: dataTable","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: dataTable This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module to manage the data table features. Version: 3.2.0 Source: viewer/viewerJS.dataTable.js, line 1 Requires module:jQuery Ã— Search results Close "},"viewerJS.module_dateSortedFeed.html":{"id":"viewerJS.module_dateSortedFeed.html","title":"Module: dateSortedFeed","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: dateSortedFeed This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module to render a RSS-Feed sorted by date. Version: 3.2.0 Source: viewer/viewerJS.dateSortedFeed.js, line 1 Requires module:jQuery Methods &lt;inner&gt; _dateConverter(str) Converts a date to this form: 16. November 2015 Parameters: Name Type Description str String The date to convert. Source: viewer/viewerJS.dateSortedFeed.js, line 193 Returns: The new formated date. Type String &lt;inner&gt; _renderFeed(data) Renders the feed and appends it to the wrapper. Parameters: Name Type Description data Object An JSON object of the feed data. Source: viewer/viewerJS.dateSortedFeed.js, line 162 &lt;inner&gt; getDataEncoding() Returns the type of encoding. Source: viewer/viewerJS.dateSortedFeed.js, line 140 Returns: The type of encoding. Type String &lt;inner&gt; getDataSortOrder(str) Sets the sorting order of the feed. Parameters: Name Type Description str String The sorting order (asc/desc) Source: viewer/viewerJS.dateSortedFeed.js, line 110 &lt;inner&gt; getDataSortOrder() Returns the number of entries from the feed. Source: viewer/viewerJS.dateSortedFeed.js, line 120 Returns: The number of entries. Type String &lt;inner&gt; getDataSortOrder() Returns the sorting order of the feed. Source: viewer/viewerJS.dateSortedFeed.js, line 100 Returns: The sorting order. Type String &lt;inner&gt; init(config) Method which initializes the date sorted RSS-Feed. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description path String The rootpath of the application. feedBox Object An jQuery object of the wrapper DIV. Source: viewer/viewerJS.dateSortedFeed.js, line 41 Example &lt;pre&gt; var dateSortedFeedConfig = { path: '#{request.contextPath}', feedBox: $( '#dateSortedFeed' ) }; viewerJS.dateSortedFeed.setDataSortOrder( '#{cc.attrs.sorting}' ); viewerJS.dateSortedFeed.setDataCount( '#{cc.attrs.count}' ); viewerJS.dateSortedFeed.setDataEncoding( '#{cc.attrs.encoding}' ); viewerJS.dateSortedFeed.init( dateSortedFeedConfig ); &lt;/pre&gt; &lt;inner&gt; setDataCount(The) Sets the number of entries from the feed. Parameters: Name Type Description The String number of entries. Source: viewer/viewerJS.dateSortedFeed.js, line 130 &lt;inner&gt; setDataEncoding(The) Sets the type of encoding. Parameters: Name Type Description The String type of encoding. Source: viewer/viewerJS.dateSortedFeed.js, line 150 Ã— Search results Close "},"viewerJS.module_download.html":{"id":"viewerJS.module_download.html","title":"Module: download","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: download This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which manages the download view. Version: 3.2.0 Source: viewer/viewerJS.download.js, line 1 Requires module:jQuery Methods &lt;inner&gt; checkboxValidation(state) Method which validates the checkstate of a checkbox and enables the downloadbutton. Parameters: Name Type Description state String The current checkstate of the checkbox. Source: viewer/viewerJS.download.js, line 57 &lt;inner&gt; init() Method to initialize the download view. Source: viewer/viewerJS.download.js, line 35 Ã— Search results Close "},"viewerJS.module_downloadModal.html":{"id":"viewerJS.module_downloadModal.html","title":"Module: downloadModal","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: downloadModal This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which generates a download modal which dynamic content. Version: 3.2.0 Source: viewer/viewerJS.downloadModal.js, line 1 Requires module:jQuery Methods &lt;inner&gt; buildAPICall(path, type, pi, logid, email) Method which returns an URL to trigger the ITM download task. Parameters: Name Type Description path String The current application path. type String The current file type to download. pi String The PI of the current work. logid String The LOG_ID of the current work. email String The current user email. Source: viewer/viewerJS.downloadModal.js, line 326 Returns: The URL to trigger the ITM download task. Type String &lt;inner&gt; getWorkInfo(pi, logid) Method which returns a promise if the work info has been reached. Parameters: Name Type Description pi String The PI of the work. logid String The LOG_ID of the work. Source: viewer/viewerJS.downloadModal.js, line 379 Returns: A promise object if the info has been reached. Type Promise &lt;inner&gt; init(config) Method to initialize the download modal mechanic. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description dataType String The data type of the current file to download. dataTitle String The title of the current file to download. dataId String The LOG_ID of the current file to download. dataPi String The PI of the current file to download. downloadBtn Object A collection of all buttons with the classattribute 'download-modal'. reCaptchaSiteKey String The site key for the google reCAPTCHA,fetched from the viewer config. path String The current application path. apiUrl String The URL to trigger the ITM download task. userEmail String The current user email if the user is loggedin. Otherwise the one which the user enters or leaves blank. modal Object A configuration object for the download modal. Properties Name Type Description id String The ID of the modal. label String The label of the modal. string Object An object of strings for the modal content. Properties Name Type Description title String The title of the modal. body String The content of the modal as HTML. closeBtn String Buttontext saveBtn String Buttontext messages Object An object of strings for the used textsnippets. Source: viewer/viewerJS.downloadModal.js, line 72 Example &lt;pre&gt; var downloadModalConfig = { downloadBtn: $( '.download-modal' ), path: '#{navigationHelper.applicationUrl}', userEmail: $( '#userEmail' ).val(), messages: { reCaptchaText: '#{msg.downloadReCaptchaText}', rcInvalid: '#{msg.downloadRcInvalid}', rcValid: '#{msg.downloadRcValid}', eMailText: '#{msg.downloadEMailText}', eMailTextLoggedIn: '#{msg.downloadEMailTextLoggedIn}', eMail: '#{msg.downloadEmail}', closeBtn: '#{msg.downloadCloseModal}', saveBtn: '#{msg.downloadGenerateFile}', } }; viewerJS.downloadModal.init( downloadModalConfig ); &lt;/pre&gt; &lt;inner&gt; initModal(params) Method which initializes the download modal and its content. Parameters: Name Type Description params Object An config object which overwrites the defaults. Source: viewer/viewerJS.downloadModal.js, line 171 &lt;inner&gt; renderModalBody(type, title) Method which returns a HTML-String to render the download modal body. Parameters: Name Type Description type String The current file type to download. title String The title of the current download file. Source: viewer/viewerJS.downloadModal.js, line 237 Returns: The HTML-String to render the download modal body. Type String &lt;inner&gt; validateReCaptcha(response) Method which checks the reCAPTCHA response. Parameters: Name Type Description response String The reCAPTCHA response. Source: viewer/viewerJS.downloadModal.js, line 307 Returns: Returns true if the reCAPTCHA sent a response. Type Boolean Ã— Search results Close "},"viewerJS.module_editComment.html":{"id":"viewerJS.module_editComment.html","title":"Module: editComment","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: editComment This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module to edit comments in user generated content. Version: 3.2.0 Source: viewer/viewerJS.editComment.js, line 1 Requires module:jQuery Methods &lt;inner&gt; init() Method which initializes all required events to edit comments. Source: viewer/viewerJS.editComment.js, line 39 Example &lt;pre&gt; $( document ).ready( function() { viewerJS.editComment.init(); } ); &lt;/pre&gt; Ã— Search results Close "},"viewerJS.module_helper.html":{"id":"viewerJS.module_helper.html","title":"Module: helper","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: helper This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which includes mostly used helper functions. Version: 3.2.0 Source: viewer/viewerJS.helper.js, line 1 Requires module:jQuery Methods &lt;inner&gt; checkLocalStorage() Method to check if itÂ´s possible to write to local Storage Source: viewer/viewerJS.helper.js, line 275 Returns: true or false Type Boolean &lt;inner&gt; detectIEVersion() Method to get the version number of the used MS Internet Explorer. Source: viewer/viewerJS.helper.js, line 240 Returns: The browser version. Type Number &lt;inner&gt; equalHeight(sidebar, content) Method to equal height of sidebar and content. Parameters: Name Type Description sidebar String The selector of the sidebar. content String The selector of the content. Source: viewer/viewerJS.helper.js, line 326 &lt;inner&gt; getCurrentBrowser() Method to get the current used browser. Source: viewer/viewerJS.helper.js, line 378 Returns: The name of the current Browser. Type String &lt;inner&gt; getRemoteData(url) Returns an JSON object from a API call. Parameters: Name Type Description url String The API call URL. Source: viewer/viewerJS.helper.js, line 130 Returns: A promise object, which tells about the success of receivingdata. Type Object Example &lt;pre&gt; viewerJS.helper.getRemoteData( dataURL ); &lt;/pre&gt; &lt;inner&gt; renderAlert(type, content, dismissable) Returns a BS Alert with dynamic content. Parameters: Name Type Description type String The type of the alert. content String The content of the alert. dismissable Boolean Sets the option to make the alert dismissable,true = dismissable. Source: viewer/viewerJS.helper.js, line 212 Returns: A HTML-String which renders the alert. Type String &lt;inner&gt; renderModal(config) Returns a BS Modal with dynamic content. Parameters: Name Type Description config Object An config object which includes the content of themodal. Properties Name Type Description id String The ID of the modal. label String The label of the modal. string Object An object of strings for the modal content. Properties Name Type Description title String The title of the modal. body String The content of the modal as HTML. closeBtn String Buttontext saveBtn String Buttontext Source: viewer/viewerJS.helper.js, line 158 Returns: A HTML-String which renders the modal. Type String &lt;inner&gt; renderWarningPopover(msg) Method to render a warning popover. Parameters: Name Type Description msg String The message to show in the popover. Source: viewer/viewerJS.helper.js, line 297 Returns: An jQuery Object to append to DOM. Type Object &lt;inner&gt; saveSidebarTocPosition() Method which calculates the current position of the active element in sidebartoc and the image container position and saves it to lacal storage. Source: viewer/viewerJS.helper.js, line 62 Example &lt;pre&gt; viewerJS.helper.saveSidebarTocPosition(); &lt;/pre&gt; &lt;inner&gt; truncateString(str, size) Method to truncate a string to a given length. Parameters: Name Type Description str String The string to truncate. size Number The number of characters after the string should becroped. Source: viewer/viewerJS.helper.js, line 32 Returns: The truncated string. Type String Example &lt;pre&gt; viewerJS.helper.truncateString( $( '.something' ).text(), 75 ); &lt;/pre&gt; &lt;inner&gt; validateReCaptcha(wrapper, key) Method to validate the reCAPTCHA response. Parameters: Name Type Description wrapper String The reCAPTCHA widget wrapper. key String The reCAPTCHA site key. Source: viewer/viewerJS.helper.js, line 352 Returns: Returns true if the response is valid. Type Boolean Ã— Search results Close "},"viewerJS.module_navigation.html":{"id":"viewerJS.module_navigation.html","title":"Module: navigation","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: navigation This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. This module drives the functionality of the main navigation from the Goobi viewer. Version: 3.2.0 Source: viewer/viewerJS.navigation.js, line 1 Requires module:jQuery Methods &lt;inner&gt; _calcSubMenuPosition(menu) Method to calculate the position of the shown submenu. Parameters: Name Type Description menu Object An jQuery object of the current submenu. Source: viewer/viewerJS.navigation.js, line 138 &lt;inner&gt; _resetMenus() Method to reset all shown menus. Source: viewer/viewerJS.navigation.js, line 112 &lt;inner&gt; _resetSubMenus() Method to reset all shown submenus. Source: viewer/viewerJS.navigation.js, line 128 &lt;inner&gt; init(config) Method to initialize the viewer main navigation. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description navigationSelector String The selector for the navigationelement. subMenuSelector String The selector for the submenu element. megaMenuSelector String The selector for the mega menu element. closeMegaMenuSelector String The selector for the close megamenu element. Source: viewer/viewerJS.navigation.js, line 37 Ã— Search results Close "},"viewerJS.module_nerFacetting.html":{"id":"viewerJS.module_nerFacetting.html","title":"Module: nerFacetting","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: nerFacetting This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which facetts the NER-Tags in a sidebar widget and Pageview. Version: 3.2.0 Source: viewer/viewerJS.nerFacetting.js, line 1 Requires module:jQuery module:Bootstrap Methods &lt;inner&gt; _cleanUpLocalStorage() Method which removes all set local storage values. Source: viewer/viewerJS.nerFacetting.js, line 938 &lt;inner&gt; _getPageCount(work) Method which returns the page count of the current work. Parameters: Name Type Description work Object The current wor object. Source: viewer/viewerJS.nerFacetting.js, line 908 Returns: The page count of the current work. Type Number &lt;inner&gt; _hideCurrentTags() Method which hides the current tag row tooltip. Source: viewer/viewerJS.nerFacetting.js, line 545 &lt;inner&gt; _renderOverview(data) Method to render the NER overview. Parameters: Name Type Description data Object A JSON-Object. Source: viewer/viewerJS.nerFacetting.js, line 410 Returns: A HTML-String which renders the overview. Type Sting &lt;inner&gt; _renderPageBubble(page) Method which renders a span showing the current page section. Parameters: Name Type Description page Number The current pagenumber. Source: viewer/viewerJS.nerFacetting.js, line 828 &lt;inner&gt; _renderSection(data) Method to render the NER section. Parameters: Name Type Description data Object A JSON-Object. Source: viewer/viewerJS.nerFacetting.js, line 554 &lt;inner&gt; _renderSectionTags(data) Method which renders the tags in the section area. Parameters: Name Type Description data Object A JSON-Object. Source: viewer/viewerJS.nerFacetting.js, line 784 Returns: A HTML-String which renders the tag section. Type Sting &lt;inner&gt; _resetFacettingIcons() Method which resets all facetting icons to default Source: viewer/viewerJS.nerFacetting.js, line 924 &lt;inner&gt; _showCurrentTags($obj) Method which shows the current tag row in a tooltip. Parameters: Name Type Description $obj Object An jQuery object of the current tag row. Source: viewer/viewerJS.nerFacetting.js, line 503 &lt;inner&gt; init(config) Method to initialize the NER-Widget or NER-View. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description currentPage String The name of the current page. baseUrl String The root URL. apiUrl String The base URL for the API-Calls. workId String The ID of the current work. overviewTrigger String The ID/Class of the overview trigger. overviewContent String The ID/Class of the content section fromoverview. sectionTrigger String The ID/Class of the section trigger. sectionContent String The ID/Class of the content section fromsection. facettingTrigger String The ID/Class of the facetting trigger. setTagRange String The ID/Class of the select menu for therange. slider String The ID/Class of the tag range slider. sliderScale String The ID/Class of the slider scale. sectionTags String The ID/Class of the tag section. currentTags String The ID/Class of the tag container. sliderHandle String The ID/Class of the slider handle. sliderSectionStripe String The ID/Class of the range stripe onthe slider. recurrenceNumber Number The number of displayed tags in a row. recurrenceSectionNumber Number The number of displayed tags ina section. sidebarRight Boolean If true, the current tag row will show upto the left of the sidebar widget. loader String The ID/Class of the AJAX-Loader. msg Object An object of strings for multi language use. Source: viewer/viewerJS.nerFacetting.js, line 77 Ã— Search results Close "},"viewerJS.module_nerFulltext.html":{"id":"viewerJS.module_nerFulltext.html","title":"Module: nerFulltext","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: nerFulltext This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module to render NER-Popovers in fulltext pages. Version: 3.2.0 Source: viewer/viewerJS.nerFulltext.js, line 1 Requires module:jQuery Methods &lt;inner&gt; _calculateNerPopoverPosition(triggerCoords, textBoxCoords) Method which calculates the position of the popover in the DOM. Parameters: Name Type Description triggerCoords Object A jQuery object including the position of the clickedtrigger. textBoxCoords Object A jQuery object including the position of the parentDIV. Source: viewer/viewerJS.nerFulltext.js, line 291 Returns: An object which includes the position of the popover. Type Object &lt;inner&gt; _getRemoteData(target) Method which fetches data from the API and returns an JSON object. Parameters: Name Type Description target String The API call URL. Source: viewer/viewerJS.nerFulltext.js, line 70 Returns: The JSON object with the API data. Type Object &lt;inner&gt; _initNerPopover(path) Method which initializes the events for the NER-Popovers. Parameters: Name Type Description path String The root path of the application. Source: viewer/viewerJS.nerFulltext.js, line 103 &lt;inner&gt; _removeNerPopover() Method to remove a popover from the DOM. Source: viewer/viewerJS.nerFulltext.js, line 328 &lt;inner&gt; _renderNerPopover(data, position, title, path) Method which renders a popover to the DOM. Parameters: Name Type Description data Object The JSON object from the API. position Object A jQuery object including the position of the clickedtrigger. title String The value of the title attribute from the clicked trigger. path String The root path of the application. Source: viewer/viewerJS.nerFulltext.js, line 152 Returns: The HTML string which renders the popover. Type String &lt;inner&gt; _renderNerPopoverDetail(data, title) Method which renders detail information into the popover. Parameters: Name Type Description data Object The JSON object from the API. title String The value of the title attribute from the clicked trigger. Source: viewer/viewerJS.nerFulltext.js, line 244 Returns: The HTML string which renders the details. Type String &lt;inner&gt; init(config) Method which initializes the NER Popover methods. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description path String The rootpath of the application. Source: viewer/viewerJS.nerFulltext.js, line 39 Example &lt;pre&gt; var nerConfig = { path: '#{request.contextPath}' }; viewerJS.nerFulltext.init( nerConfig ); &lt;/pre&gt; Ã— Search results Close "},"viewerJS.module_normdata.html":{"id":"viewerJS.module_normdata.html","title":"Module: normdata","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: normdata This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module to render popovers including normdata. Version: 3.2.0 Source: viewer/viewerJS.normdata.js, line 1 Requires module:jQuery module:Bootstrap Methods &lt;inner&gt; _buildPopover(data, id) Returns an HTML-String which renders the fetched data into a popover. Parameters: Name Type Description data Object The JSON-Object which includes the data. id String The incremented id of the popover. Source: viewer/viewerJS.normdata.js, line 161 Returns: The HTML-String with the fetched data. Type String &lt;inner&gt; _calculateFirstLevelPopoverPosition(id, pos, $Obj) Sets the position to the first level popovers. Parameters: Name Type Description id String The incremented id of the popover. pos Object An Object with the current position oft the clicked link. $Obj Object An jQuery-Object of the clicked link. Source: viewer/viewerJS.normdata.js, line 227 &lt;inner&gt; _closeAllNormdataPopovers() Removes all popovers from the DOM on click. Source: viewer/viewerJS.normdata.js, line 297 &lt;inner&gt; _closeNormdataPopover() Removes current popover from the DOM on click. Source: viewer/viewerJS.normdata.js, line 275 &lt;inner&gt; _getRemoteData() Returns an JSON object from a API call. Source: viewer/viewerJS.normdata.js, line 333 Returns: The JSON object with the API data. Type Object &lt;inner&gt; _renderPopoverAction($Obj, id) Method which executes the click event action of the popover. Parameters: Name Type Description $Obj Object The jQuery object of the current clicked link. id String The current id of the popover. Source: viewer/viewerJS.normdata.js, line 101 &lt;inner&gt; init(config) Method to initialize the timematrix slider and the events which builds thematrix and popovers. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description id String The starting ID of the popover. path String The rootpath of the application. lang Object An object of localized strings. elemWrapper Object An jQuery object of the wrapper DIV. Source: viewer/viewerJS.normdata.js, line 48 Example &lt;pre&gt; var normdataConfig = { path: '#{request.contextPath}', lang: { popoverTitle: '#{msg.normdataPopverTitle}', popoverClose: '#{msg.normdataPopoverClose}' }, elemWrapper: $( '#metadataElementWrapper' ) }; viewerJS.normdata.init( normdataConfig ); &lt;/pre&gt; Ã— Search results Close "},"viewerJS.module_pageScroll.html":{"id":"viewerJS.module_pageScroll.html","title":"Module: pageScroll","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: pageScroll This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module to scroll a page back to top animated. Version: 3.2.0 Source: viewer/viewerJS.pageScroll.js, line 1 Requires module:jQuery Methods &lt;inner&gt; _scrollPage(anchor) Method which scrolls the page animated. Parameters: Name Type Description anchor String The name of the anchor to scroll to. Source: viewer/viewerJS.pageScroll.js, line 59 &lt;inner&gt; init(obj, anchor) Initializes the animated pagescroll. Parameters: Name Type Description obj String The selector of the jQuery object. anchor String The name of the anchor to scroll to. Source: viewer/viewerJS.pageScroll.js, line 32 Ã— Search results Close "},"viewerJS.module_responsiveColumnGallery.html":{"id":"viewerJS.module_responsiveColumnGallery.html","title":"Module: responsiveColumnGallery","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: responsiveColumnGallery This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which generates a responsive image gallery in columns. Version: 3.2.0 Source: viewer/viewerJS.responsiveColumnGallery.js, line 1 Requires module:jQuery Methods &lt;inner&gt; centerLightbox($obj) Method which centers the given object to the viewport. Parameters: Name Type Description $obj Object An jQuery object of the element to center. Source: viewer/viewerJS.responsiveColumnGallery.js, line 326 &lt;inner&gt; checkForSmallViewport() Method which checks the viewport width and returns true if itÂ´s smaller then375px. Source: viewer/viewerJS.responsiveColumnGallery.js, line 256 Returns: Returns true if itÂ´s smaller then 375px. Type Boolean &lt;inner&gt; fixedHeight($obj) Method which sets a fixed height to the gallery images. Parameters: Name Type Description $obj Object An jQuery object of the element which height should befixed. Source: viewer/viewerJS.responsiveColumnGallery.js, line 239 &lt;inner&gt; init(config) Method which initializes the column gallery. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description themePath String The path to the current activated viewertheme. imagePath String The path to the used images. imageDataFile String The path to the JSON-File, which containsthe images data. galleryObject Object The DIV where the gallery should berendered. maxColumnCount Number Count count of the gallery, 4 column aremaximum. maxImagesPerColumn Number Count of the images per column. fixedHeight Boolean If true the images have a fixed height,default is false. maxHeight String Sets the given max height value for theimages. caption Boolean If true the gallery images have a caption withthe title text, default is true. overlayColor String Takes a HEX-value to set the color of theimage overlay. lang Object An object of strings for multilanguagefunctionality. lightbox Object An Object to configure the image lightbox. Properties Name Type Description active Boolean If true the lightbox functionality isenabled, default is true. caption Boolean If true the lightbox has a captiontext, default is true. Source: viewer/viewerJS.responsiveColumnGallery.js, line 57 &lt;inner&gt; prepareLightbox($obj) Method which prepares the lightbox object with the required data. Parameters: Name Type Description $obj Object An jQuery object which includes the required dataattributes. Source: viewer/viewerJS.responsiveColumnGallery.js, line 276 Returns: An Object which includes the required data. Type Object &lt;inner&gt; renderColumns(count) Method which renders the gallery columns. Parameters: Name Type Description count String The column count of the gallery. Source: viewer/viewerJS.responsiveColumnGallery.js, line 178 Returns: A HTML-String which renders a column. Type String &lt;inner&gt; renderImages(data) Method which renders the gallery images. Parameters: Name Type Description data Object An object of image data to render the images. Source: viewer/viewerJS.responsiveColumnGallery.js, line 196 Returns: A HTML-String which renders the gallery images. Type String &lt;inner&gt; renderLightbox(data) Method which renders a lightbox for the selected image. Parameters: Name Type Description data Object An object which includes the required data. Source: viewer/viewerJS.responsiveColumnGallery.js, line 296 Returns: A HTML-String which renders the lightbox. Type String Ã— Search results Close "},"viewerJS.module_searchAdvanced.html":{"id":"viewerJS.module_searchAdvanced.html","title":"Module: searchAdvanced","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: searchAdvanced This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which sets up the functionality for search advanced. Version: 3.2.0 Source: viewer/viewerJS.searchAdvanced.js, line 1 Requires module:jQuery Methods &lt;inner&gt; init(config) Method to initialize the search advanced features. Parameters: Name Type Description config Object An config object which overwrites the defaults. Source: viewer/viewerJS.searchAdvanced.js, line 37 Ã— Search results Close "},"viewerJS.module_searchList.html":{"id":"viewerJS.module_searchList.html","title":"Module: searchList","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: searchList This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which sets up the functionality for search list. Version: 3.2.0 Source: viewer/viewerJS.searchList.js, line 1 Requires module:jQuery Methods &lt;inner&gt; _getApiUrl(id) Method to get the full REST-API URL. Parameters: Name Type Description id String The current IDDoc of the hit set. Source: viewer/viewerJS.searchList.js, line 161 Returns: The full REST-API URL. Type String &lt;inner&gt; _renderChildHits(data, $this) Method which renders the child hits into the DOM. Parameters: Name Type Description data Object The data object which contains the child hits. $this Object The current child hits trigger. Source: viewer/viewerJS.searchList.js, line 177 Returns: An jquery object which contains the child hits. Type Object &lt;inner&gt; _renderGetMoreChildren() Method to render a get more children link. Source: viewer/viewerJS.searchList.js, line 377 &lt;inner&gt; _renderHitSetTitle(data) Method which renders the hit set title. Parameters: Name Type Description data Object The data object which contains the hit set title values. Source: viewer/viewerJS.searchList.js, line 220 Returns: A jquery object which contains the hit set title. Type Object &lt;inner&gt; _renderMetdataInfo(data, url) Method which renders metadata info. Parameters: Name Type Description data Object The data object which contains the sub hit values. url String The URL for the current work. Source: viewer/viewerJS.searchList.js, line 251 Returns: A jquery object which contains the metadata info. Type Object &lt;inner&gt; _renderSubChildHits(data, type) Method which renders sub child hits. Parameters: Name Type Description data Object The data object which contains the sub hit values. type String The type of hit to render. Source: viewer/viewerJS.searchList.js, line 308 Returns: A jquery object which contains the sub child hits. Type Object &lt;inner&gt; init(config) Method to initialize the search list features. Parameters: Name Type Description config Object An config object which overwrites the defaults. Source: viewer/viewerJS.searchList.js, line 50 Ã— Search results Close "},"viewerJS.module_searchSortingDropdown.html":{"id":"viewerJS.module_searchSortingDropdown.html","title":"Module: searchSortingDropdown","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: searchSortingDropdown This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which sets up the sorting functionality for search list. Version: 3.2.0 Source: viewer/viewerJS.searchSortingDropdown.js, line 1 Requires module:jQuery Methods &lt;inner&gt; init(config) Method to initialize the search sorting widget. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description select Object An jQuery object which holds the sorting menu. Source: viewer/viewerJS.searchSortingDropdown.js, line 40 Ã— Search results Close "},"viewerJS.module_simpleLightbox.html":{"id":"viewerJS.module_simpleLightbox.html","title":"Module: simpleLightbox","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: simpleLightbox This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module to render a simple lightbox for images. Version: 3.2.0 Source: viewer/viewerJS.simpleLightBox.js, line 1 Example &lt;img src=&quot;/your/path/to/the/image.jpg&quot; class=&quot;lightbox-image&quot; data-imgpath=&quot;/your/path/to/the/&quot; data-imgname=&quot;image.jpg&quot; alt=&quot;&quot; /&gt; * Requires module:jQuery Methods &lt;inner&gt; _centerModalBox($Obj) Puts the lightbox to the center of the screen. Parameters: Name Type Description $Obj Object Must be a jQuery-Object like $('.something') Source: viewer/viewerJS.simpleLightBox.js, line 120 &lt;inner&gt; _getImageName($Obj) Returns the image name from the 'data-imgname' attribute. Parameters: Name Type Description $Obj Object Must be a jQuery-Object like $('.something') Source: viewer/viewerJS.simpleLightBox.js, line 84 Returns: The image name from the 'data-imgname' attribute. Type String &lt;inner&gt; _getImagePath($Obj) Returns the image path from the 'data-imgpath' attribute. Parameters: Name Type Description $Obj Object Must be a jQuery-Object like $('.something') Source: viewer/viewerJS.simpleLightBox.js, line 70 Returns: The image path from the 'data-imgpath' attribute. Type String &lt;inner&gt; _setupLightBox(path, name) Returns a HTML-String which renders the lightbox. Parameters: Name Type Description path String The path to the big image. name String The name of the big image. Source: viewer/viewerJS.simpleLightBox.js, line 98 Returns: The HTML-Code to render the lightbox. Type String &lt;inner&gt; init() Initializes an event (click) which renders a lightbox with an bigger image. Source: viewer/viewerJS.simpleLightBox.js, line 35 Example &lt;pre&gt; viewerJS.simpleLightBox.init(); &lt;/pre&gt; Ã— Search results Close "},"viewerJS.module_stackedThumbnails.html":{"id":"viewerJS.module_stackedThumbnails.html","title":"Module: stackedThumbnails","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: stackedThumbnails This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which renders CSS featured stacked thumbnails in search list for multivolumeworks. Version: 3.2.0 Source: viewer/viewerJS.stackedThumbnails.js, line 1 Requires module:jQuery Methods &lt;inner&gt; init(config) Method to initialize the timematrix slider and the events which builds thematrix and popovers. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description thumbs Object All jQuery objects of the stacked thumbnails. thumbsBefore String The classname of the stacked thumbnailbefore element. thumbsAfter String The classname of the stacked thumbnail afterelement. Source: viewer/viewerJS.stackedThumbnails.js, line 39 Ã— Search results Close "},"viewerJS.module_timematrix.html":{"id":"viewerJS.module_timematrix.html","title":"Module: timematrix","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: timematrix This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module to create an imagemap sorted by the year of creation. Version: 3.2.0 Source: viewer/viewerJS.timematrix.js, line 1 Requires module:jQuery Methods &lt;inner&gt; _calculatePopoverPosition(triggerCoords, tmCanvasCoords) Method which calculates the position of the popover. Parameters: Name Type Description triggerCoords Object An object which contains the coordinates of theelement has been clicked. tmCanvasCoords Object An object which contains the coordinates of thewrapper element from the timematrix. Source: viewer/viewerJS.timematrix.js, line 289 Returns: An object which contains the top and the left position of thepopover. Type Object &lt;inner&gt; _removePopovers() Method which removes all popovers. Source: viewer/viewerJS.timematrix.js, line 348 &lt;inner&gt; _renderPopover($Obj, lang) Method to render a popover with a thumbnail image. Parameters: Name Type Description $Obj Object Must be an jQuery-Object like $(this). lang Object An Object with localized strings in the selected language. Source: viewer/viewerJS.timematrix.js, line 247 &lt;inner&gt; _renderSliderBubble(time, val) Method which renders the bubbles for the slider. Parameters: Name Type Description time String The string for the time value. val String The string for the value. Source: viewer/viewerJS.timematrix.js, line 331 Returns: HTML-String which renders the slider-bubble. Type String &lt;inner&gt; _renderThumbs(json) Method to render image thumbnails to the timematrix canvas. Parameters: Name Type Description json Object An JSON-Object which contains the image data. Source: viewer/viewerJS.timematrix.js, line 209 Returns: HTML-String which displays the image thumbnails. Type String &lt;inner&gt; init(config) Method to initialize the timematrix slider and the events which builds thematrix and popovers. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description contextPath String The rootpath of the application. apiQuery String The API action to call. startDateQuery String The GET-Parameter for the start date. rangeInput1 Object An jQuery object of the first range input. startDate String The value of the first range input. endDateQuery String The GET-Parameter for the end date. rangeInput2 Object An jQuery object of the second range input. endDate String The value of the second range input. countQuery String The GET-Parameter for the count query. count String The number of results from the query. $tmCanvas Object An jQuery object of the timematrix canvas. $tmCanvasPos Object An jQuery object of the timematrix canvasposition. lang Object An object of localized strings. Source: viewer/viewerJS.timematrix.js, line 50 Example &lt;pre&gt; $( document ).ready( function() { var timematrixConfig = { path: '#{request.contextPath}/', lang: { closeWindow: '#{msg.timematrixCloseWindow}', goToWork: '#{msg.timematrixGoToWork}' } }; viewerJS.timematrix.init( timematrixConfig ); } ); &lt;/pre&gt; Ã— Search results Close "},"viewerJS.module_tinyMce.html":{"id":"viewerJS.module_tinyMce.html","title":"Module: tinyMce","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: tinyMce This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Version: 3.2.0 Source: viewer/viewerJS.tinyMce.js, line 1 Requires module:jQuery Ã— Search results Close "},"viewerJS.module_userDropdown.html":{"id":"viewerJS.module_userDropdown.html","title":"Module: userDropdown","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: userDropdown This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module to manage the user dropdown. Version: 3.2.0 Source: viewer/viewerJS.userDropdown.js, line 1 Requires module:jQuery Ã— Search results Close "},"viewerJS.module_versionHistory.html":{"id":"viewerJS.module_versionHistory.html","title":"Module: versionHistory","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: versionHistory This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which renders current and other versions of a work into a widget. Version: 3.2.0 Source: viewer/viewerJS.versionHistory.js, line 1 Requires module:jQuery Methods &lt;inner&gt; init(config) Method to initialize the version history widget. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description versions Array An array which holds all versions. json Object An JSON-Object which takes all versions. imgUrl String The image URL for the current work. imgPi String The PI for the image of the current work. versionLink String A string placeholder for the final HTML. widgetInputs String A string placeholder for the final HTML. widgetList String A string placeholder for the final HTML. Source: viewer/viewerJS.versionHistory.js, line 40 Ã— Search results Close "},"viewImage.controls.module_persistence.html":{"id":"viewImage.controls.module_persistence.html","title":"Module: persistence","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: persistence This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which handles the persistence of zoom and rotation levels. Version: 3.2.0 Source: viewImage/viewImage.controls.persistence.js, line 1 Requires module:jQuery Ã— Search results Close "},"viewImage.module_controls.html":{"id":"viewImage.module_controls.html","title":"Module: controls","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: controls This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which handles the image controls of the image view. Version: 3.2.0 Source: viewImage/viewImage.controls.js, line 1 Requires module:jQuery Ã— Search results Close "},"viewImage.module_drawLine.html":{"id":"viewImage.module_drawLine.html","title":"Module: drawLine","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: drawLine This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which drwas a line to the image. Version: 3.2.0 Source: viewImage/viewImage.drawLine.js, line 1 Requires module:jQuery Ã— Search results Close "},"viewImage.module_drawRect.html":{"id":"viewImage.module_drawRect.html","title":"Module: drawRect","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: drawRect This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which draws rectangles to the image to highlight areas. Version: 3.2.0 Source: viewImage/viewImage.drawRect.js, line 1 Requires module:jQuery Ã— Search results Close "},"viewImage.module_Measures.html":{"id":"viewImage.module_Measures.html","title":"Module: Measures","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: Measures This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which contains all image informations like size, scale etc. Version: 3.2.0 Source: viewImage/viewImage.measures.js, line 1 Requires module:jQuery Ã— Search results Close "},"viewImage.module_overlays.html":{"id":"viewImage.module_overlays.html","title":"Module: overlays","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: overlays This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which shows existing overlays on images. Version: 3.2.0 Source: viewImage/viewImage.overlays.js, line 1 Requires module:jQuery Ã— Search results Close "},"viewImage.module_readingMode.html":{"id":"viewImage.module_readingMode.html","title":"Module: readingMode","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: readingMode This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which handles the viewer reading mode. Version: 3.2.0 Source: viewImage/viewImage.readingMode.js, line 1 Requires module:jQuery Methods &lt;inner&gt; _checkSidebarStatus() Method which checks the current sidebar status, based on a local storage value. Source: viewImage/viewImage.readingMode.js, line 267 Returns: Returns false if the sidebar is inactive, returns true if thesidebar is active. Type Boolean &lt;inner&gt; _setSidebarButtonPosition() Method which sets the position of the sidebar toggle button. Source: viewImage/viewImage.readingMode.js, line 246 &lt;inner&gt; _setSidebarTabHeight() Method which sets the height of the sidebar Tabs. Source: viewImage/viewImage.readingMode.js, line 216 &lt;inner&gt; _setViewportHeight() Method which sets the height of the viewport elements. Source: viewImage/viewImage.readingMode.js, line 184 &lt;inner&gt; _showContent() Method which shows the content by removing CSS-Classes after loading every pageelement. Source: viewImage/viewImage.readingMode.js, line 292 &lt;inner&gt; init(config) Method to initialize the viewer reading mode. Parameters: Name Type Description config Object An config object which overwrites the defaults. Properties Name Type Description navSelector String A string which contains the selector for thenavigation. viewSelector String A string which contains the selector forthe content view. imageContainerSelector String A string which contains theselector for the image container. imageSelector String A string which contains the selector forthe image. sidebarSelector String A string which contains the selector forthe sidebar. sidebarToggleButton String A string which contains the selectorfor the sidebar toggle button. sidebarInnerSelector String A string which contains theselector for the inner sidebar container. sidebarStatus String A string which contains the currentsidebar status. Source: viewImage/viewImage.readingMode.js, line 49 Ã— Search results Close "},"viewImage.module_tileSourceResolver.html":{"id":"viewImage.module_tileSourceResolver.html","title":"Module: tileSourceResolver","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: tileSourceResolver This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which interprets the image information. Version: 3.2.0 Source: viewImage/viewImage.tileSourceResolver.js, line 1 Requires module:jQuery Ã— Search results Close "},"viewImage.module_transformRect.html":{"id":"viewImage.module_transformRect.html","title":"Module: transformRect","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: transformRect This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which resizes existing rectangles on an image. Version: 3.2.0 Source: viewImage/viewImage.transformRect.js, line 1 Requires module:jQuery Ã— Search results Close "},"viewImage.module_zoomSlider.html":{"id":"viewImage.module_zoomSlider.html","title":"Module: zoomSlider","body":" DocStrap Modules cmsJS.createPagecmsJS.geoLocationscmsJS.masonrycmsJS.rssFeedcmsJS.sortableListcmsJS.stackedCollectioncmsJS.staticGridcmsJS.tagListcmsJS.tileGridcmsJSviewerJSviewImageviewerJS.bookshelvesSessionviewerJS.bookshelvesUserviewerJS.calendarPopoverviewerJS.changeFontSizeviewerJS.dataTableviewerJS.dateSortedFeedviewerJS.downloadviewerJS.downloadModalviewerJS.editCommentviewerJS.helperviewerJS.navigationviewerJS.nerFacettingviewerJS.nerFulltextviewerJS.normdataviewerJS.pageScrollviewerJS.responsiveColumnGalleryviewerJS.searchAdvancedviewerJS.searchListviewerJS.searchSortingDropdownviewerJS.simpleLightboxviewerJS.stackedThumbnailsviewerJS.timematrixviewerJS.tinyMceviewerJS.userDropdownviewerJS.versionHistoryviewImage.controls.persistenceviewImage.controlsviewImage.drawLineviewImage.drawRectviewImage.MeasuresviewImage.overlaysviewImage.readingModeviewImage.tileSourceResolverviewImage.transformRectviewImage.zoomSlider Global _addAutomaticNamedBookshelf_addBookshelfItemByPi_addBookshelfItemByPiLogidPage_addNamedBookshelf_addSessionBookshelf_addSessionBookshelfNamed_buildGrid_buildPopover_calcSubMenuPosition_calculateFirstLevelPopoverPosition_calculateNerPopoverPosition_calculatePopoverPosition_centerModalBox_changePos_checkSidebarStatus_cleanUpLocalStorage_closeAllNormdataPopovers_closeNormdataPopover_createListElement_createTagInputElement_dateConverter_degradeFontSize_deleteAllSessionElements_deleteBookshelfById_deleteBookshelfItemByPi_deleteBookshelfItemByPiLogidPage_deleteSessionElement_getAllBookshelves_getAllSessionElements_getApiUrl_getBookshelfById_getBookshelfItemCount_getCenterCoords_getContainingBookshelfItemByPi_getContainingBookshelfItemByPiLogidPage_getImageName_getImagePath_getJQueryItem_getLevel_getMapFeatures_getPageCount_getPopoverContent_getPublicBookshelves_getRemoteData_getSharedBookshelves_handleBeforeDropFromAvailable_handleClickTerminator_handleDrop_handleInputChange_hideCurrentTags_initNerPopover_isElementSet_isItemInBookshelf_parseFontSize_raiseFontSize_readTags_removeNerPopover_removePopovers_renderBookshelfNavigationList_renderBookshelfPopoverList_renderBookshelfPopup_renderChildHits_renderCollections_renderDropdownList_renderFeed_renderGetMoreChildren_renderHitSetTitle_renderList_renderMasonryGrid_renderMetdataInfo_renderNerPopover_renderNerPopoverDetail_renderOverview_renderPageBubble_renderPopover_renderPopoverAction_renderRssFeed_renderSection_renderSectionTags_renderSliderBubble_renderSubChildHits_renderSubCollections_renderThumbs_resetFacettingIcons_resetMenus_resetSubMenus_saveFontSize_scrollPage_serializeVisibleItems_setAddActiveState_setAddedStatus_setBookshelfName_setButtonState_setFontSize_setSessionElement_setSessionElementCount_setSidebarButtonPosition_setSidebarTabHeight_setupLightBox_setViewportHeight_showContent_showCurrentTags_updateAllSortIcons_updateSortIcons_writeTagsaddTagbuildAPICallcenterLightboxcheckboxValidationcheckForSmallViewportcheckLocalStorageclosecontainsdecreaseLeveldeleteTagdetectIEVersiondisablePreviewenablePreviewequalHeightfixedHeightgetCurrentBrowsergetDataEncodinggetDataSortOrdergetRemoteDatagetTaggetTagsgetTagValuesgetValuegetWorkInfoincreaseLevelinitinitModalinitSortablesprepareLightboxrenderAlertrenderColumnsrenderImagesrenderLightboxrenderModalrenderModalBodyrenderWarningPopoversaveSidebarTocPositionsaveTagssetDataCountsetDataEncodingStatisticstruncateStringvalidateReCaptcha Module: zoomSlider This file is part of the Goobi viewer - a content presentation and managementapplication for digitized objects. Visit these websites for more information. - http://www.intranda.com -http://digiverso.com This program is free software; you can redistribute it and/or modify it under the termsof the GNU General Public License as published by the Free Software Foundation; eitherversion 2 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANYWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR APARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with thisprogram. If not, see http://www.gnu.org/licenses/. Module which handles the zoomslider functionality. Version: 3.2.0 Source: viewImage/viewImage.zoomSlider.js, line 1 Requires module:jQuery Ã— Search results Close "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
