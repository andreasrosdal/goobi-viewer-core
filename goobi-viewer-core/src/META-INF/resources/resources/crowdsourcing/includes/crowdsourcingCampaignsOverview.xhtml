<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:composite="http://xmlns.jcp.org/jsf/composite"
	xmlns:viewerComponent="http://xmlns.jcp.org/jsf/composite/components">

    <!-- INPUT MODULE TEMPLATE -->
    <div class="crowdsourcing-campaigns-overview">
    <h:form>
		<ui:repeat var="campaign" value="#{crowdsourcingBean.getAllowedCampaigns(userBean.user)}">
			<div class="crowdsourcing-campaigns-overview__campaign">
				<ui:fragment rendered="#{campaign.hasMediaItem()}">
					<div class="crowdsourcing-campaigns-overview__campaign__image">
						<img src="#{campaign.mediaItem.iconURI}" />
					</div>
				</ui:fragment>
				<div class="crowdsourcing-campaigns-overview__campaign__text">
					<h3 class="crowdsourcing-campaigns-overview__campaign__text__title">#{campaign.getTitle(navigationHelper.locale, true)}</h3>
					<div class="crowdsourcing-campaigns-overview__campaign__text__description">
						#{campaign.description}
					</div>
				</div>
				<div class="crowdsourcing-campaigns-overview__campaign__actions">
				    <!-- Current campaigns only -->
				    <ui:fragment rendered="#{campaign.hasStarted and !campaign.hasEnded}">
					    <h:commandLink rendered="#{campaign.getNumRecordsToAnnotate() > 0 and campaign.isUserAllowedAction(userBean.user, 'ANNOTATE')}"
					        action="#{crowdsourcingBean.forwardToCrowdsourcingAnnotation(campaign)}"
					        styleClass="btn btn--default">#{msg.action__crowdsourcing_participate}</h:commandLink>
					    <h:commandLink rendered="#{campaign.getNumRecordsForStatus('REVIEW') > 0 and campaign.isUserAllowedAction(userBean.user, 'REVIEW')}"
					        action="#{crowdsourcingBean.forwardToCrowdsourcingReview(campaign)}"
					        styleClass="btn btn--default">#{msg.action__crowdsourcing_review}</h:commandLink>
					</ui:fragment>
				</div>
				<ui:include src="/resources/crowdsourcing/includes/campaignStatistics.xhtml"></ui:include>
				<!-- Future campaign: days left counter -->
				<h:outputFormat rendered="#{!campaign.hasStarted}" value="#{msg.label__crowdsourcing_campaign_days_before_start}" escape="false">
                    <f:param value="#{campaign.daysBeforeStart}" />
                </h:outputFormat>
                <!-- Current campaign: motivational message-->
                <h:outputText rendered="#{campaign.hasStarted and !campaign.hasEnded}" value="#{msg.label__crowdsourcing_campaign_contribute}" />
			</div>
		</ui:repeat>
	</h:form>
	<script>
		riot.mount("progressBar");
	</script>
    </div>
</ui:composition>