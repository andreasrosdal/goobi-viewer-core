<ui:composition
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
    xmlns:jsf="http://xmlns.jcp.org/jsf"
    xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
    xmlns:viewer="http://xmlns.jcp.org/jsf/composite/components/partner"
    xmlns:viewerComponent="http://xmlns.jcp.org/jsf/composite/components"
    xmlns:widgetComponent="http://xmlns.jcp.org/jsf/composite/components/widgets">

	<ui:define name="metadata">
		<f:metadata>
		</f:metadata>
	</ui:define>

    <!-- MESSAGES -->
    <div class="messages">
        <h:messages id="messages" globalOnly="false" infoClass="alert alert-success" errorClass="alert alert-danger" />
    </div>


    <div id="Archives" class="archives">
		<header id="pageHeaderTop" class="archives__top-wrapper">
            <div class="archives__header">
	            <!-- OPEN MOBILE NAVIGATION -->
            	<div class="archives__top-mobile-nav">
					<button type="button" class="btn btn--clean" data-open="menu" aria-label="#{msg.aria_label__open_navigation}">
						<span></span>
					</button>
				</div>

                <!-- PAGE HEADER TOP BRAND -->
		        <!-- LOGO -->
		        <div class="archives__header-brand">
		            <a href="#{request.contextPath}/">
		                <img src="#{request.contextPath}/resources/themes/#{navigationHelper.theme}/images/template/fullscreen_logo.png" alt="Goobi Logo" />
		            </a>
		        </div>
                
                
                <div class="archives__top-brand">
				<a href="#{request.contextPath}/" target="_self" rel="noopener">#{configurationBean.name}</a> â€º <h1>#{msg.archives__archiveViewHeading}</h1>
                </div>


                <!-- PAGE HEADER TOP ARCHIVE TITLE -->
<!--                 <div class="archives__top-title"> -->
<!--                 	<span>#{archiveBean.trueRoot.label}</span> -->
<!--                 </div> -->
					<div class="archives__top-title">
	                    <h:selectOneMenu styleClass="archives__select-database-dropdown" value="EMPTY">
		                    <f:selectItem itemValue = "1" itemLabel = "#{archiveBean.trueRoot.label}" /> 
		   					<f:selectItem itemValue = "2" itemLabel = "Database 2 Long Name for Testing This and That" />
	
		   					<!-- TO DO: POPULATE SELECTABLE ITEMS FROM DATABASE AND TRIGGER PAGE RELOAD/ARCHIVE TREE RELOAD -->
							<!-- <f:selectItems value="#{bean.names}" /> -->
						
						</h:selectOneMenu>
					</div>
					
					<select id="tempWidthSelect">
					 <option id="tempWidthOption"></option>
					</select>
                
<!--                 PAGE HEADER TOP ACTIONS -->
<!--                 <div class="archives__top-actions"> -->
<!--                     CHANGE LOCAL -->
<!--                     <ui:fragment rendered="#{fn:length(navigationHelper.supportedLanguages) > 1}"> -->
<!-- 	                    <div id="changeLocalWrapper" class="archives__top-actions-language"> -->
<!-- 							<button type="button" -->
<!-- 		                  class="btn btn-clean" -->
<!-- 		                  data-toggle="local" -->
<!-- 		                  aria-label="#{msg.aria_label__switch_language}"> -->
<!-- 		                  <span class="fa fa-globe"></span>#{msg.language}</button> -->
<!-- 		                  <viewerComponent:changeLocal toggleLanguage="false" longLanguageStrings="true"/> -->
<!-- 	                    </div> -->
<!--                     </ui:fragment> -->

<!--                     LOGIN NAVIGATION -->
<!--                     <div class="archives__top-actions-login"> -->
<!--                         <viewerComponent:loginNavigation /> -->
<!--                     </div> -->
<!--                 </div> -->

<!-- 	            OPEN MOBILE NAVIGATION -->
<!--             	<div class="archives__top-mobile-sidebar"> -->
<!-- 					<button type="button" class="btn btn-clean" data-open="sidebar" aria-label="#{msg.aria_label__open_sidebar}"> -->
<!-- 						<span></span> -->
<!-- 					</button> -->
<!-- 				</div> -->

			        <!-- EXIT -->
			        <div class="archives__header-exit">
			            <h:outputLink value="#{request.contextPath}" title="#{msg.fullscreen_exit}">
<!-- 			                <f:passThroughAttribute name="data-toggle" value="tooltip" /> -->
<!-- 			                <f:passThroughAttribute name="data-placement" value="bottom" /> -->
<!-- 			                <f:passThroughAttribute name="data-js" value="exit-fullscreen" /> -->
<!-- 			                <f:passThroughAttribute name="aria-label" value="#{msg.fullscreen_exit}" /> -->
			            </h:outputLink>
			        </div>

            </div>
	    </header>

		<!-- CONTENT -->
		<main id="ArchivesContent" class="archives__main">
			<!-- <ui:insert name="breadcrumbs" /> -->
			<c:choose>
				<c:when test="#{archiveBean.databaseState == 'ERROR_NOT_CONFIGURED'}">
					<div class="archives__error">
						<span>#{msg.error__archives_database_configuration_missing}</span>
					</div>
				</c:when>
				<c:when test="#{archiveBean.databaseState == 'ERROR_NOT_REACHABLE'}">
					<div class="archives__error">
						<span>#{msg.error__archives_database_not_reachable}</span>
					</div>
				</c:when>
				<c:when test="#{archiveBean.databaseState == 'ERROR_INVALID_FORMAT'}">
					<div class="archives__error">
						<span>#{msg.error__archives_failed_to_read_database}</span>
					</div>
				</c:when>
				<c:otherwise>
					<ui:insert name="content" />
				</c:otherwise>
			</c:choose>
		</main>

		    <!-- USER LOGIN + TERMS -->
		<viewerComponent:modalUserLogin id="userLoginModal"/>
		<viewerComponent:modalUserTerms id="userTermsModal"/>

		<script type="text/javascript">
        	viewerJS.archives.init({
                initHcSticky: true,
                initSearch: true,
                initTextTree: true,
        });
        	
   		// Make select dropdown always the size of the options text
   			$(document).ready(function() {
   			  $('.archives__select-database-dropdown').change(function(){
   			    $("#tempWidthOption").html($('.archives__select-database-dropdown option:selected').text()); 
   			    $(this).width($("#tempWidthSelect").width());  
   			  });
   			});
   			$(document).ready(function() {
     			    $("#tempWidthOption").html($('.archives__select-database-dropdown option:selected').text()); 
     			    $('.archives__select-database-dropdown').width($("#tempWidthSelect").width());  
     	 });
            
        </script>

    </div>
</ui:composition>
