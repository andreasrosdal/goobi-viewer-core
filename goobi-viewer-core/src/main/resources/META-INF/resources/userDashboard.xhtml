<ui:composition
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:viewerComponent="http://xmlns.jcp.org/jsf/composite/components"
    xmlns:widgetComponent="http://xmlns.jcp.org/jsf/composite/components/widgets"
    template="/resources/themes/#{navigationHelper.theme}/template.html"
	xmlns:composite="http://xmlns.jcp.org/jsf/composite">

		<composite:attribute name="user" required="true"
			type="io.goobi.viewer.model.security.user.User" />	

    <ui:define name="metadata">
        <f:metadata>
            <f:event type="preRenderView" listener="#{navigationHelper.setCurrentPageUser()}" />
            <f:event type="preRenderView" listener="#{breadcrumbBean.addStaticLinkToBreadcrumb(userBean.loggedIn ? msg.userLoggedIn : msg.userNotLoggedIn,1)}" />
            <f:viewAction onPostback="false" action="#{userBean.user.backupFields()}" />
        </f:metadata>
    </ui:define>

    <ui:define name="breadcrumbs">
        <ui:include src="resources/includes/breadcrumbs.xhtml" />
    </ui:define>

    <ui:define name="content">
        <div id="userAccount" class="user-account">
            <h2>#{msg.account}</h2>
            <!-- USER NOT LOGGED IN -->
            <ui:fragment rendered="#{!userBean.loggedIn}">
                <div class="alert alert-warning" role="alert">
                    #{msg.login__please_login}
                </div>
            </ui:fragment>

            <!-- USER LOGGED IN -->
            <ui:fragment rendered="#{userBean.loggedIn}">
            
            	<!-- ACTIVITIES BLOCK -->
				<h3>Aktivität</h3>
				<div class="user-dashboard__form-wrapper">
					<div class="user-dashboard__last-activities-wrapper">
						<div class="user-dashboard__last-activities-list">

							
							
							<div class="user-dashboard__last-activities-timeline-wrapper">
							
								<!-- TO DO: LOGIC FOR UI:REPEAT OF LAST ACTIVITIES -->
								<div class="user-dashboard__last-activities-timeline-item">
									<div class="user-dashboard__last-activities-timeline-item-type"><i class="fa fa-bookmark"></i>Merkliste</div>
									<div class="user-dashboard__last-activities-timeline-item-date">04.10.2021</div>
									<div class="user-dashboard__last-activitiestimeline-item-name">Neptune (List 4)</div>
								</div>
								
								<div class="user-dashboard__last-activities-timeline-item">
									<div class="user-dashboard__last-activities-timeline-item-type"><i class="fa fa-search"></i>Gespeicherte Suche</div>
									<div class="user-dashboard__last-activities-timeline-item-date">04.10.2021</div>
									<div class="user-dashboard__last-activitiestimeline-item-name">Neptune (List 4)</div>
								</div>
								
								<div class="user-dashboard__last-activities-timeline-item">
									<div class="user-dashboard__last-activities-timeline-item-type"><i class="fa fa-comment"></i>Kommentar</div>
									<div class="user-dashboard__last-activities-timeline-item-date">04.10.2021</div>
									<div class="user-dashboard__last-activitiestimeline-item-name">Neptune (List 4)</div>
								</div>
								
								<div class="user-dashboard__last-activities-timeline-item">
									<div class="user-dashboard__last-activities-timeline-item-type"><i class="fa fa-bookmark"></i>Merkliste</div>
									<div class="user-dashboard__last-activities-timeline-item-date">04.10.2021</div>
									<div class="user-dashboard__last-activitiestimeline-item-name">Neptune (List 4)</div>
								</div>
								
								<div class="user-dashboard__last-activities-timeline-item">
									<div class="user-dashboard__last-activities-timeline-item-type"><i class="fa fa-search"></i>Gespeicherte Suche</div>
									<div class="user-dashboard__last-activities-timeline-item-date">04.10.2021</div>
									<div class="user-dashboard__last-activitiestimeline-item-name">Neptune (List 4)</div>
								</div>
								
								<div class="user-dashboard__last-activities-timeline-item">
									<div class="user-dashboard__last-activities-timeline-item-type"><i class="fa fa-comment"></i>Kommentar</div>
									<div class="user-dashboard__last-activities-timeline-item-date">04.10.2021</div>
									<div class="user-dashboard__last-activitiestimeline-item-name">Neptune (List 4)</div>
								</div>
								
								
								
							</div>
					
					</div>
				</div>
				</div>
				
				<!-- OVERVIEW BLOCK -->
				<h3>Übersicht</h3>
				<div class="user-dashboard__form-wrapper-container">
				
					<!-- BOOKMARKS BOX -->
					<div class="user-dashboard__form-wrapper -w50 ">
					<h4>Merklisten</h4>
						<div class="user-dashboard__bookmarks-wrapper">
								<ul class="user-dashboard__bookmarks-list">
									<ui:repeat
										value="#{bookmarkBean.getBookmarkListsForUser(userBean.user)}"
										var="bookmarkList" varStatus="status">
										<ui:fragment
											rendered="#{bookmarkList.isOwnedBy(userBean.user)}">
											<li>#{bookmarkList.name}</li>
										</ui:fragment>
									</ui:repeat>
								</ul>
						</div>
						
						<div class="user-dashboard__searches-count">Insgesamt wurden 7 Merklisten gespeichert.</div>	
						<!-- GO TO BOOKMARKS OVERVIEW PAGE -->
						<a styleClass="user-dashboard__show-all-link" href="#{request.contextPath}/user/bookmarks/">
							Übersicht aller Merklisten
						</a>
					</div>

					<!-- SEARCHES BOX -->
					<div class="user-dashboard__form-wrapper -w50 ">
					
					<h4>Gespeicherte Suchen</h4>
						<div class="user-dashboard__searches-wrapper">

								<!-- SHOW IF NO SEARCHES EXIST -->
								<h:panelGroup rendered="#{userDataBean.searches.isEmpty()}">
									<div class="alert alert-warning" role="alert">#{msg.searches_noSearchesWarning}</div>
								</h:panelGroup>

								<!-- SAVED SEARCHES -->
									<ul class="user-dashboard__searches-list">
										<ui:repeat value="#{userDataBean.searches}" var="search">
											<li class="user-dashboard__searches-list-item"><h:outputText value="#{search.name}" escape="true" /></li>
										</ui:repeat>
									</ul>
						</div>
						
						<div class="user-dashboard__searches-count">Insgesamt wurden 3 Suchen gespeichert.</div>
						<!-- GO TO SEARCHES OVERVIEW PAGE -->
						<a styleClass="user-dashboard__show-all-link" href="#{request.contextPath}/user/searches/">
							Übersicht aller gespeicherter Suchen
						</a>
					</div>
					
					</div>
					
					<div class="user-dashboard__form-wrapper-container">
					<!-- COMMENTS BOX -->
					<div class="user-dashboard__form-wrapper -w100 ">
					<h4>Kommentare</h4>
						<div class="user-dashboard__comments-wrapper">

								<!-- TO DO: RENDER IF NO COMMENTS EXIST -->
<!-- 								<h:panelGroup rendered="#{userDataBean.searches.isEmpty()}"> -->
<!-- 									<div class="alert alert-warning" role="alert">#{msg.searches_noSearchesWarning}</div> -->
<!-- 								</h:panelGroup> -->


								<!-- USER COMMENTS -->
								<!-- TO DO: UI REPEAT FOR COMMENTS BY USER -->
								<h:panelGroup>
									<div class="user-dashboard__comments-item">
										<div class="user-dashboard__comments-text">Moin</div>
										<a class="user-dashboard__comments-open-record">Werk öffnen</a>
									</div>
									<div class="user-dashboard__comments-item">
										<div class="user-dashboard__comments-text">Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.</div>
										<a class="user-dashboard__comments-open-record">Werk öffnen</a>
									</div>
								</h:panelGroup>
								

						</div>
					<div class="user-dashboard__searches-count">Insgesamt wurden 2 Kommentare in 2 Werken verfasst.</div>
					<!-- TO DO: THERE IS NO OVERVIEW PAGE FOR COMMENTS YET? -->
					<h:commandLink styleClass="user-dashboard__show-all-link" action="#{searchBean.executeSavedSearchAction(search)}">
						Übersicht aller Kommentare
					</h:commandLink>
					</div>
					</div>

            </ui:fragment>
        </div>
    </ui:define>

    <ui:define name="sidebar">
		<h:panelGroup layout="block" styleClass="user-settings__profile-image-box">
				<img class="user-settings__profile-image" src="#{userBean.user.getAvatarUrl(300)}" alt="User Avatar" />
				
				
					<div class="user-dashboard__sidebar-welcome-text">
						
						<span>#{msg.admin__dashboard_hello}</span><ui:fragment rendered="#{not empty userBean.user.firstName}"><span><b> #{userBean.user.firstName}</b></span></ui:fragment><span>, schön, dass du da bist.</span>
					</div>

		</h:panelGroup>
    </ui:define>

</ui:composition>
