<ui:composition
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:viewerComponent="http://xmlns.jcp.org/jsf/composite/components"
    xmlns:adminWidget="http://xmlns.jcp.org/jsf/composite/admin/widgets"
    template="/resources/themes/#{navigationHelper.theme}/templateAdmin.html"
    xmlns:jsf="http://xmlns.jcp.org/jsf">

    <ui:define name="metadata">
        <f:metadata>
            <f:event
                type="preRenderView"
                listener="#{navigationHelper.setCurrentPageAdmin('adminQuartz')}" />
        </f:metadata>
    </ui:define>

    <ui:define name="content">
        <div id="adminAllUsers">
            <h:panelGroup rendered="#{userBean.admin}">
                <h:form
                    id="adminAllUserForm"
                    prependId="false">
                    <div class="admin__title-bar">
                        <!-- TITLE -->
                        <h1 class="admin__title">#{msg.admin__quartz__title}</h1>
                        
		                    <div class="admin__tasks-title-wrapper">
			                    
			                    <div class="admin__tasks-status">
		<!-- 							<div class="admin__tasks-icon-text">Status: #{messageQueueBean.paused ? 'stopped' : 'running'}</div> -->
									
									<div class="admin__tasks-icon-wrapper #{quartzBean.paused ? '-paused' : ''}" 
										data-js-trigger="#{quartzBean.paused ? 'resumeButton' : 'pauseButton'}"
										title="#{msg.admin__tasks__resume_button_tooltip}"
										data-toggle="tooltip"
										data-placement="top"
										data-trigger="hover">
									<div class="admin__tasks-icon-loader"></div>
										<div class="admin__tasks-icon">
											<div class="admin__tasks-button-pause #{messageQueueBean.paused ? '-hidden' : '-active'}"><i class="fa fa-pause"></i></div>
				                        	<div class="admin__tasks-button-play #{messageQueueBean.paused ? '-active' : '-hidden'}"><i class="fa fa-play"></i></div>
										</div>
									</div>
								</div>
								
<!-- 								<a class="admin__tasks-icon-wrapper #{messageQueueBean.paused ? '-paused' : ''}" -->
<!-- 								title="#{msg.admin__tasks__clear_all_button_tooltip}"  -->
<!-- 								data-toggle="tooltip" -->
<!-- 								data-placement="top" -->
<!-- 								data-trigger="hover" -->
<!-- 		                        jsf:action="#{messageQueueBean.clearQueue}" -->
<!-- 		                        jsf:id="clearButton" -->
<!-- 		                        data-require-confirmation="true" -->
<!-- 		                        data-confirmation-text="#{msg.admin__tasks__clear_all_button_confirmation}" -->
<!-- 		                        aria-label="#{msg.admin__tasks__clear_all_button_confirmation}"> -->
<!-- 								<div class="admin__tasks-clear-all"></div> -->
<!-- 									<div class="admin__tasks-icon"> -->
<!-- 										<div class="admin__tasks-button-trash #{messageQueueBean.paused ? '-hidden' : '-active'}"><i class="fa fa-times"></i></div> -->
<!-- 									</div> -->
<!-- 								</a> -->
		
							</div>
                        
                        
                    </div>
                    <viewerComponent:adminBreadcrumbs />

                    <div class="admin__content-inner-content">
                    
                    <div class="admin__info-text">#{msg.admin__quartz__info_text}</div>
                    
                    
                        <div class="admin__quartz">
                        
                        
                            <h:outputText value="#{quartzBean.paused}" />
                            
                            
                            <button
                           		data-target="pauseButton"
                                jsf:action="#{quartzBean.pauseAllJobs}"
                                class="btn">
                                <i class="fa fa-pause"></i>
                            </button>

                            <button
                            	data-target="resumeButton"
                                jsf:action="#{quartzBean.resumeAllJobs}"
                                class="btn">
                                <i class="fa fa-play"></i>
                            </button>

                        </div>

                        <div class="admin__quartz">

                            <!-- show all active message types -->

                            <div
                                style="width: 100%;"
                                id="new-table-adminallmessagetypes"
                                class="admin__table-content"
                                role="grid"
                                aria-label="#{msg.admin__queue_types}: #{msg.aria_label__table__actions}">
                                <!-- TITLE ROW -->
                                <div
                                    class="row no-gutters admin__table-title"
                                    role="row">
                                    <!-- NAME COL -->
                                    <div class="col-3 d-flex">Name</div>
                                    <!-- LAST LOGIN COL -->
                                    <div class="col-3 d-flex">Group</div>
                                    <div class="col-2 d-flex">previousFireTime</div>
                                    <div class="col-2 d-flex">nextFireTime</div>
                                    <div class="col-2 d-flex">actions</div>

                                </div>


                                <!-- INDIVIDUAL ROWS -->
                                <ui:repeat
                                    var="entry"
                                    value="#{quartzBean.activeJobs}">
                                    <div
                                        class="row no-gutters admin__table-entry"
                                        role="row">
                                        <div class="col-3 d-flex">
                                            <h:outputText value="#{msg[entry.jobName]}" />
                                        </div>

                                        <div
                                            class="col-3 d-flex align-items-center"
                                            role="gridcell">
                                            <h:outputText value="#{entry.jobGroup}" />
                                        </div>

                                        <div
                                            class="col-2 d-flex align-items-center"
                                            role="gridcell">
                                            <h:outputText value="#{entry.previousFireTime}" />
                                        </div>
                                        <div
                                            class="col-2 d-flex align-items-center"
                                            role="gridcell">
                                            <h:outputText value="#{entry.nextFireTime}" />
                                        </div>

                                        <div
                                            class="col-2 d-flex align-items-center align-content-center flex-wrap"
                                            role="gridcell">

                                            <h:outputText value="#{entry.paused}" />
 <h:outputText value="#{entry.cronExpression}" />

 <h:outputText value="#{entry.humanReadableCronTime}" />

                                            <button
                                                jsf:action="#{quartzBean.triggerQuartzJob}"
                                                class="btn">
                                                <i class="fa fa-fast-forward" />
                                                <f:setPropertyActionListener
                                                    target="#{quartzBean.quartzJobDetails}"
                                                    value="#{entry}" />
                                            </button>

                                            <button
                                                jsf:action="#{quartzBean.pauseJob}"
                                                class="btn">
                                                <i class="fa fa-pause" />
                                                <f:setPropertyActionListener
                                                    target="#{quartzBean.quartzJobDetails}"
                                                    value="#{entry}" />
                                            </button>

                                            <button
                                                jsf:action="#{quartzBean.resumeJob}"
                                                class="btn">
                                                <i class="fa fa-play" />
                                                <f:setPropertyActionListener
                                                    target="#{quartzBean.quartzJobDetails}"
                                                    value="#{entry}" />
                                            </button>
                                        </div>
                                    </div>
                                </ui:repeat>
                            </div>

                        </div>

                    </div>

                </h:form>
            </h:panelGroup>
        </div>
        
        <script>
			$('[data-js-trigger="resumeButton"]').on('click', function() {
				$('.admin__tasks-icon-wrapper').toggleClass('-paused');
			    $('[ data-target="resumeButton"]').click();
			    $('.admin__tasks-button-pause, .admin__tasks-button-play').toggleClass('-hidden');
			});
			
			$('[data-js-trigger="pauseButton"]').on('click', function() {
				$('.admin__tasks-icon-wrapper').toggleClass('-paused');
				$('.admin__tasks-icon-wrapper').addClass('-stoppingStatus');
			    $('[ data-target="pauseButton"]').click();
			    $('.admin__tasks-button-pause, .admin__tasks-button-play').toggleClass('-hidden');
			});
		</script>

    </ui:define>

</ui:composition>
