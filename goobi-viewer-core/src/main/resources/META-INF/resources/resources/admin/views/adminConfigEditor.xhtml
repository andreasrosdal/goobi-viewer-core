<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:jsf="http://xmlns.jcp.org/jsf"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:viewerComponent="http://xmlns.jcp.org/jsf/composite/components"
	xmlns:cmsComponent="http://xmlns.jcp.org/jsf/composite/cms/components"
	xmlns:adminWidget="http://xmlns.jcp.org/jsf/composite/admin/widgets"
	template="/resources/themes/#{navigationHelper.theme}/templateAdmin.html">

	<ui:define name="metadata">
		<f:metadata>
			<f:event type="preRenderView"
				listener="#{navigationHelper.setCurrentPageAdmin('adminConfigEditor')}" />
		</f:metadata>
	</ui:define>

	<ui:define name="content">
		<f:view contentType="text/html" encoding="utf-8">
			<div id="adminConfigEditor">

				<div class="admin__title-bar">
					<!-- TITLE -->
					<h1 class="admin__title">#{msg.admin__config_editor__title}</h1>

				</div>

				<div class="admin__content-inner-content">

					<div class="admin__content-wrapper">
						<div class="admin__content-main -sticky -refreshHCsticky">

							<!-- INFO TEXT -->
							<div class="admin__info-text">
								<h:outputText value="#{msg.admin__config_editor__description}"
									escape="false" />
							</div>



							<!-- CURRENT FILE NAME -->
							<div class="admin__config-editor-current-file-wrapper">
								<h:form id="configEditorActualFile">
									<h2>#{msg.admin__config_editor__actual_file}:
										#{configEditorBean.fileInEditionName}</h2>
								</h:form>


								<div
									class="admin__config-editor-current-file-release-button-wrapper">
									<h:form>
										<button
											class="btn btn--clean" data-toggle="tooltip"
											data-placement="top" data-trigger="hover"
	                                        data-require-confirmation="true"
	                                        data-confirmation-text="#{navigationHelper.getTranslationWithParamsUnescaped(msg.admin__config_editor__release_confirm)}"
											title="#{msg.admin__config_editor__release_button_tooltip}"
											jsf:action="#{configEditorBean.closeCurrentFileAction}">
											<i class="fa fa-times-circle" aria-hidden="true"></i>
										</button>
									</h:form>
								</div>
								<div></div>



							</div>

							<div class="admin__config-editor-form-wrapper">

								<!-- GENERIC OVERLAY -->
								<div class="admin__config-editor-form-wrapper-overlay"
									data-cm="overlay"></div>

								<!-- AJAX LOADING OVERLAY -->
								<span class="ajax_loader"> <img
									src="#{request.contextPath}/resources/images/AJAX_preloader_white.svg"
									class="img-responsive" alt="Waiting..." />
								</span>

								<!-- CODEMIRROR EDITOR FORM -->
								<h:form id="editor-form">

									<!-- TEXTAREA -->
									<h:inputTextarea id="editor"
										class="admin__config-editor-textarea" cols="80" rows="10"
										value="#{configEditorBean.fileContent}" />

									<script>console.log('something happened');</script>


									<script>			
											var readOnly;
											readOnly = false;
// 											if (readOnly === undefined){
// 												readOnly = true;
// 											}
												$( document ).ready(function() {
													initTextArea();
												});

										</script>

									<div class="admin__overlay-bar">

										<div class="admin__config-editor-overlay-bar-buttons-wrapper">
											<!-- CANCEL -->
											<h:commandButton value="#{msg.reset}"
												disabled="#{not(configEditorBean.editable)}"
												styleClass="btn btn--default admin__overlay-bar-action"
												pt:data-cm="cancel"
												action="#{configEditorBean.cancelAction}">
												<f:ajax execute="@form" render="nothing" />
											</h:commandButton>

											<!-- SAVE -->
											<h:commandButton value="#{msg.save}" type="submit"
												styleClass="btn btn--success admin__overlay-bar-action"
												pt:data-cm="save" onclick="viewerJS.showLoader();"
												action="#{configEditorBean.saveCurrentFileAction}">
											</h:commandButton>

										</div>

									</div>

									<!-- CHECK THIS + ADAPT STYLING -->
									<div id="currentConfigFileType"
										style="position: absolute; visibility: hidden">
										#{configEditorBean.currentConfigFileType}</div>

								</h:form>

							</div>



						</div>
						<!-- SIDEBAR -->
						<div class="admin__content-side">

							<!-- AVAILABLE CONFIG AND PROPERTIES FILES BLOCK -->
							<div class="admin__default-block">

								<h2>#{msg.admin__config_editor__files}</h2>

								<h:form id="file-form">

									<div class="admin__config-editor-file-selection-inner"
										id="file-table">



										<ui:repeat var="record" varStatus="status"
											value="#{configEditorBean.fileRecordsModel}">

											<div
												class="admin__config-editor-file-selection-single-entry #{configEditorBean.fileInEditionNumber == status.index ? '-selectedFile' : ''} #{record.readable  ? '-isEditable' : '-isReadOnly'}">
												<div
													class="admin__config-editor-file-selection-single-entry-button-wrapper">

													<h:commandButton value="#{record.fileName}"
														styleClass="admin__config-editor-file-selection-single-entry-button"
														action="#{configEditorBean.editFile(record.writable)}"
														name="#{record.number}" disabled="#{!record.readable}"
														onclick="setEditable(#{record.writable}, #{record.number}, true); viewerJS.showLoader();">
														<f:ajax execute="@this"
															render="editor-form file-form backup-form configEditorActualFile"
															immediate="true" />
													</h:commandButton>


													<!-- 												<h:panelGroup styleClass="admin__config-editor-file-selection-single-entry-button-wrapper-info-wrapper" layout="block" rendered="#{!record.writable or !record.readable}"> -->
													<ui:fragment rendered="#{!record.readable}">
														<div
															class="admin__config-editor-file-selection-single-entry-button-wrapper-info"
															title="#{msg.admin__config_editor__not_readable}"
															data-toggle="tooltip" data-placement="left"
															data-trigger="hover">
															<i class="fa fa-eye" aria-hidden="true"></i> <i
																class="fa fa-ban" aria-hidden="true"></i>
														</div>
													</ui:fragment>
													<ui:fragment
														rendered="#{!record.writable and record.readable}">
														<div
															class="admin__config-editor-file-selection-single-entry-button-wrapper-info"
															title="#{msg.admin__config_editor__not_writable}"
															data-toggle="tooltip" data-placement="left"
															data-trigger="hover">
															<i class="fa fa-pencil" aria-hidden="true"></i> <i
																class="fa fa-ban" aria-hidden="true"></i>
														</div>
													</ui:fragment>
													<ui:fragment
														rendered="#{configEditorBean.isFileLocked(record)}">
														<div
															class="admin__config-editor-file-selection-single-entry-button-wrapper-info"
															title="#{msg.admin__config_editor__not_writable}"
															data-toggle="tooltip" data-placement="left"
															data-trigger="hover">
															<i class="fa fa-lock" aria-hidden="true"></i> <i
																class="fa fa-ban" aria-hidden="true"></i>
														</div>
													</ui:fragment>
													<!-- 												</h:panelGroup>	 -->




												</div>



											</div>

										</ui:repeat>

									</div>

								</h:form>
							</div>

							<!-- BACKUP FILES BLOCK -->
							<div class="admin__default-block">

								<h2>#{msg.admin__config_editor__backups}</h2>

								<h:form id="backup-form">
									<div class="admin__config-editor-backup-wrapper">
										<ui:repeat var="record"
											value="#{configEditorBean.backupRecordsModel}">

											<ui:fragment
												rendered="#{not empty configEditorBean.backupRecordsModel}">

												<h:commandLink
													styleClass="btn btn--clean admin__config-editor-backup-single-entry"
													action="#{configEditorBean.downloadFile(record)}"
													disabled="#{not(configEditorBean.downloadable)}">
													<span class="admin__config-editor-backup-single-entry-text">#{record.name}</span>
													<span class="admin__config-editor-backup-single-entry-icon"><i
														class="fa fa-download"></i></span>
												</h:commandLink>

											</ui:fragment>

											<ui:fragment rendered="#{empty configEditorBean.backupRecordsModel}">

												<span
													class="btn btn--clean admin__config-editor-backup-single-entry -noHover">
													<span class="admin__config-editor-backup-single-entry-text">#{msg.admin__config_editor__no_backups}</span>
												</span>

											</ui:fragment>


										</ui:repeat>
									</div>
								</h:form>

							</div>


							<div class="admin__default-block">

								<h2>#{msg.admin__config_editor__shortcuts_list_title}</h2>

								<div class="admin__form-help-text in mb-2">
									#{msg.admin__config_editor__shortcuts_help}</div>

								<div class="admin__config-editor-shortcuts-wrapper">
									<div class="admin__config-editor-shortcuts-entry">
										<div class="admin__config-editor-shortcuts-text">#{msg.admin__config_editor__shortcuts_search}</div>
										<div class="admin__config-editor-shortcuts-key-wrapper">
											<div class="admin__config-editor-shortcuts-key">#{msg.admin__config_editor__shortcuts_ctrl}</div>
											<div class="admin__config-editor-shortcuts-key-spacer">+</div>
											<div class="admin__config-editor-shortcuts-key">F</div>
										</div>
									</div>
									<div class="admin__config-editor-shortcuts-entry">
										<div class="admin__config-editor-shortcuts-text">#{msg.admin__config_editor__shortcuts_next}</div>
										<div class="admin__config-editor-shortcuts-key-wrapper">
											<div class="admin__config-editor-shortcuts-key">#{msg.admin__config_editor__shortcuts_ctrl}</div>
											<div class="admin__config-editor-shortcuts-key-spacer">+</div>
											<div class="admin__config-editor-shortcuts-key">G</div>
										</div>
									</div>
									<div class="admin__config-editor-shortcuts-entry">
										<div class="admin__config-editor-shortcuts-text">#{msg.admin__config_editor__shortcuts_prev}</div>
										<div class="admin__config-editor-shortcuts-key-wrapper">
											<div class="admin__config-editor-shortcuts-key">#{msg.admin__config_editor__shortcuts_ctrl}</div>
											<div class="admin__config-editor-shortcuts-key-spacer">+</div>
											<div class="admin__config-editor-shortcuts-key">SHIFT</div>
											<div class="admin__config-editor-shortcuts-key-spacer">+</div>
											<div class="admin__config-editor-shortcuts-key">G</div>
										</div>
									</div>
									<div class="admin__config-editor-shortcuts-entry">
										<div class="admin__config-editor-shortcuts-text">#{msg.admin__config_editor__shortcuts_replace}</div>
										<div class="admin__config-editor-shortcuts-key-wrapper">
											<div class="admin__config-editor-shortcuts-key">#{msg.admin__config_editor__shortcuts_ctrl}</div>
											<div class="admin__config-editor-shortcuts-key-spacer">+</div>
											<div class="admin__config-editor-shortcuts-key">SHIFT</div>
											<div class="admin__config-editor-shortcuts-key-spacer">+</div>
											<div class="admin__config-editor-shortcuts-key">F</div>
										</div>
									</div>
									<div class="admin__config-editor-shortcuts-entry">
										<div class="admin__config-editor-shortcuts-text">#{msg.admin__config_editor__shortcuts_indent}</div>
										<div class="admin__config-editor-shortcuts-key-wrapper">
											<div class="admin__config-editor-shortcuts-key">SHIFT</div>
											<div class="admin__config-editor-shortcuts-key-spacer">+</div>
											<div class="admin__config-editor-shortcuts-key">TAB</div>
										</div>
									</div>
									<div class="admin__config-editor-shortcuts-entry">
										<div class="admin__config-editor-shortcuts-text">#{msg.admin__config_editor__shortcuts_save}</div>
										<div class="admin__config-editor-shortcuts-key-wrapper">
											<div class="admin__config-editor-shortcuts-key">#{msg.admin__config_editor__shortcuts_ctrl}</div>
											<div class="admin__config-editor-shortcuts-key-spacer">+</div>
											<div class="admin__config-editor-shortcuts-key">S</div>
										</div>
									</div>
									<!-- 								<div class="admin__config-editor-shortcuts-entry"> -->
									<!-- 									<div class="admin__config-editor-shortcuts-text">Keep search open</div> -->
									<!-- 									<div class="admin__config-editor-shortcuts-key-wrapper"> -->
									<!-- 										<div class="admin__config-editor-shortcuts-key">#{msg.admin__config_editor__shortcuts_ctrl}</div> -->
									<!-- 										<div class="admin__config-editor-shortcuts-key-spacer">+</div> -->
									<!-- 										<div class="admin__config-editor-shortcuts-key">E</div> -->
									<!-- 									</div> -->
									<!-- 								</div> -->
									<div class="admin__config-editor-shortcuts-entry">
										<div class="admin__config-editor-shortcuts-text">#{msg.admin__config_editor__shortcuts_fullscreen}</div>
										<div class="admin__config-editor-shortcuts-key-wrapper">
											<div class="admin__config-editor-shortcuts-key">F11</div>
										</div>
									</div>
									<div class="admin__config-editor-shortcuts-entry">
										<div class="admin__config-editor-shortcuts-text">#{msg.admin__config_editor__shortcuts_dark}</div>
										<div class="admin__config-editor-shortcuts-key-wrapper">
											<div class="admin__config-editor-shortcuts-key">#{msg.admin__config_editor__shortcuts_ctrl}</div>
											<div class="admin__config-editor-shortcuts-key-spacer">+</div>
											<div class="admin__config-editor-shortcuts-key">D</div>
										</div>
									</div>
									<div class="admin__config-editor-shortcuts-entry">
										<div class="admin__config-editor-shortcuts-text">#{msg.admin__config_editor__shortcuts_linejump}</div>
										<div class="admin__config-editor-shortcuts-key-wrapper">
											<div class="admin__config-editor-shortcuts-key">ALT</div>
											<div class="admin__config-editor-shortcuts-key-spacer">+</div>
											<div class="admin__config-editor-shortcuts-key">G</div>
										</div>
									</div>
								</div>

							</div>




						</div>
					</div>
				</div>

			</div>
		</f:view>
	</ui:define>

</ui:composition>
