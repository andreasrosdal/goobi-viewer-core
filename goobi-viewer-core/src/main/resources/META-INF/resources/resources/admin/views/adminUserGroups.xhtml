<ui:composition
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:viewerComponent="http://xmlns.jcp.org/jsf/composite/components"
    xmlns:adminWidget="http://xmlns.jcp.org/jsf/composite/admin/widgets"
    template="/resources/themes/#{navigationHelper.theme}/templateAdmin.html">

    <ui:define name="metadata">
        <f:metadata>
            <f:event type="preRenderView" listener="#{navigationHelper.setCurrentPageAdmin('adminAllUserGroups')}" />
            <f:event type="preRenderView" listener="#{adminBean.resetCurrentUserGroupAction}" />
            <f:event type="preRenderView" listener="#{adminBean.resetCurrentLicenseAction}" />
        </f:metadata>
    </ui:define>

    <ui:define name="content">
        <f:view contentType="text/html" encoding="utf-8">
			<div id="adminAllUserGroups">
				<h:panelGroup rendered="#{userBean.admin}">
					<h:form id="adminAllUserGroupsForm" prependId="false">
						<div class="admin__title-bar">
							<!-- HEADING -->
							<h2 class="admin__title">#{msg.admin__groups}</h2>
							<!-- CREATE NEW GROUP BUTTON -->
							<h:commandLink action="pretty:adminGroupNew" value="#{msg.add}" styleClass="btn btn--default admin__title-bar-action" />
						</div>
						<div class="admin__content-inner-content">
							<!-- INFO TEXT -->
							<p class="admin__group-info-text">
								<h:outputText value="#{msg.admin__groups_description_text}" escape="false" />
							</p>
							
							<div class="admin__entry-list">
								<!-- INDIVIDUAL GROUPS -->
								<ui:repeat var="userGroup" value="#{adminBean.allUserGroups}">
									<div class="admin__boxed-entry -w33">
										<!-- GROUP NAME -->
										<div class="row">
											<h3 class="col-12 admin__group-title">#{userGroup.name}</h3>
										</div>
										<!-- GROUP DESCRIPTION -->
										<ui:fragment rendered="#{userGroup.description != ''}">
											<div class="row">
												<p class="col-12 admin__group-description">#{userGroup.description}</p>
											</div>
										</ui:fragment>

										<!-- GROUP MEMBER COUNT -->
										<div class="row mb-2">
											<div class="col-12 admin__group-member-count">#{msg.userGroup_members}:
												#{userGroup.memberCount}</div>
										</div>
										<!-- GROUP OWNER -->
										<div class="row mb-2">
											<div class="col-12 admin__group-owner">#{msg.owner}:
												#{userGroup.owner.displayName}</div>
										</div>

										<!-- GROUP ACTIONS -->
									<div class="row justify-content-end admin__boxed-entry-actions">
										<div class="col-3 d-flex justify-content-end">
												<!-- DELETE USER GROUP -->
												<h:commandLink
													onclick="if ( !confirm( &quot;#{navigationHelper.getTranslationWithParams(msg.userGroup_deleteConfirmationText, userGroup.name)}&quot; ) ) { return false };"
													action="adminAllUserGroups"
													actionListener="#{adminBean.deleteUserGroupAction(userGroup)}"
													title="#{msg.delete}"
													styleClass="admin__boxed-entry-actions-delete -redlink">
		                                        #{msg.delete}
		                                    	</h:commandLink>
												<!-- EDIT USER GROUP-->
<!-- 												<h:commandLink action="pretty:adminUserGroupEdit" -->
<!-- 													title="#{msg.edit}" -->
<!-- 													styleClass="admin__boxed-entry-actions-edit -bluelink"> -->
<!-- 													<f:setPropertyActionListener value="#{userGroup}" -->
<!-- 														target="#{adminBean.currentUserGroup}" /> -->
<!-- 		                                        #{msg.edit} -->
<!-- 		                                    	</h:commandLink> -->
                                                <h:outputLink styleClass="admin__boxed-entry-actions-edit -bluelink" title="#{msg.edit}"
                                                    value="#{navigationHelper.applicationUrl}admin/groups/edit/#{userGroup.id}/">#{msg.edit}</h:outputLink>
										</div>
									</div>
									</div>
								</ui:repeat>
								</div>
						</div>
					</h:form>
				</h:panelGroup>
			</div>




			<script type="text/javascript">
				var dataTableConfig = {
					dataTablePaginator : "#dataTablePaginator",
					txtField1 : "#txtMoveTo1",
					txtField2 : "#txtMoveTo2",
					totalCount : "#totalCount",
					reloadBtn : 'input[id*="cmdMoveTo"]',
				};

				viewerJS.dataTable.init(dataTableConfig);
			</script>
        </f:view>
    </ui:define>

    <!-- SIDEBAR -->
    <ui:define name="sidebar">
        <adminWidget:widget_admin />
    	<adminWidget:widget_crowdsourcing />
    	<adminWidget:widget_cms />
    </ui:define>
</ui:composition>
