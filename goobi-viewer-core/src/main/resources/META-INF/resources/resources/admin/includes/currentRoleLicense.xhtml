<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:composite="http://xmlns.jcp.org/jsf/composite">

    <h3>
        <h:outputText value="#{msg.license_addNew}" rendered="#{adminBean.currentLicense.id == null}" />
        <h:outputText value="#{msg.license_edit}" rendered="#{adminBean.currentLicense.id != null}" />
    </h3>

    <div class="form-horizontal" role="form">
        <!-- LICENSE TYPE -->
        <div class="form-group">
            <h:outputLabel for="name" styleClass="col-sm-4 control-label" value="#{msg.roles} *" />
            <div class="col-sm-8">
                <div class="custom-control custom-control--select">
                    <h:selectOneMenu id="name" value="#{adminBean.currentLicense.licenseType}" converter="licenseTypeConverter" required="true">
                        <!-- TODO different modes for core and other license types -->
                        <f:selectItems value="#{adminBean.allCoreLicenseTypes}" var="licenseType" itemLabel="#{msg[licenseType.name]}" />
                        <f:ajax render="@form" />
                    </h:selectOneMenu>
                </div>
            </div>
        </div>
       
        <!-- LICENSE DESCRIPTION -->
        <div class="form-group">
            <h:outputLabel for="description" styleClass="col-sm-4 control-label" value="#{msg.description}" />
            <div class="col-sm-8">
                <h:inputTextarea value="#{adminBean.currentLicense.description}" id="description" styleClass="form-control" />
            </div>
        </div>
        
        <!-- LICENSE START -->
<!--         <div class="form-group"> -->
<!--             <h:outputLabel for="dateStart" styleClass="col-sm-4 control-label" value="#{msg.license_start}" /> -->
<!--             <div class="col-sm-8"> -->
<!--                 <p:calendar id="dateStart" locale="#{navigationHelper.locale}" pattern="#{navigationHelper.datePattern}" value="#{adminBean.currentLicense.start}" showOn="button" /> -->
<!--             </div> -->
<!--         </div> -->
        
        <!-- LICENSE END -->
<!--         <div class="form-group"> -->
<!--             <h:outputLabel for="dateEnd" styleClass="col-sm-4 control-label" value="#{msg.license_end}" /> -->
<!--             <div class="col-sm-8"> -->
<!--                 <p:calendar id="dateEnd" locale="#{navigationHelper.locale}" pattern="#{navigationHelper.datePattern}" value="#{adminBean.currentLicense.end}" showOn="button" /> -->
<!--             </div> -->
<!--         </div> -->

        <!-- CMS SETTINGS -->
        <ui:fragment rendered="#{adminBean.currentLicense.licenseType.cmsType}">
        
            <ui:fragment rendered="#{configurationBean.subthemeDiscriminatorFieldSet}">
                <!-- SUBTHEME FILTERING ON/OFF -->
                <label>
                    <h:selectBooleanCheckbox 
                        id="privCmsAllSubthemesDisabled"
                        rendered="#{adminBean.currentLicense.licenseType.privCmsAllSubthemes}" 
                        disabled="true" 
                        selected="true"
                        title="#{msg.license_privInheritedFromLicenseType}" />
                    <h:selectBooleanCheckbox 
                        id="privCmsAllSubthemes"
                        rendered="#{!adminBean.currentLicense.licenseType.privCmsAllSubthemes}" 
                        value="#{adminBean.currentLicense.privCmsAllSubthemes}">
                        <f:ajax render="@form" />
                    </h:selectBooleanCheckbox> #{msg.license_privCmsAllSubthemes}
                </label>
                <br />
        
                <!-- ALLOWED SUBTHEMES -->
                <ui:fragment rendered="#{!adminBean.currentLicense.privCmsAllSubthemes}">
                <div class="form-group">
                    <h:outputLabel for="subthemes" styleClass="col-sm-4 control-label" value="#{msg.license_allowed_subthemes}" />
                    <div class="col-sm-8">
                        <div class="custom-control custom-control--select multiple">
                            <h:selectManyListbox id="subthemes" value="#{adminBean.currentLicense.subthemeDiscriminatorValues}"
                                disabled="#{!configurationBean.subthemeDiscriminatorFieldSet}">
                                <f:selectItems value="#{cmsBean.subthemeDiscriminatorValues}" />
                            </h:selectManyListbox>
                        </div>
                    </div>
                </div>
                </ui:fragment>
            </ui:fragment>
            
            <!-- CATEGORY FILTERING ON/OFF -->
            <label>
                <h:selectBooleanCheckbox 
                    id="privCmsAllCategoriesDisabled"
                    rendered="#{adminBean.currentLicense.licenseType.privCmsAllCategories}" 
                    disabled="true" 
                    selected="true"
                    title="#{msg.license_privInheritedFromLicenseType}" 
                    label="privCmsAllCategories" />
                <h:selectBooleanCheckbox 
                    id="privCmsAllCategories"
                    rendered="#{!adminBean.currentLicense.licenseType.privCmsAllCategories}" 
                    value="#{adminBean.currentLicense.privCmsAllCategories}"
                    label="privCmsAllCategories">
                    <f:ajax render="@form" />
                </h:selectBooleanCheckbox> #{msg.license_privCmsAllCategories}
            </label>
            <br />
            
            <!-- ALLOWED CATEGORIES -->
            <ui:fragment rendered="#{!adminBean.currentLicense.privCmsAllCategories}">
            <div class="form-group">
                <h:outputLabel for="categories" styleClass="col-sm-4 control-label" value="#{msg.license_allowed_categories}" />
                <div class="col-sm-8">
                    <div class="custom-control custom-control--select multiple">
                        <h:selectManyListbox id="categories" value="#{adminBean.currentLicense.allowedCategories}">
                            <f:selectItems value="#{cmsBean.allCategories}" var="category" itemLabel="#{category.name}" itemValue="#{category}" />
                        </h:selectManyListbox>
                    </div>
                </div>
            </div>
            </ui:fragment>
            
            <!-- TEMPLATE FILTERING ON/OFF -->
            <label>
                <h:selectBooleanCheckbox 
                    id="privCmsAllTemplatesDisabled"
                    rendered="#{adminBean.currentLicense.licenseType.privCmsAllTemplates}" 
                    disabled="true" 
                    selected="true"
                    title="#{msg.license_privInheritedFromLicenseType}" />
                <h:selectBooleanCheckbox 
                    id="privCmsAllTemplates"
                    rendered="#{!adminBean.currentLicense.licenseType.privCmsAllTemplates}" 
                    value="#{adminBean.currentLicense.privCmsAllTemplates}">
                    <f:ajax render="@form" />
                </h:selectBooleanCheckbox> #{msg.license_privCmsAllTemplates}
            </label>
            <br />

            <!-- ALLOWED TEMPLATES -->
            <ui:fragment rendered="#{!adminBean.currentLicense.privCmsAllTemplates}">
            <div class="form-group">
                <h:outputLabel for="templates" styleClass="col-sm-4 control-label" value="#{msg.license_allowed_templates}" />
                <div class="col-sm-8">
                    <div class="custom-control custom-control--select multiple">
                        <h:selectManyListbox id="templates" value="#{adminBean.currentLicense.allowedCmsTemplates}">
                            <f:selectItems value="#{cmsBean.templates}" var="template" itemLabel="#{template.name}" itemValue="#{template.id}" />
                        </h:selectManyListbox>
                    </div>
                </div>
            </div>
            </ui:fragment>
            
        </ui:fragment>
        
       <!-- CROWDSOURCING SETTINGS -->
        <ui:fragment rendered="#{adminBean.currentLicense.licenseType.crowdsourcingType}">
        
            <!-- CAMPAIGN FILTERING ON/OFF -->
            <label>
                <h:selectBooleanCheckbox 
                    id="privCrowdsourcingAllCampaignsDisabled"
                    rendered="#{adminBean.currentLicense.licenseType.privCrowdsourcingAllCampaigns}" 
                    disabled="true" 
                    selected="true"
                    title="#{msg.license_privInheritedFromLicenseType}" 
                    label="privCrowdsourcingAllCampaigns" />
                <h:selectBooleanCheckbox 
                    id="privCrowdsourcingAllCampaigns"
                    rendered="#{!adminBean.currentLicense.licenseType.privCrowdsourcingAllCampaigns}" 
                    value="#{adminBean.currentLicense.privCrowdsourcingAllCampaigns}"
                    label="privCrowdsourcingAllCampaigns">
                    <f:ajax render="@form" />
                </h:selectBooleanCheckbox> #{msg.license_privCrowdsourcingAllCampaigns}
            </label>
            <br />
            
            <!-- ALLOWED CAMPAIGNS -->
            <ui:fragment rendered="#{!adminBean.currentLicense.privCrowdsourcingAllCampaigns}">
            <div class="form-group">
                <h:outputLabel for="campaigns" styleClass="col-sm-4 control-label" value="#{msg.license_allowed_crowdsourcing_campaigns}" />
                <div class="col-sm-8">
                    <div class="custom-control custom-control--select multiple">
                        <h:selectManyListbox id="campaigns" value="#{adminBean.currentLicense.allowedCrowdsourcingCampaigns}">
                            <f:selectItems value="#{crowdsourcingBean.getAllCampaigns('RESTRICTED')}" var="campaign" itemLabel="#{campaign.title}" itemValue="#{campaign}" />
                        </h:selectManyListbox>
                    </div>
                </div>
            </div>
            </ui:fragment>
           
        </ui:fragment>
    </div>
</ui:composition>