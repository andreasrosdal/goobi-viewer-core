<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:viewerComponent="http://xmlns.jcp.org/jsf/composite/components"
	xmlns:adminWidget="http://xmlns.jcp.org/jsf/composite/admin/widgets"
	template="/resources/themes/#{navigationHelper.theme}/templateAdmin.html">

	<ui:define name="metadata">
		<f:metadata>
			<f:event type="preRenderView"
				listener="#{navigationHelper.setCurrentPageAdmin('adminCmsCreatePage')}" />
			<f:event type="preRenderView" listener="#{cmsBean.loadTemplates()}" />
		</f:metadata>
	</ui:define>

	<ui:define name="content">
		<h:panelGroup id="cmsSelectTemplateAccessControl"
			rendered="#{userBean.user.cmsAdmin}">
			<div id="cmsSelectTemplate" class="cms-select-template">
				<h1 class="admin__content-inner-title">#{msg.cms_createPage}</h1>

				<div class="admin__content-inner-content">
					<h:form id="cmsSelectTemplateForm" prependId="false">

						<div class="cms-create-page__choose-template-wrapper">
							<ui:fragment rendered="#{userBean.user.hasPriviledgeForAllTemplates()}">
								<div class="cms-create-page__choose-template-box">
									<div class="cms-create-page__choose-template-box-start">
										<img src="#{request.contextPath}/resources/images/backend/empty_template.jpg" class="img-responsive" alt="Choose empty template" />
									</div>
	
									<div class="cms-create-page__choose-template-box-end">
										<h2>#{msg.cms__create_empty_page_title}</h2>
										<p>#{msg.lorem_ipsum__short}</p>
										<h:commandLink action="pretty:adminCmsNewPage"
											value="#{msg.cms__create_empty_page_button}"
											styleClass="btn btn--full">
											<f:setPropertyActionListener value="#{false}"
												target="#{cmsBean.editMode}" />
										</h:commandLink>
									</div>
								</div>
								<div
									class="cms-create-page__choose-template-box">
									
									<div class="cms-create-page__choose-template-box-start">
										<img src="#{request.contextPath}/resources/images/backend/predefined_template.jpg" class="img-responsive" alt="Choose prefined template" />
									</div>
	
									<div class="cms-create-page__choose-template-box-end">
										<h2>#{msg.cms__create_page_template_title}</h2>
										<p>#{msg.lorem_ipsum__short}</p>
									
										<h:commandLink action="pretty:adminCmsNewPageTemplate"
											value="#{msg.cms__create_page_template_button}"
											styleClass="btn btn--full">
											<f:setPropertyActionListener value="#{false}"
												target="#{cmsBean.editMode}" />
										</h:commandLink>
									</div>
								</div>
							</ui:fragment>
						
						</div>

						<div class="cms-select-template__filters">
							<button type="button" onclick="setTemplateFilter('.admin__entry-list .admin__boxed-entry', this)" 
									class="admin__content-component-option -active">#{msg.all}
							</button>
							<button type="button" onclick="setTemplateFilter('.admin__entry-list .-published:not(.-legacy-template)', this)" 
									class="admin__content-component-option">#{msg.pubished}
							</button>
							<button type="button" onclick="setTemplateFilter('.admin__entry-list .admin__boxed-entry:not(.-published)', this)" 
									class="admin__content-component-option">#{msg.not_published}
							</button>
							<button type="button" onclick="setTemplateFilter('.admin__entry-list .-legacy-template', this)" 
									class="admin__content-component-option">#{msg.legacy}
							</button>
							
							<script>
								function hideAll() {
								    $('.admin__entry-list .admin__boxed-entry').hide();
								}
								function setTemplateFilter(selector, source) {
								    console.log("show Templates with ", selector, source);
								    $(source).parent().children().removeClass("-active");
								    $(source).addClass("-active");
								    hideAll();
								    $(selector).show();
								}
							</script>
						</div>

						<div id="cmsSelectTemplateWrapper"
							class="cms-select-template__wrapper admin__entry-list">
							<ui:repeat value="#{cmsBean.getAllowedTemplates(userBean.user)}"
								var="template">
								<div
									class="admin__boxed-entry row no-gutters -std-bottom-pad -w100 #{template.legacyTemplate ? '-legacy-template':''} #{template.published ? '-published':''}">
									<!-- TEMPLATE -->
									<div class="col-9 d-flex align-items-center">
										<!-- DESCRIPTION -->
										<div class="admin__table-data">
											<h2>#{msg[template.title]}</h2>
											<h:outputFormat value="#{template.description}" escape="false"></h:outputFormat>
										</div>
									</div>
									<div class="col-3">
										<!-- ACTION -->
										<div class="cms-select-template__action">
											<a href="../new/?templateId=#{template.id}" class="btn  #{template.published ? '':'disabled'}">#{msg.cms_createPageWithTemplate}</a>
											<ui:fragment rendered="#{user.hasPriviledgeForAllTemplates()}">
												<a href="edit/#{template.id}/" class="btn">#{msg.cms__edit_template__action}</a>
											</ui:fragment>
										</div>
									</div>
								</div>
							</ui:repeat>
						</div>
					</h:form>
				</div>
			</div>
		</h:panelGroup>
	</ui:define>

</ui:composition>
