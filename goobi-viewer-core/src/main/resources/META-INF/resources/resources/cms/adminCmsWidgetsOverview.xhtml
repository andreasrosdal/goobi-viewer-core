<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:jsf="http://xmlns.jcp.org/jsf"
	xmlns:viewerComponent="http://xmlns.jcp.org/jsf/composite/components"
	xmlns:adminWidget="http://xmlns.jcp.org/jsf/composite/admin/widgets"
	template="/resources/themes/#{navigationHelper.theme}/templateAdmin.html">

	<f:event listener="cmswidgetEditBean.startConversation()"
		type="preRenderView"></f:event>

	<ui:define name="metadata">
		<f:metadata>
			<f:event type="preRenderView"
				listener="#{navigationHelper.setCurrentPageAdmin('adminCmswidgets')}" />
		</f:metadata>
	</ui:define>

	<ui:define name="content">
		<div id="cmsWidgetsOverview" class="cms-widgets-overview">
			<h:panelGroup rendered="#{userBean.user.cmsAdmin}">

				<div class="admin__title-bar">
					<!-- TITLE -->
					<h2 class="admin__title">#{msg.cms_widgets__title}</h2>
                    <!-- CREATE NEW IP RANGE -->
                    <a href="#{navigationHelper.getPageUrl('adminCmsWidgetsAdd')}/" class="btn btn--default admin__title-bar-action">
                    	#{msg.add}
                    </a>
                    
				</div>
			


				<h:form prependId="false">
	
						<div class="admin__content-inner-content">
						
						<div class="admin__info-text">#{msg.cms_widgets__description}:</div>
						
						
                            <div class="cms-widgets-overview__grid">
                                <!--  INDIVIDUAL IP RANGES -->
                                <ui:repeat var="widget" value="#{cmsSidebarWidgetsBean.allWidgets}">
                                
                                
                                <div class="cms-widgets-overview__single-widget-wrapper">
                                    <div class="admin__boxed-entry">

                                    	<!-- TITLE -->
                                        <div class="cms-widgets-overview__single-widget-title-wrapper">                                    	
	                                        <h3 class="cms-widgets-overview__single-widget-title">
	                                        	<span class="cms-widgets-overview__single-widget-title-name">#{widget.title.getValue(navigationHelper.locale).orElse("")}</span>
	                                        	<ui:fragment rendered="#{widget.generationType != 'DEFAULT'}" >
		                                        	<span class="cms-widgets-overview__single-widget-title-type">(#{msg[widget.generationType.label]})</span>
	                                        	</ui:fragment>
	                                        </h3>
	                                        
	                                        <ui:fragment rendered="#{widget.generationType == 'CUSTOM'}">
		                                        <div class="cms-widgets-overview__single-widget-title-indicator">
		                                        	<viewerComponent:localeSelector object="#{widget}" />
		                                        </div>
	                                        </ui:fragment>
                                        </div>
                                        

                                        
											

                                        <!-- DESCRIPTION -->
                                        <p class="admin__boxed-entry-description">#{widget.description.getValue(navigationHelper.locale).orElse("")}</p>
                                        
                                        <!-- INFOS + DATA -->
										<div class="cms-widgets-overview__single-widget-info-wrapper">
										
											<!-- TYPE OF WIDGET -->
											<ui:fragment rendered="#{widget.generationType != 'DEFAULT'}" >
												<div class="cms-widgets-overview__single-widget-info-type">
													<div class="cms-widgets-overview__single-widget-info-label">#{msg.type}</div>
													<div class="cms-widgets-overview__single-widget-info-data">
														#{msg[widget.contentType.label]}
													</div>
												</div>
											</ui:fragment>
											
											<!-- WHERE IS THIS WIDGET DISPLAYED -->
											<c:set var="pages" value="#{widget.embeddingPages}" scope="view"></c:set>
											<ui:fragment rendered="#{not empty pages}">
												<div class="cms-widgets-overview__single-widget-info-used">
													<div class="cms-widgets-overview__single-widget-info-label">#{msg.usage}</div>
													
													<!-- LIST ALL PAGES ON WHICH THIS WIDGET IS ACTIVE -->
	
													<div class="cms-widgets-overview__single-widget-info-data-wrapper">
														<ui:repeat var="page" value="#{pages}">
															<div class="cms-widgets-overview__single-widget-info-data">
																<a href="#{page.url}">#{page.getTitle(navigationHelper.locale)}</a>
															</div>
														</ui:repeat>
													</div>
	
												</div>
											</ui:fragment>

											<!-- ADDITIONAL INFO DEPENDING ON WIDGET TYPE -->
											<ui:fragment rendered="#{false}">
												<div class="cms-widgets-overview__single-widget-info-additional-field">
													
													<div class="cms-widgets-overview__single-widget-info-label">#{msg.maps}</div>
				
												</div>
											</ui:fragment>
										</div>
										
                                        <!-- ACTIONS -->
 										<ui:fragment rendered="#{widget.generationType == 'CUSTOM'}">
                                        <div class="row admin__boxed-entry-actions">
                                            <div class="col-3 d-flex">
                                                <!-- EDIT -->
                                                <a href="#{navigationHelper.applicationUrl}admin/cms/widgets/edit/#{widget.id}/" class="admin__boxed-entry-actions-edit" aria-label="#{msg.edit}: #{widget.title.getValue(navigationHelper.locale).orElse('')}">#{msg.edit}</a>

                                                <!-- DELETE -->
                                                <h:commandLink
                                                    styleClass="admin__boxed-entry-actions-delete -redlink"
                                                    onclick="if ( !confirm( &quot;#{navigationHelper.getTranslationWithParams(msg.ipRange_deleteConfirmationText, widget.title.getValue(navigationHelper.locale).orElse(&quot;&quot;))}&quot; ) ) { return false };"
                                                    action="adminCmsWidgetsOverview"
                                                    actionListener="#{cmsSidebarWidgetsBean.deleteWidget(widget.id)}">
                                                    <f:passThroughAttribute name="aria-label" value="#{msg.delete}: #{widget.title.getValue(navigationHelper.locale).orElse('')}" />
                                                    #{msg.delete}
                                                </h:commandLink>
                                            </div>
                                        </div>
                                        </ui:fragment>
                                    </div>
                                   </div>

                               </ui:repeat>
                           </div>
						

					</div>
						
						

				</h:form>
			</h:panelGroup>
		</div>	
		
	</ui:define>

</ui:composition>


