<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml" 
    xmlns:h="http://xmlns.jcp.org/jsf/html" 
    xmlns:f="http://xmlns.jcp.org/jsf/core" 
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets" 
    xmlns:c="http://java.sun.com/jsp/jstl/core" 
    xmlns:viewerComponent="http://xmlns.jcp.org/jsf/composite/components"
    xmlns:adminWidget="http://xmlns.jcp.org/jsf/composite/admin/widgets" 
    template="/resources/themes/#{navigationHelper.theme}/templateAdmin.html">

    <ui:define name="metadata">
        <f:metadata>
            <f:event type="preRenderView" listener="#{navigationHelper.setCurrentPageAdmin('adminCmsCategories')}" />
            <f:event type="preRenderView" listener="#{cmsBean.init()}" />
        </f:metadata>
    </ui:define>

    <ui:define name="content">
        <ui:fragment id="cmsCategoriesAccessControl" rendered="#{configurationBean.cmsEnabled and userBean.user.isHasCmsPrivilege('CMS_CATEGORIES')}">
            <div id="adminCmsCategories">
                <div class="admin__title-bar">
                    <h2 class="admin__title">#{msg.admin__categories}</h2>
                </div>

                <div class="admin__content-inner-content">
                    <!-- TODO INLINE CSS -->
                    <div style="margin-bottom: 1.6rem;"><h:outputText value="#{msg.admin__categories_description_text}" escape="false" /></div>

                    <!-- LIST -->
                    <!-- TODO INLINE CSS -->
                    <div class="admin__user-table-content" style="margin-bottom:3rem;">
                        <h:form id="adminCategoryListForm" prependId="false">
                            <div class="row no-gutters admin__user-table-title">
                                <div class="col-4 d-flex">#{msg.admin__category_title}</div>
                                <div class="col-8 d-flex">#{msg.admin__category_description}</div>
                            </div>
                            <ui:repeat var="category" value="#{categories.allCategories}">
                                <div class="row no-gutters admin__user-table-entry">
                                    <div class="col-4 d-flex">
                                        <!-- TODO INLINE CSS -->
                                        <div class="admin__user-table-data" style="padding-left:0">
                                            <span>#{category.name}</span>
                                            <div>
                                                <h:commandLink type="button" class="admin__user-table-edit-user -bluelink" action="#{categories.edit(category)}">
                                                    #{msg.button__edit}
                                                    <f:ajax render="@all" />
                                                    <f:passThroughAttribute name="style" value="margin-right:1.4rem;" />
                                                </h:commandLink>
                                                <h:commandLink type="button" class="admin__user-table-edit-user -redlink" action="#{categories.delete(category)}">
                                                    #{msg.button__delete}
                                                    <f:ajax render="@all" />
                                                </h:commandLink>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-8 d-flex">#{category.description}</div>
                                </div>
                            </ui:repeat>
                        </h:form>
                    </div>

                    <!-- CREATE / EDIT -->
                    <h:form id="adminCategoryCreateForm" prependId="false">
                        <ui:fragment rendered="#{!categories.editing}">
                            <h3>#{msg.admin__category_create_new}</h3>
                        </ui:fragment>
                        <ui:fragment rendered="#{categories.editing}">
                            <h3>#{msg.admin__category_edit}</h3>
                        </ui:fragment>


                        <div class="admin__default-block">
                            <fieldset>
                                <!-- TITLE -->
                                <div class="form-group form-row">
                                    <div class="col-2 control-label admin__form-label">
                                        <label for="createCategoryTitle">#{msg.admin__category_title}:</label>
                                        <span class="admin__label-required-field">(#{msg.form__required_field})</span>
                                    </div>
                                    <div class="col-9 admin__form-input">
                                        <h:inputText id="createCategoryTitle" styleClass="form-control" value="#{categories.categoryName}"/>
                                        <span class="admin__form-help-text">#{msg.inline_help__create_category_title}</span>
                                    </div>
                                    <div class="col-1 admin__form-help-icon">
                                        <button type="button" class="btn btn--clean" data-toggle="helptext" aria-label="inline help icon">
                                            <i class="fa fa-question-circle" aria-hidden="true"></i>
                                        </button>
                                    </div>
                                </div>
                                <!-- DESCRIPTION -->
                                <div class="form-group form-row">
                                    <div class="col-2 control-label admin__form-label">
                                        <label for="createCategoryDescription">#{msg.admin__category_description}:</label>
                                    </div>
                                    <div class="col-9 admin__form-input">
                                        <h:inputTextarea id="createCategoryDescription" styleClass="form-control" value="#{categories.categoryDescription}"/>
                                        <span class="admin__form-help-text">#{msg.inline_help__create_category_description}</span>
                                    </div>
                                    <div class="col-1 admin__form-help-icon">
                                        <button type="button" class="btn btn--clean" data-toggle="helptext" aria-label="inline help icon">
                                            <i class="fa fa-question-circle" aria-hidden="true"></i>
                                        </button>
                                    </div>
                                </div>
                            </fieldset>
                        </div>

                        <!-- ACTION -->
                        <div class="row no-gutters justify-content-end admin__final-actions">
                            <h:commandLink rendered="#{categories.editing}" type="button" class="btn btn--cancel" action="#{categories.cancel()}">
                                #{msg.cancel}
                            </h:commandLink>
                            <h:commandLink type="button" class="btn btn--success" action="#{categories.save()}">
                                #{msg.save}
                            </h:commandLink>
                        </div>
                    </h:form>
                </div>
            </div>
        </ui:fragment>
    </ui:define>
</ui:composition>

