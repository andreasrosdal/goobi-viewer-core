<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:jsf="http://xmlns.jcp.org/jsf"
	xmlns:viewerComponent="http://xmlns.jcp.org/jsf/composite/components"
	xmlns:adminWidget="http://xmlns.jcp.org/jsf/composite/admin/widgets"
	template="/resources/themes/#{navigationHelper.theme}/templateAdmin.html">

	<f:event listener="cmswidgetEditBean.startConversation()"
		type="preRenderView"></f:event>

	<ui:define name="metadata">
		<f:metadata>
			<f:event type="preRenderView"
				listener="#{navigationHelper.setCurrentPageAdmin('adminCmswidgets')}" />
		</f:metadata>
	</ui:define>

	<ui:define name="content">
		<div id="cmsWidgetsAdd" class="cms-widgets-add">
			<h:panelGroup rendered="#{userBean.user.cmsAdmin}">

				<div class="admin__title-bar">
					<!-- TITLE -->
					<c:if test="#{customWidgetEditBean.widgetType == null}">
						<h2 class="admin__title">#{msg.cms__add_widget__title}</h2>
					</c:if>
					<c:if test="#{customWidgetEditBean.widgetType != null}">
						<h2 class="admin__title">#{msg.cms__edit_widget__title}</h2>
					</c:if>
				</div>

				<h:form prependId="false">
	
						<div class="admin__content-inner-content">
						
						<div class="admin__content-wrapper">
						
						<div class="admin__content-main -sticky -refreshHCsticky">
						
						  <ui:fragment rendered="#{customWidgetEditBean.widgetType == null}">
							<div class="admin__info-text">#{msg.cms__add_widget__select_type}:</div>
	
							<div class="admin__entry-list -w33">
								<ui:repeat var="type" value="#{customWidgetEditBean.widgetTypes}">
									<div class="admin__boxed-entry -w33">
										<div class="d-flex flex-column h-100">
											<div>
												<h3>#{msg[type.label]}</h3>
											</div>
											<div class="mb-2">
												<p>#{msg[type.description]}</p>
											</div>
											<div class="mt-auto">
												<div class="d-flex">
													<button jsf:action="#{customWidgetEditBean.createWidget(type)}" class="btn btn--default ml-auto">#{msg.action__select}</button>
												</div>
											</div>
										</div>
									</div>
								</ui:repeat>
							</div>
						</ui:fragment>
						
						<ui:fragment rendered="#{customWidgetEditBean.widgetType != null}">
							<c:set var="widget" value="#{customWidgetEditBean.widget}" scope="view"/>
							<div class="form-horizontal form-group admin__content-wrapper">
								<div class="w-100">
									<h3 class="admin__content-inner-content__form_title mt-0">
										#{msg.general}
									</h3>
									
									
									<!-- LANGUAGE TABS -->
									<div class="admin__language-tabs">
										<viewerComponent:localeSelector object="#{widget}"/>
									</div>
									<div class="admin__default-block">
	
										<!-- TITLE -->
												<div class="form-group form-row">
													<div class="col-2 control-label admin__form-label">
														<label for="widgetTitle">
															#{msg.label__cms_page_title}: 
															<ui:fragment rendered="#{widget.isDefaultLocaleSelected()}">
																<span class="admin__label-required-field">(#{msg.form__required_field})</span>
															</ui:fragment>
														</label>
													</div>

													<div class="col-9 cms-module__option-control admin__form-input">
													
									                    <h:message for="widgetTitle" errorClass="-validation-message -danger"></h:message>
		                                                 <div class="-validation-mark">
		                                                     <i class="fa fa-check" aria-hidden="true"></i>
		                                                     <i class="fa fa-exclamation" aria-hidden="true"></i>
		                                                 </div>
		                                                 
														<h:inputText value="#{widget.title.text}"
															id="widgetTitle" label="widgetTitle"
															styleClass="form-control -validation-input" required="#{widget.isDefaultLocaleSelected()}"
															requiredMessage="#{msg.info__input_required}">
															<f:passThroughAttribute name="aria-label" value="#{msg.label__cms_page_title}"/>
														</h:inputText>
														<span class="admin__form-help-text">#{msg.help__cms_page_title}</span>
													</div>

													<div class="col-1 admin__form-help-icon">
														<button type="button" class="btn btn--clean"
															data-toggle="helptext" aria-label="inline help icon">
															<i class="fa fa-question-circle" aria-hidden="true"></i>
														</button>
													</div>
												</div>

									</div>
									
									<ui:fragment rendered="#{widget.type == 'WIDGET_CMSPAGES'}">
									<h3 class="admin__content-inner-content__form_title mt-0">
										#{msg.settings}
									</h3>
									
									<div class="admin__default-block">
												<div class="form-group form-row">
													<div class="col-2 control-label admin__form-label">
														<label for="pagesSelect">
															#{msg.admin__cms_pages}: <span
															class="admin__label-required-field">(#{msg.form__required_field})</span>
														</label>
													</div>
	
													<div
														class="col-9 admin__form-input cms-module__option-control">
	
														<h:message for="pagesSelect"
															errorClass="-validation-message -danger"></h:message>
														<div class="-validation-mark">
															<i class="fa fa-check" aria-hidden="true"></i> <i
																class="fa fa-exclamation" aria-hidden="true"></i>
														</div>
														<h:selectManyListbox id="pagesSelect"
															styleClass="form-control -validation-input"
															required="true"
															requiredMessage="#{msg.info__input_required}"
															value="#{widget.collections}">
															<h:selectManyCheckbox value="#{widget.pageIds}">
																<f:selectItems value="#{cmsBean.validCMSPages}" var="page" itemLabel="#{page.title}" itemValue="#{page.id}"></f:selectItems>
															</h:selectManyCheckbox>
															
														</h:selectManyListbox>
														<span class="admin__form-help-text">#{msg.cms__edit_widget__collections__help}</span>
													</div>
													<div class="col-1 admin__form-help-icon">
														<button type="button" class="btn btn--clean"
															data-toggle="helptext" aria-label="inline help icon">
															<i class="fa fa-question-circle" aria-hidden="true"></i>
														</button>
													</div>
												</div>
									</div>
									</ui:fragment>		
									
									
									<ui:fragment rendered="#{widget.type == 'WIDGET_HTML'}">
									<h3 class="admin__content-inner-content__form_title mt-0">
										#{msg.settings}
									</h3>		
												
									<div class="admin__default-block">
									
										<div class="form-group form-row">
											<h:outputLabel value="#{msg.cms_sidebarElement_html}:" styleClass="col-2 control-label" />
											<div class="col-9">
												<h:inputTextarea value="#{widget.htmlText.text}" styleClass="form-control tinyMCE">
													<f:passThroughAttribute name="aria-label" value="#{msg.cms_sidebarElement_html}" />
												</h:inputTextarea>
												<span class="admin__form-help-text">#{msg.cms__edit_widget__style__help}</span>
											</div>
											<div class="col-1 admin__form-help-icon">
												<button type="button" class="btn btn--clean"
													data-toggle="helptext" aria-label="inline help icon">
													<i class="fa fa-question-circle" aria-hidden="true"></i>
												</button>
											</div>
											
										</div>
									
									</div>
									</ui:fragment>
									
	
									<h3 class="admin__content-inner-content__form_title mt-0">
										#{msg.settings}
									</h3>		
												
									<div class="admin__default-block">
										
										<!-- STYLE -->
										<div class="form-group form-row">
											<div class="col-2 control-label admin__form-label">
												<label for="styleSelect">
													#{msg.cms__edit_widget__style__label}: </label>
											</div>

											<div class="col-9 admin__form-input cms-module__option-control">
												<h:inputText value="#{widget.styleClass}"
															id="styleSelect" label="styleSelect"
															styleClass="form-control -validation-input" required="false"
															requiredMessage="#{msg.info__input_required}">
															<f:passThroughAttribute name="aria-label" value="#{msg.cms__edit_widget__style__label}"/>
												</h:inputText>
<!-- 												<select onchange="setStyle({widgetStyle : this.value});" id="styleSelect" class="form-control" data-value="#{widget.cssStyle}" data-options="widget-styles"> -->
<!-- 													<option value="" disabled="disabled">#{msg.action__select}</option> -->
<!-- 												</select> -->
												<span class="admin__form-help-text">#{msg.cms__edit_widget__style__help}</span>
											</div>
											<div class="col-1 admin__form-help-icon">
												<button type="button" class="btn btn--clean"
													data-toggle="helptext" aria-label="inline help icon">
													<i class="fa fa-question-circle" aria-hidden="true"></i>
												</button>
											</div>
										</div>
										
										<!-- COLLAPSED -->
										<div class="form-group form-row">
											<div class="col-2 control-label admin__form-label">
												<label for="toggleCollapsed">
													#{msg.cms__edit_widget__collapsed__label}: </label>
											</div>

											<div class="col-9 admin__form-input cms-module__option-control">
												<viewerComponent:toggleSwitch
													name="toggleCollapsed"
													value="#{widget.collapsed}"/>  
												<span class="admin__form-help-text">#{msg.cms__edit_widget__collapsed__help}</span>
											</div>
											<div class="col-1 admin__form-help-icon">
												<button type="button" class="btn btn--clean"
													data-toggle="helptext" aria-label="inline help icon">
													<i class="fa fa-question-circle" aria-hidden="true"></i>
												</button>
											</div>
										</div>
		
								</div>
								</div>
								
								
							</div>
							</ui:fragment>
	
							<div
								class="row no-gutters justify-content-end admin__final-actions">
								<a class="btn btn--cancel"
									href="#{customWidgetEditBean.returnUrl}">#{msg.button__abort}
								</a>
								<button class="btn btn--success" jsf:action="#{customWidgetEditBean.save()}">
									
									#{msg.button__save}
									
								</button>
							</div>
							
							
													</div>
							
							
							<div class="admin__content-side">
                                <div class="admin__default-block">
                                    <h:panelGroup binding="#{customWidgetEditBean.previewGroup}"/>
                                </div>
                            </div>

							
						</div>
						</div>
						
						

				</h:form>
			</h:panelGroup>
		</div>	
		
	</ui:define>

</ui:composition>


